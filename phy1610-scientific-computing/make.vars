# generate dependency files with each compilation:
CXXFLAGS += -MMD

CXXFLAGS += -I../inc

# PRODUCTION := 1
ifdef PRODUCTION
   CXXFLAGS += -DNDEBUG
   CXXFLAGS += -O2
else
   CXXFLAGS += -g
endif

GPROF := gprof --line --no-graph --brief
ifdef PROFILED
   PROFFLAGS += -pg
   ifdef SCRATCH
      # on scinet:
      PROFFLAGS += -gstabs
   else
      PROFFLAGS += -g
   endif

   CXXFLAGS += $(PROFFLAGS)
   LDFLAGS += $(PROFFLAGS)
endif

OSNAME := $(shell uname -o)
ifeq ("$(OSNAME)","Cygwin")
   CXXFLAGS += -D_GLIBCXX_USE_C99

   # get cxx11 abi link errors attempting to use boost unit_test with the pre-compiled boost library
   CXXFLAGS += -DUSE_SINGLE_HEADER_BOOST_TEST_FRAMEWORK

   # for putenv and mkstemp
   CXXFLAGS += -U__STRICT_ANSI__
endif

ifdef SCINET_FFTW_INC
   CXXFLAGS += -I$(SCINET_FFTW_INC)
   LDFLAGS += -L$(SCINET_FFTW_LIB)
endif

BOOST_TEST_LDLIBS += -lboost_unit_test_framework
ifdef SCINET_BOOST_INC
	CXXFLAGS += -I$(SCINET_BOOST_INC)
	LDFLAGS += -L$(SCINET_BOOST_LIB)
endif

ifdef SCINET_OPENBLAS_INC
   CXXFLAGS += -I$(SCINET_OPENBLAS_INC)
   LDFLAGS += -L$(SCINET_OPENBLAS_LIB)
   LDFLAGS += -lopenblas
endif

CXXFLAGS += -Wall -Werror

#CXXFLAGS += -std=c++11
CXXFLAGS += -std=c++14

TARGETS += .gitignore

CLEANTARGETS += html latex

# clean dependency and object files if any
CLEANTARGETS += *.o
CLEANTARGETS += *.d
