%
% Copyright © 2012 Peeter Joot.  All Rights Reserved.
% Licenced as described in the file LICENSE under the root directory of this GIT repository.
%
\documentclass{scrreprt}
\usepackage{scrpage2}
\usepackage{lipsum}
\usepackage{currfile}

%\clearscrheadings
%\setheadsepline{0pt}
%\lefoot{\currfilepath}
%%\rofoot{\currfilepath}
%
%\renewcommand{\chaptermark}[1] %
%{\markboth{\chaptername\ \thechapter.\ #1}{}}
%
%\renewcommand{\sectionmark}[1] %
%{\markright{\thesection.\ #1}}

%\renewcommand{\headfont}{\bfseries\fontsize{9}{11}\selectfont}
%\renewcommand{\pnumfont}{\bfseries\fontsize{9}{11}\selectfont}

\PassOptionsToPackage{automark}{scrpage2}
   \RequirePackage{scrpage2} % provides headers and footers (KOMA Script)
    \clearscrheadings
    \setheadsepline{0pt}
%    \ifthenelse{\boolean{@nochapters}}%
%        {\relax}%
%        {
\renewcommand{\chaptermark}[1]{\markboth{\spacedlowsmallcaps{#1}}{\spacedlowsmallcaps{#1}}\currfilepath}
%}
    \renewcommand{\sectionmark}[1]{\markright{\thesection\enspace\spacedlowsmallcaps{#1}}\currfilepath}
    \lehead{\mbox{\llap{\small\thepage\kern2em}\headmark\hfil}}
    \rohead{\mbox{\hfil{\headmark}\rlap{\small\kern2em\thepage}}}
    %\lehead{\mbox{\llap{\small\thepage\ \currfilepath\kern2em}\headmark\hfil}}
    %\rohead{\mbox{\hfil{\headmark}\rlap{\small\kern2em\thepage\ \currfilepath}}}
    \renewcommand{\headfont}{\small}
%    \DeclareRobustCommand{\fixBothHeadlines}[2]{} % <--- ToDo
    % hack to get the content headlines right (thanks, Lorenzo!)
%      \def\toc@heading{%
%         \ifthenelse{\boolean{@nochapters}}%
%         {\section*{\contentsname}}%nochapters
%         {\chapter*{\contentsname}}%chapters
%         \@mkboth{\spacedlowsmallcaps{\contentsname}}{\spacedlowsmallcaps{\contentsname}}}


\begin{document}
\chapter{blah}
\lipsum
\clearpage
\lipsum
\clearpage
\chapter{foo}
\section{foo bar}
\include{a/b/f1}
\section{more foo bar}
\include{a/b/f2}
%\chapter{moo}
%\include{a/b/f3}
%\include{a/b/f4}
%\include{a/b/f5}
%\include{a/b/f6}
\end{document}
