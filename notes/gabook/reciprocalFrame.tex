\documentclass{article}      % Specifies the document class

\input{../peeters_macros.tex}

\DeclareMathOperator{\AbsName}{abs}

\DeclareMathOperator{\RejName}{Rej}
\newcommand{\Rej}[2]{\RejName_{#1}\left( {#2} \right)}

\DeclareMathOperator{\AName}{A}
\newcommand{\AreaOp}[1]{\AName_{#1}}

\DeclareMathOperator{\VName}{V}
\newcommand{\VolumeOp}[1]{\VName_{#1}}

%
% The real thing:
%

                             % The preamble begins here.
\title{ Reciprocal Frame Vectors } % Declares the document's title.
\author{Peeter Joot}         % Declares the author's name.
%\date{}        % Deleting this command produces today's date.

\begin{document}             % End of preamble and beginning of text.

\maketitle{}

\section{ Approach without Geometric Algebra. }

Without employing geometric algebra, one can use the projection
operation expressed as a dot product and calculate the a vector
orthogonal to a set of other vectors, in the direction of a reference
vector.

Such a calculation also yields \R{N} results in terms of deteminants, and as a side
effect produces equations for
parallelogram area, parallopiped volume and higher dimensional analogues as a side effect
(without having to employ change of basis diagonalization arguments that don't work well
for higher dimensional subspaces).

\subsection{ Orthogonal to one vector }

The simplest case is the vector perpendicular to another.  In anything
but \R{2} there are a whole set of such vectors, so to express this as a
non-set result a reference vector is required.

Calculation of the coordinate vector for this case follows directly from
the dot product.  Borrowing the GA term, we subtract the projection
to calculate the rejection.

\begin{align*}
\Rej{\ucap}{\Bv}
&= \Bv - \Bv \cdot \ucap \ucap \\
&= \inv{\Bu^2}(\Bv\Bu^2 - \Bv \cdot \Bu \Bu) \\
&= \inv{\Bu^2}\sum{v_i\Be_i u_j u_j - v_j u_j u_i \Be_i} \\
&= \inv{\Bu^2}\sum{u_j\Be_i\DETuvij{v}{u}{i}{j}} \\
&= \inv{\Bu^2}\sum_{i<j}{(u_i \Be_j -u_j\Be_i)\DETuvij{u}{v}{i}{j}} \\
\end{align*}

Thus we can write the rejection of $\Bv$ from $\ucap$ as:

\begin{equation}\label{eqn:rejonevector}
\Rej{\ucap}{\Bv} = \inv{\Bu^2}\sum_{i<j}\DETuvij{u}{v}{i}{j}\DETuvij{u}{\Be}{i}{j}
\end{equation}

Or introducing some shorthand:

\begin{align*}
D_{ij}^{\Bu \Bv} &= \DETuvij{u}{v}{i}{j} \\
D_{ij}^{\Bu \Be} &= \DETuvij{u}{\Be}{i}{j} \\
\end{align*}

equation \ref{eqn:rejonevector} can be expressed in a form that will be slightly more convient for larger sets of
vectors:

\begin{equation}\label{eqn:rejonevectorD}
\Rej{\ucap}{\Bv} = \inv{\Bu^2}\sum_{i<j} D_{ij}^{\Bu \Bv} D_{ij}^{\Bu \Be}
\end{equation}

Note that although the GA axiom $\Bu^2 = \Bu \cdot \Bu$ has been used
in equations \ref{eqn:rejonevector} and \ref{eqn:rejonevectorD} above and the derivation, that was
not neccessary to prove them.
This can, for now, be thought of as a notational convienence, to avoid having to write $\Bu \cdot \Bu$, or
$\norm{\Bu}^2$.

This result can be used to express the \R{N} area of a parallogram since we just have to multiply the length
of $\Rej{\ucap}{\Bv}$:

\[
\norm{\Rej{\ucap}{\Bv}}^2 = 
\Rej{\ucap}{\Bv} \cdot \Bv =
\inv{\Bu^2}\sum_{i<j} {\left(D_{ij}^{\Bu \Bv}\right)}^2
\]

with the length of the base $\norm{\Bu}$. [FIXME: insert figure.]

Thus the area (squared) is:

\begin{equation}\label{eqn:parallogramarea}
\AreaOp{\Bu,\Bv}^2 = \sum_{i<j} {\left(D_{ij}^{\Bu \Bv}\right)}^2
\end{equation}

For the special case of a vector in \R{2} this is
\begin{equation}\label{eqn:parallogramarear2}
\AreaOp{\Bu,\Bv} = \abs{D_{12}^{\Bu \Bv}} = \AbsName\left(\DETuvij{u}{v}{i}{j}\right)
\end{equation}

\subsection{ Vector orthogonal to two vectors in direction of a third. }

The same procedure can be followed for three vectors, but the algebra gets messier.  Given three vectors $\Bu$, $\Bv$, and $\Bw$
we can calculate the component $\Bw'$ of $\Bw$ perpendicular to $\Bu$ and $\Bv$.  That is:

\begin{align*}
\Bv' &= \Bv - \Bv \cdot \ucap \ucap \\
\implies & \\
\Bw' &= \Bw - \Bw \cdot \ucap \ucap - \Bw \cdot \hat{\Bv'} \hat{\Bv'}
\end{align*}

After expanding this out, a number of the terms magically cancel out and one is left with

\begin{align*}
\Bw'' = \Bw' (\Bu^2\Bv^2 - (\Bu \cdot \Bv)^2)
&= \Bu \left(-\Bu \cdot \Bw \Bv^2 + (\Bu \cdot \Bv)(\Bv \cdot \Bw)\right)  \\
&+ \Bv \left(-\Bu^2(\Bv \cdot \Bw) - (\Bu \cdot \Bv)(\Bu \cdot \Bw)\right)  \\
&+ \Bw \left(\Bu^2\Bv^2 - (\Bu \cdot \Bv)^2\right) \\
\end{align*}

And this in turn can be expanded in terms of coordinates and the results collected yielding

\begin{align*}
\Bw'' &= \sum \Be_i u_j v_k \left(
u_i \DETuvij{v}{w}{j}{k}
-v_i \DETuvij{u}{w}{j}{k}
w_i \DETuvij{u}{v}{j}{k}
\right) \\
&= \sum \Be_i u_j v_k \DETuvwijk{u}{v}{w}{i}{j}{k} \\
&= \sum_{i,j<k} \Be_i \DETuvij{u}{v}{j}{k} \DETuvwijk{u}{v}{w}{i}{j}{k} \\
&= 
\left(\sum_{i<j<k} + \sum_{j<i<k} + \sum_{j<k<i} \right) \Be_i \DETuvij{u}{v}{j}{k} \DETuvwijk{u}{v}{w}{i}{j}{k}.
\end{align*}

Expanding the sum of the denominator in terms of coordinates:
\[
\Bu^2\Bv^2 - (\Bu \cdot \Bv)^2 = \sum_{i<j} \DETuvij{u}{v}{i}{j}^2
\]

and using a change of summation indexes, our final result for the vector perpendicular to two others in the direction of a third is:

\begin{equation}\label{eqn:orthotwovectors}
\Rej{\ucap,\vcap}{\Bw} = 
\frac{\sum_{i<j<k} \DETuvwijk{u}{v}{w}{i}{j}{k} \DETuvwijk{u}{v}{\Be}{i}{j}{k}}
{\sum_{i<j} \DETuvij{u}{v}{i}{j}^2}
\end{equation}

As in equation \ref{eqn:rejonevectorD}, use of a $D_{ijk}^{\Bu\Bv\Bw}$ notation allows for a more compact
result:

\begin{equation}\label{eqn:rejtwovectorsD}
\Rej{\ucap\vcap}{\Bw} = 
{\left(\sum_{i<j} \left(D_{ij}^{\Bu\Bv}\right)^2\right)}^{-1}
\sum_{i<j<k} D_{ijk}^{\Bu\Bv\Bw} D_{ijk}^{\Bu\Bv\Be}
\end{equation}

And, as before this yields the Volume of the parallopiped by multiplying perpendicular height:

\[
\norm{\Rej{\ucap\vcap}{\Bw}} =
\Rej{\ucap\vcap}{\Bw} \cdot \Bw =
{\left(\sum_{i<j} \left(D_{ij}^{\Bu\Bv}\right)^2\right)}^{-1}
\sum_{i<j<k} \left(D_{ijk}^{\Bu\Bv\Bw} \right)^2
\]

by the base area.

Thus the squared volume of a parallopiped spanned by the three vectors is:

\begin{equation}\label{eqn:parallopipedvolume}
\VolumeOp{\Bu,\Bv,\Bw}^2 = \sum_{i<j<k} {\left(D_{ijk}^{\Bu \Bv \Bw}\right)}^2.
\end{equation}

The simplest case is for \R{3} where we have only one summand:

\begin{equation}\label{eqn:parallopipedvolumer3}
\VolumeOp{\Bu,\Bv,\Bw} 
= \abs{D_{ijk}^{\Bu \Bv \Bw}}
= \AbsName\left(
\DETuvwijk{u}{v}{w}{1}{2}{3}
\right).
\end{equation}

\subsection{ Generalization.  Inductive Hypothosis. }

There are two things to prove

\begin{enumerate}
\item hypervolume of parallolopiped spanned by vectors $\Bu_1, \Bu_2, \dots, \Bu_k$

\begin{equation} \label{eqn:hypervolume}
\VolumeOp{\Bu_1, \Bu_2, \cdots, \Bu_k}^2
=
\sum_{i_1 < i_2 < \cdots < i_k } \left(
D_{i_1 i_2 \cdots i_k}^{\Bu_{i_1} \Bu_{i_2} \cdots \Bu_{i_k}}
\right)^2
\end{equation}

\item Orthogonal rejection of a set of vectors in direction of another.

\begin{equation} \label{eqn:hyperrejection}
\Rej{\ucap_1\cdots\ucap_{k-1}}{\Bu_k} = 
\frac{
\sum_{i_1 < \cdots < i_{k} } 
D_{i_1 \cdots i_{k}}^{\Bu_{i_1} \cdots \Bu_{i_{k}}}
D_{i_1 \cdots i_{k}}^{\Bu_{i_1} \cdots \Bu_{i_{k-1}} \Be }}
{
\sum_{i_1 < \cdots < i_{k-1} } \left(D_{i_1 \cdots i_{k-1}}^{\Bu_{i_1} \cdots \Bu_{i_{k-1}}}\right)^2
}
\end{equation}
\end{enumerate}

I cannot recall if I ever did the inductive proof for this.
Proving for the initial case is done (since it's proved for both the 
two and three vector cases).  For the limiting case where $k=n$ it can be observed that this is normal to all the others, so the
only thing to prove for that case is if the scaling provided by hypervolume equation \ref{eqn:hypervolume} is correct.

\subsection{ Scaling required for reciprocal frame vector. }

Presuming an inductive proof of the general result of \ref{eqn:hyperrejection} is possible, this rejection
has the property

\begin{equation*}
\Rej{\ucap_1\cdots\ucap_{k-1}}{\Bu_k} \cdot \Bu_i \propto \delta_{ki}
\end{equation*}

With the scaling factor picked so that this equals $\delta_{ki}$, the resulting ``reciprocal frame vector'' is

\begin{equation} \label{eqn:framevec}
\Bu^k =
\frac{
\sum_{i_1 < \cdots < i_{k} } 
D_{i_1 \cdots i_{k}}^{\Bu_{i_1} \cdots \Bu_{i_{k}}}
D_{i_1 \cdots i_{k}}^{\Bu_{i_1} \cdots \Bu_{i_{k-1}} \Be }}
{
\sum_{i_1 < \cdots < i_{k} } \left(D_{i_1 \cdots i_{k}}^{\Bu_{i_1} \cdots \Bu_{i_{k}}}\right)^2
}
\end{equation}

The superscript notation is borrowed from Doran/Lasenby, and denotes not a vector raised to a power, but this
this special vector satisfying the following othongonality and scaling criteria:
\[
\Bu^k \cdot \Bu_i = \delta_{ki}.
\]

Note that for $k=n-1$, equation \ref{eqn:framevec} reduces to

\begin{equation} \label{eqn:framevecnminus}
\Bu^n =
\frac{ D_{1 \cdots (n-1)}^{\Bu_1 \cdots \Bu_{n-1} \Be} } { D_{1 \cdots n}^{\Bu_1 \cdots \Bu_n} }.
\end{equation}

Observe that for \R{3}, writing $\Bu = \Bu_1$, $\Bv = \Bu_2$, $\Bw = \Bu_3$, and $\Bw' = {\Bu_3}^3$ this is:

\begin{equation*}
\Bw' = 
\frac{\DETuvwijk{u}{v}{\Be}{1}{2}{3}}{\DETuvwijk{u}{v}{w}{1}{2}{3}}
= 
\frac{\Bu \cross \Bv}{(\Bu \cross \Bv) \cdot \Bw}
\end{equation*}

We have the cross product scaled by the (signed) volume for the parallopiped spanned by the three vectors.

\end{document}               % End of document.
