\documentclass{article}

\input{../peeters_macros.tex}
\input{../peeters_macros2.tex}

\usepackage[bookmarks=true]{hyperref}

\title{Some notes on Euler Angles.}
\author{Peeter Joot}
\date{ November 1, 2008. Last Revision: $Date: 2008/11/02 19:01:12 $ }

\begin{document}

\maketitle{}
\tableofcontents

\section{ Removing the rotors from the exponentials. }

In \cite{doran2003gap} section 2.7.5 the Euler angle formula is 
developed for $\{z,x',z''\}$ axis rotations by $\{\phi, \theta, \psi\}$
respectively.

Other than a few details the derivation is pretty straightforward.  Equation
2.153 would be clearer with a series expansion hint like

\begin{align*}
\exp(R \alpha i R^\dagger) 
&= \sum_k \inv{k!} (R \alpha i R^\dagger)^k \\
&= \sum_k \inv{k!} R (\alpha i)^k R^\dagger \\
&= R \exp(\alpha i) R^\dagger
\end{align*}

where $i$ is a bivector, and $R$ is a rotor ($RR^\dagger = 1$).

\section{ In matrix form. }

The end result of the composite Euler rotations is that the rotation is

\begin{align*}
R(x) &= R x R^\dagger \\
R &= \exp(-e_{12}\psi/2) \exp(-e_{23}\theta/2) \exp(-e_{12}\phi/2)
\end{align*}

Then there are notes saying this is easier to visualize and work with than
the equivalent matrix formula.  Let's see what the equivalent matrix formula
is.  First calculate the rotor action on $\Be_1$

\begin{align*}
R \Be_1 R^\dagger
&= 
e^{-e_{12}\psi/2} e^{-e_{23}\theta/2} e^{-e_{12}\phi/2}
\Be_1
e^{e_{12}\phi/2}
e^{e_{23}\theta/2} 
e^{e_{12}\psi/2} \\
&= 
e^{-e_{12}\psi/2} e^{-e_{23}\theta/2} 
\Be_1 e^{e_{12}\phi}
e^{e_{23}\theta/2} 
e^{e_{12}\psi/2} \\
&= 
e^{-e_{12}\psi/2} e^{-e_{23}\theta/2} 
(\Be_1 C_\phi + \Be_2 S_\phi)
e^{e_{23}\theta/2} 
e^{e_{12}\psi/2} \\
&= 
e^{-e_{12}\psi/2} 
(\Be_1 C_\phi + \Be_2 S_\phi e^{e_{23}\theta} )
e^{e_{12}\psi/2} \\
&= 
e^{-e_{12}\psi/2} 
(\Be_1 C_\phi + \Be_2 S_\phi C_\theta + \Be_3 S_\phi S_\theta )
e^{e_{12}\psi/2} \\
&= 
(\Be_1 C_\phi + \Be_2 S_\phi C_\theta ) e^{e_{12}\psi} 
+ \Be_3 S_\phi S_\theta  \\
&= 
  \Be_1 (C_\phi C_\psi - S_\phi C_\theta S_\psi)
+ \Be_2 (C_\phi S_\psi - S_\phi C_\theta C_\psi)
+ \Be_3 S_\phi S_\theta  \\
\end{align*}

Now $\Be_2$:

\begin{align*}
R \Be_2 R^\dagger
&= 
e^{-e_{12}\psi/2} e^{-e_{23}\theta/2} e^{-e_{12}\phi/2}
\Be_2
e^{e_{12}\phi/2}
e^{e_{23}\theta/2} 
e^{e_{12}\psi/2} \\
&= 
e^{-e_{12}\psi/2} e^{-e_{23}\theta/2} 
(\Be_2 C_\phi - \Be_1 S_\phi)
e^{e_{23}\theta/2} 
e^{e_{12}\psi/2} \\
&= 
(\Be_2 C_\phi C_\theta
- \Be_1 S_\phi)
e^{e_{12}\psi} 
+\Be_3 C_\phi S_\theta \\
&= 
- \Be_1 (C_\phi C_\theta S_\psi + S_\phi C_\psi)
+ \Be_2 (S_\phi S_\psi + C_\phi C_\theta C_\psi)
+ \Be_3 C_\phi S_\theta \\
\end{align*}

And finally $\Be_3$

\begin{align*}
R \Be_3 R^\dagger
&= 
e^{-e_{12}\psi/2} e^{-e_{23}\theta/2} e^{-e_{12}\phi/2}
\Be_3
e^{e_{12}\phi/2}
e^{e_{23}\theta/2} 
e^{e_{12}\psi/2} \\
&= 
e^{-e_{12}\psi/2} 
\Be_3 e^{e_{23}\theta} 
e^{e_{12}\psi/2} \\
&= 
e^{-e_{12}\psi/2} 
(
\Be_3 C_\theta
-\Be_2 S_\theta
)
e^{e_{12}\psi/2} \\
&= -\Be_2 S_\theta e^{e_{12}\psi} +\Be_3 C_\theta \\
&= 
 \Be_1 S_\theta S_\psi
-\Be_2 S_\theta C_\psi
+\Be_3 C_\theta \\
\end{align*}

This can now be assembled into matrix form
\begin{align*}
\begin{bmatrix}
R(x) \cdot \Be_1 \\
R(x) \cdot \Be_2 \\
R(x) \cdot \Be_3
\end{bmatrix}
=
\begin{bmatrix}
(R \Be_1 R^\dagger) \cdot \Be_1 & (R \Be_2 R^\dagger) \cdot \Be_1 & (R \Be_3 R^\dagger) \cdot \Be_1 \\
(R \Be_1 R^\dagger) \cdot \Be_2 & (R \Be_2 R^\dagger) \cdot \Be_2 & (R \Be_3 R^\dagger) \cdot \Be_2 \\
(R \Be_1 R^\dagger) \cdot \Be_3 & (R \Be_2 R^\dagger) \cdot \Be_3 & (R \Be_3 R^\dagger) \cdot \Be_3 \\
\end{bmatrix}
\begin{bmatrix}
x^1 \\
x^2 \\
x^3 \\
\end{bmatrix} = \BR \Bx
\end{align*}

Therefore we have the composite matrix form for the Euler angle rotations
\begin{align*}
\BR &=
%\begin{bmatrix}
%C_\phi C_\psi - S_\phi C_\theta S_\psi   & -S_\phi C_\psi - C_\phi C_\theta S_\psi & S_\theta S_\psi \\
%C_\phi S_\psi - S_\phi C_\theta C_\psi   & S_\phi S_\psi + C_\phi C_\theta C_\psi  & -S_\theta C_\psi \\
%S_\phi S_\theta                          & C_\phi S_\theta                         & C_\theta \\
%\end{bmatrix}
\begin{bmatrix}
C_\psi C_\phi - S_\psi C_\theta S_\phi & - C_\psi S_\phi - S_\psi C_\theta C_\phi & S_\psi S_\theta \\
S_\psi C_\phi - C_\psi C_\theta S_\phi &  S_\psi S_\phi + C_\psi C_\theta C_\phi & -C_\psi S_\theta \\
S_\theta S_\phi & S_\theta C_\phi & C_\theta \\
\end{bmatrix}
\end{align*}

Lots of opportunity to make sign errors here.  Let's check with matrix multiplication, which should give the same result

\section{ With composition of rotation matrixes. }

\begin{align*}
R(x) &= \BR \Bx \\
&= 
\BR_{\psi \Be_3}
\BR_{\theta \Be_1}
\BR_{\phi \Be_3} \Bx \\
\end{align*}

Now, that first rotation is

\begin{align*}
R_\phi(x)
&= e^{-e_{12}\phi/2} (\Be_i x^i) e^{e_{12}\phi/2} \\
&= ( \Be_1 x^1 +\Be_2 x^2) e^{e_{12}\phi} + \Be_3 x^3 \\
&= 
 x^1 ( \Be_1 \cos\phi +\Be_2 \sin\phi )
+x^2 ( \Be_2 \cos\phi -\Be_1 \sin\phi )
+x^3 \Be_3 \\
&= 
 \Be_1 ( x^1 \cos\phi - x^2 \sin\phi )
+\Be_2 ( x^1 \sin\phi + x^2 \cos\phi )
+\Be_3 x^3 \\
\end{align*}

Which has the expected matrix form

\begin{align*}
\BR_{\phi \Be_3} \Bx =
\begin{bmatrix}
\cos\phi & - \sin\phi & 0 \\
\sin\phi & \cos\phi & 0 \\
0 & 0 & 1 \\
\end{bmatrix}
\begin{bmatrix}
x^1 \\
x^2 \\
x^3 \\
\end{bmatrix}
\end{align*}

Using $C_x = \cos(x)$, and $S_x = \sin(x)$ for brievity, the composite rotation is
\begin{align*}
\BR_{\psi \Be_3} \BR_{\theta \Be_1} \BR_{\phi \Be_3} 
&=
\begin{bmatrix}
C_\psi & - S_\psi & 0 \\
S_\psi & C_\psi & 0 \\
0 & 0 & 1 \\
\end{bmatrix} 
\begin{bmatrix}
1 & 0 & 0 \\
0 & C_\theta & - S_\theta \\
0 & S_\theta & C_\theta \\
\end{bmatrix} 
\begin{bmatrix}
C_\phi & - S_\phi & 0 \\
S_\phi & C_\phi & 0 \\
0 & 0 & 1 \\
\end{bmatrix} \\
&=
\begin{bmatrix}
C_\psi & - S_\psi C_\theta & S_\psi S_\theta \\
S_\psi & C_\psi C_\theta & -C_\psi S_\theta \\
0 & S_\theta & C_\theta \\
\end{bmatrix} 
\begin{bmatrix}
C_\phi & - S_\phi & 0 \\
S_\phi & C_\phi & 0 \\
0 & 0 & 1 \\
\end{bmatrix} \\
&=
\begin{bmatrix}
C_\psi C_\phi - S_\psi C_\theta S_\phi & -C_\psi S_\phi - S_\psi C_\theta C_\phi &   S_\psi S_\theta \\
C_\psi C_\phi + C_\psi C_\theta S_\phi & -S_\psi S_\phi + C_\psi C_\theta C_\phi & - C_\psi S_\theta \\
                       S_\theta S_\phi &                         S_\theta C_\phi &          C_\theta \\
\end{bmatrix} \\
&\text{CF} \\
&\begin{bmatrix}
C_\psi C_\phi - S_\psi C_\theta S_\phi & - C_\psi S_\phi - S_\psi C_\theta C_\phi & S_\psi S_\theta \\
S_\psi C_\phi - C_\psi C_\theta S_\phi &  S_\psi S_\phi + C_\psi C_\theta C_\phi & -C_\psi S_\theta \\
S_\theta S_\phi & S_\theta C_\phi & C_\theta \\
\end{bmatrix}
\end{align*}

Different results.  After messing up both the matrix and exponential expansions on the first try only the $\{2,1\}$ entry 
is now different.  Go back and verify the first column expansion for the rotors.

\bibliographystyle{plainnat}
\bibliography{myrefs}

\end{document}
