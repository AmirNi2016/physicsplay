\documentclass{article}

\input{../peeters_macros.tex}
\input{../peeters_macros2.tex}
\newcommand{\PDSq}[2]{\frac{\partial^2 {#2}}{\partial {#1}^2}}
\DeclareMathOperator{\sinc}{sinc}
\newcommand{\FF}[0]{\mathcal{F}}
\newcommand{\IIinf}[0]{ \int_{-\infty}^\infty }

\usepackage[bookmarks=true]{hyperref}

\usepackage{color,cite,graphicx}
   % use colour in the document, put your citations as [1-4]
   % rather than [1,2,3,4] (it looks nicer, and the extended LaTeX2e
   % graphics package. 
\usepackage{latexsym,amssymb,epsf} % don't remember if these are
   % needed, but their inclusion can't do any damage


\title{ Fourier Solutions to Heat and Wave equations. }
\author{Peeter Joot}
\date{ Jan 19, 2009.  Last Revision: $Date: 2009/01/21 03:39:10 $ }

\begin{document}

\maketitle{}

%\tableofcontents

\section{ Motivation. }

Stanford iTunesU has some Fourier transform lectures by Prof. Brad Osgood.
He starts with Fourier series and by Lecture 5 has covered this and
the solution of the Heat equation on a ring as an example.

Now, for these lectures I get only sound on my ipod.  I can listen along and
pick up most of the lectures since this is review material, but here's some
notes to firm things up.

Since this heat equation

\begin{align}
\grad^2 u = \kappa \partial_t u
\end{align}

is also the Schr\"{o}dinger equation for a free particle in one 
dimension (once the 
constant is fixed appropriately), we can also apply the Fourier
technique to a particle
constrained to a circle.  It would be interesting afterwards to 
contrast this with Susskind's solution of the
same problem (where he used the Fourier transform and algebraic techniques
instead).

\section{ Preliminaries. }

\subsection{ Laplacian. }

Osgood wrote the heat equation for the ring as

\begin{align*}
\inv{2} u_{xx} = u_t
\end{align*}

where $x$ represented an angular position on the ring, and where
he set the heat diffusion constant to $1/2$ for convienience.
To apply this to the Schr\"{o}dinger equation retaining all the desired
units we want to be a bit more careful, so let's start with the Laplacian
in polar coordinates.

In polar coordinates our gradient is

\begin{align*}
\grad = \thetacap \inv{r} \PD{\theta}{} +\rcap \PD{r}{} 
\end{align*}

squaring this we have

\begin{align*}
\grad^2 = \grad \cdot \grad
&= 
\thetacap \inv{r} \PD{\theta}{} \cdot \left(\thetacap \inv{r} \PD{\theta}{}\right)
 +
\rcap \PD{r}{} \cdot \left(\rcap \PD{r}{} \right) \\
&= 
\frac{-1}{r^3} \PD{\theta}{r} \PD{\theta}{}
+\inv{r^2} \PDSq{\theta}{}
+ \PDSq{r}{}
\\
&= \inv{r^2} \PDSq{\theta}{} + \PDSq{r}{} \\
\end{align*}

So for the circularly constrained where $r$ is constant case we have simply

\begin{align}
\grad^2 = \inv{r^2} \PDSq{\theta}{}
\end{align}

and our heat equation to solve becomes

\begin{align}
\PDSq{\theta}{u(\theta, t)} = (r^2 \kappa) \PD{t}{u(\theta, t)}
\end{align}

\subsection{ Fourier series. }

Now we also want Fourier series for a given period.  Assuming the absence of the "Rigor Police" as Osgood puts it
we write for a periodic function $f(x)$ known on the interval $I = [a, a+T]$

\begin{align*}
f(x) = \sum c_k e^{2\pi i k x/T}
\end{align*}

\begin{align*}
\int_{\partial I} f(x) e^{- 2 \pi i n x /T} 
&= \sum c_k \int_{\partial I} e^{2\pi i (k -n) x/T} \\
&= c_n T
\end{align*}

So our Fourier coefficient is
\begin{align*}
\hat{f}(n) = c_n = \inv{T} \int_{\partial I} f(x) e^{- 2 \pi i n x /T} 
\end{align*}

\section{ Solution of heat equation. } 

\subsection{ Basic solution. }

Now we are ready to solve the radial heat equation

\begin{align}\label{eqn:heatRadial}
u_{\theta\theta} = r^2 \kappa u_t,
\end{align}

by assuming a Fourier series solution.

Suppose

\begin{align*}
u(\theta, t) 
&= \sum c_n(t) e^{2 \pi i n \theta / T} \\
&= \sum c_n(t) e^{i n \theta} \\
\end{align*}

Taking derivatives of this assumed solution we have
\begin{align*}
u_{\theta\theta} &= \sum (i n)^2 c_n e^{i n \theta} \\
u_{t} &= \sum c_n' e^{i n \theta}
\end{align*}

Substituting this back into \ref{eqn:heatRadial} we have

\begin{align*}
\sum - n^2 c_n e^{ i n \theta} = \sum c_n' r^2 \kappa e^{i n \theta}
\end{align*}

equating components we have 

\begin{align*}
c_n' = - \frac{n^2}{ r^2 \kappa } c_n 
\end{align*}

which is also just an exponential.

\begin{align*}
c_n = A_n \exp\left(- \frac{n^2}{ r^2 \kappa } t \right)
\end{align*}

Reassembling we have the time variation of the solution now fixed and can write

\begin{align}
u(\theta, t) = \sum A_n \exp\left(- \frac{n^2}{ r^2 \kappa } t + i n \theta\right)
\end{align}

\subsection{ As initial value problem. }

For the heat equation case, we can assume a known initial heat distribution 
$f(\theta)$.
For an initial time $t=0$ we can then write

\begin{align*}
u(\theta, 0) = \sum A_n e^{i n \theta} = f(\theta)
\end{align*}

This is just another Fourier series, with Fourier coefficients

\begin{align*}
A_n = \inv{2\pi} \int_{\partial I} f(v) e^{-i n v} dv
\end{align*}

Final reassembly of the results gives us

\begin{align}
u(\theta, t) = \sum \exp\left(- \frac{n^2}{ r^2 \kappa } t + i n \theta\right) \inv{2\pi} \int_{\partial I} f(v) e^{-i n v} dv
\end{align}

\subsection{ Convolution. }

Osgood's next step, also with the rigor police in hiding, was to exchange orders of integration and summation, to write

\begin{align*}
u(\theta, t) 
&= 
\int_{\partial I} f(v) dv \inv{2 \pi} \sum_{n=-\infty}^{\infty} \exp\left(- \frac{n^2}{ r^2 \kappa } t -i n (v -\theta)\right) \\
\end{align*}

Introducing a Green's function $g(v, t)$, we then have the complete solution in terms of convolution

\begin{align}\label{eqn:seriesGreens}
g( v , t ) &= \inv{2 \pi} \sum_{n=-\infty}^\infty \exp\left(- \frac{n^2}{ r^2 \kappa } t -i n v \right) \\
u(\theta, t) &= \int_{\partial I} f(v) g(v - \theta, t) dv 
\end{align}

Now, this Green's function is fairly interesting.  By summing over paired negative and positive indexes, we have a set of
weighted Gaussians.

\begin{align*}
g( v , t ) &= \inv{2 \pi} + \sum_{n=1}^\infty \exp\left(- \frac{n^2}{ r^2 \kappa } t \right) \frac{\cos(n v )}{\pi} \\
\end{align*}

Recalling that the delta function can be expressed as a limit of a $\sinc$ function, seeing something similar
in this Green's function is not entirely unsuprising seeming.

\section{ Wave equation. }

The QM equation for a free particle is

\begin{align}\label{eqn:schro}
-\frac{\hbar^2}{2m} \grad^2 \psi = i \hbar \partial_t \psi
\end{align}

This has the same form of the heat equation, so for the free particle on a circle our wave equation is

\begin{align*}
\psi_{\theta\theta} = - \frac{2 m i r^2 }{\hbar} \partial_t \psi \quad \mbox{ ie: $\kappa = - 2 m i /\hbar$ }
\end{align*}

So, if the wave equation was known at an initial time $\psi(\theta, 0) = \phi(\theta)$, we therefore have by comparision the time evolution of the particle's wave function is

\begin{align*}
g( w, t ) &= \inv{2 \pi} + \sum_{n=1}^\infty \exp\left(- \frac{i \hbar n^2 t}{ 2 m r^2 } \right) \frac{\cos(n w )}{\pi} \\
\psi(\theta, t) &= \int_{\partial I} \phi(v) g(v - \theta, t) dv 
\end{align*}

%TODO: contrast this to a Fourier transform solution.  Also write this in terms of circular angular momentum since that appears natually in the Green's function.

\section{ Fourier transform solution. }

% also see example (brief on details)
%\href{http://zakuski.utsa.edu/~gokhman/ftp//courses/notes/heat.pdf}{ example of Fourier tx solution. }
Now, lets try this one dimensional heat problem with a Fourier transform instead to compare.  Here we don't try to start with an
assumed solution, but instead take the Fourier transform of both sides of the equation directly.

\begin{align*}
\FF(u_{xx}) = \kappa \FF(u_t)
\end{align*}

Let's start with the left hand side, where we can evaluate by integrating by parts

\begin{align*}
\FF(u_{xx}) 
&= \inv{\sqrt{2\pi}} \IIinf u_{xx}(x, t) e^{- 2 \pi i s x } dx \\
&= \inv{\sqrt{2\pi}} \IIinf \PD{x}{u_x(x, t)} e^{- 2 \pi i s x } dx \\
&= \inv{\sqrt{2\pi}} 
\left(
{\left. u_x(x, t) e^{- 2 \pi i s x } \right\vert}_{x= -\infty}^\infty
-( - 2 \pi i s ) \IIinf u_x(x, t) e^{- 2 \pi i s x } dx 
\right) \\
\end{align*}

So if we assume (or require) that the derivative of our unknown function $u$ is zero at infinity, and then similarily
require the function itself to be zero there, we have

\begin{align*}
\FF(u_{xx}) 
&= \inv{\sqrt{2\pi}} ( 2 \pi i s ) \IIinf \PD{x}{u_x(x, t)} e^{- 2 \pi i s x } dx  \\
&= \inv{\sqrt{2\pi}} ( 2 \pi i s )^2 \IIinf u(x, t) e^{- 2 \pi i s x } dx  \\
&= ( 2 \pi i s )^2 \FF(u)
\end{align*}

Now, for the time derivative.  We want

\begin{align*}
\FF(u_t) &= \inv{\sqrt{2\pi}} \IIinf u_t(x, t) e^{- 2 \pi i s x } dx \\
\end{align*}

But can pull the derivative out of the integral for
\begin{align*}
\FF(u_t)
&= \PD{t}{} \left(\inv{\sqrt{2\pi}} \IIinf u(x, t) e^{- 2 \pi i s x } dx \right) \\
&= \PD{t}{\FF(u)} 
\end{align*}

So, now we have an equation relating time derivatives only of the Fourier transformed solution.

Writing $\FF(u) = \hat{u}$ this is

\begin{align}\label{eqn:toSolveFreq}
( 2 \pi i s )^2 \hat{u} = \kappa \PD{t}{\hat{u}}
\end{align}

With a solution of

\begin{align*}
\hat{u} = A(s) e^{ -4 \pi^2 s^2 t/ \kappa }
\end{align*}

Here $A(s)$ is an arbitrary constant in time integration constant, which may depend on $s$ since it is a solution of our simpler freqency domain partial differential equation
\ref{eqn:toSolveFreq}.

Performing an inverse transform to recover $u(x,t)$ we thus have

\begin{align*}
u(x,t) 
&= \inv{\sqrt{2\pi}} \IIinf \hat{u} e^{2 \pi i x s } ds  \\
&= \inv{\sqrt{2\pi}} \IIinf A(s) e^{ -4 \pi^2 s^2 t/ \kappa } e^{2 \pi i x s } ds  \\
\end{align*}

Now, how about initial conditions.  Suppose we have $u(x,0) = f(x)$, then 

\begin{align*}
f(x) &= \inv{\sqrt{2\pi}} \IIinf A(s) e^{2 \pi i x s } ds \\
\end{align*}

Which is just an inverse Fourier transform in terms of the integration ``constant'' $A(s)$.  We can therefore write the $A(s)$ in terms of the
initial time domain conditions.

\begin{align*}
A(s) &= \inv{\sqrt{2\pi}} \IIinf f(x) e^{-2 \pi i s x } dx \\
&= \hat{f}(s)
\end{align*}

and finally have a complete solution of the one dimensional Heat equation.  That is

\begin{align*}
u(x,t) &= \inv{\sqrt{2\pi}} \IIinf \hat{f}(s) e^{ -4 \pi^2 s^2 t/ \kappa } e^{2 \pi i x s } ds  \\
\end{align*}

\subsection{ With Green's function? }

If we put in the integral for $\hat{f}(s)$ explicitly and switch the order as was done with the Fourier series will we get a similar result?   Let's try

\begin{align*}
u(x,t) 
&= \inv{\sqrt{2\pi}} \IIinf \left( \inv{\sqrt{2\pi}} \IIinf f(u) e^{-2 \pi i s u } du \right) e^{ -4 \pi^2 s^2 t/ \kappa } e^{2 \pi i x s } ds  \\
&= \inv{\sqrt{2\pi}} \IIinf du f(u) \inv{\sqrt{2\pi}} \IIinf e^{ -4 \pi^2 s^2 t/ \kappa } e^{2 \pi i (x - u) s } ds  \\
\end{align*}

Cool.  So, with the introduction of a Green's function $g(w,t)$ for the fundamental solution of the heat equation, we therefore have
our solution in terms of convolution with the initial conditions.  It doesn't get any more general than this!

\begin{align}
g(w,t) &= \inv{{2\pi}} \IIinf \exp\left( -\frac{4 \pi^2 s^2 t}{\kappa} + 2 \pi i w s \right) ds \\
u(x,t) &= \IIinf f(u) g( x - u, t) du
\end{align}

Compare this to \ref{eqn:seriesGreens}, the solution in terms of Fourier series.  The form is almost identical, but the requirement for periodicity has been removed by switch to the continuous frequency domain!

\subsection{ Wave equation. }

With only a change of variables, setting $\kappa = - 2 m i /\hbar$ we have the general solution to the one dimensional zero potential wave equation 
\ref{eqn:schro}
in terms of an initial wave function.

Our solution is 

\begin{align}
g(w,t) &= \inv{{2\pi}} \IIinf \exp\left( 2 \pi i s \left(w -\frac{\pi s t \hbar}{m} \right)\right) ds \\
u(x,t) &= \IIinf f(u) g( x - u, t) du
\end{align}

%\bibliographystyle{plainnat}
%\bibliography{myrefs}

\end{document}
