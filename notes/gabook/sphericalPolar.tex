\documentclass{article}

\input{../peeters_macros.tex}
\input{../peeters_macros2.tex}

\newcommand{\phicap}[0]{\hat{\boldsymbol{\phi}}}

\usepackage{color,cite,graphicx}
   % use colour in the document, put your citations as [1-4]
   % rather than [1,2,3,4] (it looks nicer, and the extended LaTeX2e
   % graphics package. 
\usepackage{latexsym,amssymb,epsf} % don't remember if these are
   % needed, but their inclusion can't do any damage


\usepackage[bookmarks=true]{hyperref}


\title{Some notes on spherical polar coordinates}
\author{Peeter Joot}
\date{ Nov 13, 2008.  Last Revision: $Date: 2008/11/14 04:38:29 $ }

\begin{document}

\maketitle{}
%\tableofcontents

\section{ Motivation. }

Derive the coordinates and unit vector relationships, gradient, divergence and curl in spherical polar coordinates.

These results can be found in many texts, including the excellent review article \cite{fleischCoords}, but 
the exersize of working out the details will be worthwhile as a learning exersize.

\section{ Derivation. }

\begin{figure}[htp]
\centering
\includegraphics[totalheight=0.4\textheight]{spherical_polar}
\caption{Angles and lengths in spherical polar coordinates}\label{fig:spherical_polar}
\end{figure}

Figure \ref{fig:spherical_polar} illustrates the conventions used in 
these notes.

\subsection{ Coordinates. }

By inspection, the coordinates can be read off the diagram.

\begin{align*}
u &= r \cos\phi \\
x &= u \cos\theta = r \cos\phi \cos\theta \\
y &= u \sin\theta = r \cos\phi \sin\theta \\
z &= r \sin\phi \\
\end{align*}

\subsection{ The unit vectors. }

As for the unit vectors themselves, $\rcap$ can be calculated the easiest

\begin{align*}
\rcap 
&= \inv{r} (x, y, z) \\
\end{align*}

Next, $\thetacap$ lies in the $x,y$ plane, perpendicular to the outwards radial vector in that plane:
\begin{align*}
\thetacap 
&= (\cos\theta \Be_1 + \sin\theta \Be_2) \Be_1 \Be_2 \\
\end{align*}

Lastly, $\phicap$ can be calculated from the dual of $\rcap \wedge \thetacap$

\begin{align*}
\phicap 
&= - \Be_1 \Be_2 \Be_3 (\rcap \wedge \thetacap) \\
\end{align*}

The end result of the algebra above is
\begin{align}
\rcap 
&=
\cos\phi \cos\theta \Be_1
+ \cos\phi \sin\theta \Be_2
+ \sin\phi \Be_3 \\
\thetacap 
&= \cos\theta \Be_2 - \sin\theta \Be_1 \\
\rcap \wedge \thetacap 
%&=
%\sin\phi \sin\theta \Be_1 \Be_3 
%- \cos\theta \sin\phi \Be_2 \Be_3 
%+ ( \cos\phi \sin\theta^2 + \cos\phi \cos\theta^2 ) \Be_1 \Be_2  \\
&=
\sin\phi \sin\theta \Be_1 \Be_3 
+ \sin\phi \cos\theta \Be_3 \Be_2 
+ \cos\phi \Be_1 \Be_2 \\
\phicap 
&=
- \sin\phi \cos\theta \Be_1 
- \sin\phi \sin\theta \Be_2 
+ \cos\phi \Be_3 %\\
\end{align}

\subsection{ Rotor }

As noted in \cite{doran2003gap}, and \cite{PJEulerAngle} the composition of rotors for the sequence of $\theta$, $\phi$ rotations
in the $x,y$ and $x',z$ planes will be

\begin{align*}
R(\Bx) 
&= 
\exp(-\Be_{12}\theta/2)
\exp(-\Be_{13}\phi/2)
\Bx
\exp(\Be_{13}\phi/2)
\exp(\Be_{12}\theta/2)
\end{align*}

Or, more compactly

\begin{align*}
R(\Bx) &= R^\dagger \Bx R \\
R &= R_\phi R_\theta \\
R_\phi &= \exp(\Be_{13}\phi/2) \\
R_\theta &= \exp(\Be_{12}\theta/2)
\end{align*}

Application of these to the $\{\Be_i\}$ basis produces the $\{\rcap, \thetacap, \phicap\}$ basis.  First application 
of $R_\phi$ yields the basis vectors for the intermediate rotation.

\begin{align*}
\begin{array}{l l l}
{R_\phi}^\dagger \Be_1 R_\phi &= \Be_1 (\cos\phi + \Be_{13} \sin\phi) &= \Be_1 \cos\phi + \Be_3 \sin\phi \\
{R_\phi}^\dagger \Be_2 R_\phi &= \Be_2 {R_\phi}^\dagger R_\phi &= \Be_2 \\
{R_\phi}^\dagger \Be_3 R_\phi &= \Be_3 (\cos\phi + \Be_{13} \sin\phi) &= \Be_3 \cos\phi - \Be_1 \sin\phi \\
\end{array}
\end{align*}

Applying the second rotor to $R_\phi(\Be_i)$ we have
\begin{align*}
\rcap 
&= {R_\theta}^\dagger \Be_1' R_\theta \\
&=
\Be_1 \cos\phi (\cos\theta + \Be_{12} \sin\theta)
+ \Be_3 \sin\phi \\
&=
\Be_1 \cos\phi \cos\theta 
+ \Be_2 \cos\phi \sin\theta
+ \Be_3 \sin\phi \\
\thetacap
&= {R_\theta}^\dagger \Be_2' R_\theta \\
&= \Be_2 (\cos\theta + \Be_{12} \sin\theta) \\
&= \Be_2 \cos\theta - \Be_1 \sin\theta \\
\phicap
&= {R_\theta}^\dagger \Be_3' R_\theta \\
&= \Be_3 \cos\phi - \Be_1 \sin\phi (\cos\theta + \Be_{12} \sin\theta) \\
&= 
- \Be_1 \sin\phi \cos\theta 
- \Be_2 \sin\phi \sin\theta 
+ \Be_3 \cos\phi
\\
\end{align*}

And sure enough this produces the same result, but algebraically without any reliance on pictures.  A possible
advantage to this formulation is that one can study 
frame transformations of the general form $\{\Be_i'\} = \{ R^\dagger \Be_i R \}$, and the result will hold for
not only spherical polar coordinate systems but others (such as the cylindrical case).

\bibliographystyle{plainnat} % supposed to allow for \url use.
\bibliography{myrefs}      % expects file "myrefs.bib"

\end{document}               % End of document.
