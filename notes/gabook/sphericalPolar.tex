\documentclass{article}

\input{../peeters_macros.tex}
\input{../peeters_macros2.tex}

\newcommand{\phicap}[0]{\hat{\boldsymbol{\phi}}}

\usepackage{color,cite,graphicx}
   % use colour in the document, put your citations as [1-4]
   % rather than [1,2,3,4] (it looks nicer, and the extended LaTeX2e
   % graphics package. 
\usepackage{latexsym,amssymb,epsf} % don't remember if these are
   % needed, but their inclusion can't do any damage


\usepackage[bookmarks=true]{hyperref}


\title{Some notes on spherical polar coordinates}
\author{Peeter Joot}
\date{ Nov 13, 2008.  Last Revision: $Date: 2008/11/15 05:10:17 $ }

\begin{document}

\maketitle{}
%\tableofcontents

\section{ Motivation. }

Derive the coordinates and unit vector relationships, gradient, divergence and curl in spherical polar coordinates.

These results can be found in many texts, including the excellent review article \cite{fleischCoords}, but 
the exersize of working out the details will be worthwhile as a learning exersize.

\section{ Derivation. }

\begin{figure}[htp]
\centering
\includegraphics[totalheight=0.4\textheight]{spherical_polar}
\caption{Angles and lengths in spherical polar coordinates}\label{fig:spherical_polar}
\end{figure}

Figure \ref{fig:spherical_polar} illustrates the conventions used in 
these notes.

\subsection{ Coordinates. }

By inspection, the coordinates can be read off the diagram.

\begin{align*}
u &= r \cos\phi \\
x &= u \cos\theta = r \cos\phi \cos\theta \\
y &= u \sin\theta = r \cos\phi \sin\theta \\
z &= r \sin\phi \\
\end{align*}

\subsection{ The unit vectors. }

As for the unit vectors themselves, $\rcap$ can be calculated the easiest

\begin{align*}
\rcap 
&= \inv{r} (x, y, z) \\
\end{align*}

Next, $\thetacap$ lies in the $x,y$ plane, perpendicular to the outwards radial vector in that plane:
\begin{align*}
\thetacap 
&= (\cos\theta \Be_1 + \sin\theta \Be_2) \Be_1 \Be_2 \\
\end{align*}

Lastly, $\phicap$ can be calculated from the dual of $\rcap \wedge \thetacap$

\begin{align*}
\phicap 
&= - \Be_1 \Be_2 \Be_3 (\rcap \wedge \thetacap) \\
\end{align*}

The end result of the algebra above is
\begin{align}
\rcap 
&=
\cos\phi \cos\theta \Be_1
+ \cos\phi \sin\theta \Be_2
+ \sin\phi \Be_3 \\
\thetacap 
&= \cos\theta \Be_2 - \sin\theta \Be_1 \\
\rcap \wedge \thetacap 
%&=
%\sin\phi \sin\theta \Be_1 \Be_3 
%- \cos\theta \sin\phi \Be_2 \Be_3 
%+ ( \cos\phi \sin\theta^2 + \cos\phi \cos\theta^2 ) \Be_1 \Be_2  \\
&=
\sin\phi \sin\theta \Be_1 \Be_3 
+ \sin\phi \cos\theta \Be_3 \Be_2 
+ \cos\phi \Be_1 \Be_2 \\
\phicap 
&=
- \sin\phi \cos\theta \Be_1 
- \sin\phi \sin\theta \Be_2 
+ \cos\phi \Be_3 %\\
\end{align}

\subsection{ Rotor }

As noted in \cite{doran2003gap}, and \cite{PJEulerAngle} the composition of rotors for the sequence of $\theta$, $\phi$ rotations
in the $x,y$ and $x',z$ planes will be

\begin{align*}
R(\Bx) 
&= 
\exp(-\Be_{12}\theta/2)
\exp(-\Be_{13}\phi/2)
\Bx
\exp(\Be_{13}\phi/2)
\exp(\Be_{12}\theta/2)
\end{align*}

Or, more compactly

\begin{align*}
R(\Bx) &= R^\dagger \Bx R \\
R &= R_\phi R_\theta \\
R_\phi &= \exp(\Be_{13}\phi/2) \\
R_\theta &= \exp(\Be_{12}\theta/2)
\end{align*}

Application of these to the $\{\Be_i\}$ basis produces the $\{\rcap, \thetacap, \phicap\}$ basis.  First application 
of $R_\phi$ yields the basis vectors for the intermediate rotation.

\begin{align*}
\begin{array}{l l l}
{R_\phi}^\dagger \Be_1 R_\phi &= \Be_1 (\cos\phi + \Be_{13} \sin\phi) &= \Be_1 \cos\phi + \Be_3 \sin\phi \\
{R_\phi}^\dagger \Be_2 R_\phi &= \Be_2 {R_\phi}^\dagger R_\phi &= \Be_2 \\
{R_\phi}^\dagger \Be_3 R_\phi &= \Be_3 (\cos\phi + \Be_{13} \sin\phi) &= \Be_3 \cos\phi - \Be_1 \sin\phi \\
\end{array}
\end{align*}

Applying the second rotor to $R_\phi(\Be_i)$ we have
\begin{align*}
\rcap 
&= {R_\theta}^\dagger ( \Be_1 \cos\phi + \Be_3 \sin\phi ) R_\theta \\
&=
\Be_1 \cos\phi (\cos\theta + \Be_{12} \sin\theta)
+ \Be_3 \sin\phi \\
&=
\Be_1 \cos\phi \cos\theta 
+ \Be_2 \cos\phi \sin\theta
+ \Be_3 \sin\phi \\
\thetacap
&= {R_\theta}^\dagger ( \Be_2 ) R_\theta \\
&= \Be_2 (\cos\theta + \Be_{12} \sin\theta) \\
&= \Be_2 \cos\theta - \Be_1 \sin\theta \\
\phicap
&= {R_\theta}^\dagger ( \Be_3 \cos\phi - \Be_1 \sin\phi ) R_\theta \\
&= \Be_3 \cos\phi - \Be_1 \sin\phi (\cos\theta + \Be_{12} \sin\theta) \\
&= 
- \Be_1 \sin\phi \cos\theta 
- \Be_2 \sin\phi \sin\theta 
+ \Be_3 \cos\phi
\\
\end{align*}

And sure enough this produces the same result, but algebraically without any reliance on pictures.

A possible
advantage to this formulation is that one can study 
frame transformations of the general form $\{\Be_i'\} = \{ R^\dagger \Be_i R \}$, and the result will hold for
not only spherical polar coordinate systems but others (such as the cylindrical case).

\section{ Coordinates. } 

\subsection{ Digression.  Tensor transformation review. }

Considering a linear transformation providing a mapping from one basis to another of the following form

\begin{align*}
f_i = \LL(e_i) = L e_i L^\dagger
\end{align*}

where
\begin{align*}
L L^\dagger = 1
\end{align*}

The 
coordinate vector representation in each of these frames is

\begin{align*}
x = x^i e_i = y^j f_j.
\end{align*}

Utilizing a reciprocal frame (ie: not yet requiring an orthonormal frame here), such that $e^i \cdot e_j = {\delta^i}_j$, 
then dot product provide the coordinate transformations
\begin{align*}
x^k e_k \cdot e^k &= y^j f_j \cdot e^k \\
y^j f_j \cdot f^i &= x^k e_k \cdot f^i \\
\implies \\
x^i &= y^j f_j \cdot e^i \\
y^i &= x^j e_j \cdot f^i
\end{align*}

The transformed reciprocal frame vectors can be expressed directly in terms of the initial reciprocal frame $f^i = \LL(e^i)$.  Taking
dot products confirms this

\begin{align*}
(L e_i L^\dagger) \cdot (L e^j L^\dagger) 
&= \gpgradezero{ L e_i L^\dagger L e^j L^\dagger } \\
&= \gpgradezero{ L e_i e^j L^\dagger } \\
&= e_i \cdot e^j \gpgradezero{ L L^\dagger } \\
&= e_i \cdot e^j
\end{align*}

This implies that the forward and inverse coordinate transformations may be summarized as
\begin{align*}
y^i &= x^j e_j \cdot \LL(e^i) \\
x^i &= y^j \LL(e_j) \cdot e^i \\
\end{align*}

Or in matrix form
\begin{align}\label{eqn:coordinateTxTensors}
{\Lambda^i}_j &= \LL(e^i) \cdot e_j \\
{\Lambda_j}^i &= \LL(e_j) \cdot e^i \\
y^i &= {\Lambda^i}_j x^j \\
x^i &= {\Lambda_j}^i y^j
\end{align}

Where
\begin{align*}
x^i &= {\Lambda_j}^i y^j \\
&= {\Lambda_j}^i {\Lambda^j}_k x^k \\
\end{align*}

So
\begin{align*}
{\Lambda_j}^i {\Lambda^j}_k &= \delta^i_k
\end{align*}

\subsection{ Expressing spherical polar rotation in matrix form. }

For the spherical polar case, both sets of frame vectors are orthonormal

\begin{align*}
{\Lambda^i}_j
&= \LL(\Be_i) \cdot \Be_j \\
&= (R^\dagger \Be_i R) \cdot \Be_j \\
&=
\begin{bmatrix}
%rcap . {e1 e2 e3}
\cos\phi \cos\theta & \cos\phi \sin\theta & \sin\phi \\
%thetacap . {e1 e2 e3}
- \sin\theta & \cos\theta & 0 \\
%phicap . {e1 e2 e3}
- \sin\phi \cos\theta & - \sin\phi \sin\theta & \cos\phi \\
\end{bmatrix}
\end{align*}

From equation \ref{eqn:coordinateTxTensors}, one can see that the inverse transformation is the transpose.  This isn't clear looking at the matrix above until one factors it into a pair of separate matrixes
\begin{align*}
{\Lambda^i}_j
&=
\begin{bmatrix}
\cos\phi & 0 & \sin\phi \\
0 & 1 & 0 \\
-\sin\phi & 0 & \cos\phi
\end{bmatrix}
\begin{bmatrix}
\cos\theta & \sin\theta & 0 \\
-\sin\theta & \cos\theta & 0 \\
0 & 0 & 1 \\
\end{bmatrix}
\end{align*}

FIXME: from my Euler angle notes, I would have expected this matrix factorization to be in inverted order.  There's an inconsistency
or misunderstanding here or there somewhere, but I can't find anything wrong in either place.

Hmm, after doing this, which I thought would shed some light on how to transform the gradient (and divergence and curl), but it isn't clear to me
that this was completely helpful.

\bibliographystyle{plainnat}
\bibliography{myrefs}

\end{document}
