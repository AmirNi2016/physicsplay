\documentclass{article}

\input{../peeters_macros.tex}
\input{../peeters_macros2.tex}

\usepackage[bookmarks=true]{hyperref}

\usepackage{color,cite,graphicx}
   % use colour in the document, put your citations as [1-4]
   % rather than [1,2,3,4] (it looks nicer, and the extended LaTeX2e
   % graphics package. 
\usepackage{latexsym,amssymb,epsf} % don't remember if these are
   % needed, but their inclusion can't do any damage


\title{ Spherical and hyperspherical parameterization. }
\author{Peeter Joot \quad peeter.joot@gmail.com }
\date{ Feb 26, 2009.  Last Revision: $Date: 2009/02/28 04:42:07 $ }

\begin{document}

\maketitle{}
\tableofcontents

\section{ Motivation. }

In \cite{PJ4dFourier} a 4D fourier transform solution 
of Maxwell's equation yielded a Green's function of the form

\begin{align*}
G(x) = \iiiint \frac{e^{i k_\mu x^\mu}}{k_\nu k^\nu} dk_1 dk_2 dk_3 dk_4
\end{align*}

To attempt to ``evaluate'' this integral, as done in
\cite{PJpoisson}
to produce the retarded time potentials,
a hypervolume equivalent to spherical polar coordinate
parameterization is probably desirable.

Before attempting to tackle the problem of interest, the basic question
of how to do volume and weighted volume integrals over a hyperspherical volumes
must be considered.  Doing this for both Euclidean and Minkowski metrics will have to be covered.

\section{ Euclidean n-volume }

\subsection{ Parameterizations. }

The \href{http://en.wikipedia.org/wiki/Hypersphere}{wikipedia article on n-volumes} gives a parameterization, which I'll write out explicitly for the first few dimensions

\begin{itemize}
\item 1-sphere (circle)

\begin{align*}
x_1 &= r \cos\phi_1 \\
x_2 &= r \sin\phi_1 
\end{align*}

\item 2-sphere (sphere)

\begin{align*}
x_1 &= r \cos\phi_1 \\
x_2 &= r \sin\phi_1 \cos\phi_2 \\
x_3 &= r \sin\phi_1 \sin\phi_2
\end{align*}

\item 3-sphere (hypersphere)

\begin{align*}
x_1 &= r \cos\phi_1 \\
x_2 &= r \sin\phi_1 \cos\phi_2 \\
x_3 &= r \sin\phi_1 \sin\phi_2 \cos\phi_3 \\
x_4 &= r \sin\phi_1 \sin\phi_2 \sin\phi_3 \\
\end{align*}

\end{itemize}

By inspection one can see that we have the desired $r^2 = \sum_i (x_i)^2$ relation.  Each of these can be vectorized to produce
a parameterized vector that can trace out all the possible points on the volume

\begin{align*}
\Br &= e^k x_k 
\end{align*}

\subsection{ Volume elements. }

We can form a parallelogram area (or parallopiped volume, ...) element for any parameterized surface by taking wedge products, and can do that
for this spherical parameterization too.

FIXME: scan picture.

%\begin{figure}[htp]
%\centering
%\includegraphics[totalheight=0.4\textheight]{picturepath}
%\caption{My Caption}\label{fig:pictlabel}
%\end{figure}
%
%... see figure \ref{fig:picturepath} ...

For example for the circle we have

\begin{align*}
dV_{\Rm{2}}
&= \PD{r}{\Br} \wedge \PD{\phi_1}{\Br} dr d\phi_1 \\
&= \left(\PD{r}{}r(\cos\phi_1, \sin\phi_1) \right) \wedge \left(\PD{\phi_1}{}r(\cos\phi_1, \sin\phi_1) \right) dr d\phi_1 \\
&= (\cos\phi_1, \sin\phi_1) \wedge (-\sin\phi_1, \cos\phi_1) r dr d\phi_1 \\
&= (\cos^2\phi_1 e^1 e^2 - \sin^2\phi_1 e^2 e^1 ) r dr d\phi_1 \\
&= r dr d\phi_1 e^1 e^2 \\
\end{align*}

And for the sphere
\begin{align*}
dV_{\Rm{3}}
&= \PD{r}{\Br} \wedge \PD{\phi_1}{\Br} \wedge \PD{\phi_2}{\Br} dr d\phi_1 d\phi_2 \\
&= (\cos\phi_1, \sin\phi_1 \cos\phi_2, \sin\phi_1 \sin\phi_2)  \\
&\wedge (-\sin\phi_1, \cos\phi_1 \cos\phi_2, \cos\phi_1 \sin\phi_2)  \\
&\wedge (0, -\sin\phi_1 \sin\phi_2, \sin\phi_1 \cos\phi_2) r^2 dr d\phi_1 d\phi_2 \\
&= 
\begin{vmatrix}
\cos\phi_1 & \sin\phi_1 \cos\phi_2 & \sin\phi_1 \sin\phi_2  \\
-\sin\phi_1 & \cos\phi_1 \cos\phi_2 & \cos\phi_1 \sin\phi_2  \\
0 & -\sin\phi_1 \sin\phi_2 & \sin\phi_1 \cos\phi_2  \\
\end{vmatrix} r^2 dr d\phi_1 d\phi_2 e^1 e^2 e^3 \\
&=
r^2 dr \sin\phi_1 d\phi_1 d\phi_2 e^1 e^2 e^3 \\
\end{align*}

And finally for the hypersphere

\begin{align*}
dV_{\Rm{4}} &=
\begin{vmatrix}
\cos\phi_1 & \sin\phi_1 \cos\phi_2 & \sin\phi_1 \sin\phi_2 \cos\phi_3 & \sin\phi_1 \sin\phi_2 \sin\phi_3  \\
-\sin\phi_1 & \cos\phi_1 \cos\phi_2 & \cos\phi_1 \sin\phi_2 \cos\phi_3 & \cos\phi_1 \sin\phi_2 \sin\phi_3  \\
         0 & -\sin\phi_1 \sin\phi_2 & \sin\phi_1 \cos\phi_2 \cos\phi_3 & \sin\phi_1 \cos\phi_2 \sin\phi_3  \\
         0 &                     0 & -\sin\phi_1 \sin\phi_2 \sin\phi_3 & \sin\phi_1 \sin\phi_2 \cos\phi_3  \\
\end{vmatrix} \\
&\quad r^3 dr d\phi_1 d\phi_2 d\phi_3 e^1 e^2 e^3 e^4 \\
&=
%
%
%C_1  &  S_1 C_2 &  S_1 S_2 C_3 & S_1 S_2 S_3  \\
%-S_1 &  C_1 C_2 &  C_1 S_2 C_3 & C_1 S_2 S_3  \\
%   0 & -S_1 S_2 &  S_1 C_2 C_3 & S_1 C_2 S_3  \\
%   0 &        0 & -S_1 S_2 S_3 & S_1 S_2 C_3  \\
%
%
%C_1^2 C_2 S_1^2 C_2 S_2
%+C_1 S_1 S_2^3 C_1 S_1
%+S_1^2 C_2 S_1^2 C_2 S_2
%+S_1^2 S_2 S_1^2 S_2^2
%
%
%+C_1^2 C_2^2 S_1^2 S_2
%+C_1^2 S_1^2 S_2^3 
%+S_1^4 C_2^2 S_2
%+S_1^4 S_2^3
%
%
%+ S_1^2 S_2 
r^3 dr \sin^2\phi_1 d\phi_1 \sin\phi_2 d\phi_2 d\phi_3 e^1 e^2 e^3 e^4 \\
\end{align*}

Each of these is consistent with the result in the wiki page.

\subsection{ Some volume computations. }

Let's apply the above results to compute the corresponding n-volume's.


\begin{itemize}
\item 1-sphere (circle)
\begin{align*}
V_{\Rm{2}} 
&= 4 \int_{0}^R r dr \int_{0}^{\pi/2} d\phi_1 \\
&= \pi R^2 
\end{align*}

\item 2-sphere (sphere)

\begin{align*}
V_{\Rm{3}} 
&= 8 \int_0^R r^2 dr \int_0^{\pi/2} \sin\phi_1 d\phi_1 \int_0^{\pi/2} d\phi_2 \\
&= 8 \inv{3} R^3 \left( {\left. -\cos\phi_1 \right\vert}_0^{\pi/2} \right) \frac{\pi}{2} \\
&= \frac{4\pi R^3}{3} \\
\end{align*}

Okay, so far so good.

\item 3-sphere (hypersphere)

\begin{align*}
V_{\Rm{3}} 
&= 16 \int_0^R r^3 dr \int_0^{\pi/2} \sin^2\phi_1 d\phi_1 \int_0^{\pi/2} \sin\phi_2 d\phi_2 \int_0^{\pi/2} d\phi_3 \\
&= 2 \pi R^4 \int_0^{\pi/2} \sin^2\phi_1 d\phi_1 \\
&= \pi R^4 \left( {\left.  \phi_1 - \cos\phi_1 \sin\phi_1 \right\vert}_0^{\pi/2} \right) \\
&= \frac{\pi^2 R^4}{2} \\
\end{align*}

This is also consistent with the formula supplied in the wiki article.  

\end{itemize}

\subsection{ Range determination. }

What I've done here though it integrate over only one of the quadrants, and multiply by $2^n$.  This avoided the more tricky issue of what exact range of angles is required for a complete and non-overlapping cover of the surface.

The wiki article says that the range is $[0,2\pi]$ for the last angle and $[0,\pi]$ for the others.  
Reevaluating the integrals above shows that this does work, but that's a bit of a cheat, and it isn't obvious
to me past \R{3} that this should be the case.

How can this be rationalized?

\begin{itemize}
\item circle
For the case of the circle what are the end points in each of the quadrants?  These are (with $r=1$)

\begin{align*}
(\cos\phi_1, \sin\phi_1)_{\phi_1 = 0}        &= ( 1, 0 ) = e^1 \\
(\cos\phi_1, \sin\phi_1)_{\phi_1 = \pi/2}    &= ( 0, 1 ) = e^2 \\
(\cos\phi_1, \sin\phi_1)_{\phi_1 = \pi}      &= ( -1, 0 ) = -e^1 \\
(\cos\phi_1, \sin\phi_1)_{\phi_1 = 3\pi/2}   &= ( 0, -1 ) = -e^2
\end{align*}

As expected, each of the $\pi/2$ increments traces out the points in successive quadrants.

\item sphere

Again with $r=1$, some representitive points on the circle are

\begin{tabular}{|l|l|l|l|}
\hline
$\phi_1$ & $\phi_2$ & $(\cos\phi_1, \sin\phi_1 \cos\phi_2, \sin\phi_1 \sin\phi_2)$ & $\Br$ \\
\hline
0 & 0 & $(1,0,0)$ & $e^1$ \\
0 & $\pi/2$ &  $(1,0,0)$ & $e^1$ \\
0 & $\pi$ &  $(1,0,0)$ & $e^1$ \\
0 & $3\pi/2$ &  $(1,0,0)$ & $e^1$ \\
%
% $(0, \cos\phi_2, \sin\phi_2)$ 
%
% traces out a circle in y,z plane
%
$\pi/2$ & 0 &  $(0,1,0)$ & $e^2$ \\
$\pi/2$ & $\pi/2$ &  $(0,0,1)$ & $e^3$ \\
$\pi/2$ & $\pi$ &  $(0,-1,0)$ & $-e^2$ \\
$\pi/2$ & $3\pi/2$ &  $(0,0,-1)$ & $-e^3$ \\
%
%
% $(-1, 0\cos\phi_2, \sin\phi_1 \sin\phi_2)$ & $\Br$ \\
%
$\pi$ & 0 &  $(-1,0,0)$ & $-e^1$ \\
$\pi$ & $\pi/2$ &  $(-1,0,0)$ & $-e^1$ \\
$\pi$ & $\pi$ &  $(-1,0,0)$ & $-e^1$ \\
$\pi$ & $3\pi/2$ & $(-1,0,0)$ & $-e^1$ \\
\hline
\end{tabular}

The most informative of these is for $\phi_1 = \pi/2$, where we had $\Br = (0, \cos\phi_2, \sin\phi_2)$, and our points trace out a path along the unit circle of the $y,z$ plane.  At $\phi_1 = 0$ our point $\Br = e_1$ didn't move, and at $\phi_1 = \pi$ we are at the other end of the sphere, also fixed.  A reasonable guess is that at each $\phi_1$ we trace out a different circle in the $y,z$ plane.

We can write, with $i_{23} = e^1 \wedge e^2 = e^1 e^2$,

\begin{align*}
\Br 
%&= \cos\phi_1 (1, \tan\phi_1 \cos\phi_2, \tan\phi_1 \sin\phi_2) \\
&= \cos\phi_1 e^1 + \sin\phi_1 ( \cos\phi_2 e^2 + \sin\phi_2 e^3 ) \\
&= \cos\phi_1 e^1 + \sin\phi_1 e^2 ( \cos\phi_2 + \sin\phi_2 e^2 e^3 ) \\
&= \cos\phi_1 e^1 + \sin\phi_1 e^2 \exp( i_{23} \phi_2 )
\end{align*}

Put this way the effects of the parameterization is clear.   For each fixed $\phi_1$, the exponential traces out a circle in the $y,z$ plane, starting at the point $\Br = \cos\phi_1 e^1 + \sin\phi_1 e^2$.  $\phi_1$ traces out a semi-circle in the $x,y$ plane.

FIXME: picture.

This would have been easy enough to understand if starting from a picture and constructing the parameterization.  Seeing what the 
geometry is from the algebra requires a bit more (or different) work.  Having done it, are we now prepared to understand the geometry 
of the hypersphere parameterization.

\item hypersphere.

The vector form in the spherical case was convient for extracting geometric properties.  Can we do that here too?

\begin{align*}
\Br
&= e^1 \cos\phi_1 + e^2 \sin\phi_1 \cos\phi_2 + e^3 \sin\phi_1 \sin\phi_2 \cos\phi_3 + e^4 \sin\phi_1 \sin\phi_2 \sin\phi_3 \\
&= e^1 \cos\phi_1 + e^2 \sin\phi_1 \cos\phi_2 + e^3 \sin\phi_1 \sin\phi_2 (\cos\phi_3 + e^{34} \sin\phi_3) \\
&= e^1 \cos\phi_1 + e^2 \sin\phi_1 \cos\phi_2 + e^3 \sin\phi_1 \sin\phi_2 \exp(e^{34}\phi_3) \\
&= e^1 \cos\phi_1 + e^2 \sin\phi_1 (\cos\phi_2 + i_{23} \sin\phi_2 \exp(i_{34}\phi_3) ) \\
\end{align*}

Observe that if $\phi_3 = 0$ we have

\begin{align*}
\Br
&= e^1 \cos\phi_1 + e^2 \sin\phi_1 \exp( i_{23} \phi_2 ) \\
\end{align*}

Which is exactly the parameterization of a half sphere ($\phi_2 \in [0,\pi]$).  Contrast this to the semi-circle that $\phi_1$ traced out in the spherical case.  

In the spherical case, the points $\phi_1 = \pi/2$ were nicely representitive.  For the hypersphere those points are

\begin{align*}
\Br &= e^2 \cos\phi_2 + e^3 \sin\phi_2 \exp(i_{34}\phi_3) \\
\end{align*}

We saw above that this is the parameterization of a sphere.

Also like the spherical case, we have $\Br = \pm e^1$ at $\phi_1 = 0$, and $\phi_1 = \pi$ respectively.

The geometrical conclusion is that for each $\phi_1 \in [0,\pi/2]$ range the points $\Br$ trace out increasingly
larger spheres, and after that decreasing sized spheres until we get to a point again at $\phi_1 = \pi$.

\end{itemize}

\section{ Minkowski metric sphere. }

\bibliographystyle{plainnat}
\bibliography{myrefs}

\end{document}
