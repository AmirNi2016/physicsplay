%
% Copyright © 2012 Peeter Joot.  All Rights Reserved.
% Licenced as described in the file LICENSE under the root directory of this GIT repository.
%

% 
% 
%\input{../peeter_prologue_print.tex}
%\usepackage{txfonts}

\chapter{Stokes theorem.  Revisited again}
%\chapter{Stokes theorem in Geometric Algebra formalism}
\label{chap:stokesNoTensor}


%\blogpage{http://sites.google.com/site/peeterjoot/math2009/stokesNoTensor.pdf}
%\revisionInfo{stokesNoTensor.tex}
%\date{July 21, 2009}

\beginArtWithToc

\section{Motivation}

Relying on pictorial means and a brute force ugly comparison of left and right hand sides, a verification of Stokes theorem for the vector and bivector cases was performed (\chapcite{stokesGradeTwo}).  This was more of a confirmation than a derivation, and the technique fails the transition to the trivector case.  The trivector case is of particular interest in electromagnetism since that and a duality transformation provides a four-vector divergence theorem.

The fact that the pictorial means of defining the boundary surface doesn't work well in four vector space is not the only unsatisfactory aspect of the previous treatment.  The fact that a coordinate expansion of the hypervolume element and hypersurface element was performed in the LHS and RHS comparisons was required is particularly ugly.  It is a lot of work and essentially has to be undone on the opposing side of the equation.  Comparing to previous attempts to come to terms with Stokes theorem in (\chapcite{PJStokes1}) and (\chapcite{PJStokes2}) this more recent attempt at least avoids the requirement for a tensor expansion of the vector or bivector.  It should be possible to build on this and minimize the amount of coordinate expansion required and go directly from the volume integral to the expression of the boundary surface.

\section{Do it}
\subsection{Notation and Setup}

The desire is to relate the curl hypervolume integral to a hypersurface integral on the boundary

\begin{align}\label{eqn:stokesNoTensor:stokes}
\int (\grad \wedge F) \cdot d^k x = \int F \cdot d^{k-1} x
\end{align}

In order to put meaning to this statement the volume and surface elements need to be properly defined.  In order that this be a scalar equation, the object $F$ in the integral is required to be of grade $k-1$, and $k \le n$ where $n$ is the dimension of the vector space that generates the object $F$.

\subsection{Reciprocal frames}

As evident in equation (\ref{eqn:stokesNoTensor:stokes}) a metric is required to define the dot product.  If an affine non-metric formulation
of Stokes theorem is possible it will not be attempted here.  A reciprocal basis pair will be utilized, defined by

\begin{align}\label{eqn:stokesNoTensor:140}
\gamma^\mu \cdot \gamma_\nu = {\delta^\mu}_\nu
\end{align}

Both of the sets $\{\gamma_\mu\}$ and $\{\gamma^\mu\}$ are taken to span the space, but are not required to be orthogonal.  The notation is consistent with the Dirac reciprocal basis, and there will not be anything in this treatment that prohibits the Minkowski metric signature required for such a relativistic space.

Vector decomposition in terms of coordinates follows by taking dot products.  We write

\begin{align}\label{eqn:stokesNoTensor:150}
x = x^\mu \gamma_\mu = x_\nu \gamma^\nu
\end{align}

\subsection{Gradient}

When working with a non-orthonormal basis, use of the reciprocal frame can be utilized to express the gradient.

\begin{align}\label{eqn:stokesNoTensor:160}
\grad \equiv \gamma^\mu \partial_\mu \equiv \sum_\mu \gamma^\mu \PD{x^\mu}{}
\end{align}

This contains what may perhaps seem like an odd seeming mix of upper and lower indexes in this definition.  This is how the gradient is defined in \citep{doran2003gap}.  Although it is possible to accept this definition and work with it, this form can be justified by require of the gradient consistency with the the definition of directional derivative.  A definition of the directional derivative that works for single and multivector functions, in \R{3} and other more general spaces is

\begin{align}\label{eqn:stokesNoTensor:170}
a \cdot \grad F \equiv \lim_{\lambda \rightarrow 0} \frac{F(x + a\lambda) - F(x)}{\lambda} = {\left.\PD{\lambda}{F(x + a\lambda)} \right\vert}_{\lambda=0}
\end{align}

Taylor expanding about $\lambda=0$ in terms of coordinates we have

\begin{align*}
{\left.\PD{\lambda}{F(x + a\lambda)} \right\vert}_{\lambda=0}
&= a^\mu \PD{x^\mu}{F} \\
%&= a^\mu \partial_\mu F \\
&= (a^\nu \gamma_\nu) \cdot (\gamma^\mu \partial_\mu) F \\
&= a \cdot \grad F \quad\quad\quad\square
\end{align*}

The lower index representation of the vector coordinates could also have been used, so using the directional derivative to imply a definition of the gradient, we have an additional alternate representation of the gradient

\begin{align}\label{eqn:stokesNoTensor:180}
\grad \equiv \gamma_\mu \partial^\mu \equiv \sum_\mu \gamma_\mu \PD{x_\mu}{}
\end{align}

\subsection{Volume element}
We define the hypervolume in terms of parametrized vector displacements $x = x(a_1, a_2, ... a_k)$.  For the vector x we can form a pseudoscalar for the subspace spanned by this parametrization by wedging the displacements in each of the directions defined by variation of the parameters.  For $m \in [1,k]$ let

\begin{align}\label{eqn:stokesNoTensor:oneForm}
dx_i = \PD{a_i}{x} da_i = \gamma_\mu \PD{a_i}{x^\mu} da_i,
\end{align}

%\begin{align*}
%dx_1 & = \PD{a_1}{x} da_1 = \gamma_\mu \PD{a_1}{x^\mu} da_1 \\
%dx_2 & = \PD{a_2}{x} da_2 = \gamma_\mu \PD{a_2}{x^\mu} da_2 \\
%\hdots \\
%dx_k & = \PD{a_k}{x} da_k = \gamma_\mu \PD{a_k}{x^\mu} da_k,
%\end{align*}

so the hypervolume element for the subspace in question is
\begin{align}\label{eqn:stokesNoTensor:volumeElement}
d^k x \equiv dx_1 \wedge dx_2 \cdots dx_k
\end{align}

This can be expanded explicitly in coordinates

\begin{align*}
d^k x 
&= da_1 da_2 \cdots da_k 
\left(
\PD{a_1}{x^{\mu_1}} 
\PD{a_2}{x^{\mu_2}} 
\cdots
\PD{a_k}{x^{\mu_k}} 
\right)
( \gamma_{\mu_1} \wedge \gamma_{\mu_2} \wedge \cdots \wedge \gamma_{\mu_k} ) \\
%&= 
%da_1 da_2 \cdots da_k 
%\sum_{\mu_1 < \mu_2 < \cdots < \mu_k}
%\PD{(a_1, a_2, \cdots, a_k)}{(x^{\mu_1}, x^{\mu_2}, \cdots, x^{\mu_k})}
%( \gamma_{\mu_1} \wedge \gamma_{\mu_2} \wedge \cdots \wedge \gamma_{\mu_k} ) \\
\end{align*}

Observe that when $k$ is also the dimension of the space, we can employ a pseudoscalar $I = \gamma_0 \gamma_1 \cdots \gamma_k$ and can specify our volume element in terms of the Jacobian determinant.

This is
\begin{align}\label{eqn:stokesNoTensor:jacobian}
d^k x =
%da_1 da_2 \cdots da_k
%\PD{(a_1, a_2, \cdots, a_k)}{(x^{\mu_1}, x^{\mu_2}, \cdots, x^{\mu_k})}
%\epsilon_{ \mu_1 \mu_2 \cdots \mu_k } I
%= 
I da_1 da_2 \cdots da_k \Abs{
\PD{(a_1, a_2, \cdots, a_k)}{(x^1, x^2, \cdots, x^k)}
}
\end{align}

However, we won't have a requirement to express the Stokes result in terms of such Jacobians.

\subsection{Expansion of the curl and volume element product}

We are now prepared to go on to the meat of the issue.  The first order of business is the expansion of the curl and volume element product

\begin{align*}
( \grad \wedge F ) \cdot d^k x
&=
( \gamma^\mu \wedge \partial_\mu F ) \cdot d^k x \\
&=
\gpgradezero{ ( \gamma^\mu \wedge \partial_\mu F ) d^k x } \\
\end{align*}

The wedge product within the scalar grade selection operator can be expanded in symmetric or antisymmetric sums, but this is a grade dependent operation.  For odd grade blades $A$ (vector, trivector, ...), and vector $a$ we have for the dot and wedge product respectively

\begin{align*}
a \wedge A = \inv{2} (a A - A a) \\
a \cdot A = \inv{2} (a A + A a)
\end{align*}

Similarly for even grade blades we have

\begin{align*}
a \wedge A = \inv{2} (a A + A a) \\
a \cdot A = \inv{2} (a A - A a)
\end{align*}

First treating the odd grade case for $F$ we have

\begin{align*}
( \grad \wedge F ) \cdot d^k x
&=
\inv{2} \gpgradezero{ \gamma^\mu \partial_\mu F d^k x } - \inv{2} \gpgradezero{ \partial_\mu F \gamma^\mu d^k x } \\
\end{align*}

Employing cyclic scalar reordering within the scalar product for the first term

\begin{align}\label{eqn:stokesNoTensor:100}
\gpgradezero{a b c} = \gpgradezero{b c a}
\end{align}

we have

\begin{align*}
( \grad \wedge F ) \cdot d^k x
&=
\inv{2} \gpgradezero{ \partial_\mu F (d^k x \gamma^\mu - \gamma^\mu d^k x)} \\
&=
\inv{2} \gpgradezero{ \partial_\mu F (d^k x \cdot \gamma^\mu - \gamma^\mu d^k x)} \\
&=
\gpgradezero{ \partial_\mu F (d^k x \cdot \gamma^\mu)} \\
\end{align*}

The end result is 

\begin{align}\label{eqn:stokesNoTensor:startingPoint}
( \grad \wedge F ) \cdot d^k x &= \partial_\mu F \cdot (d^k x \cdot \gamma^\mu) 
\end{align}

For even grade $F$ (and thus odd grade $d^k x$) it is straightforward to show that (\ref{eqn:stokesNoTensor:startingPoint}) also holds.

\subsection{Expanding the volume dot product}

We want to expand the volume integral dot product

\begin{align}\label{eqn:stokesNoTensor:110}
d^k x \cdot \gamma^\mu
\end{align}

Picking $k = 4$ will serve to illustrate the pattern, and the generalization (or degeneralization to lower grades) will be clear.  We have

\begin{align*}
d^4 x \cdot \gamma^\mu
&=
( dx_1 \wedge dx_2 \wedge dx_3 \wedge dx_4 ) \cdot \gamma^\mu \\
&= ( dx_1 \wedge dx_2 \wedge dx_3 ) dx_4 \cdot \gamma^\mu \\
&-( dx_1 \wedge dx_2 \wedge dx_4 ) dx_3 \cdot \gamma^\mu \\
&+( dx_1 \wedge dx_3 \wedge dx_4 ) dx_2 \cdot \gamma^\mu \\
&-( dx_2 \wedge dx_3 \wedge dx_4 ) dx_1 \cdot \gamma^\mu  \\
\end{align*}

This avoids the requirement to do the entire Jacobian expansion of (\ref{eqn:stokesNoTensor:jacobian}).  The dot product of the differential displacement $dx_m$ with $\gamma^\mu$ can now be made explicit without as much mess.

\begin{align*}
dx_m \cdot \gamma^\mu 
&=
da_m \PD{a_m}{x^\nu} \gamma_\nu \cdot \gamma^\mu \\
&=
da_m \PD{a_m}{x^\mu} \\
\end{align*}

We now have products of the form

\begin{align*}
\partial_\mu F da_m \PD{a_m}{x^\mu} 
&=
da_m \PD{a_m}{x^\mu} \PD{x^\mu}{F} \\
&=
da_m \PD{a_m}{F} \\
\end{align*}

Now we see that the differential form of (\ref{eqn:stokesNoTensor:startingPoint}) for this $k=4$ example is reduced to

\begin{align*}
( \grad \wedge F ) \cdot d^4 x 
&= da_4 \PD{a_4}{F} \cdot ( dx_1 \wedge dx_2 \wedge dx_3 ) \\
&- da_3 \PD{a_3}{F} \cdot ( dx_1 \wedge dx_2 \wedge dx_4 ) \\
&+ da_2 \PD{a_2}{F} \cdot ( dx_1 \wedge dx_3 \wedge dx_4 ) \\
&- da_1 \PD{a_1}{F} \cdot ( dx_2 \wedge dx_3 \wedge dx_4 ) \\
\end{align*}

While \ref{eqn:stokesNoTensor:startingPoint} was a statement of Stokes theorem in this Geometric Algebra formulation, it was really incomplete without this explicit expansion of $(\partial_\mu F) \cdot (d^k x \cdot \gamma^\mu)$.  This expansion for the $k=4$ case serves to illustrate that we would write Stokes theorem as

\begin{equation}\label{eqn:stokesNoTensor:190}
\boxed{
\int
( \grad \wedge F ) \cdot d^k x 
=
\inv{(k-1)!} \epsilon^{ r s \cdots t u } \int da_u \PD{a_{u}}{F} \cdot 
(dx_r \wedge dx_s \wedge \cdots \wedge dx_t)
}
\end{equation}
%\left( 
%\PD{a_r}{x} \wedge \PD{a_s}{x} \wedge \cdots \wedge \PD{a_t}{x} \right)
%da_1 da_2 \cdots da_k

Here the indexes have the range $\{r, s, \cdots, t, u\} \in \{1, 2, \cdots k\}$.  This with the definitions \ref{eqn:stokesNoTensor:oneForm}, and \ref{eqn:stokesNoTensor:volumeElement} is really Stokes theorem in its full glory.

Observe that in this Geometric algebra form, the one forms $dx_i = da_i \PDi{a_i}{x}, i \in [1,k]$ are nothing more abstract that plain old vector differential elements.  In the formalism of differential forms, this would be vectors, and $(\grad \wedge F) \cdot d^k x$ would be a $k$ form.  In a context where we are working with vectors, or blades already, the Geometric Algebra statement of the theorem avoids a requirement to translate to the language of forms.

With a statement of the general theorem complete, let's return to our $k=4$ case where we can now integrate over each of the $a_1, a_2, \cdots, a_k$ parameters.  That is

\begin{align*}
\int ( \grad \wedge F ) \cdot d^4 x 
&= \int (F(a_4(1)) - F(a_4(0))) \cdot ( dx_1 \wedge dx_2 \wedge dx_3 ) \\
&- \int (F(a_3(1)) - F(a_3(0))) \cdot ( dx_1 \wedge dx_2 \wedge dx_4 ) \\
&+ \int (F(a_2(1)) - F(a_2(0))) \cdot ( dx_1 \wedge dx_3 \wedge dx_4 ) \\
&- \int (F(a_1(1)) - F(a_1(0))) \cdot ( dx_2 \wedge dx_3 \wedge dx_4 ) \\
\end{align*}

This is precisely Stokes theorem for the trivector case and makes the enumeration of the boundary surfaces explicit.  As derived there was no requirement for an orthonormal basis, nor a Euclidean metric, nor a parametrization along the basis directions.  The only requirement of the parametrization is that the associated volume element is non-trivial (i.e. none of $dx_q \wedge dx_r = 0$).  %The issue of how to extend this from the hyper-parallelepiped volume element to a general has been skipped, and should perhaps be thought through more carefully.

For completeness, note that our boundary surface and associated Stokes statement for the bivector and vector cases is, by inspection respectively

\begin{align*}
\int ( \grad \wedge F ) \cdot d^3 x 
&= \int (F(a_3(1)) - F(a_3(0))) \cdot ( dx_1 \wedge dx_2 ) \\
&- \int (F(a_2(1)) - F(a_2(0))) \cdot ( dx_1 \wedge dx_3 ) \\
&+ \int (F(a_1(1)) - F(a_1(0))) \cdot ( dx_2 \wedge dx_3 ) \\
\end{align*}

and
\begin{align*}
\int ( \grad \wedge F ) \cdot d^2 x 
&= \int (F(a_2(1)) - F(a_2(0))) \cdot dx_1 \\
&- \int (F(a_1(1)) - F(a_1(0))) \cdot dx_2 \\
\end{align*}

These three expansions can be summarized by the original single statement of (\ref{eqn:stokesNoTensor:stokes}), which repeating for reference, is

\begin{align*}
\int ( \grad \wedge F ) \cdot d^k x = \int F \cdot d^{k-1} x 
\end{align*}

Where it is implied that the blade $F$ is evaluated on the boundaries and dotted with the associated hypersurface boundary element.  However, having expanded this we now have an explicit statement of exactly what that surface element is now for any desired parametrization.

\section{Duality relations and special cases}

Some special (and more recognizable) cases of (\ref{eqn:stokesNoTensor:stokes}) are possible considering specific grades of $F$, and in some cases employing duality relations.  

\subsection{curl surface integral}

One important case is the \R{3} vector result, which can be expressed in terms of the cross product.

Write $\ncap d^2 x = -i dA$.  Then we have

\begin{align*}
( \spacegrad \wedge \Bf ) \cdot d^2 x
&=
\gpgradezero{ i (\spacegrad \cross \Bf) (- \ncap i dA) } \\
&=
(\spacegrad \cross \Bf) \cdot \ncap dA
\end{align*}

This recovers the familiar cross product form of Stokes law.

\begin{align}\label{eqn:stokesNoTensor:120}
\int (\spacegrad \cross \Bf) \cdot \ncap dA = \ointclockwise \Bf \cdot d\Bx
\end{align}

\subsection{3D divergence theorem}

Duality applied to the bivector Stokes result provides the divergence theorem in \R{3}.  For bivector $B$, let $iB = \Bf$, $d^3 x = i dV$, and $d^2 x = i \ncap dA$.  We then have

\begin{align*}
( \spacegrad \wedge B ) \cdot d^3 x
&=
\gpgradezero{ ( \spacegrad \wedge B ) \cdot d^3 x } \\
&=
\inv{2} \gpgradezero{ ( \spacegrad B + B \spacegrad ) i dV } \\
&=
\spacegrad \cdot \Bf dV \\
\end{align*}

Similarly

\begin{align*}
B \cdot d^2 x
&=
\gpgradezero{ 
-i\Bf i \ncap dA
} \\
&=
(\Bf \cdot \ncap) dA
 \\
\end{align*}

This recovers the \R{3} divergence equation

\begin{align}\label{eqn:stokesNoTensor:130}
\int \spacegrad \cdot \Bf dV = \int (\Bf \cdot \ncap) dA
\end{align}

\subsection{4D divergence theorem}

How about the four dimensional spacetime divergence?  Write, express a trivector as a dual four-vector $T = if$, and the four volume element $d^4 x = i dQ$.  This gives

\begin{align*}
(\grad \wedge T) \cdot d^4 x
&=
\inv{2} \gpgradezero{ (\grad T - T \grad) i } dQ \\
&=
\inv{2} \gpgradezero{ (\grad i f - if \grad) i } dQ \\
&=
\frac{1}{2} \gpgradezero{ (\grad f + f \grad) } dQ \\
&=
(\grad \cdot f) dQ
\end{align*}

For the boundary volume integral write $d^3 x = n i dV$, for
\begin{align*}
T \cdot d^3 x 
&= 
\gpgradezero{ (if) ( n i ) } dV \\
&= 
\gpgradezero{ f n } dV \\
&= 
(f \cdot n) dV
\end{align*}

So we have

\begin{align*}
\int \partial_\mu f^\mu dQ = \int f^\nu n_\nu dV
\end{align*}

the orientation of the fourspace volume element and the boundary normal is defined in terms of the parametrization, the duality relations and our explicit expansion of the 4D stokes boundary integral above.

\subsection{4D divergence theorem, continued}

The basic idea of using duality to express the 4D divergence integral as a stokes boundary surface integral has been explored.  Lets consider this in more detail picking a specific parametrization, namely rectangular four vector coordinates.  For the volume element write

\begin{align*}
d^4 x 
&= ( \gamma_0 dx^0 ) \wedge ( \gamma_1 dx^1 ) \wedge ( \gamma_2 dx^2 ) \wedge ( \gamma_3 dx^3 ) \\
&= \gamma_0 \gamma_1 \gamma_2 \gamma_3 dx^0 dx^1 dx^2 dx^3 \\
&= i dx^0 dx^1 dx^2 dx^3 \\
\end{align*}

As seen previously (but not separately), the divergence can be expressed as the dual of the curl

\begin{align*}
\grad \cdot f
&=
\gpgradezero{ \grad f } \\
&=
-\gpgradezero{ \grad i (\underbrace{i f}_{\text{grade 3}}) } \\
&=
\gpgradezero{ i \grad (i f) } \\
%&=
%\gpgradezero{ i ( \grad \cdot (i f) + \grad \wedge (i f) ) } \\
&=
\gpgradezero{ i ( \underbrace{\grad \cdot (i f)}_{\text{grade 2}} + \underbrace{\grad \wedge (i f)}_{\text{grade 4}} ) } \\
&=
i (\grad \wedge (i f)) \\
\end{align*}

So we have $\grad \wedge (i f) = -i (\grad \cdot f)$.  Putting things together, and writing $i f = -f i$ we have 

\begin{align*}
\int (\grad \wedge (i f)) \cdot d^4 x
&= 
\int (\grad \cdot f) dx^0 dx^1 dx^2 dx^3 \\
&=
\int dx^0 \partial_0 (f i) \cdot \gamma_{123} dx^1 dx^2 dx^3 \\
&-\int dx^1 \partial_1 (f i) \cdot \gamma_{023} dx^0 dx^2 dx^3 \\
&+\int dx^2 \partial_2 (f i) \cdot \gamma_{013} dx^0 dx^1 dx^3 \\
&-\int dx^3 \partial_3 (f i) \cdot \gamma_{012} dx^0 dx^1 dx^2 \\
\end{align*}

It is straightforward to reduce each of these dot products.  For example

\begin{align*}
\partial_2 (f i) \cdot \gamma_{013}
&=
\gpgradezero{ \partial_2 f \gamma_{0123013} } \\
&=
-\gpgradezero{ \partial_2 f \gamma_{2} } \\
&=
- \gamma_2 \partial_2 \cdot f \\
&=
\gamma^2 \partial_2 \cdot f 
\end{align*}

The rest proceed the same and rather anticlimactically we end up coming full circle 

\begin{align*}
\int (\grad \cdot f) dx^0 dx^1 dx^2 dx^3 
&=
\int dx^0 \gamma^0 \partial_0 \cdot f dx^1 dx^2 dx^3 \\
&+\int dx^1 \gamma^1 \partial_1 \cdot f dx^0 dx^2 dx^3 \\
&+\int dx^2 \gamma^2 \partial_2 \cdot f dx^0 dx^1 dx^3 \\
&+\int dx^3 \gamma^3 \partial_3 \cdot f dx^0 dx^1 dx^2 \\
\end{align*}

This is however nothing more than the definition of the divergence itself and no need to resort to Stokes theorem is required.  However, if we are integrating over a rectangle and perform each of the four integrals, we have (with $c=1$) from the dual Stokes equation the perhaps less obvious result

\begin{align*}
\int \partial_\mu f^\mu dt dx dy dz
&=
\int (f^0(t_1) - f^0(t_0)) dx dy dz \\
&+\int (f^1(x_1) - f^1(x_0)) dt dy dz \\
&+\int (f^2(y_1) - f^2(y_0)) dt dx dz \\
&+\int (f^3(z_1) - f^3(z_0)) dt dx dy \\
\end{align*}

When stated this way one sees that this could have just as easily have followed directly from the left hand side.  What's the point then of the divergence theorem or Stokes theorem?  I think that the value must really be the fact that the Stokes formulation naturally builds the volume element in a fashion independent of any specific parametrization.  Here in rectangular coordinates the result seems obvious, but would the equivalent result seem obvious if non-rectangular spacetime coordinates were employed?  Probably not.

%\EndArticle
