%
% Copyright © 2012 Peeter Joot.  All Rights Reserved.
% Licenced as described in the file LICENSE under the root directory of this GIT repository.
%

% 
% 
%\input{../peeter_prologue.tex}

\chapter{Spherical Polar unit vectors in exponential form}
\label{chap:sphericalPolarUnit}

%\blogpage{http://sites.google.com/site/peeterjoot/math2009/sphericalPolarUnit.pdf?revision=5}
%\date{Sept 20, 2009 $RCSfile: sphericalPolarUnit.tex,v $ Last $Revision: 1.10 $ $Date: 2009/10/26 03:56:52 $}
%%\date{Sept 20, 2009}
%%\revisionInfo{$RCSfile: sphericalPolarUnit.tex,v $ Last $Revision: 1.10 $ $Date: 2009/10/26 03:56:52 $}

\beginArtWithToc
%\beginArtNoToc

\section{Motivation}

In \chapcite{qmAngularMom} I blundered on a particularly concise exponential non-coordinate form for the unit vectors in a spherical polar coordinate system.  For future reference outside of a quantum mechanical context here is a separate and more concise iteration of these results.

\section{The rotation and notation}

The spherical polar rotor is a composition of rotations, expressed as half angle exponentials.  Following the normal physics conventions we first apply a $z,x$ plane rotation by angle theta, then an $x,y$ plane rotation by angle $\phi$.  This produces the rotor

\begin{align}\label{eqn:sphericalPolarUnit:foo1}
R = e^{\Be_{31}\theta/2} e^{\Be_{12}\phi/2}
\end{align}

Our triplet of Cartesian unit vectors is therefore rotated as

\begin{align}\label{eqn:sphericalPolarUnit:foo2}
\begin{pmatrix}
\rcap \\
\thetacap \\
\phicap \\
\end{pmatrix}
&=
\tilde{R}
\begin{pmatrix}
\Be_3 \\
\Be_1 \\
\Be_2 \\
\end{pmatrix}
R
\end{align}

In the quantum mechanical context it was convenient to denote the $x,y$ plane unit bivector with the imaginary symbol

\begin{align}\label{eqn:sphericalPolarUnit:foo3}
i = \Be_1 \Be_2
\end{align}

reserving for the spatial pseudoscalar the capital

\begin{align}\label{eqn:sphericalPolarUnit:foo4}
I = \Be_1 \Be_2 \Be_3 = \rcap \thetacap \phicap = i \Be_3
\end{align}

Note the characteristic differences between these two ``imaginaries''.  The planar quantity $i = \Be_1 \Be_2$ commutes with $\Be_3$, but anticommutes with either $\Be_1$ or $\Be_2$.  On the other hand the spatial pseudoscalar $I$ commutes with any vector, bivector or trivector in the algebra.

\section{Application of the rotor.  The spherical polar unit vectors}

Having fixed notation, lets apply the rotation to each of the unit vectors in sequence, starting with the calculation for $\phicap$.  This is

\begin{align*}
\phicap 
&= e^{-i \phi/2} e^{-\Be_{31}\theta/2} (\Be_2) e^{\Be_{31}\theta/2} e^{i\phi/2} \\
&= \Be_2 e^{i\phi} 
\end{align*}

Here, since $\Be_2$ commutes with the rotor bivector $\Be_3 \Be_1$ the innermost exponentials cancel, leaving just the $i\phi$ rotation.  For $\rcap$ it is a bit messier, and we have

\begin{align*}
\rcap 
&= e^{-i \phi/2} e^{-\Be_{31}\theta/2} (\Be_3) e^{\Be_{31}\theta/2} e^{i\phi/2} \\
&= e^{-i \phi/2} \Be_3 e^{\Be_{31}\theta} e^{i\phi/2} \\
&= e^{-i \phi/2} (\Be_3 \cos\theta + \Be_1 \sin\theta) e^{i\phi/2} \\
&= \Be_3 \cos\theta + \Be_1 \sin\theta e^{i\phi} \\
&= \Be_3 \cos\theta + \Be_1 \Be_2 \sin\theta \Be_2 e^{i\phi} \\
&= \Be_3 \cos\theta + i \sin\theta \phicap \\
&= \Be_3 (\cos\theta + \Be_3 i \sin\theta \phicap) \\
&= \Be_3 e^{I\phicap\theta} 
\end{align*}

Finally for $\thetacap$, we have a similar messy expansion

\begin{align*}
\thetacap 
&= e^{-i \phi/2} e^{-\Be_{31}\theta/2} (\Be_1) e^{\Be_{31}\theta/2} e^{i\phi/2} \\
&= e^{-i \phi/2} \Be_1 e^{\Be_{31}\theta} e^{i\phi/2} \\
&= e^{-i \phi/2} (\Be_1 \cos\theta - \Be_3 \sin\theta) e^{i\phi/2} \\
&= \Be_1 \cos\theta e^{i\phi} - \Be_3 \sin\theta \\
&= i \cos\theta \Be_2 e^{i\phi} - \Be_3 \sin\theta \\
&= i \phicap \cos\theta - \Be_3 \sin\theta \\
&= i \phicap (\cos\theta + \phicap i \Be_3 \sin\theta) \\
&= i \phicap e^{I\phicap\theta}
\end{align*}

Summarizing the three of these relations we have for the rotated unit vectors

\begin{align}\label{eqn:sphericalPolarUnit:foo5}
\rcap &= \Be_3 e^{I \phicap \theta} \\
\thetacap &= i \phicap e^{I \phicap \theta} \\
\phicap &= \Be_2 e^{i\phi} 
\end{align}

and in particular for the radial position vector from the origin, rotating from the polar axis, we have

\begin{align}\label{eqn:sphericalPolarUnit:foo6}
\Bx &= r \rcap = r \Be_3 e^{I\phicap \theta}
\end{align}

Compare this to the coordinate representation

\begin{align}\label{eqn:sphericalPolarUnit:foo7}
\Bx = r(\sin\theta \cos\phi, \sin\theta \sin\phi, \cos\theta)
\end{align}

it is not initially obvious that these $\theta$ and $\phi$ rotations admit such a tidy factorization.  In retrospect, this does not seem so surprising, since we can form a quaternion product that acts via multiplication to map a vector to a rotated position.  In fact those quaternions, acting from the right on the initial vectors are 

\begin{align}\label{eqn:sphericalPolarUnit:foo8}
\Be_3 &\rightarrow \rcap = \Be_3 \bigl( e^{I \phicap \theta} \bigr) \\
\Be_1 &\rightarrow \thetacap = \Be_1 \bigl( \Be_2 \phicap e^{I \phicap \theta} \bigr) \\
\Be_2 &\rightarrow \phicap = \Be_2 \bigl( e^{i\phi} \bigr)
\end{align}

FIXME: it should be possible to reduce the quaternion that rotates $\Be_1 \rightarrow \thetacap$ to a single exponential.  What is it?

\section{A consistency check}

We expect that the dot product between a north pole oriented vector $\Bz = Z \Be_3$ and the spherically polar rotated vector $\Bx = r \Be_3 e^{I\phicap \theta}$ is just

\begin{align}\label{eqn:sphericalPolarUnit:foo13}
\Bx \cdot \Bz = Z r \cos\theta
\end{align}

Lets verify this

\begin{align*}
\Bx \cdot \Bz 
&= 
\gpgradezero{ Z \Be_3 \Be_3 r e^{I\phicap \theta}} \\
&= 
Z r \gpgradezero{ \cos\theta + I \phicap \sin\theta} \\
&= 
Z r \cos\theta &\quad\square
\end{align*}

\section{Area and volume elements}

Let us use these results to compute the spherical polar volume element.  Pictorially this can be read off simply from a diagram.  If one is less trusting of pictorial means (or want a method more generally applicable), we can also do this particular calculation algebraically, expanding the determinant of partials

\begin{align}\label{eqn:sphericalPolarUnit:foo9}
\begin{vmatrix}
\frac{\partial \Bx}{\partial r} & \frac{\partial \Bx}{\partial \theta} & \frac{\partial \Bx}{\partial \phi} \\
\end{vmatrix} dr d\theta d\phi
&=
\begin{vmatrix}
\sin\theta \cos\phi & \cos\theta \cos\phi & -\sin\theta \sin\phi \\
\sin\theta \sin\phi & \cos\theta \sin\phi & \sin\theta \cos\phi \\
\cos\theta          & -\sin\theta         & 0                   \\
\end{vmatrix} r^2 dr d\theta d\phi
\end{align}

One can chug through the trig reduction for this determinant with not too much trouble, but it is not particularly fun.

Now compare to the same calculation proceeding directly with the exponential form.  We do still need to compute the partials

\begin{align*}
\frac{\partial \Bx}{\partial r} = \rcap
\end{align*}

\begin{align*}
\frac{\partial \Bx}{\partial \theta} 
&= r \Be_3 \frac{\partial }{\partial \theta} e^{I\phicap \theta} \\
&= r \rcap I \phicap \\
&= r \rcap (\rcap \thetacap \phicap) \phicap \\
&= r \thetacap
\end{align*}

\begin{align*}
\frac{\partial \Bx}{\partial \phi} 
&= r \Be_3 \frac{\partial }{\partial \phi} (\cos\theta + I\phicap \sin\theta) \\
&= -r \Be_3 I i \phicap \sin\theta \\
&= r \phicap \sin\theta 
\end{align*}

So the area element, the oriented area of the parallelogram between the two vectors $d\theta \partial \Bx/\partial \theta$, and $d\phi \partial \Bx/\partial \phi$ on the spherical surface at radius $r$ is

\begin{align}\label{eqn:sphericalPolarUnit:foo10}
d\BS = \left(d\theta \frac{\partial \Bx}{\partial \theta}\right) \wedge \left( d\phi \frac{\partial \Bx}{\partial \phi} \right) 
= r^2 \thetacap \phicap \sin\theta d\theta d\phi
\end{align}

and the volume element in trivector form is just the product
\begin{align}\label{eqn:sphericalPolarUnit:foo11}
d\BV = \left(dr\frac{\partial \Bx}{\partial r}\right) \wedge d\BS
= r^2 \sin\theta I dr d\theta d\phi
\end{align}

\section{Line element}

The line element for the particle moving on a spherical surface can be calculated by calculating the derivative of the spherical polar unit vector $\rcap$

\begin{align}\label{eqn:sphericalPolarUnit:yoo1a}
\frac{d\rcap}{dt} = \PD{\phi}{\rcap} \frac{d\phi}{dt} 
+\PD{\theta}{\rcap} \frac{d\theta}{dt}
\end{align}

than taking the magnitude of this vector.  We can start either in coordinate form

\begin{align}\label{eqn:sphericalPolarUnit:yoo1}
\rcap 
&= \Be_3 \cos\theta + \Be_1 \sin\theta \cos\phi + \Be_2 \sin\theta \sin\phi
\end{align}

or, instead do it the fun way, first grouping this into a complex exponential form.  This factorization was done above, but starting over allows this to be done a bit more effectively for this particular problem.  As above, writing $i = \Be_1 \Be_2$, the first factorization is

\begin{align}\label{eqn:sphericalPolarUnit:yoo2}
\rcap 
&= \Be_3 \cos\theta + \Be_1 \sin\theta e^{i\phi} 
\end{align}

The unit vector $\Brho = \Be_1 e^{i\phi}$ lies in the $x,y$ plane perpendicular to $\Be_3$, so we can form the unit bivector $\Be_3\Brho$ and further factor the unit vector terms into a $\cos + i \sin$ form

\begin{align*}
\rcap 
&= \Be_3 \cos\theta + \Be_1 \sin\theta e^{i\phi} \\
&= \Be_3 (\cos\theta + \Be_3 \Brho \sin\theta) \\
\end{align*}

This allows the spherical polar unit vector to be expressed in complex exponential form (really a vector-quaternion product)

\begin{align}\label{eqn:sphericalPolarUnit:yoo3}
\rcap = \Be_3 e^{\Be_3 \Brho \theta} = e^{-\Be_3 \Brho \theta} \Be_3
\end{align}

Now, calculating the unit vector velocity, we get

\begin{align*}
\frac{d\rcap}{dt} 
&= \Be_3 \Be_3 \Brho e^{\Be_3 \Brho \theta} \thetadot + \Be_1 \Be_1 \Be_2 \sin\theta e^{i\phi} \phidot \\
&= \Brho e^{\Be_3 \Brho \theta} \left(\thetadot + e^{-\Be_3 \Brho \theta} \Brho \sin\theta e^{-i\phi} \Be_2 \phidot\right) \\
&= \left( \thetadot + \Be_2 \sin\theta e^{i\phi} \phidot \Brho e^{\Be_3 \Brho \theta} \right) e^{-\Be_3 \Brho \theta} \Brho
\end{align*}

The last two lines above factor the $\Brho$ vector and the $e^{\Be_3 \Brho \theta}$ quaternion to the left and to the right in preparation for squaring this to calculate the magnitude.

\begin{align*}
\left( \frac{d\rcap}{dt} \right)^2
&=
\gpgradezero{ \left( \frac{d\rcap}{dt} \right)^2 } \\
&=
\gpgradezero{ 
\left( \thetadot + \Be_2 \sin\theta e^{i\phi} \phidot \Brho e^{\Be_3 \Brho \theta} \right) 
\left(\thetadot + e^{-\Be_3 \Brho \theta} \Brho \sin\theta e^{-i\phi} \Be_2 \phidot\right) } \\
&=
\thetadot^2 + \sin^2\theta \phidot^2
+ \sin\theta \phidot \thetadot
\gpgradezero{ 
\Be_2 e^{i\phi} \Brho e^{\Be_3 \rho \theta}
+e^{-\Be_3 \rho \theta} \Brho e^{-i\phi} \Be_2
} \\
\end{align*}

This last term ($\in \Span \{\rho\Be_1, \rho\Be_2, \Be_1\Be_3, \Be_2\Be_3\}$) has only grade two components, so the scalar part is zero.  We are left with the line element 

\begin{align}\label{eqn:sphericalPolarUnit:yoo4}
\left(\frac{d (r\rcap)}{dt}\right)^2 = r^2 \left( \thetadot^2 + \sin^2\theta \phidot^2 \right)
\end{align}

In retrospect, at least once one sees the answer, it seems obvious.  Keeping $\theta$ constant the length increment moving in the plane is $ds = \sin\theta d\phi$, and keeping $\phi$ constant, we have $ds = d\theta$.  Since these are perpendicular directions we can add the lengths using the Pythagorean theorem.

\subsection{Line element using an angle and unit bivector parameterization}

Parameterizing using scalar angles is not the only approach that we can take to calculate the line element on the unit sphere.  Proceding directly with a alternate polar representation, utilizing a unit bivector $j$, and scalar angle $\theta$ is

\begin{align}\label{eqn:sphericalPolarUnit:zoo1}
\Bx = r \Be_3 e^{j\theta}
\end{align}

For this product to be a vector $j$ must contain $\Be_3$ as a factor ($j = \Be_3 \wedge m$ for some vector m.)  Setting $r = 1$ for now, the deriviate of $\Bx$ is

\begin{align*}
\dot{\Bx} 
&= \Be_3 \frac{d}{dt} \left( \cos\theta + j \sin\theta \right) \\
&= \Be_3 \thetadot \left( -\sin\theta + j \cos\theta \right) + \Be_3 \frac{d j}{dt} \sin\theta  \\
&= \Be_3 \thetadot j \left( j \sin\theta + \cos\theta \right) + \Be_3 \frac{d j}{dt} \sin\theta  \\
\end{align*}

This is
\begin{align}\label{eqn:sphericalPolarUnit:zoo2}
\dot{\Bx} = \Be_3 \left( \frac{d\theta}{dt} j e^{j\theta} + \frac{d j}{dt} \sin\theta \right)
\end{align}

Alternately, we can take derivatives of $\Bx = r e^{-j\theta} \Be_3$, for

%COMMENT OUT:
%\begin{align*}
%\dot{\Bx} 
%&= \frac{d}{dt} \left( \cos\theta - j \sin\theta \right) \Be_3 \\
%&= \thetadot \left( -\sin\theta - j \cos\theta \right) \Be_3 - \frac{d j}{dt} \sin\theta \Be_3 \\
%&= -\thetadot j \left( -j \sin\theta + \cos\theta \right) \Be_3 - \frac{d j}{dt} \sin\theta \Be_3 \\
%\end{align*}

Or
\begin{align}\label{eqn:sphericalPolarUnit:zoo3}
\dot{\Bx} = -\left( \frac{d\theta}{dt} j e^{-j\theta} + \frac{d j}{dt} \sin\theta \right) \Be_3
\end{align}

Together with \ref{eqn:sphericalPolarUnit:zoo2}, the line element for position change on the unit sphere is then

\begin{align*}
\dot{\Bx}^2 
&= \gpgradezero{
-\left( \frac{d\theta}{dt} j e^{-j\theta} + \frac{d j}{dt} \sin\theta \right) \Be_3 \Be_3 \left( \frac{d\theta}{dt} j e^{j\theta} + \frac{d j}{dt} \sin\theta \right) } \\
&= \gpgradezero{
-\left( \frac{d\theta}{dt} j e^{-j\theta} + \frac{d j}{dt} \sin\theta \right) \left( \frac{d\theta}{dt} j e^{j\theta} + \frac{d j}{dt} \sin\theta \right) } \\
&=
\left(\frac{d\theta}{dt}\right)^2 - \left(\frac{d j}{dt}\right)^2 \sin^2\theta 
- \frac{d\theta}{dt} \sin\theta 
\gpgradezero{ \frac{dj}{dt} j e^{j\theta} + j e^{-j\theta} \frac{dj}{dt} } \\
\end{align*}

Starting with cyclic reordering of the last term, we get zero

\begin{align*}
\gpgradezero{ \frac{dj}{dt} j e^{j\theta} + j e^{-j\theta} \frac{dj}{dt} } 
&=
\gpgradezero{ \frac{dj}{dt} j \left( e^{j\theta} + e^{-j\theta} \right) }  \\
&=
\gpgradezero{ \frac{dj}{dt} j 2 j \sin\theta }  \\
&=
- 2 \sin\theta \frac{d}{dt} \mathLabelBox{\gpgradezero{ j }}{$=0$}  \\
\end{align*}

The line element (for constant $r$) is therefore

\begin{align}\label{eqn:sphericalPolarUnit:zoo4}
\dot{\Bx}^2 
=
r^2 \left( \thetadot^2 - \left(\frac{dj}{dt}\right)^2 \sin^2 \theta \right)
\end{align}

This is essentially the same result as we got starting with an explicit $r, \theta, \phi$.  Repeating for comparision that was

\begin{align}\label{eqn:sphericalPolarUnit:zoo5}
\dot{\Bx}^2 = r^2 \left( \thetadot^2 + \sin^2\theta \phidot^2 \right)
\end{align}

The bivector that we have used this time encodes the orientation of the plane of rotation from the polar axis down to the position on the sphere corresponds to the angle $\phi$ in the 
scalar parameterization.  The negation in sign is expected due to the negative bivector square.

Also comparing to previous results it is notable that we can explicitly express this bivector in terms of the scalar angle if desired as

\begin{align}\label{eqn:sphericalPolarUnit:zoo6}
\Brho &= \Be_1 e^{\Be_1 \Be_2 \phi} = \Be_1 \cos\phi + \Be_2 \sin\phi \\
j &= \Be_3 \wedge \Brho = \Be_3 \Brho
\end{align}

The inverse mapping, expressing the scalar angle using the bivector representation is also possible, but not unique.  The principle angle for that inverse mapping is

\begin{align}\label{eqn:sphericalPolarUnit:zoo7}
\phi &= -\Be_1 \Be_2 \ln(\Be_1 \Be_3 j) 
\end{align}

\subsection{Allowing the magnitude to vary}

Writing a vector in polar form

\begin{align}\label{eqn:sphericalPolarUnit:xoo1}
\Bx = r \rcap
\end{align}

and also allowing $r$ to vary, we have

\begin{align*}
\left(\frac{d\Bx}{dt}\right)^2 
&= \left( \frac{dr}{dt} \rcap + r \frac{d\rcap}{dt} \right)^2 \\
&= 
\left( \frac{dr}{dt} \right)^2 + r^2 \left( \frac{d\rcap}{dt} \right)^2 
+ 2 r \frac{dr}{dt} \rcap \cdot \frac{d\rcap}{dt} 
\end{align*}

The squared unit vector derivative was previously calculated to be

\begin{align}\label{eqn:sphericalPolarUnit:xoo2}
\left(\frac{d \rcap}{dt}\right)^2 = \thetadot^2 + \sin^2\theta \phidot^2 
\end{align}

Picturing the geometry is enough to know that $\dot{\rcap} \cdot \rcap = 0$ since $\dot{\rcap}$ is always tangential to the sphere.  It should also be possible to algebraically show this, but without going through the effort we at least now know the general line element

\begin{align}\label{eqn:sphericalPolarUnit:xoo3}
\dot{\Bx}^2 = {\dot{r}}^2 + r^2 \left( \thetadot^2 + \sin^2\theta \phidot^2 \right)
\end{align}

%Observe that we can also write this in matrix form tidily.  Let
%
%\begin{align}\label{eqn:sphericalPolarUnit:xoo4}
%\BTheta &\equiv
%\begin{bmatrix}
%r \\
%\theta \\
%\phi \\
%\end{bmatrix} \\
%Q &\equiv
%\begin{bmatrix} 
%1 & 0 & 0 \\
%0 & r^2 & 0 \\
%0 & 0 & r^2 \sin^2\theta \\
%\end{bmatrix} 
%\end{align}
%
%Then we have
%
%\begin{align}\label{eqn:sphericalPolarUnit:xoo5}
%\dot{\Bx}^2 = \dot{\BTheta}^\T Q \dot{\BTheta}
%\end{align}
%
%For study of the Hamiltonian equations of the double (or multiple) pendulum in a plane we were able to express the Kinetic term with such a matrix, but work only in $Q$, so it appears we can probably generalize that treatment to the non-planar case without too much trouble.

%\EndArticle
%%\EndNoBibArticle
