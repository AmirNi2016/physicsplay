\documentclass{article}

\input{../peeters_macros.tex}
\input{../peeters_macros2.tex}

\newcommand{\PDSq}[2]{\frac{\partial^2 {#2}}{\partial {#1}^2}}
\DeclareMathOperator{\sinc}{sinc}
\DeclareMathOperator{\PV}{PV}
\newcommand{\FF}[0]{\mathcal{F}}
\newcommand{\IIinf}[0]{ \int_{-\infty}^\infty }

\usepackage[bookmarks=true]{hyperref}

\usepackage{color,cite,graphicx}
   % use colour in the document, put your citations as [1-4]
   % rather than [1,2,3,4] (it looks nicer, and the extended LaTeX2e
   % graphics package. 
\usepackage{latexsym,amssymb,epsf} % don't remember if these are
   % needed, but their inclusion can't do any damage


\title{ Derivation of the Poisson Green's function from the Fourier kernel. }
\author{Peeter Joot}
\date{ Feb 18, 2009.  Last Revision: $Date: 2009/02/20 20:03:48 $ }

\begin{document}

\maketitle{}
\tableofcontents

\section{ Motivation.}

Having recently attempted a number of Fourier solutions to the Heat, Schr\"{o}dinger, Maxwell vacuum, and inhomogeneous Maxwell equation, a reading
of \cite{mjPerryElectrodynamics} inspired me to have another go.  In particular, he writes the Poisson equation solution explicitly in terms of a Green's 
function.

The Green's function for the Poisson equation

\begin{align}
G(\mathbf{x} - \Bx') = \frac{1}{4\pi\lvert{\mathbf{x} -\Bx'}\rvert}
\end{align}

isn't really derived, rather is just pointed out.  However, it is a nice closed form that doesn't have any integrals.
Contrast this to the Fourier transform method, where one ends up with a messy threefold 
integral that isn't particularily obvious how to integrate.

In the PF thread \href{http://www.physicsforums.com/showthread.php?t=293550}{Fourier transform solution to electrostatics Poisson equation?}
I asked if anybody knew how to reduce this integral to the
potential kernel of electrostatics.  Before getting any answer from PF I found it in 
\cite{byron1992mca}, a book recently purchased, but not yet read.


Go through this calculation here myself in full detail to get more comfort with the ideas.  Some of these ideas can probably also be applied to 
previous incomplete Fourier solution attempts.  In particular, the retarded time potential solutions likely follow.
Can these same ideas be applied to the STA form of the Maxwell equation, explicitly inverting it, as 
\cite{doran2003gap} indicate is possible (but do not spell out).

\section{ Poisson equation. }
\subsection{ Setup. }

As often illustrated with the Heat equation, we seek a Fourier transform solution of the electrostatics Poisson equation

\begin{align}
\nabla^2 \phi &= -\rho/\epsilon_0
\end{align}

Our 3D Fourier transform pairs are defined as
\begin{align*}
\hat{f}(\mathbf{k}) &= \frac{1}{(\sqrt{2\pi})^3} \iiint f(\mathbf{x}) e^{-i \mathbf{k} \cdot \mathbf{x} } d^3 x \\
{f}(\mathbf{x}) &= \frac{1}{(\sqrt{2\pi})^3} \iiint \hat{f}(\mathbf{k}) e^{i \mathbf{k} \cdot \mathbf{x} } d^3 k \\
\end{align*}

Applying the transform we get

\begin{align}\label{eqn:poissonSolution}
\phi(\mathbf{x}) &= \frac{1}{\epsilon_0} \iiint \rho(\mathbf{x}') G(\mathbf{x-x'}) d^3 x' \\
G(\mathbf{x}) &= \frac{1}{(2 \pi)^3} \iiint \frac{1}{\mathbf{k}^2} e^{ i \mathbf{k} \cdot \mathbf{x} } d^3 k
\end{align}

Now it seems to me that this integral $G$ only has to be evaluated around a small neighbourhood of the origin.  For example if one evaluates one of
the
integrals  
\begin{align*}
\int_{-\infty}^\infty \frac{1}{{k_1}^2 + {k_2}^2 + {k_3}^3 } e^{ i k_1 x_1 } dk_1 
\end{align*}

using a an upper half plane contour the result is zero unless $k_2 = k_3 = 0$.  So one is left with something loosely like

\begin{align*}
G(\mathbf{x}) &= \lim_{\epsilon \rightarrow 0} \frac{1}{(2 \pi)^3} 
\int_{k_1 = -\epsilon}^{\epsilon} dk_1
\int_{k_2 = -\epsilon}^{\epsilon} dk_2
\int_{k_3 = -\epsilon}^{\epsilon} dk_3
 \frac{1}{\mathbf{k}^2} e^{ i \mathbf{k} \cdot \mathbf{x} } 
\end{align*}

How to reduce this?  Somehow it must be possible to take this Fourier convolution kernel and somehow evaluate the integral to produce the 
electrostatics potential.

\subsection{ Evaluating the convolution kernel integral. }

The answer of how to do so, as pointed out above, was found in
\cite{byron1992mca}.  Instead of trying to evaluate this integral which has a pole at the origin, they cleverly evaluate a variant of it

\begin{align*}
I = \iiint \frac{1}{\mathbf{k}^2 + a^2} e^{ i \mathbf{k} \cdot \mathbf{x} } d^3 k
\end{align*}

which splits and shifts the repeated pole into two first order poles away from the origin.
After a change to spherical polar coordinates, the new integral can be evaluated, and the Poisson Green's function in potential form follows by
letting $a$ tend to zero.

Very cool.  It seems worthwhile to go through the motions of this myself, omitting no details I would find valuable.

First we want the volume element in spherical polar form, and our vector.  That is

\begin{align*}
\rho &= k \cos\phi \\
dA &= (\rho d\theta)(k d\phi) \\
d^3 k &= dk dA = k^2 \cos\phi d\theta d\phi dk \\
\Bk 
&= (\rho \cos\theta, \rho \sin\theta, k \sin\theta) \\
&= k (\cos\phi \cos\theta, \cos\phi \sin\theta, \sin\phi) \\
\end{align*}

FIXME: scan picture to show angle conventions picked.

This produces
\begin{align*}
I = \int_{\theta=0}^{2\pi} \int_{\phi=-\pi/2}^{\pi/2} \int_{k=0}^\infty \frac{1}{k^2 + a^2} \exp\left( i k (\cos\phi \cos\theta x_1 + \cos\phi \sin\theta + x_2 + \sin\phi x_3) \right) 
k^2 \cos\phi d\theta d\phi dk \\
\end{align*}

Now, this is a lot less tractable than the Byron/Fuller treatment.  In particular they were able to make a $t = \cos\phi$ substitution, and if I try this I get

\begin{align*}
I = -\int_{\theta=0}^{2\pi} \int_{t=-1}^{1} \int_{k=0}^\infty \frac{1}{k^2 + a^2} \exp\left( i k (t \cos\theta x_1 + t \sin\theta x_2 + \sqrt{1-t^2} x_3) \right) 
k^2 dt d\theta dk \\
\end{align*}

Now, this is still a whole lot different, and in particular it has $ik (t\sin\theta x_2 + \sqrt{1-t^2} x_3)$ in the exponential.  I puzzled over this for a while, but it becomes clear on writing.  Freedom to orient the axis along a preferable direction has been used, and some basis for which $\Bx = x_j \Be^j + = x \Be^1$ has been used!  We are now left with

\begin{align*}
I 
&= -\int_{\theta=0}^{2\pi} \int_{t=-1}^{1} \int_{k=0}^\infty \frac{1}{k^2 + a^2} \exp\left( i k t \cos\theta x \right) k^2 dt d\theta dk \\
&= -\int_{\theta=0}^{2\pi} \int_{k=0}^\infty \frac{2}{(k^2 + a^2) \cos\theta} \sin\left( k t \cos\theta x \right) k d\theta dk \\
&= -\int_{\theta=0}^{2\pi} \int_{k=-\infty}^\infty \frac{1}{(k^2 + a^2) \cos\theta} \sin\left( k t \cos\theta x \right) k d\theta dk \\
\end{align*}

Here the fact that our integral kernel is even in $k$ has been used to double the range and half the kernel.

However, looking at this, one can see that there is trouble.  In particular, we have $\cos\theta$ in the denominator, with a range that allows zeros.  How did the text avoid this trouble?

\subsection{ Take II. }

After mulling it over for a bit, it appears that aligning $\Bx$ with the x-axis is causing the trouble.  Aligning
with the 
z-axis will work out much better, and leave only one trig term in the exponential.  Essentially we need to 
use a volume of rotation about the z-axis, integrating along all sets of constant $\Bk \cdot \Bx$.
This is a set of integrals over concentric ring volume elements (FIXME: picture).

Our volume element, measuring $\theta \in [0, \pi]$ from the z-axis, and $\phi$ as our position on the ring

\begin{align*}
\Bk \cdot \Bx &= k x \cos\theta \\
\rho &= k \sin\theta \\
dA &= (\rho d\phi)(k d\theta) \\
d^3 k &= dk dA = k^2 \sin\theta d\theta d\phi dk \\
\end{align*}

This gives us 

\begin{align*}
I &= \int_{\theta=0}^{\pi} \int_{\phi=0}^{2\pi} \int_{k=0}^\infty \frac{1}{k^2 + a^2} \exp\left( i k x \cos\theta \right) 
k^2 \sin\theta d\theta d\phi dk \\
\end{align*}

Now we can integrate immediately over $\phi$, and make a $t = \cos\theta$ substitution ($dt = -\sin\theta d\theta$)

\begin{align*}
I 
&= - 2\pi \int_{t=1}^{-1} \int_{k=0}^\infty \frac{1}{k^2 + a^2} \exp\left( i k x t \right) k^2 dt dk \\
&= - \frac{2\pi}{ix} \int_{k=0}^\infty \frac{1}{k^2 + a^2} 
\left( 
e^{-i k x } -e^{i k x } 
\right) 
k dk \\
&= \frac{2\pi}{ix} \int_{k=0}^\infty \frac{1}{k^2 + a^2} 
e^{i k x } 
k dk 
- \frac{2\pi}{ix} \int_{k=-0}^{-\infty} \frac{1}{k^2 + a^2} 
e^{i k x } 
(-k) (-dk) \\
&= \frac{2\pi}{ix} \int_{k=-\infty}^\infty \frac{1}{k^2 + a^2} e^{i k x } k dk \\
&= \frac{2\pi}{ix} \int_{k=-\infty}^\infty \inv{k - ia} \frac{ k e^{ i k x } }{(k + ia)} dk \\
\end{align*}

Now we have something that's in form for contour integration.  In the upper half plane we have a pole at $k= ia$.  Assuming that the
integral over the big semicircular arc vanishes, we can just pick up the residue at that pole contributing.  The assumption that
this vanishes is actually non-trivial looking since the $k/(k+ia)$ term at a big radius $R$ tends to $1$.  This is probably where 
Jordan's lemma comes in, so some study to understand that looks well justified.

\begin{align*}
0 
&= I - 2 \pi i {\left. \frac{2\pi}{ix} \frac{ k e^{ i k x } }{(k + ia)} \right\vert}_{k= ia} \\
&= I - 2 \pi i \frac{2\pi}{ix} \frac{ e^{ - a x } }{2} \\
\end{align*}

So we have
\begin{align*}
I = \frac{2 \pi^2}{x} e^{ - a x } 
\end{align*}

Now that we have this, the Green's function of \ref{eqn:poissonSolution} is

\begin{align*}
G(\mathbf{x}) 
&= \lim_{a \rightarrow 0} \inv{(2\pi)^3} \frac{2 \pi^2}{x} e^{ - a x } \\
&= \inv{4\pi\Abs{\Bx}}
\end{align*}

Which gives
\begin{align*}
\phi(\Bx) &= \inv{4\pi \epsilon_0} \int \frac{\rho(\Bx')}{\Abs{\Bx - \Bx'}} dV'
\end{align*}

Awesome!  All following from the choice to set $\BE = -\spacegrad \phi$, we have a solution for $\phi$ following directly
from the divergence equation $\spacegrad \cdot \BE = \rho/\epsilon_0$ via Fourier transformation of this equation.

\section{ Retarded time potentials? }

If we look at the general inhomogeneous Maxwell equation

\begin{align}
\grad F = J/\epsilon_0 c
\end{align}

In terms of potential $F = \grad \wedge A$ and employing in the Lorentz gauge $\grad \cdot A = 0$, we have

\begin{align}
\grad^2 A = \left(\inv{c^2} \partial_{tt} - \sum \partial_{jj}\right) A = J/\epsilon_0 c
\end{align}

As scalar equations with $A = A^\mu \gamma_\mu$, $J = J^\nu \gamma_\nu$ we have four equations all of the same form.

A Green's function form for such wave equations was previously calculated in \cite{PJfourierMaxwellSecondOrder}.  That was

\begin{align}
\left( \inv{v^2} \PDSq{t}{} -\sum_j \PDSq{x^j}{} \right)\psi &= \rho \\
\end{align}

\begin{align}
{\psi}(\Bx, t) &= \IIinf \rho(\Bx', t') G(\Bx - \Bx', t - t') d^3 x' dt' \\
G(\Bx, t) &= u(t) \IIinf \frac{v}{(2\pi)^3 \Abs{\Bk}} \sin( \Abs{\Bk} v t ) \exp\left( i \Bk \cdot \Bx \right) d^3 k
\end{align}

Here $u(t)$ is the unit step function, which meant we only sum the time contributions of the charge density for $t - t' > 0$, or $t' < t$.  That's the causal variant of the solution, which was arbitrary mathematically ($t > t'$ would have also worked).

\bibliographystyle{plainnat}
\bibliography{myrefs}

\end{document}
