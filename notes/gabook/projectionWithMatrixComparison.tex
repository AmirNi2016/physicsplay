\documentclass{article}      % Specifies the document class


\input{../peeters_macros.tex}
%\DeclareMathOperator{\Transpose}{T}
\DeclareMathOperator{\rank}{rank}
%\newcommand{\transpose}[1]{{{#1}^{\TextTranspose}}}
%\newcommand{\transpose}[1]{{{#1}^{\text{T}}}}
\newcommand{\T}[0]{\text{T}}
\newcommand{\BOmega}[0]{\boldsymbol{\Omega}}

\newcommand{\Det}[1] {\abs{#1}}

\usepackage{color,cite,graphicx}
   % use colour in the document, put your citations as [1-4]
   % rather than [1,2,3,4] (it looks nicer, and the extended LaTeX2e
   % graphics package. 
\usepackage{latexsym,amssymb,epsf} % don't remember if these are
   % needed, but their inclusion can't do any damage


%
% The real thing:
%

                             % The preamble begins here.
\title{ Matrix review. } % Declares the document's title.
\author{Peeter Joot}         % Declares the author's name.
\date{ April 11, 2008 }        % Deleting this command produces today's date.

\begin{document}             % End of preamble and beginning of text.

\maketitle{}


\section{ Motivation. }


My initial intention for these notes was to 

get a feel for the similarities and differences between GA and matrix approaches to solution of projection.  Attempting to
write up that comparison
I found gaps in my understanding of the matrix algebra.  In particular the topic of projection as well as the related
ideas of pseudoinverses and SVD were not adequately covered in my university courses, nor my texts from those courses.
Here is my attempt to write up what I understand of these subjects and explore the gaps in my knowledge.

Particularily helpful was 
Gilbert Strang's excellent MIT lecture on subspace projection (available on the MIT opencourse website).
Much of the notes below are probably detailed in his course textbook, which I don't have.  However, 
if I can't explain the ideas to myself, or write them up in a way that I feel would explain
to others, then I obviously don't understand them sufficiently.


\section{ Subspace projection in matrix notation. }


\subsection{ Projection onto line. }


\begin{figure}[htp]

\centering
\includegraphics[totalheight=0.4\textheight]{Projection_line}
\caption{Projection onto line.}\label{fig:Projection_line}
\end{figure}

The simplest sort of projection to compute is projection onto a line.  Given a direction vector $b$, and a line with direction vector $u$
as in figure \ref{fig:Projection_line}.

The projection onto $u$ is some value:

\[
p = \alpha u
\]

and we can write

\[
b = p + e
\]

where e is the component perpendicular to the line $u$.

Expressed in terms of the dot product this relationship is described by:

\[
(b - p) \cdot a = 0
\]

Or, 

\[
b \cdot a = \alpha a \cdot a
\]

and solving for $\alpha$ and substituting we have:

\begin{equation}
p = a \frac{a \cdot b}{a \cdot a}
\end{equation}

In matrix notation that is:

\begin{equation}
p = a \left(\frac{a^\T b}{a^\T a} \right)
\end{equation}

Following Gilbert Strang's MIT lecture on subspace projection, the parenthesis can be moved to directly express this as a projection matrix operating on b.

\begin{equation}\label{eqn:projectmatrixline}
p = \left(\frac{a a^\T}{a^\T a}\right) b = P b
\end{equation}


\subsection{ Projection onto plane (or subspace). }



\begin{figure}[htp]
\centering
\includegraphics[totalheight=0.4\textheight]{Projection_plane}
\caption{Projection onto plane.}\label{fig:Projection_plane}
\end{figure}

Calculation of the projection matrix to project onto a plane is similar.  The variables to solve for are $p$, and $e$ in as
figure \ref{fig:Projection_plane}.

For projection onto a plane (or hyperplane) the idea is the same, splitting the vector into a component in the plane and an perpendicular component.
Since the
idea is the same for any dimensional subspace, explicit specification of the summation range is omitted here so the result is good for higher dimensional
subspaces as well as the plane:

\[
b - p = e
\]
\[
p = \sum \alpha_i u_i
\]

however, we get a set of equations, one for each direction vector in the plane

\[
(b - p) \cdot u_i = 0
\]

Expanding $p$ explicitly and rearranging we have the following set of equations:

\[
b \cdot u_i = (\sum_s \alpha_s u_s) \cdot u_i
\]

putting this in matrix form

\begin{align*}
[b \cdot u_i]_i 
&= 
{
\begin{bmatrix}
(\sum_s \alpha u_s) \cdot u_i
\end{bmatrix}
}_i \\
\end{align*}

Writing $U = 
\begin{bmatrix}
u_1 & u_2 & \cdots 
\end{bmatrix}$
\begin{align*}
\begin{bmatrix}
u_1^\T \\
u_2^\T \\
\vdots 
\end{bmatrix}
b
&= 
\begin{bmatrix}
(\sum_s \alpha_s u_s) \cdot u_i
\end{bmatrix} \\
&= 
{
\begin{bmatrix}
u_i \cdot u_j
\end{bmatrix}
}_{ij}
\begin{bmatrix}
\alpha_1 \\
\alpha_2 \\
\vdots \\
\end{bmatrix} \\
\end{align*}

Solving for the vector of unknown coefficients $\alpha = [\alpha_i]_i$ we have

\[
\alpha
=
{{
\begin{bmatrix}
u_i \cdot u_j
\end{bmatrix}
}_{ij}}^{-1}
U^\T b
\]

And 

\begin{equation}
p = U \alpha = U
{{
\begin{bmatrix}
u_i \cdot u_j

\end{bmatrix}
}_{ij}}^{-1}
U^\T b
\end{equation}

However, this matrix in the middle is just $U^\T U$:

\begin{align*}
\begin{bmatrix}
u_1^\T \\
u_2^\T \\
\vdots \\
\end{bmatrix}
\begin{bmatrix}
{u_1} & {u_2} & \hdots \\
\end{bmatrix}
&=
\begin{bmatrix}
u_1^\T {u_1} & u_1^\T {u_2} & \hdots \\
u_2^\T {u_1} & u_2^\T {u_2} & \hdots \\
\vdots & & \\
\end{bmatrix} \\
&=
{
\begin{bmatrix}
u_i^\T {u_j}
\end{bmatrix}
}_{ij} \\
&=
{
\begin{bmatrix}
{u_i} \cdot {u_j}
\end{bmatrix}
}_{ij} \\
\end{align*}

This provides the final result:

\begin{equation}\label{eqn:projectiongeneralmatrix}
\Proj_{U}\left(b\right) = U (U^\T U)^{-1} U^\T b
\end{equation}

\subsection{ Simplifying case.  Orthonormal basis for column space. }

To evaluate equation \ref{eqn:projectiongeneralmatrix} we need only full column rank for $U$, but this will be messy in general due to the matrix inversion required for the center product.  That can be avoided by picking an orthonormal basis for the vector space that we are projecting on.  With an orthonormal column basis that 
central product term to invert is:

\[
U^\T U = [ u_i^\T u_j ]_{ij} = [ \delta_{ij} ]_{ij} = I_{r,r}
\]

Therefore, the projection matrix can be expressed using the two exterior terms alone:

\begin{equation}\label{eqn:projOrthonormal}
\Proj_U = U (U^\T U)^{-1} U^\T = U U^\T
\end{equation}

\subsection{ Numerical expansion of left pseudoscalar matrix with matrix.}

Numerically expanding the projection matrix $A (A^\T A)^{-1}A^\T$ isn't something
that we want to do, but the simpler projection matrix of equation
\ref{eqn:projOrthonormal} that we get with an orthonormal basis makes this not so daunting.

Let's do this to get a feel for things.

\subsubsection{ \R{4} plane projection example. }

Take a simple projection onto the plane spanned by the following two orthonormal vectors

\[
u_1 = 
\frac{\sqrt{2}}{4}
\begin{bmatrix}
1 \\
2 \\
\sqrt{3} \\
0 \\
\end{bmatrix}
\]

\[
u_2 = 
\frac{\sqrt{2}}{4}
\begin{bmatrix}
-\sqrt{3} \\
0 \\
1 \\
2 \\
\end{bmatrix}
\]

Thus the projection matrix is:

\[
P =
\begin{bmatrix}
u_1 & u_2 \\
\end{bmatrix}
\begin{bmatrix}
u_1^\T \\
u_2^\T \\
\end{bmatrix}
=
\inv{8}
\begin{bmatrix}
1 & -\sqrt{3} \\
2 & 0 \\
\sqrt{3} & 1 \\
0 & 2 \\
\end{bmatrix}
\begin{bmatrix}
1 & 2 & \sqrt{3} & 0 \\
-\sqrt{3} & 0 & 1 & 2 \\
\end{bmatrix}
\]
\[
\implies
P =
\inv{8}
\begin{bmatrix}
4 & 2 & 0 & -2\sqrt{3} \\
2 & 4 & 2\sqrt{3} & 0 \\
0 & 2\sqrt{3} & 4 & 2 \\
-2\sqrt{3} & 0 & 2 & 4 \\
\end{bmatrix}
=
\begin{bmatrix}
1/2 & 1/4 & 0 & -\sqrt{3}/4 \\
1/4 & 1/2 & \sqrt{3}/4 & 0 \\
0 & \sqrt{3}/4 & 1/2 & 1/4 \\
-\sqrt{3}/4 & 0 & 1/4 & 1/2 \\
\end{bmatrix}
\]

What can be said about this just by looking at the matrix itself?

\begin{enumerate}
\item
One can verify by inspection that $P u_1 = u_1$ and $P u_2 = u_2$.  This is what we expected
so this validates all the math performed so far.  Good!

%, so this
%is has at least one of the expected properties of a projection matrix.
%We also expect that $P x = 0$ for any $x \in N(V^\T)$, so if
%it has that property too we can call it the projection matrix for the subspace
%spanned by $u_1$, and $u_2$.  We also assume that this is the projection
%matrix for $A$ (we haven't yet shown any explicit
%relationship between this first
%$r$ column vectors in the matrix $V$ and the original matrix $A$).

\item
It is symmetric.  Analytically, we know to expect this, since for a 
a full column rank matrix $A$ the transpose of the projection matrix is:

\[
P^\T = {\left(A \inv{A^\T A} A^\T \right)}^\T = P.
\]

\item
In this particular case columns 2,4 and columns 1,3 are each pairs of
perpendicular vectors.  Is something like this to be expected in general for
projection matrices?

\item
We expect this to be a rank two matrix, so the null space has dimension two.  This can be verified.

\end{enumerate}

\subsection{ Return to analytic treatment. }

Let's look at the matrix for projection onto an orthonormal basis in a bit more detail.  This simpler form allows for
some observations that are a bit harder in the general form.

Suppose we have a vector $n$ that is perpendicular to all the orthonormal vectors $u_i$ that span the subspace.  We can then write:

\[
u_i \cdot n = 0
\]

Or,
\[
u_i^\T n = 0
\]

In block matrix form for all $u_i$ that is:

\[
[u_i^\T n]_i = [u_i^\T]_i n = U^\T n = 0
\]

This is all we need to verify that our projection matrix indeed produces a zero for any vector completely outside of the subspace:

\[
\Proj_U(n) = U (U^\T n) = U 0 = 0
\]

Now we have seen numerically that $U U^\T$ is not an identity matrix despite 
operating as one on any vector that lies completely in the subspace.
%Although this matrix may 
%have blocks of identity matrixes along the diagonal in some cases.

Having seen the action of this matrix on vectors in the null space, we can now
directly examine the action of this matrix on any vector that lies in the
span of the set $\{u_i\}$.  By linearity it is sufficient to do this calcuation 
for a particular $u_i$:

\begin{align*}
U U^\T u_i
&=
U
\begin{bmatrix}
u_1^\T u_i \\
u_2^\T u_i \\
\vdots \\
u_r^\T u_i \\
\end{bmatrix}
\\
&=
\begin{bmatrix}
{u_1} & {u_2} & \cdots & {u_r} \\
\end{bmatrix}
{
\begin{bmatrix}
\delta_{si}
\end{bmatrix}
}_s \\
&= \sum_{k=1}^{r} u_k \delta_{ki} \\
&= u_i \\
\end{align*}

This now completes the validation of the properties of this matrix (in it's simpler form with an orthonormal basis for the subspace).

\section{ Matrix projection vs. Geometric Algebra. }

I found it pretty interesting how similar the projection product is to the projection matrix above from traditional matrix algebra.  It is worthwhile
to write this out and point out the similarities and differences.

\subsection{ General projection matrix. }

We've shown above, provided a matrix A is of full column rank, a projection onto it's columns can be written:

\[
\Proj_A(x) = \left( A \frac{1}{A^\T A} A^\T \right) x
\]

Now contrast this with the projection written in terms of a vector dot product with a non-null blade 

\[
\Proj_A(x) = A \left(\inv{A} \cdot x\right) = A \inv{A^\dagger A} \left(A^\dagger \cdot x\right)
\]

This is a curious correspondence and niave comparison could lead one to think that perhaps there the concepts of matrix
transposition and blade reversal are equivalent.

This isn't actually the case since the matrix transposition actually corresponds to
the adjoint operation of a linear transformation for blades.  Be that as it may, there appears to be other situations
other than projections where matrix operations of the form $A^\T A$ end up with GA equivalents in the form $A^\dagger A$.  Another example
is the rigid body equations where the body anglular velocity bivector corresponding to a rotor $R$ is of the form $\BOmega = R' R^\dagger$, whereas the matrix
form for a rotation matrix $R$ is of the form $\BOmega = R' R^\dagger$.

\subsection{ Projection matrix full column rank requirement. }

The projection matrix derivations above required full column rank.  A reformulation in terms
of a generalized matrix (Moore-Penrose) inverse, or SVD can eliminate this full column rank requirement for
the formulation of the projection matrix.

We will get to this later, but we never really proved that
full column rank implies $A^\T A$ invertability.

If one writes out the matrix $A^\T A$ in full

Now, if $A = [a_i]_i$, the matrix

\begin{equation}\label{eqn:AtA}
A^\T A
=
\begin{bmatrix}
{a_1} \cdot {a_1} & {a_1} \cdot {a_2} & \hdots \\
{a_2} \cdot {a_1} & {a_2} \cdot {a_2} & \hdots \\
\vdots & & \\
\end{bmatrix}.
\end{equation}

This is an invertible matrix provided $\{a_i\}_i$ is a linearly independent set of vectors.
For full column rank to imply invertability, it would be sufficient to prove that the 
determinant of this matrix was non-zero.

I'm not sure how to show that this is true with just matrix algebra, however
one can identify the determinant of the matrix of equation \ref{eqn:AtA}, after an adjustment
of sign for reversion, as the GA dot product of a k-blade:

\begin{equation}\label{eqn:AdagdotA}
(-1)^{k(k-1)/2} (a_1 \wedge \cdots \wedge a_k) \cdot (a_1 \wedge \cdots \wedge a_k).
\end{equation}

Linear independence means that this wedge product is non-zero, and therefore the dot product, and thus original determinant is also non-zero.

When the $A^\T A$ matrix of equation \ref{eqn:AtA} is invertable that inverse can be written using a cofactor matrix (adjugate expansion):

Let's write this out, where $C_{ij}$ are the cofactor matrixes of $A^\T A$, we have:

\[
\inv{A^\T A} = \inv{ \Det{ A^\T A } } {[ C_{ij} ]}^\T
\]

Observe that the denominator here is exactly the determinant of equation \ref{eqn:AdagdotA}.  This illustrates
the motivation of Hestenes to lable the explicit alternating vector-vector dot product expansion of a 
blade-vector dot product the ``generalized Laplace expansion''.

%  This allows us to give additional meaning to the
%$\inv{A^\T A}A^\T$ factor of the general projection matrix.
%  Operationally this appears to 
%provide a way to compute the dot product of a
%blade with vector (just scaled by the determinant and by the sign of the reversion).

\subsection{ Projection onto orthonormal columns. }

When the 
columns of the matrix $A$ are orthonormal, the projection matrix is reduced to:

\[
\Proj_A(x) = \left( A A^\T \right) x.
\]

The corresponding GA entity is a projection onto a unit magnitude blade.  With that scaling the inverse term also drops out leaving:

\[
\Proj_A(x) = A \left(A^\dagger \cdot x\right)
\]

This helps point out the similarity between the matrix inverse $\inv{A^\T A}$ and the blade product inverse $\inv{{A^\dagger}A}$ is only on the surface,
since this blade product is only a scalar.






\section{ Projection with generalized dot product. }

\section{ Oblique projection and reciprocal frame vectors. }




















%\begin{figure}[htp]
%\centering
%\includegraphics[totalheight=0.4\textheight]{visualize_subspace_projection}
%\caption{Visualizing projection onto a subspace.}\label{fig:Projection_subspace}
%\end{figure}
%
%We can geometrically visualize the projection problem 
%
%as in figure \ref{fig:Projection_subspace}.  Here
%the subspace can be pictured
%as a plane containing a set of mutually perpendicular basis vectors, as if
%one has visually projected all the higher dimensional vectors onto a plane.
%
%For a vector $x$ that contains some part not in the space we want to find
%the component in the space $p$, or characterize the projection operation
%that produces this vector, and also find the space of vectors that lie
%perpendicular to the space.




%This is why we say that $n$ is in the null space of $U^\T$,
%$N(U^\T)$ not $N(U)$.  One perhaps could say this is in the null
%or perpendicular space of the set $\{u_i\}$, but our use of columns as
%vectors coupled with the Euclianian norm requires transposition to express
%the same null space concept for a matrix of column vectors.
%
%Since $U^\T n = 0$ for any $n \in N(U)$ we also have


















%\subsection{ Application of projection as left pseudoinverse (ie: linear fitting). }
%
%%We have shown that the left pseudoinverse product with the matrix can
%%be expressed as a projection matrix (sum of the projection matrices
%%associated with a set of orthonormal vectors)
%
%%\begin{equation}\label{eqn:pseudoprojmatsum}
%%A^{+} A =
%%\sum_{k=1}^r {u_k}u_k^\T
%%\end{equation}
%%
%
%%(note this is a different ``$V$'' than the $V$ in $A = U \Sigma V^\T$ since it only includes the first $r$ columns).
%%This allows us to write the matrix of equation \ref{eqn:pseudoprojmatsum} as
%
%%\begin{equation}
%%A^{+} A = V V^\T
%%\end{equation}
%
%
%Equation \ref{eqn:projectiongeneralmatrix} provides us a way to find best solutions to general equations of the form:
%
%
%\[
%A x = b
%\]
%
%Here $A$ is the matrix of a linear transformation, $A : \mathbb{R}^k \rightarrow \mathbb{R}^n$, for some $k<n$.
%By ``best solutions'' here, we give this the geometrical meaning, namely, the solution matching the projection of $b$ onto the space.
%
%If b is not completely in the column space $C(A)$ of $A$, this can have no solution.  However, writing
%
%\[
%b = \Proj_A(b) + b_\perp
%\]
%
%as the components of $b$ in $C(A)$ and not in $C(A)$ respectively we can at least solve the reduced equation for $\hat{x}$:
%
%
%\begin{equation}\label{eqn:reducedinverseproblem}
%A \hat{x} = \Proj_A(b)
%\end{equation}
%
%
%This will be possible even in circumstances that the original equation had no solution.  Specifically, the vector b when projected onto the plane can be expressed as some
%linear combination of the columns of $A$ (a basis for the subspace).
%
%Substuition of our projection result into equation \ref{eqn:reducedinverseproblem} yields:
%
%\begin{align*}
%A \hat{x} 
%&= \Proj_{A}\left(b\right) = A (A^\T A)^{-1} A^\T b
%\end{align*}
%
%The simplest case here is when $A$ is of full column rank since one can pre-multiply this complete equation by $A^\T$ without any possibility of nulling
%$A \hat{x}$.
%
%\begin{align*}
%A^\T A \hat{x} 
%&= A^\T A (A^\T A)^{-1} A^\T b \\
%&= A^\T b \\
%\end{align*}
%
%Thus our best fit vector is
%
%\begin{equation}
%\hat{x} 
%= (A^\T A)^{-1} A^\T b
%\end{equation}
%
%Another way to view this is for any vector $x$ that is not in the null space $N(A)$, then the matrix:
%
%\begin{equation}
%A^{+}= (A^\T A)^{-1} A^\T
%\end{equation}
%
%has the action of a left inverse for any full column rank matrix $A$.  Thus when there is a solution to:
%
%\begin{equation}
%A x = b.
%\end{equation}
%
%It can be obtained by pre-multiplication using this "left" inverse.
%
%\begin{equation}
%A^{+} A x = x = A^{+} b
%\end{equation}
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%\section{ SVD connection. }
%
%
%SVT decomposition is an factoring of $A \in M^{m \times n}$ with orthonormal matrices $U \in M^{m \times m}$
%
%and $V \in M^{n \times n} $ producing the following form:
%
%\[
%A = U \Sigma V^\T
%\]
%
%Sigma has the form:
%
%\[
%\Sigma = 
%\begin{bmatrix}
%D_{r,r} & 0_{r,n-r} \\
%0_{m-r,r} & 0_{m-r,n-r} \\
%\end{bmatrix}
%\]
%
%where $r = \rank(A)$, and $D$ is a diagonal matrix with the root of the (positive) eigenvalues of $A^\T A$.
%
%This provides a generalized spectral decomposition and similarity that applies to both non-square matrices and matrices not otherwise diagonalizable
%(ie: square matrix with similarity to a Jordon form matrix).  Given this decomposition we can write:
%
%\[
%\Sigma = U^\T A V
%\]
%
%If one were to ask the question of what is the closest that one could get to inverting such a matrix.  It's pretty clear that the closest one could get to
%identity will be with multiplication of a $\Sigma^{+}$ of the following form:
%
%\[
%\Sigma^{+} \Sigma
%=
%\begin{bmatrix}
%(D_{r,r})^{-1} & 0_{r,m-r} \\
%0_{n-r,r} & 0_{n-r,m-r} \\
%\end{bmatrix}
%\begin{bmatrix}
%D_{r,r} & 0_{r,n-r} \\
%0_{m-r,r} & 0_{m-r,n-r} \\
%\end{bmatrix}
%=
%\begin{bmatrix}
%I_{r,r} & 0_{r,n-r} \\
%0_{n-r,r} & 0_{n-r,n-r} \\
%\end{bmatrix}
%\]
%
%For a right pseudoinverse we have a similar result:
%
%\[
%\Sigma
%\Sigma^{+}
%=
%\begin{bmatrix}
%D_{r,r} & 0_{r,n-r} \\
%0_{m-r,r} & 0_{m-r,n-r} \\
%\end{bmatrix}
%\begin{bmatrix}
%(D_{r,r})^{-1} & 0_{r,m-r} \\
%0_{n-r,r} & 0_{n-r,m-r} \\
%\end{bmatrix}
%=
%\begin{bmatrix}
%I_{r,r} & 0_{r,m-r} \\
%0_{m-r,r} & 0_{m-r,m-r} \\
%\end{bmatrix}
%\]
%
%With either of these one can define a corresponding pseudoinverse (left or right) as:
%
%\begin{equation}
%A^{+} = V \Sigma^{+} U^\T
%\end{equation}
%
%This is a logical definition, but how close is it to the projective
%left inverse we calculated above in the case where $A$ is not of full column 
%rank?
%
%Multiplication gives: 
%
%\begin{align*}
%A^{+} A 
%&= V \Sigma^{+} U^\T U \Sigma V^\T \\
%&= V \Sigma^{+} \Sigma V^\T \\
%&=
%\begin{bmatrix}
%v_1 & v_2 & \cdots & v_r & v_{r+1} & \cdots & v_n \\
%\end{bmatrix}
%\begin{bmatrix}
%(D_{r,r})^{-1} & 0_{r,m-r} \\
%0_{n-r,r} & 0_{n-r,m-r} \\
%\end{bmatrix}
%\begin{bmatrix}
%D_{r,r} & 0_{r,n-r} \\
%0_{m-r,r} & 0_{m-r,n-r} \\
%\end{bmatrix}
%\begin{bmatrix}
%v_1^\T \\ v_2^\T \\ \vdots \\ v_r^\T \\ {v_{r+1}}^\T \\ \vdots \\ v_n^\T \\
%\end{bmatrix}
%\end{align*}
%%Embeded in that is the same "as-close-to" identity as calculated above.
%
%Writing $D_{r,r} = [\delta_{ij}\sigma_i]_{ij}$, we have:
%
%\begin{equation}\label{eqn:VIrVt}
%V \Sigma^{+} \Sigma V^\T 
%=
%\begin{bmatrix}
%\frac{v_1}{\sigma_1} & \frac{v_2}{\sigma_2} & \cdots & \frac{v_r}{\sigma_2} & 0 & \cdots & 0 
%\end{bmatrix}
%\begin{bmatrix}
%v_1^\T \sigma_1 \\ v_2^\T \sigma_2 \\ \vdots \\ v_r^\T \sigma_r \\ 0 \\ \vdots \\ 0 \\
%\end{bmatrix}
%\end{equation}
%
%Considering this as the product of block matrices we have a product here of the form
%
%\[
%\begin{bmatrix}
%A_{n,r} & 0_{n,n-r}
%\end{bmatrix}
%\begin{bmatrix}
%B_{r,n} \\ 0_{n-r,n}
%\end{bmatrix}
%=
%\begin{bmatrix}
%A_{n,r} B_{r,n} + 0_{n,n-r} 0_{n-r,n}
%\end{bmatrix}
%=
%\begin{bmatrix}
%A_{n,r} B_{r,n} + 0_{n,n}
%\end{bmatrix}
%=
%\begin{bmatrix}
%A_{n,r} B_{r,n}
%\end{bmatrix}
%\]
%
%Thus we can strip the block zero matrices from equation \ref{eqn:VIrVt} and write
%
%\begin{equation}\label{eqn:pseudoinversetimesmatrix}
%A^{+} A =
%V \Sigma^{+} \Sigma V^\T 
%=
%\begin{bmatrix}
%\frac{v_1}{\sigma_1} & \frac{v_2}{\sigma_2} & \cdots & \frac{v_r}{\sigma_2} 
%\end{bmatrix}
%\begin{bmatrix}
%v_1^\T \sigma_1 \\ v_2^\T \sigma_2 \\ \vdots \\ v_r^\T \sigma_r 
%\end{bmatrix}
%\end{equation}
%
%Eliminating the $\sigma$ terms we have:
%
%\begin{equation}\label{eqn:pseudoinversetimesmatrixsum}
%A^{+} A =
%\begin{bmatrix}
%\sum_{k=1}^r {v_k}v_k^\T
%\end{bmatrix}
%=
%\begin{bmatrix}
%v_1 & v_2 & \cdots & v_r 
%\end{bmatrix}
%\begin{bmatrix}
%v_1^\T \\ v_2^\T \\ \vdots \\ v_r^\T 
%\end{bmatrix}
%\end{equation}
%
%We previously calculated a left inverse using the projection matrix associated with a full column rank matrix.  For this product to have the properties of a
%left acting inverse we also expect it to be a projection.
%Let's disgress
%slightly before looking at whether equation
%\ref{eqn:pseudoinversetimesmatrixsum} satisifies this expectation.
%
%
%
%\subsection{ Correlating the SVD derived projection matrix back to $A$. }
%
%
%We now have to show that this is also the projection matrix associated
%
%with the columns of the 
%original matrix that we have an SVD factorization for
%
%\[
%A = U \Sigma V^\T
%\]
%
%Once we show this, then we have also demonstrated that the first $r$ 
%(orthonormal) column vectors in the matrix $V$ of this decomposition
%are a basis for the column space of $A$ itself.  Note that we are
%switching back to the original definition of $V \in M^{n,n}$ here, and
%not the $V \in M^{n,r}$ of equation \ref{eqn:projOrthonormal}.
%
%






\section{ Proof of omitted details and auxiliary stuff. }

\subsection{ That we can remove parenthesis to form projection matrix in line projection equation. }

Remove the parenthesis in some of these expressions may not always be correct, so it is worth demonstrating that this is okay as
done to calculate the projection matrix $P$ in 
equation \ref{eqn:projectmatrixline}.
We only need to look at the numerator since the denominator is a scalar in this case.

\begin{align*}
(a a^\T) b
&= [ a_i a_j ]_{ij} [b_i]_i \\
&= 
{\begin{bmatrix}
\sum_k a_i a_k b_k
\end{bmatrix}
}_i \\
&= 
{\begin{bmatrix}
a_i \sum_k a_k b_k
\end{bmatrix}
}_i \\
&= [ a_i ]_i a^\T b \\
&= a (a^\T b) \\
\end{align*}



\subsection{ Any invertible scaling of column space basis vectors does not change the projection }


Suppose that one introduces an alternate basis for the column space


\[
v_i = \sum \alpha_{ik} u_k
\]

This can be expressed in matrix form as:

\[
V = U E
\]

or

\[
U E^{-1} = V
\]

We should expect that the projection onto the plane expressed with this alternate basis should be identical to the original.  Verification
is straightforward:

\begin{align*}
\Proj_V 
&= V \left(V^\T V\right)^{-1} V^\T \\
&= \left(U E^{-1}\right) \left({\left(U E^{-1}\right)}^\T \left(U E^{-1}\right)\right)^{-1} {\left(U E^{-1}\right)}^\T \\
&= \left(U E^{-1}\right) \left( {E^{-1}}^T U^\T U E^{-1}\right)^{-1} {\left(U E^{-1}\right)}^\T \\
&= \left(U E^{-1}\right) E \left( U^\T U\right)^{-1} E^\T {\left(U E^{-1}\right)}^\T \\
&= U \left( U^\T U\right)^{-1} E^\T {E^{-1}}^\T U^\T \\
&= U \left( U^\T U\right)^{-1} U^\T \\
&= \Proj_U
\end{align*}

\end{document}               % End of document.
