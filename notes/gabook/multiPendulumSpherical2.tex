\input{../peeter_prologue.tex}

\chapter{Spherical polar pendulum for one and multiple masses (Take II)}
\label{chap:multiPendulumSpherical2}
%\useCCL
\blogpage{http://sites.google.com/site/peeterjoot/math2009/multiPendulumSpherical2.pdf}
\date{Nov 4, 2009}
\revisionInfo{$RCSfile: multiPendulumSpherical2.tex,v $ Last $Revision: 1.12 $ $Date: 2009/11/07 18:30:04 $}

\beginArtWithToc
%\beginArtNoToc

\section{Motivation}

Attempting the multiple spherical pendulum problem with a bivector parameterized Lagrangian has just been attempted, but did not turn out to be an effective approach.  Here a variation is used, employing regular plain old scalar spherical angle parameterized Kinetic energy, but still employing Geometric Algebra to express the Hermitian quadratic form associated with this energy term.

The same set of simplifying assumptions will be made.  These are point masses, zero friction at the pivots and rigid nonspringy massless connecting rods between the masses.

\section{The Lagrangian.}

A two particle spherical pendulum is depicted in figure (\ref{fig:sPolarMultiPendulum:pendulumDouble})

\begin{figure}[htp]
\centering
\includegraphics[totalheight=0.4\textheight]{pendulumDouble}
\caption{Double spherical pendulum.}\label{fig:sPolarMultiPendulum:pendulumDouble}
\end{figure}

The position vector for each particle can be expressed relative to the mass it is connected to (or the origin for the first particle), as in

\begin{align}\label{eqn:multiPendulumSpherical2:boo1}
z_k &= z_{k-1} + \Be_3 l_k e^{j_k \theta_k} \\
j_k &= \Be_3 \wedge \left( \Be_1 e^{i \phi_k} \right) \\
i &= \Be_1 \wedge \Be_2
\end{align}

To express the Kinetic energy for any of the masses $m_k$, we need the derivative of the incremental difference in position

\begin{align*}
\frac{d}{dt} \left( \Be_3 e^{j_k \theta_k} \right)
&=
\Be_3 \left( j_k \dot{\theta}_k e^{j_k \theta_k} + \frac{d j_k }{dt} \sin\theta_k \right)  \\
&=
\Be_3 \left( j_k \dot{\theta}_k e^{j_k \theta_k} + \Be_3 \Be_2 \dot{\phi}_k e^{i \phi_k} \sin\theta_k \right)  \\
&=
\left( \frac{d}{dt}
\begin{bmatrix}
\theta_k & \phi_k
\end{bmatrix} \right)
\begin{bmatrix}
\Be_1 e^{i \phi_k} e^{j_k \theta_k} \\
\Be_2 e^{i \phi_k} \sin\theta_k
\end{bmatrix}
\end{align*}

Introducing a Hermitian conjugation $A^\dagger = \tilde{A}^\T$, reversing and transposing the matrix, and writing

\begin{align}\label{eqn:multiPendulumSpherical2:boo2}
A_k &=
\begin{bmatrix}
\Be_1 e^{i \phi_k} e^{j_k \theta_k} \\
\Be_2 e^{i \phi_k} \sin\theta_k
\end{bmatrix} \\
\BTheta_k &=
\begin{bmatrix}
\theta_k \\
\phi_k
\end{bmatrix}
\end{align}

We can now write the relative velocity differential as

\begin{align}\label{eqn:multiPendulumSpherical2:boo3}
(\dot{z}_k - \dot{z}_{k-1})^2 = l_k^2 {\dot{\BTheta}_k}^\dagger A_k A_k^\dagger \dot{\BTheta}_k
\end{align}

Observe that the inner product is Hermitian under this definition since $(A_k A_k^\dagger)^\dagger = A_k A_k^\dagger$.

The total (squared) velocity of the $k$th particle is then

\begin{align}\label{eqn:multiPendulumSpherical2:boo4}
\BTheta &=
\begin{bmatrix}
\BTheta_1 \\
\BTheta_2 \\
\vdots \\
\BTheta_N \\
\end{bmatrix} \\
B_k &=
\begin{bmatrix}
l_1 A_1 \\
l_2 A_2 \\
\vdots \\
l_k A_k \\
0 \\
\end{bmatrix} \\
(\dot{z}_k)^2 &=
\dot{\BTheta}^\dagger B_k B_k^\dagger \dot{\BTheta}
\end{align}

(where the zero matrix in $B_k$ is a $N-k$ by one zero).  Summing over all masses and adding in the potential energy we have for the Lagrangian of the system

%m_1 A_1 A_1^\dagger
%+ m_2
%A_1 A_1^\dagger
%A_2 A_2^\dagger
%+ m_3
%A_1 A_1^\dagger
%A_2 A_2^\dagger
%A_3 A_3^\dagger
%...
%=
%(m_1 + m_2 + m_3) A_1 A_1^\dagger
%+(m_2 + m_3) A_2 A_2^\dagger
%+(m_3) A_3 A_3^\dagger

\begin{align}\label{eqn:multiPendulumSpherical2:boo5b}
K &=
\inv{2} \sum_{k=1}^N m_k
\dot{\BTheta}^\dagger
B_k B_k^\dagger
\dot{\BTheta} \\
\mu_k &= \sum_{j=k}^N m_j \\
\Phi &=
g \sum_{k=1}^N \mu_k l_k \cos\theta_k \\
\LL &= K - \Phi
\end{align}

%FIXME: Had $K = \inv{2} \sum_{k=1}^N \mu_k$ above, and that has not been corrected below.
There's a few layers of equations involved and we still have an unholy mess of matrix and geometric algebra in the kernel of the kinetic energy quadratic form, but at least this time all the generalized coordinates of the system are scalars.

\section{Some tidy up.}

Before continuing with evaluation of the Euler-Lagrange equations it is helpful to make a couple of observations about the structure of the matrix products that make up our velocity quadratic forms

\begin{align}\label{eqn:multiPendulumSpherical2:boo8}
\dot{\BTheta}^\dagger
B_k B_k^\dagger
\dot{\BTheta}
&=
\dot{\BTheta}^\dagger
\begin{bmatrix}
\begin{bmatrix}
l_1^2 A_1 A_1^\dagger & l_1 l_2 A_1 A_2^\dagger & \hdots & l_1 l_k A_1 A_k^\dagger \\
l_2 l_1 A_2 A_1^\dagger & l_2^2 A_2 A_2^\dagger & \hdots & l_2 l_k A_2 A_k^\dagger \\
\vdots \\
l_k l_1 A_k A_1^\dagger & l_k l_2 A_k A_2^\dagger & \hdots & l_k^2 A_k A_k^\dagger
\end{bmatrix} & 0 \\
0 & 0
\end{bmatrix}
\dot{\BTheta}
\end{align}

Specifically, consider the $A_a A_b^\dagger$ products that make up the elements of the matrices $Q_k = B_k B_k^\dagger$.  Without knowing anything about the grades that make up the elements of $Q_k$, since it is Hermitian (by this definition of Hermitian) there can be no elements of grade order two or three in the final matrix.  This is because reversion of such grades inverts the sign, and the matrix elements in $Q_k$ all equal their reverse.  Additionally, the elements of the multivector column matrices $A_k$ are vectors, so in the product $A_a A_b^\dagger$ we can only have scalar and bivector (grade two) elements.  The resulting one by one scalar matrix is a sum over all the mixed angular velocities $\dot{\theta}_a \dot{\theta}_b$, $\dot{\theta}_a \dot{\phi}_b$, and $\dot{\phi}_a \dot{\phi}_b$, so once this summation is complete any bivector grades of $A_a A_b^\dagger$ must cancel out.  This is consistent with the expectation that we have a one by one scalar matrix result out of this in the end (i.e. a number).  The end result is a freedom to exploit the convienence of explicitly using a scalar selection operator that filters out any vector, bivector, and trivector grades in the products $A_a A_b^\dagger$.  We will get the same result if we write

\begin{align}\label{eqn:multiPendulumSpherical2:boo9}
\dot{\BTheta}^\dagger
B_k B_k^\dagger
\dot{\BTheta}
&=
\dot{\BTheta}^\dagger
\begin{bmatrix}
\begin{bmatrix}
l_1^2 \gpgradezero{A_1 A_1^\dagger} & l_1 l_2 \gpgradezero{A_1 A_2^\dagger} & \hdots & l_1 l_k \gpgradezero{A_1 A_k^\dagger} \\
l_2 l_1 \gpgradezero{A_2 A_1^\dagger} & l_2^2 \gpgradezero{A_2 A_2^\dagger} & \hdots & l_2 l_k \gpgradezero{A_2 A_k^\dagger} \\
\vdots \\
l_k l_1 \gpgradezero{A_k A_1^\dagger} & l_k l_2 \gpgradezero{A_k A_2^\dagger} & \hdots & l_k^2 \gpgradezero{A_k A_k^\dagger}
\end{bmatrix} & 0 \\
0 & 0
\end{bmatrix}
\dot{\BTheta}
\end{align}

Pulling in the summation over $m_k$ we have

\begin{align}\label{eqn:multiPendulumSpherical2:boo15}
\sum_k m_k
\dot{\BTheta}^\dagger
B_k B_k^\dagger
\dot{\BTheta}
&=
\dot{\BTheta}^\dagger
{\begin{bmatrix}
\mu_{\max(r,c)} l_r l_c \gpgradezero{A_r A_c^\dagger}
\end{bmatrix}}_{rc}
\dot{\BTheta}
\end{align}

It appears justifiable to lable the $\mu_{\max(r,c)} l_r l_c$ factors of the angular velocity matrices as moments of inertia in a generalized sense.  Using this block matrix form, and scalar selection, we can now write the Lagrangian in a slightly tidier form

\begin{align}\label{eqn:multiPendulumSpherical2:boo5}
\mu_k &= \sum_{j=k}^N m_j \\
Q &= 
{\begin{bmatrix}
\mu_{\max(r,c)} l_r l_c A_r A_c^\dagger
\end{bmatrix}}_{rc} \\
K &=
\inv{2} \dot{\BTheta}^\dagger Q
\dot{\BTheta} 
=\inv{2} \dot{\BTheta}^\dagger \gpgradezero{Q}
\dot{\BTheta} \\
\Phi &=
g \sum_{k=1}^N \mu_k l_k \cos\theta_k \\
\LL &= K - \Phi
\end{align}

After some expansion one gets for the block matrixes contained in $Q$

\begin{align}\label{eqn:multiPendulumSpherical2:boo12}
A_r A_c^\dagger
&=
\begin{bmatrix}
e^{i(\phi_c - \phi_r)} e^{j_r \theta_r} e^{j_c \theta_c} & i e^{i(\phi_c - \phi_r)} e^{j_r \theta_r} \sin\theta_c \\
-i e^{i(\phi_c - \phi_r)} e^{j_c \theta_c} \sin\theta_r  & e^{i(\phi_c - \phi_r)} \sin\theta_r \sin\theta_c
\end{bmatrix}
\end{align}

Strictly speaking we only need the scalar parts of these matrices.  For brievity, writing $S_\theta = \sin\theta$, $C_\phi = \cos\phi$ and so forth, those scalar parts are

\begin{align}\label{eqn:multiPendulumSpherical2:boo20}
\gpgradezero{A_r A_c^\dagger}
=
\begin{bmatrix}
C_{\phi_c - \phi_r} 
C_{\theta_r}
C_{\theta_c}
-C_{2(\phi_c - \phi_r)} 
S_{\theta_r}
S_{\theta_c} &
-S_{\phi_c - \phi_r} C_{\theta_r} S_{\theta_c} \\
S_{\phi_c - \phi_r} C_{\theta_c} S_{\theta_r} &
C_{\phi_c - \phi_r} S_{\theta_r} S_{\theta_c}
\end{bmatrix}
\end{align}

One has the option of working with just these scalar parts, using 

\begin{align}\label{eqn:multiPendulumSpherical2:boo21}
\gpgradezero{Q} = 
{\begin{bmatrix}
\mu_{\max(r,c)} l_r l_c \gpgradezero{ A_r A_c^\dagger }
\end{bmatrix}}_{rc}
\end{align}

for further computations associated with this problem.  That completely eliminates the Geometric algebra from the problem, and is probably a logical way to formulate things for numerical work since one can then exploit any pre existing matrix algebra system without having to create one that understands non-commuting variables and vector products.

\section{Evaluating the Euler-Lagrange equations.}

Evaluating the Euler-Lagrange equations for this system, we get for the $\theta_a$ and $\phi_a$ derivatives respectively
\begin{align}\label{eqn:multiPendulumSpherical2:boo6}
\frac{d}{dt} \PD{\dot{\theta}_a}{\LL}
&=
\PD{\theta_a}{\LL}
=
\inv{2} \dot{\BTheta}^\dagger
{\begin{bmatrix}
\mu_{\max(r,c)} l_r l_c \gpgradezero{
\PD{\theta_a}{A_r} A_c^\dagger
+A_r \PD{\theta_a}{A_c}^\dagger
}
\end{bmatrix}}_{rc} 
\dot{\BTheta}
-g \mu_a l_a \sin\theta_a 
\end{align}

\begin{align}\label{eqn:multiPendulumSpherical2:boo6c}
\frac{d}{dt} \PD{\dot{\phi}_a}{\LL}
&=
\PD{\phi_a}{\LL}
=
\inv{2} \dot{\BTheta}^\dagger
{\begin{bmatrix}
\mu_{\max(r,c)} l_r l_c \gpgradezero{
\PD{\phi_a}{A_r} A_c^\dagger
+A_r \PD{\phi_a}{A_c}^\dagger
}
\end{bmatrix}}_{rc} 
\dot{\BTheta}
\end{align}

For the acceleration terms computation reduces nicely to a function of only $\gpgradezero{Q}$

\begin{align*}
\frac{d}{dt} \PD{\dot{\theta}_a}{\LL}
&=
\frac{d}{dt} 
\left(
\PD{\dot{\theta}_a}{\dot{\BTheta}}^\dagger
\gpgradezero{Q} 
\dot{\BTheta}
+
\dot{\BTheta}^\dagger
\gpgradezero{Q} 
\PD{\dot{\theta}_a}{\dot{\BTheta}}
\right)  \\
&=
\frac{d}{dt} \left(
{\begin{bmatrix}
\delta_{ac}
\begin{bmatrix}
1 & 0
\end{bmatrix}
\end{bmatrix}}_c
\gpgradezero{Q} 
\dot{\BTheta}
\right) 
\end{align*}

and

\begin{align*}
\frac{d}{dt} \PD{\dot{\phi}_a}{\LL}
&=
\frac{d}{dt} 
\left(
\PD{\dot{\phi}_a}{\dot{\BTheta}}^\dagger
\gpgradezero{Q} 
\dot{\BTheta}
+
\dot{\BTheta}^\dagger
\gpgradezero{Q} 
\PD{\dot{\phi}_a}{\dot{\BTheta}}
\right)  \\
&=
\frac{d}{dt} \left(
{\begin{bmatrix}
\delta_{ac}
\begin{bmatrix}
0 & 1
\end{bmatrix}
\end{bmatrix}}_c
\gpgradezero{Q} 
\dot{\BTheta}
\right) 
\end{align*}

By forming a column matrix we can put the angular velocity gradient in a tidy phase space block matrix representation

\begin{align}\label{eqn:multiPendulumSpherical2:boo22}
\grad_{\dot{\BTheta}} \LL = 
{\begin{bmatrix}
\begin{bmatrix}
\PD{\dot{\theta}_r}{\LL} \\
\PD{\dot{\phi}_r}{\LL} \\
\end{bmatrix}
\end{bmatrix}}_r = \gpgradezero{Q} \dot{\BTheta}
\end{align}

The Euler-Lagrange equation evaluation is now reduced to

\begin{align}\label{eqn:multiPendulumSpherical2:boo23}
\frac{d}{dt} \left( \gpgradezero{Q} \dot{\BTheta} \right) =
{\begin{bmatrix}
\begin{bmatrix}
\PD{\theta_r}{\LL} \\
\PD{\phi_r}{\LL} \\
\end{bmatrix}
\end{bmatrix}}_r
\end{align}

With back substituition of \ref{eqn:multiPendulumSpherical2:boo20}, and \ref{eqn:multiPendulumSpherical2:boo21} we have a complete non-multivector expansion of the right hand side if desired.  To complete things it is desirable to try to find a tidy form for the left hand side, which we have expanded above in terms of $A_r A_c^\dagger$ derivatives.

FIXME: revamping from here, working with $Q$ and $\gpgradezero{Q}$ instead.  This will mean that we want $\partial_k A_a A_b^\dagger$ derivatives instead.

Note that the $\partial_a B_k$ are zero if $a > k$, and for $a \le k$ have only one term dependent on $A_a$.  We also have a matrix sum of the form $u + u^\dagger$ in the partials, which can have only scalar and vector terms.  As argued previously all but the scalar elements cancel, leaving

\begin{align}\label{eqn:multiPendulumSpherical2:boo7}
\frac{d}{dt}
\dot{\BTheta}^\dagger
\gpgradezero{Q}
{\begin{bmatrix}
\delta_{ar}
\begin{bmatrix}
1 \\
0
\end{bmatrix}
\end{bmatrix}}_r
&=
\sum_{k=a}^N m_k l_a
\dot{\BTheta}^\dagger
\gpgradezero{
{\begin{bmatrix}
\delta_{ar}
\PD{\theta_a}{A_a} \\
\end{bmatrix}}_r
B_k^\dagger }
\dot{\BTheta}
-g \mu_a l_a \sin\theta_a \\
%%%%
\frac{d}{dt}
\dot{\BTheta}^\dagger
\gpgradezero{Q}
{\begin{bmatrix}
\delta_{ar}
\begin{bmatrix}
0 \\
1
\end{bmatrix}
\end{bmatrix}}_r
&=
\sum_{k=a}^N m_k
\dot{\BTheta}^\dagger
\gpgradezero{
{\begin{bmatrix}
\delta_{ar}
\PD{\phi_a}{A_a} \\
\end{bmatrix}}_r
B_k^\dagger }
\dot{\BTheta}
\end{align}

To go forward further, we require

\begin{align}\label{eqn:multiPendulumSpherical2:boo10}
\PD{\theta_a}{A_a} &=
\begin{bmatrix}
\Be_1 e^{i \phi_a} j_a e^{j_a \theta_a} \\
\Be_2 e^{i \phi_a} \cos\theta_a
\end{bmatrix}
\end{align}

and (after some reduction)

\begin{align}\label{eqn:multiPendulumSpherical2:boo11}
\PD{\phi_a}{A_a}
%&=
%\begin{bmatrix}
%\Be_2 e^{i \phi_a} e^{j_a \theta_a}
%+\Be_1 e^{i \phi_a} \PD{\phi_a}{j_a} \sin\theta_a
%\\
%-\Be_1 e^{i \phi_a} \sin\theta_a
%\end{bmatrix} \\
%&=
%\begin{bmatrix}
%\Be_2 e^{i \phi_a} e^{j_a \theta_a}
%+\Be_1 e^{i \phi_a} \Be_3 \Be_2 e^{i\phi_a} \sin\theta_a
%\\
%-\Be_1 e^{i \phi_a} \sin\theta_a
%\end{bmatrix} \\
%&=
%\begin{bmatrix}
%\Be_2 e^{i \phi_a} e^{j_a \theta_a}
%+\Be_1 \Be_3 \Be_2 \sin\theta_a
%\\
%-\Be_1 e^{i \phi_a} \sin\theta_a
%\end{bmatrix} \\
&=
\begin{bmatrix}
\Be_2 e^{i \phi_a} \cos\theta_a \\
-\Be_1 e^{i \phi_a} \sin\theta_a
\end{bmatrix}
\end{align}

After some reduction we get for the $\phi$ partial block matrix scalar products

\begin{align}\label{eqn:multiPendulumSpherical2:boo13}
\gpgradezero{ \PD{\phi_a}{A_a} A_b^\dagger}
&=
\begin{bmatrix}
S_{\phi_a + \phi_b} C_{\theta_a} C_{\theta_b} & C_{\phi_b - \phi_a} C_{\theta_a} S_{\theta_b} \\
-C_{\phi_a + \phi_b} S_{\theta_a} C_{\theta_b} & S_{\phi_b - \phi_a} S_{\theta_a} S_{\theta_b} \\
\end{bmatrix}
\end{align}
\begin{align}\label{eqn:multiPendulumSpherical2:boo14}
\gpgradezero{ \PD{\theta_a}{A_a} A_b^\dagger}
&=
\text{TO COMPUTE}
\end{align}

%\EndArticle
\EndNoBibArticle
