\input{../peeter_prologue.tex}

\chapter{Spherical polar pendulum for one and multiple masses (Take II)}
\label{chap:multiPendulumSpherical2}
%\useCCL
\blogpage{http://sites.google.com/site/peeterjoot/math2009/multiPendulumSpherical2.pdf}
\date{Nov 4, 2009}
\revisionInfo{$RCSfile: multiPendulumSpherical2.tex,v $ Last $Revision: 1.17 $ $Date: 2009/11/09 13:14:50 $}

\beginArtWithToc
%\beginArtNoToc

\section{Motivation}

Attempting the multiple spherical pendulum problem with a bivector parameterized Lagrangian has just been attempted, but did not turn out to be an effective approach.  Here a variation is used, employing regular plain old scalar spherical angle parameterized Kinetic energy, but still employing Geometric Algebra to express the Hermitian quadratic form associated with this energy term.

The same set of simplifying assumptions will be made.  These are point masses, zero friction at the pivots and rigid nonspringy massless connecting rods between the masses.

\section{The Lagrangian.}

A two particle spherical pendulum is depicted in figure (\ref{fig:sPolarMultiPendulum:pendulumDouble})

\begin{figure}[htp]
\centering
\includegraphics[totalheight=0.4\textheight]{pendulumDouble}
\caption{Double spherical pendulum.}\label{fig:sPolarMultiPendulum:pendulumDouble}
\end{figure}

The position vector for each particle can be expressed relative to the mass it is connected to (or the origin for the first particle), as in

\begin{align}\label{eqn:multiPendulumSpherical2:boo1}
z_k &= z_{k-1} + \Be_3 l_k e^{j_k \theta_k} \\
j_k &= \Be_3 \wedge \left( \Be_1 e^{i \phi_k} \right) \\
i &= \Be_1 \wedge \Be_2
\end{align}

To express the Kinetic energy for any of the masses $m_k$, we need the derivative of the incremental difference in position

\begin{align*}
\frac{d}{dt} \left( \Be_3 e^{j_k \theta_k} \right)
&=
\Be_3 \left( j_k \dot{\theta}_k e^{j_k \theta_k} + \frac{d j_k }{dt} \sin\theta_k \right)  \\
&=
\Be_3 \left( j_k \dot{\theta}_k e^{j_k \theta_k} + \Be_3 \Be_2 \dot{\phi}_k e^{i \phi_k} \sin\theta_k \right)  \\
&=
\left( \frac{d}{dt}
\begin{bmatrix}
\theta_k & \phi_k
\end{bmatrix} \right)
\begin{bmatrix}
\Be_1 e^{i \phi_k} e^{j_k \theta_k} \\
\Be_2 e^{i \phi_k} \sin\theta_k
\end{bmatrix}
\end{align*}

Introducing a Hermitian conjugation $A^\dagger = \tilde{A}^\T$, reversing and transposing the matrix, and writing

\begin{align}\label{eqn:multiPendulumSpherical2:boo2}
A_k &=
\begin{bmatrix}
\Be_1 e^{i \phi_k} e^{j_k \theta_k} \\
\Be_2 e^{i \phi_k} \sin\theta_k
\end{bmatrix} \\
\BTheta_k &=
\begin{bmatrix}
\theta_k \\
\phi_k
\end{bmatrix}
\end{align}

We can now write the relative velocity differential as

\begin{align}\label{eqn:multiPendulumSpherical2:boo3}
(\dot{z}_k - \dot{z}_{k-1})^2 = l_k^2 {\dot{\BTheta}_k}^\dagger A_k A_k^\dagger \dot{\BTheta}_k
\end{align}

Observe that the inner product is Hermitian under this definition since $(A_k A_k^\dagger)^\dagger = A_k A_k^\dagger$.

The total (squared) velocity of the $k$th particle is then

\begin{align}\label{eqn:multiPendulumSpherical2:boo4}
\BTheta &=
\begin{bmatrix}
\BTheta_1 \\
\BTheta_2 \\
\vdots \\
\BTheta_N \\
\end{bmatrix} \\
B_k &=
\begin{bmatrix}
l_1 A_1 \\
l_2 A_2 \\
\vdots \\
l_k A_k \\
0 \\
\end{bmatrix} \\
(\dot{z}_k)^2 &=
\dot{\BTheta}^\dagger B_k B_k^\dagger \dot{\BTheta}
\end{align}

(where the zero matrix in $B_k$ is a $N-k$ by one zero).  Summing over all masses and adding in the potential energy we have for the Lagrangian of the system

%m_1 A_1 A_1^\dagger
%+ m_2
%A_1 A_1^\dagger
%A_2 A_2^\dagger
%+ m_3
%A_1 A_1^\dagger
%A_2 A_2^\dagger
%A_3 A_3^\dagger
%...
%=
%(m_1 + m_2 + m_3) A_1 A_1^\dagger
%+(m_2 + m_3) A_2 A_2^\dagger
%+(m_3) A_3 A_3^\dagger

\begin{align}\label{eqn:multiPendulumSpherical2:boo5b}
K &=
\inv{2} \sum_{k=1}^N m_k
\dot{\BTheta}^\dagger
B_k B_k^\dagger
\dot{\BTheta} \\
\mu_k &= \sum_{j=k}^N m_j \\
\Phi &=
g \sum_{k=1}^N \mu_k l_k \cos\theta_k \\
\LL &= K - \Phi
\end{align}

There's a few layers of equations involved and we still have an unholy mess of matrix and geometric algebra in the kernel of the kinetic energy quadratic form, but at least this time all the generalized coordinates of the system are scalars.

\section{Some tidy up.}

Before continuing with evaluation of the Euler-Lagrange equations it is helpful to make a couple of observations about the structure of the matrix products that make up our velocity quadratic forms

\begin{align}\label{eqn:multiPendulumSpherical2:boo8}
\dot{\BTheta}^\dagger
B_k B_k^\dagger
\dot{\BTheta}
&=
\dot{\BTheta}^\dagger
\begin{bmatrix}
\begin{bmatrix}
l_1^2 A_1 A_1^\dagger & l_1 l_2 A_1 A_2^\dagger & \hdots & l_1 l_k A_1 A_k^\dagger \\
l_2 l_1 A_2 A_1^\dagger & l_2^2 A_2 A_2^\dagger & \hdots & l_2 l_k A_2 A_k^\dagger \\
\vdots \\
l_k l_1 A_k A_1^\dagger & l_k l_2 A_k A_2^\dagger & \hdots & l_k^2 A_k A_k^\dagger
\end{bmatrix} & 0 \\
0 & 0
\end{bmatrix}
\dot{\BTheta}
\end{align}

Specifically, consider the $A_a A_b^\dagger$ products that make up the elements of the matrices $Q_k = B_k B_k^\dagger$.  Without knowing anything about the grades that make up the elements of $Q_k$, since it is Hermitian (by this definition of Hermitian) there can be no elements of grade order two or three in the final matrix.  This is because reversion of such grades inverts the sign, and the matrix elements in $Q_k$ all equal their reverse.  Additionally, the elements of the multivector column matrices $A_k$ are vectors, so in the product $A_a A_b^\dagger$ we can only have scalar and bivector (grade two) elements.  The resulting one by one scalar matrix is a sum over all the mixed angular velocities $\dot{\theta}_a \dot{\theta}_b$, $\dot{\theta}_a \dot{\phi}_b$, and $\dot{\phi}_a \dot{\phi}_b$, so once this summation is complete any bivector grades of $A_a A_b^\dagger$ must cancel out.  This is consistent with the expectation that we have a one by one scalar matrix result out of this in the end (i.e. a number).  The end result is a freedom to exploit the convienence of explicitly using a scalar selection operator that filters out any vector, bivector, and trivector grades in the products $A_a A_b^\dagger$.  We will get the same result if we write

\begin{align}\label{eqn:multiPendulumSpherical2:boo9}
\dot{\BTheta}^\dagger
B_k B_k^\dagger
\dot{\BTheta}
&=
\dot{\BTheta}^\dagger
\begin{bmatrix}
\begin{bmatrix}
l_1^2 \gpgradezero{A_1 A_1^\dagger} & l_1 l_2 \gpgradezero{A_1 A_2^\dagger} & \hdots & l_1 l_k \gpgradezero{A_1 A_k^\dagger} \\
l_2 l_1 \gpgradezero{A_2 A_1^\dagger} & l_2^2 \gpgradezero{A_2 A_2^\dagger} & \hdots & l_2 l_k \gpgradezero{A_2 A_k^\dagger} \\
\vdots \\
l_k l_1 \gpgradezero{A_k A_1^\dagger} & l_k l_2 \gpgradezero{A_k A_2^\dagger} & \hdots & l_k^2 \gpgradezero{A_k A_k^\dagger}
\end{bmatrix} & 0 \\
0 & 0
\end{bmatrix}
\dot{\BTheta}
\end{align}

Pulling in the summation over $m_k$ we have

\begin{align}\label{eqn:multiPendulumSpherical2:boo15}
\sum_k m_k
\dot{\BTheta}^\dagger
B_k B_k^\dagger
\dot{\BTheta}
&=
\dot{\BTheta}^\dagger
{\begin{bmatrix}
\mu_{\max(r,c)} l_r l_c \gpgradezero{A_r A_c^\dagger}
\end{bmatrix}}_{rc}
\dot{\BTheta}
\end{align}

It appears justifiable to lable the $\mu_{\max(r,c)} l_r l_c$ factors of the angular velocity matrices as moments of inertia in a generalized sense.  Using this block matrix form, and scalar selection, we can now write the Lagrangian in a slightly tidier form

\begin{align}\label{eqn:multiPendulumSpherical2:boo5}
\mu_k &= \sum_{j=k}^N m_j \\
Q &= 
{\begin{bmatrix}
\mu_{\max(r,c)} l_r l_c A_r A_c^\dagger
\end{bmatrix}}_{rc} \\
K &=
\inv{2} \dot{\BTheta}^\dagger Q
\dot{\BTheta} 
=\inv{2} \dot{\BTheta}^\T \gpgradezero{Q}
\dot{\BTheta} \\
\Phi &=
g \sum_{k=1}^N \mu_k l_k \cos\theta_k \\
\LL &= K - \Phi
\end{align}

After some expansion, writing $S_\theta = \sin\theta$, $C_\phi = \cos\phi$ and so forth, one can find that the scalar parts of the block matrixes $A_r A_c^\dagger$ contained in $Q$ are

\begin{align}\label{eqn:multiPendulumSpherical2:boo20}
\gpgradezero{A_r A_c^\dagger}
=
\begin{bmatrix}
C_{\phi_c - \phi_r} 
C_{\theta_r}
C_{\theta_c}
+S_{\theta_r}
S_{\theta_c} &
-S_{\phi_c - \phi_r} C_{\theta_r} S_{\theta_c} \\
S_{\phi_c - \phi_r} C_{\theta_c} S_{\theta_r} &
C_{\phi_c - \phi_r} S_{\theta_r} S_{\theta_c}
\end{bmatrix}
\end{align}

The diagonal blocks are particularily simple and have no $\phi$ dependence

\begin{align}\label{eqn:multiPendulumSpherical2:boo20d}
\gpgradezero{A_r A_r^\dagger}
=
\begin{bmatrix}
1 & 0 \\
0 & \sin^2 \theta_r
\end{bmatrix}
\end{align}

Observe also that $\gpgradezero{A_r A_c^\dagger}^T = \gpgradezero{A_c A_r^\dagger}$, so the scalar matrix

\begin{align}\label{eqn:multiPendulumSpherical2:boo21}
\gpgradezero{Q} = 
{\begin{bmatrix}
\mu_{\max(r,c)} l_r l_c \gpgradezero{ A_r A_c^\dagger }
\end{bmatrix}}_{rc}
\end{align}

is a real symmetric matrix.  We have the option of using this explicit scalar expansion if desired for further computations associated with this problem.  That completely eliminates the Geometric algebra from the problem, and is probably a logical way to formulate things for numerical work since one can then exploit any pre existing matrix algebra system without having to create one that understands non-commuting variables and vector products.

\section{Evaluating the Euler-Lagrange equations.}

For the acceleration terms of the Euler-Lagrange equations our computation reduces nicely to a function of only $\gpgradezero{Q}$

\begin{align*}
\frac{d}{dt} \PD{\dot{\theta}_a}{\LL}
&=
\inv{2} \frac{d}{dt} 
\left(
\PD{\dot{\theta}_a}{\dot{\BTheta}}^\T
\gpgradezero{Q} 
\dot{\BTheta}
+
\dot{\BTheta}^\T
\gpgradezero{Q} 
\PD{\dot{\theta}_a}{\dot{\BTheta}}
\right)  \\
&=
\frac{d}{dt} \left(
{\begin{bmatrix}
\delta_{ac}
\begin{bmatrix}
1 & 0
\end{bmatrix}
\end{bmatrix}}_c
\gpgradezero{Q} 
\dot{\BTheta}
\right) 
\end{align*}

and

\begin{align*}
\frac{d}{dt} \PD{\dot{\phi}_a}{\LL}
&=
\inv{2} \frac{d}{dt} 
\left(
\PD{\dot{\phi}_a}{\dot{\BTheta}}^\T
\gpgradezero{Q} 
\dot{\BTheta}
+
\dot{\BTheta}^\T
\gpgradezero{Q} 
\PD{\dot{\phi}_a}{\dot{\BTheta}}
\right)  \\
&=
\frac{d}{dt} \left(
{\begin{bmatrix}
\delta_{ac}
\begin{bmatrix}
0 & 1
\end{bmatrix}
\end{bmatrix}}_c
\gpgradezero{Q} 
\dot{\BTheta}
\right) 
\end{align*}

The last groupings above made use of $\gpgradezero{Q} = \gpgradezero{Q}^\T$, and in particular $(\gpgradezero{Q} + \gpgradezero{Q}^\T)/2 = \gpgradezero{Q}$.  We can now form a column matrix putting all the angular velocity gradient in a tidy block matrix representation

\begin{align}\label{eqn:multiPendulumSpherical2:boo22}
\grad_{\dot{\BTheta}} \LL = 
{\begin{bmatrix}
\begin{bmatrix}
\PD{\dot{\theta}_r}{\LL} \\
\PD{\dot{\phi}_r}{\LL} \\
\end{bmatrix}
\end{bmatrix}}_r = \gpgradezero{Q} \dot{\BTheta}
\end{align}

A small aside on Hamiltonian form.  This velocity gradient is also the conjugate momentum of the Hamiltonian, so if we wish to express the Hamiltonian in terms of conjugate momenta, we require invertability of $\gpgradezero{Q}$ at the point in time that we evaluate things.  Writing

\begin{align}\label{eqn:multiPendulumSpherical2:boo30}
P_{\BTheta} = \grad_{\dot{\BTheta}} \LL 
\end{align}

and noting that $(\gpgradezero{Q}^{-1})^\T = \gpgradezero{Q}^{-1}$, we get for the kinetic energy portion of the Hamiltonian 

\begin{align}\label{eqn:multiPendulumSpherical2:boo31}
K = \inv{2} {P_{\BTheta}}^\T \gpgradezero{Q}^{-1} P_{\BTheta}
\end{align}

Now, the invertability of $\gpgradezero{Q}$ cannot be taken for granted.  Even in the single particle case we do not have invertability.  For the single particle case we have

\begin{align}\label{eqn:multiPendulumSpherical2:boo45}
\gpgradezero{Q} =
m l^2 
\begin{bmatrix}
1 & 0 \\
0 & \sin^2 \theta
\end{bmatrix}
\end{align}

so at $\theta = \pm \pi/2$ this quadratic form is singlular, and the planar angular momentum becomes a constant of motion.

Returning to the evaluation of the Euler-Lagrange equations, the problem is now reduced to calculating the right hand side of the following system

\begin{align}\label{eqn:multiPendulumSpherical2:boo23}
\frac{d}{dt} \left( \gpgradezero{Q} \dot{\BTheta} \right) =
{\begin{bmatrix}
\begin{bmatrix}
\PD{\theta_r}{\LL} \\
\PD{\phi_r}{\LL} \\
\end{bmatrix}
\end{bmatrix}}_r
\end{align}

With back substituition of \ref{eqn:multiPendulumSpherical2:boo20}, and \ref{eqn:multiPendulumSpherical2:boo21} we have a complete non-multivector expansion of the left hand side.  For the right hand side taking the $\theta_a$ and $\phi_a$ derivatives respectively we get

\begin{align}\label{eqn:multiPendulumSpherical2:boo6}
\PD{\theta_a}{\LL}
=
\inv{2} \dot{\BTheta}^\dagger
{\begin{bmatrix}
\mu_{\max(r,c)} l_r l_c \gpgradezero{
\PD{\theta_a}{A_r} A_c^\dagger
+A_r \PD{\theta_a}{A_c}^\dagger
}
\end{bmatrix}}_{rc} 
\dot{\BTheta}
-g \mu_a l_a \sin\theta_a 
\end{align}

\begin{align}\label{eqn:multiPendulumSpherical2:boo6c}
\PD{\phi_a}{\LL}
=
\inv{2} \dot{\BTheta}^\dagger
{\begin{bmatrix}
\mu_{\max(r,c)} l_r l_c \gpgradezero{
\PD{\phi_a}{A_r} A_c^\dagger
+A_r \PD{\phi_a}{A_c}^\dagger
}
\end{bmatrix}}_{rc} 
\dot{\BTheta}
\end{align}

So to procede we must consider the $\gpgradezero{A_r A_c^\dagger}$ partials.  A bit of thought shows that the matrices of partials above are mostly zeros.  Illustrating by example, consider $\PDi{\theta_2}{\gpgradezero{Q}}$, which in block matrix form is

\begin{align}\label{eqn:multiPendulumSpherical2:boo33}
\PD{\theta_2}{\gpgradezero{Q}}
=
\begin{bmatrix}
0 & \inv{2} \mu_2 l_1 l_2 \gpgradezero{A_1 \PD{\theta_2}{A_2}^\dagger} & 0 & \hdots & 0 \\
\inv{2} \mu_2 l_2 l_1 \gpgradezero{\PD{\theta_2}{A_2} A_1^\dagger} &
\inv{2} \mu_2 l_2 l_2 \gpgradezero{A_2 \PD{\theta_2}{A_2}^\dagger + \PD{\theta_2}{A_2} A_2^\dagger} &
\inv{2} \mu_3 l_2 l_3 \gpgradezero{\PD{\theta_2}{A_2} A_3^\dagger} & \hdots &
\inv{2} \mu_N l_2 l_N \gpgradezero{\PD{\theta_2}{A_2} A_N^\dagger} \\
0 & \inv{2} \mu_3 l_3 l_2 \gpgradezero{A_3 \PD{\theta_2}{A_2}^\dagger} & 0 & \hdots & 0 \\
0 & \vdots & 0 & \hdots & 0 \\
0 & \inv{2} \mu_N l_N l_2 \gpgradezero{A_N \PD{\theta_2}{A_2}^\dagger} & 0 & \hdots & 0 \\
\end{bmatrix}
\end{align}

Observe that the diagonal term has a scalar plus its reverse, so we can drop the one half factor and one of the summands for a total contribution to $\PDi{\theta_2}{\LL}$ of just

\begin{align*}
\mu_2 {l_2}^2 {\dot{\BTheta}_2}^\T \gpgradezero{\PD{\theta_2}{A_2} A_2^\dagger} \dot{\BTheta}_2
\end{align*}

Now consider one of the pairs of off diagonal terms.  Adding these we contributions to $\PDi{\theta_2}{\LL}$ of

\begin{align*}
\inv{2} \mu_2 l_1 l_2 
{\dot{\BTheta}_1}^\T
\gpgradezero{A_1 \PD{\theta_2}{A_2}^\dagger} 
\dot{\BTheta}_2
+\inv{2} \mu_2 l_2 l_1 
{\dot{\BTheta}_2}^\T
\gpgradezero{\PD{\theta_2}{A_2} A_1^\dagger} 
\dot{\BTheta}_1
&=
\inv{2} \mu_2 l_1 l_2 
{\dot{\BTheta}_1}^\T
\gpgradezero{
A_1 \PD{\theta_2}{A_2}^\dagger
+A_1 \PD{\theta_2}{A_2}^\dagger
} 
\dot{\BTheta}_2 \\
&=
\mu_2 l_1 l_2 
{\dot{\BTheta}_1}^\T
\gpgradezero{
A_1 \PD{\theta_2}{A_2}^\dagger
} 
\dot{\BTheta}_2 \\
\end{align*}

This has exactly the same form as the diagonal term, so summing over all terms we get for the position gradient components of the Euler-Lagrange equation just

\begin{align}\label{eqn:multiPendulumSpherical2:boo41}
\PD{\theta_a}{\LL}
&=
%\mu_a {l_a}^2 {\dot{\BTheta}_a}^\T \gpgradezero{ A_a \PD{\theta_a}{A_a}^\dagger} \dot{\BTheta}_a
%+
%\sum_{k \ne a}
\sum_{k}
\mu_{\max(k,a)} l_k l_a 
{\dot{\BTheta}_k}^\T
\gpgradezero{
A_k \PD{\theta_a}{A_a}^\dagger
} 
\dot{\BTheta}_a 
-g \mu_a l_a \sin\theta_a 
\end{align}

\begin{align}\label{eqn:multiPendulumSpherical2:boo40}
\PD{\phi_a}{\LL}
&=
%\mu_a {l_a}^2 {\dot{\BTheta}_a}^\T \gpgradezero{ A_a \PD{\phi_a}{A_a}^\dagger} \dot{\BTheta}_a
%+
%\sum_{k \ne a}
\sum_{k}
\mu_{\max(k,a)} l_k l_a 
{\dot{\BTheta}_k}^\T
\gpgradezero{
A_k \PD{\phi_a}{A_a}^\dagger
} 
\dot{\BTheta}_a 
\end{align}

The only thing that remains to do is evaluate the $\gpgradezero{A_k \PDi{\phi_a}{A_a}^\dagger}$ matrixes.

It should be possible but it is tedious to calculate the block matrix derivative terms from the $A_a$ partials using

\begin{align}\label{eqn:multiPendulumSpherical2:boo10}
\PD{\theta_a}{A_a} &=
\begin{bmatrix}
-\Be_3 e^{j_a \theta_a} \\
\Be_2 e^{i \phi_a} C_{\theta_a}
\end{bmatrix}
\end{align}
\begin{align}\label{eqn:multiPendulumSpherical2:boo11}
\PD{\phi_a}{A_a}
&=
\begin{bmatrix}
\Be_2 e^{i \phi_a} C_{\theta_a} \\
-\Be_1 e^{i \phi_a} S_{\theta_a}
\end{bmatrix}
\end{align}

However multiplying this out and reducing is a bit tedious and would be a better job for a symbolic algebra package since we have done part of the work for this already and have \ref{eqn:multiPendulumSpherical2:boo20} available to use.  We get

\begin{align}\label{eqn:multiPendulumSpherical2:boo50}
\gpgradezero{ A_r \PD{\phi_c}{A_c}^\dagger }
&=
\begin{bmatrix}
-S_{\phi_c - \phi_r} C_{\theta_r} C_{\theta_c} + S_{\theta_r} S_{\theta_c} &
-C_{\phi_c - \phi_r} C_{\theta_r} S_{\theta_c} \\
C_{\phi_c - \phi_r} C_{\theta_c} S_{\theta_r} &
-S_{\phi_c - \phi_r} S_{\theta_r} S_{\theta_c} 
\end{bmatrix}
\end{align}

\begin{align}\label{eqn:multiPendulumSpherical2:boo51}
\gpgradezero{ A_r \PD{\theta_c}{A_c}^\dagger }
&=
\begin{bmatrix}
-C_{\phi_c - \phi_r} C_{\theta_r} S_{\theta_c} + S_{\theta_r} C_{\theta_c} &
-S_{\phi_c - \phi_r} C_{\theta_r} C_{\theta_c} \\
-S_{\phi_c - \phi_r} S_{\theta_c} S_{\theta_r} &
S_{\phi_c - \phi_r} (1 + \delta_{rc}) S_{\theta_r} C_{\theta_c} 
\end{bmatrix}
\end{align}

\begin{align}\label{eqn:multiPendulumSpherical2:boo20x}
\gpgradezero{A_r A_c^\dagger}
=
\begin{bmatrix}
C_{\phi_c - \phi_r} 
C_{\theta_r}
C_{\theta_c}
+S_{\theta_r}
S_{\theta_c} &
-S_{\phi_c - \phi_r} C_{\theta_r} S_{\theta_c} \\
S_{\phi_c - \phi_r} C_{\theta_c} S_{\theta_r} &
C_{\phi_c - \phi_r} S_{\theta_r} S_{\theta_c}
\end{bmatrix}
\end{align}

%\EndArticle
\EndNoBibArticle
