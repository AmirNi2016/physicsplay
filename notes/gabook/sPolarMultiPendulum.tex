\input{../peeter_prologue.tex}

\chapter{Spherical polar pendulum for one and multiple masses.}
\label{chap:sPolarMultiPendulum}
%\useCCL
\blogpage{http://sites.google.com/site/peeterjoot/math2009/sPolarMultiPendulum.pdf}
\date{Oct 27, 2009}
\revisionInfo{$RCSfile: sPolarMultiPendulum.tex,v $ Last $Revision: 1.9 $ $Date: 2009/10/30 03:26:58 $}

\beginArtWithToc
%\beginArtNoToc

\section{Motivation}

The planar multiple pendulum problem proved somewhat tractable in the Hamiltonian formulation.  Generalizing this to allow for three dimensional motion is a logical next step.  Here this is attempted, using a Geometric Algebra scalar plus bivector parameterization of the spherical position of each dangling mass relative to the position of what it is attached to, as in

\begin{align}\label{eqn:sPolarMultiPendulum:zoo1}
\Bz = l \Be_3 e^{j\theta}
\end{align}

The exponential is essentially a unit quaternion, rotating the vector $l \Be_3$ from the polar axis to its $\theta,\phi$ angle dependent position.  Two sided rotation operators are avoided here by requiring of the unit bivector $j = \Be_3 \wedge \Bm$, where $\Bm$ is a vector in the plane of rotation passing through the great circle from $\Be_3$ through $\Bz$.  Note that we are free to pick $\Bm = \Be_1 e^{\Be_1 \Be_2 \phi}$, the unit vector in the $x,y$ plane at angle $\phi$ from the x-axis.  When that is done $j = \Be_3 \Bm$ since these are perpendicular.  Setting up the Lagrangian in terms of the bivector $j$ instead of the scalar angle $\phi$ will be attempted, since this is expected to have some elegance and will be a fun way to try the problem.  This should also provide a concrete example of a multivector Lagrangian in a context much simpler than electromagnetic fields or quantum mechanics.

Note finally that a number of simplifying assumptions will be made.  These include use of point masses, zero friction at the pivots and rigid nonspringy massless connecting rods between the masses.

\section{Kinetic energy for the single pendulum case.}

Let's compute derivatives of the unit vector

\begin{align}\label{eqn:sPolarMultiPendulum:zoo2}
\zcap = \Be_3 e^{j\theta} = e^{-j\theta} \Be_3
\end{align}

This can be done with both the left and right factorization of $\Be_3$, and are respectively

\begin{align}\label{eqn:sPolarMultiPendulum:zoo3}
\dot{\zcap} 
&= \Be_3 \left( j \thetadot e^{j\theta} + \frac{dj}{dt} \sin\theta \right) \\
&=
\Be_3
\begin{bmatrix}
j e^{j\theta} & \sin\theta
\end{bmatrix}
\frac{d}{dt} 
\begin{bmatrix}
\theta \\
j
\end{bmatrix}
\end{align}

\begin{align}\label{eqn:sPolarMultiPendulum:zoo4}
\dot{\zcap} &= \left( -j \thetadot e^{-j\theta} - \frac{dj}{dt} \sin\theta \right) \Be_3 \\
&=
\left(
\frac{d}{dt} 
\begin{bmatrix}
\theta & -j
\end{bmatrix}
\right)
\begin{bmatrix}
-j e^{-j\theta} \\
\sin\theta
\end{bmatrix}
\Be_3
\end{align}

These derivatives have been grouped into a matrix factors that allow a natural seeming conjugate operation to be defined.  That is for a matrix of multivector elements $a_{ij}$ 

\begin{align}\label{eqn:sPolarMultiPendulum:zoo5}
A =
\begin{bmatrix}
a_{ij}
\end{bmatrix}
\end{align}

define a conjugate matrix, as the transpose of the reversed elements

\begin{align}\label{eqn:sPolarMultiPendulum:zoo6}
A^\dagger \equiv
\begin{bmatrix}
\tilde{a}_{ji}
\end{bmatrix}
\end{align}

With this definition, plus two helpers

\begin{align}\label{eqn:sPolarMultiPendulum:zoo7}
\BTheta &\equiv
\begin{bmatrix}
\theta \\ j
\end{bmatrix} \\
R &= 
\begin{bmatrix}
j e^{j\theta} & \sin\theta
\end{bmatrix}
\end{align}

Our velocity becomes

\begin{align}\label{eqn:sPolarMultiPendulum:zoo8}
{\dot{\zcap}}^2 
&= {\dot{\BTheta}}^\dagger R^\dagger R \dot{\BTheta} \\
\end{align}

Explicitly, expanding the inner matrix product we can write

\begin{align}\label{eqn:sPolarMultiPendulum:zoo9}
Q &\equiv R^\dagger R \\
&=
\begin{bmatrix}
1 & -j e^{-j\theta} \sin\theta \\
j e^{j\theta} \sin\theta & \sin^2 \theta
\end{bmatrix} \\
{\dot{\zcap}}^2 
&= {\dot{\BTheta}}^\dagger Q \dot{\BTheta} \\
\end{align}

This is a slightly unholy mix of geometric and matrix algebra, but it works to compactly express the velocity dependence.  Observe that this inner matrix $Q = Q^\dagger$, so it is Hermitian with this definition of conjugation.

Our Lagrangian for the one particle pendulum, measuring potential energy from the horizontal, is then

% h = l(1+\cos\theta)
% \phi = m g h = m g l (1+\cos\theta)      %% then drop m g l constant term.
\begin{align}\label{eqn:sPolarMultiPendulum:zoo10}
\LL = {\dot{\BTheta}}^\dagger \inv{2} m l^2 Q \dot{\BTheta} - m g l \cos\theta
\end{align}

We also have a mechanism that should generalize fairly easily to the two or many pendulum cases too.

\section{Two and multi particle case.}

Having constructed a way that can express the velocity of a single spherical pendulum in a tidy way, we can move on to consider the multiple pendulum case as shown in figure (\ref{fig:sPolarMultiPendulum:pendulumDouble})

\begin{figure}[htp]
\centering
\includegraphics[totalheight=0.4\textheight]{pendulumDouble}
\caption{Double spherical pendulum.}\label{fig:sPolarMultiPendulum:pendulumDouble}
\end{figure}

There are two bivectors depicted, $j_1$ and $j_2$ representing oriented planes passing through great circles from a local polar axis (in direction $\Be_3$).  Let the positions of the respective masses be $z_1$ and $z_2$, where each mass is connected by a rigid massless rod of length $l_1$ and $l_2$ respectively.  The masses are rotated by angles $\theta_1$ and $\theta_2$ in the planes $j_1$ and $j_2$ from an initial direction of $\Be_3$.  We can express the position of the second mass as

\begin{align}\label{eqn:sPolarMultiPendulum:zoo11a}
\Bz_2 = \Bz_1 + \Be_3 e^{j_2 \theta_2}
\end{align}

We can use the same factorization as previously used for the single mass case and write for our collection of angular velocities

\begin{align}\label{eqn:sPolarMultiPendulum:zoo11}
\BTheta &\equiv
\begin{bmatrix}
\theta_1 \\ j_1 \\
\theta_2 \\ j_2 \\
\end{bmatrix} 
\end{align}

Using this the total Kinetic energy is

\begin{align}\label{eqn:sPolarMultiPendulum:zoo12}
K &= {\dot{\BTheta}}^\dagger \inv{2} Q \dot{\BTheta} \\
R_1 &=
\begin{bmatrix}
l_1 j_1 e^{j_1\theta_1} & 
l_1 \sin\theta_1 &
0 &
0
\end{bmatrix} \\
R_2 &=
\begin{bmatrix}
 l_1 j_1 e^{j_1\theta_1} & 
 l_1 \sin\theta_1 &
 l_2 j_2 e^{j_2\theta_2} & 
 l_2 \sin\theta_2 
\end{bmatrix} \\
Q &=
m_1 {R_1}^\dagger R_1
+m_2 {R_2}^\dagger R_2
\end{align}

Notation has been switched slightly from the single mass case, and the $m l^2$ factor is now incorporated directly into $Q$ for convienence.

An expansion of $Q$ is essentially one of block matrix multiplication (where we already have to be careful with order of operations as we do for the geometric product elements themselves).  We have something like

\begin{align}\label{eqn:sPolarMultiPendulum:zoo13}
R_1 &= 
\begin{bmatrix}
A_1 & 0
\end{bmatrix} \\
{R_1}^\dagger &= 
\begin{bmatrix}
{A_1}^\dagger \\
0
\end{bmatrix} \\
R_2 &= 
\begin{bmatrix}
A_1 & A_2
\end{bmatrix} \\
{R_2}^\dagger &= 
\begin{bmatrix}
{A_1}^\dagger \\
{A_2}^\dagger \\
\end{bmatrix} 
\end{align}

We have for the products
\begin{align}\label{eqn:sPolarMultiPendulum:zoo14}
{R_1}^\dagger R_1 &=
\begin{bmatrix}
{A_1}^\dagger A_1 & 0 \\
0 & 0
\end{bmatrix} \\
{R_2}^\dagger R_2 &=
\begin{bmatrix}
{A_1}^\dagger A_1 & {A_1}^\dagger A_2 \\
{A_2}^\dagger A_1 & {A_2}^\dagger A_2 \\
\end{bmatrix} 
\end{align}

So our quadratic form matrix is
\begin{align}\label{eqn:sPolarMultiPendulum:zoo15}
Q =
\begin{bmatrix}
(m_1 + m_2) {A_1}^\dagger A_1 & m_2 {A_1}^\dagger A_2 \\
m_2 {A_2}^\dagger A_1 & m_2 {A_2}^\dagger A_2 \\
\end{bmatrix} 
\end{align}

In general for the multiple particle case this is
\begin{align}\label{eqn:sPolarMultiPendulum:zoo16}
Q &=
{\begin{bmatrix}
\left(\sum_{k=\max(r,c)}^N m_k \right)
{A_r}^\dagger A_c
\end{bmatrix}}_{rc} \\
A_k &= l_k 
\begin{bmatrix}
j_k e^{j_k \theta_k} & \sin\theta_k
\end{bmatrix}
\end{align}

Expanded explicitly this is

\begin{align}\label{eqn:sPolarMultiPendulum:zoo17}
Q &=
{\begin{bmatrix}
\left(\sum_{k=\max(r,c)}^N m_k \right) l_r l_c
\begin{bmatrix}
- j_r e^{-j_r \theta_r} j_c e^{j_c\theta_c} & - j_r e^{-j_r \theta_r} \sin\theta_c \\
j_c e^{j_c \theta_c} \sin\theta_r & \sin\theta_r \sin\theta_c
\end{bmatrix}
\end{bmatrix}}_{rc}
\end{align}

Observe that the order of products in this expansion is specifically ordered, since the $j_c$ and $j_r$ bivectors do not neccessarily commute.

The potential in the multiple particle case is also fairly straightforward to compute.  Consider the two particle case to illustrate the pattern.   Using the lowest point as the potential reference we have

\begin{align}\label{eqn:sPolarMultiPendulum:zoo18}
\phi' = g \sum m_i h_i
% two:
= m_1 r_1 (1 + \cos\theta_1) 
+ m_2 \left( r_1(1 + \cos\theta_1) + r_2( 1 + \cos\theta_2) \right)
%+ m_3 \left( r_1(1 + \cos\theta_1) + r_2( 1 + \cos\theta_2) + r_3( 1 + \cos\theta_3) \right)
\end{align}

Alternately, dropping all the constant terms (using the horizon as the potential reference) we have for the general case

\begin{align}\label{eqn:sPolarMultiPendulum:zoo19}
\phi = g \sum_i \left( \sum_{k=i}^N m_k \right) r_i \cos\theta_i
\end{align}

Lets collect all the bits and pieces now for the multiple pendulum Lagrangian now, repeating for coherency, and introducing a tiny bit more notation (mass sums and block angular velocity matrices) for convienence

\begin{align}\label{eqn:sPolarMultiPendulum:zoo20}
\LL &= K - \phi + C \\
\BTheta_i &=
\begin{bmatrix}
\theta_i \\
j_i
\end{bmatrix} \\
\BTheta &=
{\begin{bmatrix}
\BTheta_r
\end{bmatrix}}_{r} \\
\mu_i &=
\sum_{k=i}^N m_k \\
Q &=
{\begin{bmatrix}
\mu_{\max(r,c)}
l_r l_c
\begin{bmatrix}
- j_r e^{-j_r \theta_r} j_c e^{j_c\theta_c} & - j_r e^{-j_r \theta_r} \sin\theta_c \\
j_c e^{j_c \theta_c} \sin\theta_r & \sin\theta_r \sin\theta_c
\end{bmatrix}
\end{bmatrix}}_{rc} \\
K &=
\inv{2} {\dot{\BTheta}}^\dagger Q \dot{\BTheta} \\
\phi &=
g \sum_{i=1}^N \mu_i r_i \cos\theta_i
\end{align}

One additional term $C$, a constraint enforced by Lagrange multipliers, has been added to the Lagrangian above to encode the additional assumptions made in this derivation.  We have utilized a unit bivector assumption, as well as a $\Be_3$ containment assumption for each of the planes ($\Be_3 \wedge j = 0$).  Thus it appears that we have to add to the Lagrangian

\begin{align}\label{eqn:sPolarMultiPendulum:noo6}
C = \sum_k \lambda_k ( {j_k}^2 + 1 ) + \alpha_k \Be_3 \wedge j_k
\end{align}

\section{Multivector Euler-Lagrange equations.}

\subsection{An example to build intuition.}

We now have the Lagrangian for a set of connected spherical pendulums.  Unfortunately, the generalized coordinates used have included bivectors, and we don't know how to evaluate the Euler Lagrange equations for anything but scalar generalized coordinates.  To help understand what we have to do, lets consider the very simplest bivector parameterized Lagrangian, that of a spherical pendulum constrained (perhaps by a track or a surface) of moving only in a ring.  This is shown pictorially in figure (\ref{fig:sPolarMultiPendulum:pendulumPolarCircular})

\begin{figure}[htp]
\centering
\includegraphics[totalheight=0.4\textheight]{pendulumPolarCircular}
\caption{Circularly constrained spherical pendulum.}\label{fig:sPolarMultiPendulum:pendulumPolarCircular}
\end{figure}

The potential energy is fixed on this surface, so our Lagrangian is purely kinetic

\begin{align}\label{eqn:sPolarMultiPendulum:noo1}
\LL = -\inv{2} m l^2 {j'}^2
\end{align}

The goal is to develop Euler-Lagrange equations that can handle a Lagrangian like this, but until we figure out how to do that, tackling this using variation of the action around a stationary solution is at least possible.  Write

\begin{align}\label{eqn:sPolarMultiPendulum:noo2}
S = \int \LL dt
\end{align}

Introducing a bivector variation $j = \bar{j} + \epsilon$ we have

\begin{align*}
\bar{S} + \delta S 
&= 
-\inv{2} m l^2 \int (\bar{j}' + \epsilon')^2 dt \\
&= 
-\inv{2} m l^2 \int (\bar{j}')^2 dt
-\inv{2} m l^2 \int \left( {\bar{j}}' \epsilon' + \epsilon' {\bar{j}}' \right) dt
-\inv{2} m l^2 \int (\epsilon')^2 dt
\end{align*}

The first term is just $\bar{S}$.  Setting the variation $\delta S = 0$ (neglecting the quadratic $\epsilon'$ term) and integrating by parts we have

\begin{align*}
0 &= \delta S \\
&= 
\int dt \left( \frac{d}{dt}\left( \inv{2} m l^2 {\bar{j}}' \right) \epsilon + \epsilon \frac{d}{dt}\left( \inv{2} m l^2 {\bar{j}}' \right) \right) \\
&= 
\int \left( \frac{d}{dt} m l^2 {\bar{j}}' \right) \cdot \epsilon dt 
\end{align*}

With $\epsilon$ arbitrary we have a solution to the variation problem for some bivector constant $\kappa$

\begin{align}\label{eqn:sPolarMultiPendulum:noo3}
m l^2 j' = \kappa
\end{align}

Is this consistent with what we get with application of the Euler-Lagrange equations to the scalar Lagrangian for this problem?  Using an azimuthal angle $\phi$, that Langrangian is

\begin{align}\label{eqn:sPolarMultiPendulum:noo4}
\LL = \inv{2} m l^2 \dot{\phi}^2
\end{align}

and the Euler Lagrange equations give us, for a scalar constant $\mu$

\begin{align}\label{eqn:sPolarMultiPendulum:noo5}
m l^2 \dot{\phi} = \mu
\end{align}

To reconsile this with the bivector result observe the relation between the bivector derivative and azimuthal angular velocity.

\begin{align*}
j 
&= \Be_3 \wedge \left(\Be_1 e^{\Be_1 \Be_2 \phi} \right) \\
&= \Be_3 \left(\Be_1 \cos\phi + \Be_2 \sin\phi \right) \\
\end{align*}

and 

\begin{align*}
j'
&= \Be_3 \left(-\Be_1 \sin\phi + \Be_2 \cos\phi \right) \dot{\phi} \\
&= \Be_3 \Be_2 \left(\Be_1 \Be_2 \sin\phi + \cos\phi \right) \dot{\phi} \\
&= -\Be_2 j \dot{\phi} \\
\end{align*}

While in the square we have $(j')^2 = -\dot{\phi}^2$, there is still a subtle difference in the scalar and bivector results, since $j'$ and $\dot{\phi}$ are not related by a constant, but instead by a phase factor proportional to $\Be_2 j$.  This difference in results has its origins in the Lagrange constraint on $j$, which I lazily left off \ref{eqn:sPolarMultiPendulum:noo1} and the subsequent variation.  The constraints enforced by the Lagrange multipliers are really required to get a meaningful result out of things in the end.

\section{Evaluating the pendulum Euler-Lagrange equations.}

TODO.

\section{Multivector Hamiltonian.}

TODO.

\section{Evaluating the Hamiltonian pendulum equations.}

TODO.

\section{Appendix calculation.  A verification that the Kinetic matrix product is a real scalar.}

In the kinetic term of the rather scary looking Lagrangian of \ref{eqn:sPolarMultiPendulum:zoo20} we have what should be a real scalar, but it is not obvious that this is the case.  As a validation that nothing very bad went wrong, it seems worthwhile to do a check that this is in fact the case, expanding this out explicitly in gory detail.

One way to try this expansion is utilizing a block matrix summing over the diagonal and paired skew terms separately.  That is

\begin{align*}
K &=
\inv{2}
\sum_{k=1}^N
\mu_k
{l_k}^2
{\dot{\BTheta}_k}^\dagger
\begin{bmatrix}
1 & - j_k e^{-j_k \theta_k} \sin\theta_k \\
j_k e^{j_k \theta_k} \sin\theta_k & \sin^2\theta_k 
\end{bmatrix}
\dot{\BTheta}_k \\
&+
\inv{2}
\sum_{a<b}
\mu_b
l_a l_b
\left(
{\dot{\BTheta}_a}^\dagger
\begin{bmatrix}
- j_a e^{-j_a \theta_a} j_b e^{j_b\theta_b} & - j_a e^{-j_a \theta_a} \sin\theta_b \\
j_b e^{j_b \theta_b} \sin\theta_a & \sin\theta_a \sin\theta_b
\end{bmatrix}
\dot{\BTheta}_b 
+
{\dot{\BTheta}_b}^\dagger
\begin{bmatrix}
- j_b e^{-j_b \theta_b} j_a e^{j_a\theta_a} & - j_b e^{-j_b \theta_b} \sin\theta_a \\
j_a e^{j_a \theta_a} \sin\theta_b & \sin\theta_b \sin\theta_a
\end{bmatrix}
\dot{\BTheta}_a
\right)
\end{align*}

Examining the diagonal matrix products and expanding one of these (dropping the $k$ suffix for tidiness), we have

\begin{align}\label{eqn:sPolarMultiPendulum:moo1}
{\dot{\BTheta}}^\dagger
\begin{bmatrix}
1 & - j e^{-j \theta} \sin\theta \\
j e^{j \theta} \sin\theta & \sin^2\theta 
\end{bmatrix}
\dot{\BTheta} 
&=
\dot{\theta}^2 -\sin^2\theta \left(\frac{dj}{dt}\right)^2 - \dot{\theta} \sin\theta\cos\theta \left( j \frac{dj}{dt} + \frac{dj}{dt} j \right)
\end{align}

Since we are working in 3D this symmetric sum is twice the dot product of the bivector $j$ with its derivative, which means that it is a scalar.  We expect this to be zero though, and can observe that this is the case since $j$ was by definition a unit bivector

\begin{align}\label{eqn:sPolarMultiPendulum:moo2}
j \frac{dj}{dt} + \frac{dj}{dt} j = \frac{d j^2}{dt} = \frac{d (-1)}{dt} = 0
\end{align}

(thus $j$ and its derivative represent orthogonal oriented planes rather like $\rcap$ and its derivative are orthogonal on a circle or sphere).  The implication is that the diagonal subset of the kinetic energy expansion contains just

\begin{align}\label{eqn:sPolarMultiPendulum:moo3}
\inv{2}
\sum_{k=1}^N
\mu_k
{l_k}^2
\left(
\left(\frac{d\theta_k}{dt}\right)^2 -\sin^2\theta_k \left(\frac{d j_k}{dt}\right)^2  \right)
\end{align}

If we are going to have any complex interaction terms then they will have to come from the off diagonal products.  Expanding the first of these

\begin{align*}
{\dot{\BTheta}_a}^\dagger
&\begin{bmatrix}
- j_a e^{-j_a \theta_a} j_b e^{j_b\theta_b} & - j_a e^{-j_a \theta_a} \sin\theta_b \\
j_b e^{j_b \theta_b} \sin\theta_a & \sin\theta_a \sin\theta_b
\end{bmatrix}
\dot{\BTheta}_b \\
&=
\begin{bmatrix}
\theta_a' & -j_a'
\end{bmatrix}
\begin{bmatrix}
- j_a e^{-j_a \theta_a} j_b e^{j_b\theta_b} & - j_a e^{-j_a \theta_a} \sin\theta_b \\
j_b e^{j_b \theta_b} \sin\theta_a & \sin\theta_a \sin\theta_b
\end{bmatrix}
\begin{bmatrix}
\theta_b' \\
j_b'
\end{bmatrix} \\
&=
\begin{bmatrix}
\theta_a' & -j_a'
\end{bmatrix}
\begin{bmatrix}
- j_a e^{-j_a \theta_a} j_b e^{j_b\theta_b} \theta_b' - j_a e^{-j_a \theta_a} \sin\theta_b j_b' \\
j_b e^{j_b \theta_b} \sin\theta_a \theta_b' + \sin\theta_a \sin\theta_b j_b'
\end{bmatrix} \\
&=
- j_a e^{-j_a \theta_a} j_b e^{j_b\theta_b} \theta_a' \theta_b' - j_a e^{-j_a \theta_a} \sin\theta_b \theta_a' j_b' -j_a' j_b e^{j_b \theta_b} \sin\theta_a \theta_b' - \sin\theta_a \sin\theta_b j_a' j_b'
\end{align*}

Adding to this the $a \leftrightarrow b$ exchanged product and rearranging yields

\begin{align*}
- \theta_a' \theta_b' (j_a e^{-j_a \theta_a} j_b e^{j_b\theta_b} + j_b e^{-j_b \theta_b} j_a e^{j_a\theta_a} ) - \sin\theta_a \sin\theta_b (j_a' j_b' + j_b' j_a') \\
- \sin\theta_b \theta_a' ( j_a e^{-j_a \theta_a} j_b' + j_b' j_a e^{j_a \theta_a} )
- \sin\theta_a \theta_b' ( j_b e^{-j_b \theta_b} j_a' + j_a' j_b e^{j_b \theta_b} )
\end{align*}

Each of these multivector sums within the brackets is of the form $A + \tilde{A}$, a multivector plus its reverse.  There can therefore be no bivector or trivector terms since they negate on reversal, and the resulting sum can have only scalar and vector grades.  Of these the second term, $j_a' j_b' + j_b' j_a' = 2 j_a' \cdot j_b'$ so it is unarguably a scalar as expected, but additional arguments are required to show this of the other three terms.  Of these remaining three, the last two have the same form.  Examining the first of these two

\begin{align*}
j_b e^{-j_b \theta_b} j_a' + j_a' j_b e^{j_b \theta_b} 
&=
(j_b \cos\theta_b + \sin\theta_b) j_a' + j_a' (j_b \cos\theta_b - \sin\theta_b) \\
&=
\cos\theta_b (j_b j_a' + j_a' j_b ) \\
&=
2 \cos\theta_b (j_b \cdot j_a')
\end{align*}

The first term actually expands in a similarily straightforward way.  The vector terms all cancel, and one is left with just

\begin{align*}
j_a e^{-j_a \theta_a} j_b e^{j_b\theta_b} + j_b e^{-j_b \theta_b} j_a e^{j_a\theta_a} 
= 
2 \cos\theta_a\cos\theta_b j_a \cdot j_b - 2 \sin\theta_a \sin\theta_b 
\end{align*}

Writing $S_{\theta_k} = \sin\theta_k$ and $C_{\theta_k} = \cos\theta_k$ (for compactness to fit things all in since the expanded result is messy), all of this KE terms can be assembled into the following explicit scalar expansion

\begin{align*}
K &=
\inv{2}
\sum_{k=1}^N
\mu_k
{l_k}^2
\left( (\theta_k')^2 - (S_{\theta_k} j_k')^2 \right) \\
&-
\sum_{a<b}
\mu_b
l_a l_b
\left(
\theta_a' \theta_b' (C_{\theta_a}C_{\theta_b} (j_a \cdot j_b) - S_{\theta_a} S_{\theta_b} )
+S_{\theta_a} S_{\theta_b} (j_a' \cdot j_b')
+S_{\theta_b} C_{\theta_b} \theta_a' (j_b \cdot j_a')
+S_{\theta_a} C_{\theta_a} \theta_b' (j_a \cdot j_b')
\right)
\end{align*}

This completes the desired verification.

%\EndArticle
\EndNoBibArticle
