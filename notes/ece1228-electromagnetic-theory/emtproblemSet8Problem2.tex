%
% Copyright © 2016 Peeter Joot.  All Rights Reserved.
% Licenced as described in the file LICENSE under the root directory of this GIT repository.
%
\makeproblem{Two interfaces.}{emt:problemSet8:2}{ 

\makesubproblem{}{emt:problemSet8:2a}
Give the TE transmission function \( T^{\textrm{TE}}(\omega) \) for a slab of
length \( d \) with permittivity and permeability \( \epsilon_2, \mu_2 \), surrounded
by medium characterized by \( \epsilon_1 \)
and \( \mu_1 \)
as shown in \cref{fig:ps8:ps8Fig2}.

Make sure you provide the expressions for the terms appearing in the transmission function \( T^{\textrm{TE}}(\omega) \).

\makesubproblem{}{emt:problemSet8:2b}
Suppose medium (II) is a meta-material with \( \epsilon_2 = -\epsilon_1 \)
and \( \mu_2 = -\mu_1 \), where \( \epsilon_1 > 0 \) and \( \mu_1 > 0 \).
What is the transmission function \( T^{\textrm{TE}}(\omega) \) in this case. Express your results in terms
of the propagation constant in medium (I), i.e. \( k_{1z} \).

\makesubproblem{}{emt:problemSet8:2c}
Now consider a source located at \( z=0 \) generating
a uniform plane wave, and for simplicity suppose a one-dimensional propagation. 
What is the field at the second interface \(z=2d\). What is the meaning of your results?

\imageFigure{../../figures/ece1228-emt/ps8Fig2}{Slab geometry.}{fig:ps8:ps8Fig2}{0.2}
} % makeproblem

\makeanswer{emt:problemSet8:2}{ 
\makeSubAnswer{}{emt:problemSet8:2a}

As outlined in class,
%Assuming normal incidence, 
we can solve the system assuming waves of the form sketched in \cref{fig:twoInterfaces:twoInterfacesFig2}.

\imageFigure{../../figures/ece1228-emt/twoInterfacesFig2}{Wave functions crossing two interfaces}{fig:twoInterfaces:twoInterfacesFig2}{0.3}
%\cref{fig:threeMediaWave:threeMediaWaveFig1}.
%\imageFigure{../../figures/ece1228-emt/threeMediaWaveFig1}{Waves crossing two interfaces}{fig:threeMediaWave:threeMediaWaveFig1}{0.25}

I've utilized the freedom to include arbitrary constant phase factors in the input and output wave functions.  The boundary conditions at \( z = d \) are
\begin{dmath}\label{eqn:emtproblemSet8Problem2:20}
\begin{aligned}
A t_{12} + D r_{21} &= C \\
A r &= A r_{12} + D t_{21},
\end{aligned}
\end{dmath}

and the boundary conditions at \( z = 2d \) are
\begin{dmath}\label{eqn:emtproblemSet8Problem2:40}
\begin{aligned}
C t_{23} e^{-j k_{2z} d } &= A t \\
C e^{-j k_{2z} d} r_{23} &= D e^{+j k_{2z} d}
\end{aligned}
\end{dmath}

Setting \( A = 1 \) for convienience, we have two equations relating \( C, D \)

\begin{dmath}\label{eqn:emtproblemSet8Problem2:60}
\begin{aligned}
t_{12} + D r_{21} &= C \\
C e^{-j k_{2z} d} r_{23} &= D e^{+j k_{2z} d},
\end{aligned}
\end{dmath}

where the reflection and transmitted amplitude scaling factors \( r, t \) both follow immediately once we have solved for \( C, D \)
\begin{dmath}\label{eqn:emtproblemSet8Problem2:80}
\begin{aligned}
t &= C t_{23} e^{-j k_{2z} d } \\
r &= r_{12} + D t_{21}.
\end{aligned}
\end{dmath}

Writing \( \gamma = e^{ j k_{2z} d } \) we can solve for \( C, D \) immediately

\begin{dmath}\label{eqn:emtproblemSet8Problem2:100}
\begin{bmatrix}
C \\
D
\end{bmatrix}
=
{\begin{bmatrix}
1 & - r_{21}  \\
r_{23} & - \gamma^2
\end{bmatrix}}^{-1}
\begin{bmatrix}
t_{12} \\
0
\end{bmatrix}
=
\inv{ \gamma^2 - r_{21} r_{23} }
\begin{bmatrix}
\gamma^2 & -r_{21}  \\
r_{23} & -1
\end{bmatrix}
\begin{bmatrix}
t_{12} \\
0
\end{bmatrix}
=
\frac{t_{12}}{ \gamma^2 - r_{21} r_{23} }
\begin{bmatrix}
\gamma^2  \\
r_{23} 
\end{bmatrix}.
\end{dmath}

For the reflection amplitude we have
\begin{dmath}\label{eqn:emtproblemSet8Problem2:120}
r 
= r_{12} + D t_{21}
= r_{12} + 
\frac{t_{21} t_{12} r_{23}}{ \gamma^2 - r_{21} r_{23} }
= r_{12} + 
\frac{t_{21} t_{12} r_{23} e^{-2 j k_{2z} d}}{ 1 - r_{21} r_{23} e^{-2 j k_{2z} d}}
\end{dmath}

and for the transmission amplitude, we have
\begin{dmath}\label{eqn:emtproblemSet8Problem2:140}
t 
= C \frac{t_{23}}{\gamma}
=
\frac{t_{23} t_{12}\gamma^2}{\gamma( \gamma^2 - r_{21} r_{23}) }
=
\frac{t_{23} t_{12}\gamma}{\gamma^2 - r_{21} r_{23} }
=
\frac{t_{23} t_{12}e^{-j k_{2z} d}}{1 - r_{21} r_{23} e^{-2 j k_{2z} d} }.
\end{dmath}

Noting that for normal incident TE mode, the individual amplitudes are

\begin{dmath}\label{eqn:emtproblemSet8Problem2:160}
\begin{aligned}
r_{12} &= \frac{\mu_2 k_{1z} - \mu_1 k_{2z}}{\mu_2 k_{1z} + \mu_1 k_{2z}} = - r_{21} \\
t_{12} &= \frac{2 \mu_2 k_{1z}}{\mu_2 k_{1z} + \mu_1 k_{2z}} \\
t_{21} &= \frac{2 \mu_1 k_{2z}}{\mu_1 k_{2z} + \mu_2 k_{1z}} \\
\end{aligned}
\end{dmath}

and setting \( 3 = 1 \), the transmission function for this problem is

\begin{dmath}\label{eqn:emtproblemSet8Problem2:180}
T(\omega)
=
\frac{t_{21} t_{12}e^{-j k_{2z} d}}{1 - r_{21} r_{21} e^{-2 j k_{2z} d} }.
\end{dmath}

We have

\begin{dmath}\label{eqn:emtproblemSet8Problem2:200}
\begin{aligned}
r_{21}^2 &= 
\frac{(\mu_2 k_{1z} - \mu_1 k_{2z})^2}{(\mu_2 k_{1z} + \mu_1 k_{2z})^2} \\
t_{12} t_{21} &=
4 \frac{(\mu_2 k_{1z})(\mu_1 k_{2z})}{(\mu_2 k_{1z} + \mu_1 k_{2z})^2},
\end{aligned}
\end{dmath}

so the transmission function is

\begin{dmath}\label{eqn:emtproblemSet8Problem2:220}
T(\omega)
=
\frac{4 \mu_1 \mu_2 k_{1z} k_{2z} e^{-j k_{2z} d}}{(\mu_2 k_{1z} + \mu_1 k_{2z})^2 - (\mu_2 k_{1z} - \mu_1 k_{2z})^2 e^{-2 j k_{2z} d} }.
\end{dmath}

The frequency dependence is carried by \( k_{iz} = (\omega/c) n_i \cos\theta_i \).  In the one interface problem, that completely kills any explicit frequency dependence, but we have such dependence here, carried by the phase factor \( e^{-j k_2 d } \).  That is

%\begin{dmath}\label{eqn:emtproblemSet8Problem2:240}
\boxedEquation{eqn:emtproblemSet8Problem2:240}{
T(\omega)
=
\frac{4 \mu_1 \mu_2 n_1 \cos\theta_1 n_2 \cos\theta_2 e^{-j \omega n_2 \cos\theta_2 d/c}}{(\mu_2 n_1 \cos\theta_1 + \mu_1 n_2\cos\theta_2 )^2 - (\mu_2 n_1 \cos\theta_1 - \mu_1 n_2 \cos\theta_2)^2 e^{-2 j \omega n_2 \cos\theta_2 d/c} }.
}
%\end{dmath}

Here \( \theta_2 \) is related to \( \theta_1 \) are related by Snell's second law

\begin{dmath}\label{eqn:emtproblemSet8Problem2:360}
\theta_2 = \sin^{-1} \lr{ \frac{n_1}{n_2} \sin\theta_1 }.
\end{dmath}

\makeSubAnswer{}{emt:problemSet8:2b}

The index of refraction, in terms of \( \mu, \epsilon \) is

\begin{dmath}\label{eqn:emtproblemSet8Problem2:260}
n = \frac{c}{v} = c \sqrt{ \mu \epsilon },
\end{dmath}

so 

\begin{dmath}\label{eqn:emtproblemSet8Problem2:280}
n_2 
= c \sqrt{ \mu_2 \epsilon_2 }
= c \sqrt{ (-\mu_1)(-\epsilon_1) }
= n_1.
\end{dmath}

This allows the transmission function to be reduced nicely

\begin{dmath}\label{eqn:emtproblemSet8Problem2:300}
T(\omega)
=
\frac{4 \mu_1 \mu_2 e^{-j \omega n_1 d/c}}{(\mu_2 + \mu_1 )^2 - (\mu_2 - \mu_1 )^2 e^{-2 j \omega n_1 d/c} }
=
\frac{-4 \mu_1^2 e^{-j \omega n_1 d/c}}{(-\mu_1 + \mu_1 )^2 - (-\mu_1 - \mu_1 )^2 e^{-2 j \omega n_1 d/c} }
=
\frac{e^{-j \omega n_1 d/c}}{e^{-2 j \omega n_1 d/c} },
\end{dmath}

so we see that the transmission function is just phase shift (a time shift in the time domain),

%\begin{dmath}\label{eqn:emtproblemSet8Problem2:320}
\boxedEquation{eqn:emtproblemSet8Problem2:340}{
T(\omega)
=
e^{j \omega n_1 d/c}.
}
%\end{dmath}

\makeSubAnswer{}{emt:problemSet8:2c}

TODO.
}
