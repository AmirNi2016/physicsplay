%
% Copyright © 2016 Peeter Joot.  All Rights Reserved.
% Licenced as described in the file LICENSE under the root directory of this GIT repository.
%
\makeproblem{Helmholtz theorem}{emt:problemSet1:5}{ 
Prove the first Helmholtz's theorem, i.e. if vector \(\BM\) is defined by its divergence

\begin{dmath}\label{eqn:emtProblemSet1Problem5:20}
\spacegrad \cdot \BM = s
\end{dmath}

and its curl
\begin{dmath}\label{eqn:emtProblemSet1Problem5:40}
\spacegrad \cross \BM = \BC 
\end{dmath}

within a region and its normal component \( \BM_{\txtn} \) over the boundary, then \( \BM \) is 
uniquely specified.

%Note: Assume there is a vector \( \BN \) with its divergence and curl equal to \( s \) and \( \BC \) respectively, then show that \( \BM = \BN \) .
} % makeproblem

\makeanswer{emt:problemSet1:5}{ 

\paragraph{An equivalent multivector problem.}

This problem screams for an attempt using Geometric Algebra techniques, since
the gradient of this vector can be written as a single even grade multivector

\begin{equation}\label{eqn:emtProblemSet1Problem5:60}
\spacegrad \BM
= \spacegrad \cdot \BM + I \spacegrad \cross \BM
= s + I \BC.
\end{equation}

Observe that the Laplacian of \( \BM \) is vector valued

\begin{dmath}\label{eqn:emtProblemSet1Problem5:400}
\spacegrad^2 \BM
= \spacegrad s + I \spacegrad \BC.
\end{dmath}

This means that \( \spacegrad \BC \) must be a bivector \( \spacegrad \BC = \spacegrad \wedge \BC \), or that \( \BC \) has zero divergence

\begin{dmath}\label{eqn:emtProblemSet1Problem5:420}
\spacegrad \cdot \BC = 0.
\end{dmath}

This required constraint on \( \BC \) will show up in subsequent analysis.  An equivalent problem to the one posed 
is to show that
the even grade multivector equation \( \spacegrad \BM = s + I \BC \) has an inverse given the constraint
specified by \cref{eqn:emtProblemSet1Problem5:420}.

\paragraph{Inverting the gradient equation.}

The Green's function for the gradient can be found in \citep{doran2003gap}, where it is used to generalize the Cauchy integral equations to higher dimensions.
%Unlike the divergence or curl, the gradient is invertible, with the \R{3} Green's function

\begin{dmath}\label{eqn:emtProblemSet1Problem5:80}
\begin{aligned}
G(\Bx ; \Bx') &= \inv{4 \pi} \frac{ \Bx - \Bx' }{\Abs{\Bx - \Bx'}^3} \\
\spacegrad \BG(\Bx, \Bx') &= \spacegrad \cdot \BG(\Bx, \Bx') = \delta(\Bx - \Bx') = -\spacegrad' \BG(\Bx, \Bx').
\end{aligned}
\end{dmath}

The inversion equation is an application of the Fundamental Theorem of (Geometric) Calculus, with the gradient operating bidirectionally on the Green's function and the vector function

\begin{dmath}\label{eqn:emtProblemSet1Problem5:100}
\oint_{\partial V} G(\Bx, \Bx') d^2 \Bx' \BM(\Bx')
=
\int_V G(\Bx, \Bx') d^3 \Bx \lrspacegrad' \BM(\Bx')
=
\int_V d^3 \Bx (G(\Bx, \Bx') \lspacegrad') \BM(\Bx')
+
\int_V d^3 \Bx G(\Bx, \Bx') (\spacegrad' \BM(\Bx'))
=
-\int_V d^3 \Bx \delta(\Bx - \By) \BM(\Bx')
+
\int_V d^3 \Bx G(\Bx, \Bx') \lr{ s(\Bx') + I \BC(\Bx') }
=
-I \BM(\Bx)
+
\inv{4 \pi} \int_V d^3 \Bx \frac{ \Bx - \Bx'}{ \Abs{\Bx - \Bx'}^3 } \lr{ s(\Bx') + I \BC(\Bx') }.
\end{dmath}

The integrals are in terms of the primed coordinates so that the end result is a function of \( \Bx \).
To rearrange in terms of \( \BM \), right multiply with the pseudoscalar \( I \), and note that in \R{3} the pseudoscalar commutes with any grades.  Let \( d^3 \Bx' = I dV' \), and \( d^2 \Bx' \ncap(\Bx') = I dA' \), to find

\begin{dmath}\label{eqn:emtProblemSet1Problem5:440}
\BM(\Bx)
=
I \oint_{\partial V} G(\Bx, \Bx') I dA' \ncap \BM(\Bx')
-
I \inv{4 \pi} \int_V I dV' \frac{ \Bx - \Bx'}{ \Abs{\Bx - \Bx'}^3 } \lr{ s(\Bx') + I \BC(\Bx') }
=
-\oint_{\partial V} dA' G(\Bx, \Bx') \ncap \BM(\Bx')
+
\inv{4 \pi} \int_V dV' \frac{ \Bx - \Bx'}{ \Abs{\Bx - \Bx'}^3 } \lr{ s(\Bx') + I \BC(\Bx') }.
\end{dmath}

This can be decomposed into a vector and a trivector equation.  Let \( \Br = \Bx - \Bx' = r \rcap \), and note that

\begin{dmath}\label{eqn:emtProblemSet1Problem5:500}
\gpgradeone{ \rcap I \BC }
=
\gpgradeone{ I \rcap \BC }
=
I \rcap \wedge \BC
=
-\rcap \cross \BC,
\end{dmath}

so this pair of equations can be written as

\begin{subequations}
\label{eqn:emtProblemSet1Problem5:460}
\begin{dmath}\label{eqn:emtProblemSet1Problem5:520}
\BM(\Bx)
=
-\inv{4 \pi} \oint_{\partial V} dA' \frac{\gpgradeone{ \rcap \ncap \BM(\Bx') }}{r^2}
+
\inv{4 \pi} \int_V dV' \lr{
\frac{\rcap}{r^2} s(\Bx') - 
\frac{\rcap}{r^2} \cross \BC(\Bx') }
\end{dmath}
\begin{dmath}\label{eqn:emtProblemSet1Problem5:480}
0
=
-\inv{4 \pi} \oint_{\partial V} dA' \frac{\rcap}{r^2} \wedge \ncap \wedge \BM(\Bx')
+
\frac{I}{4 \pi} \int_V dV' \frac{ \rcap \cdot \BC(\Bx') }{r^2}.
\end{dmath}
\end{subequations}

\paragraph{Trivector grades.}
Consider the last integral in the pseudoscalar equation above.  Since we expect no pseudoscalar components, this must be zero.  It's not obvious that this is the case, but transformation to a surface integral shows the constraints required for that to be the case.

\begin{dmath}\label{eqn:emtProblemSet1Problem5:540}
\spacegrad \inv{\Bx - \Bx'}
= -\spacegrad' \inv{\Bx - \Bx'}
=
-\frac{\Bx - \Bx'}{\Abs{\Bx - \Bx'}^3} 
= -\frac{\rcap}{r^2}.
\end{dmath}

Using this and the chain rule we have

\begin{dmath}\label{eqn:emtProblemSet1Problem5:560}
\frac{I}{4 \pi} \int_V dV' \frac{ \rcap \cdot \BC(\Bx') }{r^2}
=
\frac{I}{4 \pi} \int_V dV' \lr{ \spacegrad' \inv{ r } } \cdot \BC(\Bx') 
=
\frac{I}{4 \pi} \int_V dV' \spacegrad' \cdot \frac{\BC(\Bx')}{r}
-
\frac{I}{4 \pi} \int_V dV' \frac{ \spacegrad' \cdot \BC(\Bx') }{r}
=
\frac{I}{4 \pi} \int_V dV' \spacegrad' \cdot \frac{\BC(\Bx')}{r}.
=
\frac{I}{4 \pi} \int_{\partial V} dA' \ncap(\Bx') \cdot \frac{\BC(\Bx')}{r}.
\end{dmath}

The divergence of \( \BC \) above was killed by recalling the constraint \cref{eqn:emtProblemSet1Problem5:420}.
This means that \cref{eqn:emtProblemSet1Problem5:480} can be rewritten as entirely as surface integral and eventually reduced to a single triple product

\begin{dmath}\label{eqn:emtProblemSet1Problem5:580}
0
=
-\frac{I}{4 \pi} \oint_{\partial V} dA' \lr{
\frac{\rcap}{r^2} \cdot (\ncap \cross \BM(\Bx'))
-\ncap \cdot \frac{\BC(\Bx')}{r}
}
=
\frac{I}{4 \pi} \oint_{\partial V} dA' \ncap \cdot \lr{
\frac{\rcap}{r^2} \cross \BM(\Bx')
+ \frac{\BC(\Bx')}{r}
}
=
\frac{I}{4 \pi} \oint_{\partial V} dA' \ncap \cdot \lr{
\lr{ \spacegrad' \inv{r}} \cross \BM(\Bx')
+ \frac{\BC(\Bx')}{r}
}
=
\frac{I}{4 \pi} \oint_{\partial V} dA' \ncap \cdot \lr{
\spacegrad' \cross \frac{\BM(\Bx')}{r}
+ \cancel{\frac{\BC(\Bx')}{r}
-\frac{\spacegrad' \cross \BM(\Bx')}{r}}
}
%=
%\frac{I}{4 \pi} \oint_{\partial V} dA' \ncap \cdot \lr{
%\spacegrad' \cross \frac{\BM(\Bx')}{r}
%}
%=
%\frac{I}{4 \pi} \oint_{\partial V} dA' 
%\ncap \cdot \lr{
%\lrspacegrad' \cross \frac{\BM(\Bx')}{r}
%}
%+
%\ncap \cdot \lr{
%\lspacegrad' \cross \frac{\BM(\Bx')}{r}
%}
=
\frac{I}{4 \pi} \oint_{\partial V} dA' 
\spacegrad' \cdot 
\frac{\BM(\Bx') \cross \ncap}{r}
-
\frac{\BM(\Bx')}{r} \cdot \lr{
\cancel{\spacegrad' \cross \ncap}
}
=
\frac{I}{4 \pi} \oint_{\partial V} dA' 
\spacegrad' \cdot 
\frac{\BM(\Bx') \cross \ncap}{r}.
\end{dmath}

\paragraph{Final results.}

Assuming things back into a single multivector equation, the complete inversion integral for \( \BM \) is

\begin{dmath}\label{eqn:emtProblemSet1Problem5:600}
\BM(\Bx)
=
\inv{4 \pi} \oint_{\partial V} dA' 
\lr{
\spacegrad' \wedge 
\frac{\BM(\Bx') \wedge \ncap}{r}
-\frac{\gpgradeone{ \rcap \ncap \BM(\Bx') }}{r^2}
}
+
\inv{4 \pi} \int_V dV' \lr{
\frac{\rcap}{r^2} s(\Bx') - 
\frac{\rcap}{r^2} \cross \BC(\Bx') }.
\end{dmath}

This shows that vector \( \BM \) can be recovered uniquely when \( \Abs{\BM}/r^2 \) vanishes on an infinite surface.  If we restrict attention to a finite surface, we have a fixed solution plus a solution that depends on the value of \( \BM \) on that surface.
Consider for simplicity the case of a spherical surface, which can be analyzed more easily.  
In that case the outward normal of the surface centered on the test charge point \( \Bx \) is \( \ncap = -\rcap \).  The pseudoscalar integrand is not generally killed unless the divergence of its tangential component on this surface is zero.  One way that this can occur is for \( \BM \cross \ncap = 0 \), so that \( -\gpgradeone{ \rcap \ncap \BM } = \BM = (\BM \cdot \ncap) \ncap \).  

This gives

%\begin{dmath}\label{eqn:emtProblemSet1Problem5:620}
\boxedEquation{eqn:emtProblemSet1Problem5:620}{
\BM(\Bx)
=
\inv{4 \pi} \oint_{\Abs{\Bx - \Bx'} = r} dA' \frac{\BM_\txtn(\Bx')}{r^2}
+
\inv{4 \pi} \int_V dV' \lr{
\frac{\rcap}{r^2} s(\Bx') + 
\BC(\Bx') \cross \frac{\rcap}{r^2} }.
}
%\end{dmath}

This can also be rewritten in terms of potential functions, which is arguably tidier

\begin{dmath}\label{eqn:emtProblemSet1Problem5:300}
\BM(\Bx)
=
\inv{4 \pi} \oint_{\Abs{\Bx - \Bx'} = r} dA' \frac{\BM_\txtn(\Bx')}{r^2}
+
-\spacegrad \int_V dV' \frac{ s(\Bx')}{ 4 \pi r }
+\spacegrad \cross \int_V dV' \frac{ \BC(\Bx') }{ 4 \pi r }.
\end{dmath}
}
