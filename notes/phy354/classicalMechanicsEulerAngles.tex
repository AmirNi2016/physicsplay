%\input{../peeter_prologue_print.tex}
%\input{../peeter_prologue_widescreen.tex}

%\chapter{Classical Mechanics Euler Angles (lecture for phy354 taught by Prof E. Poppitz)}
\chapter{Classical Mechanics Euler Angles}
\label{chap:classicalMechanicsEulerAngles}
%\useCCL
\blogpage{http://sites.google.com/site/peeterjoot2/math2012/classicalMechanicsEulerAngles.pdf}
\date{Mar 21, 2012}
\gitRevisionInfo{classicalMechanicsEulerAngles}
\keywords{Euler angles, general 3D rotation, angular velocity, phy354}

\beginArtWithToc
%\beginArtNoToc

\section{Pictorially.}

We want to look at some of the trig behind expressing general rotations.  We can perform a general rotation by a sequence of successive rotations.  One such sequence is a rotation around the $z,x,z$ axes in sequence.  Application of a rotation of angle $\phi$ takes us from our original (\ref{fig:classicalMechanicsEulerAngles:classicalMechanicsEulerAnglesFig1}) frame to that of (\ref{fig:classicalMechanicsEulerAngles:classicalMechanicsEulerAnglesFig2}).  A second rotation around the (new) $x$ axis by angle $\theta$ takes us to (\ref{fig:classicalMechanicsEulerAngles:classicalMechanicsEulerAnglesFig3}), and finally a rotation of $\psi$ around the (new) $z$ axis, takes us to (\ref{fig:classicalMechanicsEulerAngles:classicalMechanicsEulerAnglesFig4}).

A composite image of all of these rotations taken together can be found in figure (\ref{fig:classicalMechanicsEulerAngles:classicalMechanicsEulerAnglesFig5}).

\begin{figure}[htp]
   \centering
   \includegraphics[totalheight=0.2\textheight]{classicalMechanicsEulerAnglesFig1}
   \caption{Initial frame.}\label{fig:classicalMechanicsEulerAngles:classicalMechanicsEulerAnglesFig1}
\end{figure}
\begin{figure}[htp]
   \centering
   \includegraphics[totalheight=0.2\textheight]{classicalMechanicsEulerAnglesFig2}
   \caption{Rotation by $\phi$ around $z$ axis.}\label{fig:classicalMechanicsEulerAngles:classicalMechanicsEulerAnglesFig2}
\end{figure}
\begin{figure}[htp]
   \centering
   \includegraphics[totalheight=0.2\textheight]{classicalMechanicsEulerAnglesFig3}
   \caption{Rotation of $\theta$ around (new) $x$ axis.}\label{fig:classicalMechanicsEulerAngles:classicalMechanicsEulerAnglesFig3}
\end{figure}
\begin{figure}[htp]
   \centering
   \includegraphics[totalheight=0.2\textheight]{classicalMechanicsEulerAnglesFig4}
   \caption{Rotation of $\psi$ around (new) $z$ axis.}\label{fig:classicalMechanicsEulerAngles:classicalMechanicsEulerAnglesFig4}
\end{figure}

\begin{figure}[htp]
   \centering
   \includegraphics[totalheight=0.2\textheight]{classicalMechanicsEulerAnglesFig5}
   \caption{All three rotations superimposed.}\label{fig:classicalMechanicsEulerAngles:classicalMechanicsEulerAnglesFig5}
\end{figure}

\section{Relating the two pairs of coordinate systems.}

Let's look at this algebraically instead, using figure (\ref{fig:classicalMechanicsEulerAngles:classicalMechanicsEulerAnglesFig6}) as a guide.

\begin{figure}[htp]
   \centering
   \includegraphics[totalheight=0.2\textheight]{classicalMechanicsEulerAnglesFig6}
   \caption{A point in two coordinate systems.}\label{fig:classicalMechanicsEulerAngles:classicalMechanicsEulerAnglesFig6}
\end{figure}

Step 1.  Rotation of $\phi$ around $z$

\begin{equation}\label{eqn:classicalMechanicsEulerAngles:20}
\begin{bmatrix}
x' \\
y' \\
z'
\end{bmatrix}
=
\begin{bmatrix}
\cos\phi & \sin\phi & 0 \\
-\sin\phi & \cos\phi & 0 \\
0 & 0 & 1
\end{bmatrix}
\begin{bmatrix}
x \\
y \\
z
\end{bmatrix}
\end{equation}

Step 2.  Rotation around $x'$.

\begin{equation}\label{eqn:classicalMechanicsEulerAngles:40}
\begin{bmatrix}
x'' \\
y'' \\
z''
\end{bmatrix}
=
\begin{bmatrix}
1 & 0 & 0 \\
0 & \cos\theta & \sin\theta & 0 \\
0 & -\sin\theta & \cos\theta & 0 
\end{bmatrix}
\begin{bmatrix}
x' \\
y' \\
z'
\end{bmatrix}
\end{equation}

Step 3.  Rotation around $z''$.

\begin{equation}\label{eqn:classicalMechanicsEulerAngles:60}
\begin{bmatrix}
x''' \\
y''' \\
z'''
\end{bmatrix}
=
\begin{bmatrix}
\cos\psi & \sin\psi & 0 \\
-\sin\psi & \cos\psi & 0 \\
0 & 0 & 1
\end{bmatrix}
\begin{bmatrix}
x'' \\
y'' \\
z''
\end{bmatrix}
\end{equation}

So, our full rotation is the composition of the rotation matrices

\begin{equation}\label{eqn:classicalMechanicsEulerAngles:80}
\begin{bmatrix}
x''' \\
y''' \\
z'''
\end{bmatrix}
=
\begin{bmatrix}
\cos\psi & \sin\psi & 0 \\
-\sin\psi & \cos\psi & 0 \\
0 & 0 & 1
\end{bmatrix}
\begin{bmatrix}
1 & 0 & 0 \\
0 & \cos\theta & \sin\theta & 0 \\
0 & -\sin\theta & \cos\theta & 0 
\end{bmatrix}
\begin{bmatrix}
\cos\phi & \sin\phi & 0 \\
-\sin\phi & \cos\phi & 0 \\
0 & 0 & 1
\end{bmatrix}
\begin{bmatrix}
x \\
y \\
z
\end{bmatrix}
\end{equation}

Let's introduce some notation and write this as

\begin{equation}\label{eqn:classicalMechanicsEulerAngles:100}
B_z(\alpha)
=
\begin{bmatrix}
\cos\alpha & \sin\alpha & 0 \\
-\sin\alpha & \cos\alpha & 0 \\
0 & 0 & 1
\end{bmatrix}
\end{equation}

\begin{equation}\label{eqn:classicalMechanicsEulerAngles:120}
B_x(\theta) =
\begin{bmatrix}
1 & 0 & 0 \\
0 & \cos\theta & \sin\theta & 0 \\
0 & -\sin\theta & \cos\theta & 0 
\end{bmatrix}
\end{equation}

so that we have the mapping

\begin{equation}\label{eqn:classicalMechanicsEulerAngles:140}
\Br \rightarrow B_z(\psi) B_x(\theta) B_z(\phi) \Br
\end{equation}

Now let's write

\begin{equation}\label{eqn:classicalMechanicsEulerAngles:160}
\Br = 
\begin{bmatrix}
x_1 \\
x_2 \\
x_3
\end{bmatrix}
\end{equation}

We'll call

\begin{equation}\label{eqn:classicalMechanicsEulerAngles:180}
A(\psi, \theta, \phi) = B_z(\psi) B_x(\theta) B_z(\phi) 
\end{equation}

so that

\begin{equation}\label{eqn:classicalMechanicsEulerAngles:200}
x_i' = \sum_{j = 1}^3 A_{ij} x_j.
\end{equation}

We'll drop the explicit summation sign, so that the summation over repeated indexes are implied

\begin{equation}\label{eqn:classicalMechanicsEulerAngles:220}
x_i' = A_{ij} x_j.
\end{equation}

This matrix $A(\psi, \theta, \phi)$ is in fact a general parameterization of the $3 \times 3$ special orthogonal matrices. The set of three angles $\theta$, $\phi$, $\psi$ parameterizes all rotations in 3dd space.  Transformations that preserve $\Ba \cdot \Bb$ and have unit determinant.

In symbols we must have

\begin{equation}\label{eqn:classicalMechanicsEulerAngles:240}
A^\T A = 1
\end{equation}
\begin{equation}\label{eqn:classicalMechanicsEulerAngles:260}
\det A = +1.
\end{equation}

Having solved this auxiliary problem, we now want to compute the angular velocity.

We want to know how to express the coordinates of a point that is fixed in the body.  i.e. We are fixing $x_i'$ and now looking for $x_i$.

The coordinates of a point that has $x'$, $y'$ and $z'$ in a body-fixed frame, in the fixed frame are $x$, $y$, $z$.  That is given by just inverting the matrix

\begin{align*}
\begin{bmatrix}
x_1 \\
x_2 \\
x_3
\end{bmatrix}
&=
A^{-1}(\psi, \theta, \phi)
\begin{bmatrix}
x_1' \\
x_2' \\
x_3'
\end{bmatrix} \\
&=
B_z^{-1}(\phi)
B_x^{-1}(\theta)
B_z^{-1}(\psi)
\begin{bmatrix}
x_1' \\
x_2' \\
x_3'
\end{bmatrix} \\
&=
B_z^{\T}(\phi)
B_x^{\T}(\theta)
B_z^{\T}(\psi)
\begin{bmatrix}
x_1' \\
x_2' \\
x_3'
\end{bmatrix}
\end{align*}

Here we've used the fact that $B_x$ and $B_z$ are orthogonal, so that their inverses are just their transposes.

We have finally

\begin{equation}\label{eqn:classicalMechanicsEulerAngles:280}
\begin{bmatrix}
x_1 \\
x_2 \\
x_3
\end{bmatrix}
=
B_z(-\phi)
B_x(-\theta)
B_z(-\psi)
\begin{bmatrix}
x_1' \\
x_2' \\
x_3'
\end{bmatrix} 
\end{equation}

If we assume that $\psi$, $\theta$ and $\phi$ are functions of time, and compute $d \Br/dt$.  Starting with

\begin{equation}\label{eqn:classicalMechanicsEulerAngles:300}
x_i = [A^{-1}(\phi, \theta, \psi)]_{ij} x_j',
\end{equation}


\begin{equation}\label{eqn:classicalMechanicsEulerAngles:320}
\Delta x_i = 
\left(
[A^{-1}(\phi + \Delta \phi, \theta + \Delta \theta, \psi + \Delta \psi)]_{ij} 
-[A^{-1}(\phi, \theta, \psi)]_{ij} 
\right)
x_j'.
\end{equation}

For small changes, we can Taylor expand and retain only the first order terms.  Doing that and dividing by $\Delta t$ we have

\begin{equation}\label{eqn:classicalMechanicsEulerAngles:340}
\frac{d x_i}{dt} =
\left(
\PD{\psi}{} A^{-1}_{ij} \dot{\psi}
+\PD{\theta}{} A^{-1}_{ij} \dot{\theta}
+\PD{\phi}{} A^{-1}_{ij} \dot{\phi}
\right) x_j'
\end{equation}

Now, we use

\begin{equation}\label{eqn:classicalMechanicsEulerAngles:360}
x_j' = A_{jl} x_l,
\end{equation}

so that we have

\begin{equation}\label{eqn:classicalMechanicsEulerAngles:380}
\frac{d x_i}{dt} =
\left(
\left(\PD{\psi}{} A^{-1}_{ij} \right) A_{jl} \dot{\psi}
+\left(\PD{\theta}{} A^{-1}_{ij} \right) A_{jl} \dot{\theta}
+\left(\PD{\phi}{} A^{-1}_{ij} \right) A_{jl} \dot{\phi}
\right) x_l.
\end{equation}

We are looking for a relation of the form

\begin{equation}\label{eqn:classicalMechanicsEulerAngles:400}
\frac{d\Br}{dt} = \BOmega \cross \Br.
\end{equation}

We can write this as

\begin{equation}\label{eqn:classicalMechanicsEulerAngles:420}
\begin{bmatrix}
v_x \\
v_y \\
v_z
\end{bmatrix} 
=
\left(
\thetadot \PD{\theta}{A^{-1}} A
+\phidot \PD{\phi}{A^{-1}} A
+\psidot \PD{\psi}{A^{-1}} A
\right)
\begin{bmatrix}
x \\
y \\
z
\end{bmatrix} 
\end{equation}

Actually doing this calculation is asked of us in HW6.  The final answer is

\begin{equation}\label{eqn:classicalMechanicsEulerAngles:440}
\frac{d x_i}{dt} = \left(
\phidot \epsilon_{ijk} j_n^\phi
+\thetadot \epsilon_{ijk} j_n^\theta
+\psidot \epsilon_{ijk} j_n^\psi
\right) x_j.
\end{equation}

Here $\epsilon_{ijk}$ is the usual fully antisymmetric tensor with properties

\begin{equation}\label{eqn:classicalMechanicsEulerAngles:460}
\epsilon_{ijk} =
\left\{
\begin{array}{l l}
0 & \quad \mbox{when any of the indexes are equal.} \\
1 & \quad \mbox{for any of $ijk = 123, 231, 312$ (cyclic permutations of $123$.} \\
-1 & \quad \mbox{for any of $ijk = 213, 132, 321$.} \\
\end{array}
\right.
\end{equation}

%\EndArticle
\EndNoBibArticle
