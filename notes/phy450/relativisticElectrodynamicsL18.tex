%\input{../peeter_prologue_print.tex}
%\input{../peeter_prologue_widescreen.tex}

\chapter{Green's function solution to Maxwell's equation.  Lienard-Wiechert potentials.}
\label{chap:relativisticElectrodynamicsL18}
%\useCCL
\blogpage{http://sites.google.com/site/peeterjoot/math2011/relativisticElectrodynamicsL18.pdf}
\date{Mar 9, 2011}
\revisionInfo{relativisticElectrodynamicsL18.tex}

%\beginArtWithToc
\beginArtNoToc

\section{Reading.}

Covering chapter 8 material from the text \citep{landau1980classical}.

Covering \href{http://www.physics.utoronto.ca/~poppitz/epoppitz/PHY450_files/RelEMpp136-146.pdf}{lecture notes pp. 136-146}: continued reminder of electrostatic Green's function (136); the retarded Green's function of the d'Alembert operator: derivation and properties (137-140); the solution of the d'Alembert equation with a source: retarded potentials (141-142); retarded time.

\section{Solving the forced wave equation.}

See the notes for a complex variables and Fourier transform method of deriving the Green's function.  In class, we'll just pull it out of a magic hat.  We wish to solve

\begin{equation}\label{eqn:relativisticElectrodynamicsL18:10}
\square A^k = \partial_i \partial^i A^k = \frac{4 \pi}{c} j^k
\end{equation}

(with a $\partial_i A^i = 0$ gauge choice).

Our Green's method utilizes

\begin{equation}\label{eqn:relativisticElectrodynamicsL18:30}
\square_{(\Bx, t)} G(\Bx - \Bx', t - t') = \delta^3( \Bx - \Bx') \delta( t - t')
\end{equation}

If we know such a function, our solution is simple to obtain

\begin{equation}\label{eqn:relativisticElectrodynamicsL18:50}
A^k(\Bx, t)
= \int d^3 \Bx' dt' \frac{4 \pi}{c} j^k(\Bx', t') G(\Bx - \Bx', t - t')
\end{equation}

Proof:
\begin{align*}
\square_{(\Bx, t)} A^k(\Bx, t)
&=
\int d^3 \Bx' dt' \frac{4 \pi}{c} j^k(\Bx', t')
\square_{(\Bx, t)}
G(\Bx - \Bx', t - t') \\
&=
\int d^3 \Bx' dt' \frac{4 \pi}{c} j^k(\Bx', t')
\delta^3( \Bx - \Bx') \delta( t - t') \\
&=
\frac{4 \pi}{c} j^k(\Bx, t)
\end{align*}

Claim:

\begin{equation}\label{eqn:relativisticElectrodynamicsL18:70}
G(\Bx, t) = \frac{\delta(t - \Abs{\Bx}/c)}{4 \pi \Abs{\Bx} }
\end{equation}

This is the retarded Green's function of the operator $\square$, where

\begin{equation}\label{eqn:relativisticElectrodynamicsL18:90}
\square G(\Bx, t) = \delta^3(\Bx) \delta(t)
\end{equation}

\subsection{Proof of the d'Alembertian Green's function}

Our Prof is excellent at motivating any results that he pulls out of magic hats.  He's said that he's included a derivation using Fourier transforms and tricky contour integration arguments in the class notes for anybody who is interested (and for those who also know how to do contour integration).  For those who don't know contour integration yet (some people are taking it concurrently), one can actually prove this by simply applying the wave equation operator to this function.  This treats the delta function as a normal function that one can take the derivatives of, something that can be well defined in the context of generalized functions.  Chugging ahead with this approach we have

\begin{equation}\label{eqn:relativisticElectrodynamicsL18:110}
\square G(\Bx, t)
=
\left(\inv{c^2} \PDSq{t}{} - \Delta\right)
\frac{\delta\left(t - \frac{\Abs{\Bx}}{c}\right)}{4 \pi \Abs{\Bx} }
=
\frac{\delta''\left(t - \frac{\Abs{\Bx}}{c}\right)}{4 \pi c^2 \Abs{\Bx} }
- \Delta \frac{\delta\left(t - \frac{\Abs{\Bx}}{c}\right)}{4 \pi \Abs{\Bx} }.
\end{equation}

This starts things off and now things get a bit hairy.  It's helpful to consider a chain rule expansion of the Laplacian

\begin{align*}
\Delta (u v)
&=
\partial_{\alpha\alpha} (u v) \\
&=
\partial_{\alpha} (
v \partial_\alpha u
+ u\partial_\alpha v
) \\
&=
(\partial_\alpha v) (\partial_\alpha u ) + v \partial_{\alpha\alpha} u
+(\partial_\alpha u) (\partial_\alpha v ) + u \partial_{\alpha\alpha} v
).
\end{align*}

In vector form this is

\begin{equation}\label{eqn:relativisticElectrodynamicsL18:130}
\Delta (u v) = u \Delta v + 2 (\spacegrad u) \cdot (\spacegrad v) + v \Delta u.
\end{equation}

Applying this to the Laplacian portion of \ref{eqn:relativisticElectrodynamicsL18:110} we have

\begin{equation}\label{eqn:relativisticElectrodynamicsL18:131}
\Delta \frac{\delta\left(t - \frac{\Abs{\Bx}}{c}\right)}{4 \pi \Abs{\Bx} }
=
\delta\left(t - \frac{\Abs{\Bx}}{c}\right)
\Delta
\inv{4 \pi \Abs{\Bx} }
+\left(\spacegrad \inv{2 \pi \Abs{\Bx} }\right)
\cdot
\left(
\spacegrad
\delta\left(t - \frac{\Abs{\Bx}}{c}\right) \right)
+
\inv{4 \pi \Abs{\Bx} }
\Delta
\delta\left(t - \frac{\Abs{\Bx}}{c}\right).
\end{equation}

Here we make the identification

\begin{equation}\label{eqn:relativisticElectrodynamicsL18:132}
\Delta \inv{4 \pi \Abs{\Bx} } = - \delta^3(\Bx).
\end{equation}

This could be considered a given from our knowledge of electrostatics, but it's not too much work to just do so.

\subsubsection{An aside.  Proving the Laplacian Green's function.}

If $-1/{4 \pi \Abs{\Bx} }$ is a Green's function for the Laplacian, then the Laplacian of the convolution of this with a test function should recover that test function

\begin{equation}\label{eqn:relativisticElectrodynamicsL18:133}
\Delta \int d^3 \Bx' \left(-\inv{4 \pi \Abs{\Bx - \Bx'} } \right) f(\Bx') = f(\Bx).
\end{equation}

We can directly evaluate the LHS of this equation, following the approach in \citep{schwartz1987pe}.  First note that the Laplacian can be pulled into the integral and operates only on the presumed Green's function.  For that operation we have

\begin{equation}\label{eqn:relativisticElectrodynamicsL18:134}
\Delta \left(-\inv{4 \pi \Abs{\Bx - \Bx'} } \right)
=
-\inv{4 \pi} \spacegrad \cdot \spacegrad \Abs{\Bx - \Bx'}.
\end{equation}

It will be helpful to compute the gradient of various powers of $\Abs{\Bx}$

\begin{align*}
\spacegrad \Abs{\Bx}^a
&=
e_\alpha \partial_\alpha (x^\beta x^\beta)^{a/2} \\
&=
e_\alpha \left(\frac{a}{2}\right) 2 x^\beta {\delta_\beta}^\alpha \Abs{\Bx}^{a - 2}.
\end{align*}

In particular we have, when $\Bx \ne 0$, this gives us

\begin{align}\label{eqn:relativisticElectrodynamicsL18:135}
\spacegrad \Abs{\Bx} &= \frac{\Bx}{\Abs{\Bx}} \\
\spacegrad \inv{\Abs{\Bx}} &= -\frac{\Bx}{\Abs{\Bx}^3} \\
\spacegrad \inv{\Abs{\Bx}^3} &= -3 \frac{\Bx}{\Abs{\Bx}^5}.
\end{align}

For the Laplacian of $1/\Abs{\Bx}$, at the points $\Be \ne 0$ where this is well defined we have

\begin{align*}
\Delta \inv{\Abs{\Bx}} 
&=
\spacegrad \cdot \spacegrad \inv{\Abs{\Bx}} \\
&= 
-\partial_\alpha \frac{x^\alpha}{\Abs{\Bx}^3} \\
&= 
-\frac{3}{\Abs{\Bx}^3} 
- x^\alpha \partial_\alpha \frac{1}{\Abs{\Bx}^3} \\
&= 
-\frac{3}{\Abs{\Bx}^3} 
- \Bx \cdot \spacegrad \frac{1}{\Abs{\Bx}^3} \\
&= 
-\frac{3}{\Abs{\Bx}^3} 
+ 3 \frac{\Bx^2}{\Abs{\Bx}^5}
\end{align*}

So we have a zero.  This means that the Laplacian operation 

\begin{equation}\label{eqn:relativisticElectrodynamicsL18:300}
\Delta \int d^3 \Bx' \inv{\Abs{\Bx - \Bx'} } f(\Bx') 
=
\lim_{\epsilon = \Abs{\Bx -\Bx'} \rightarrow 0}
f(\Bx) \int d^3 \Bx' \Delta \inv{\Abs{\Bx - \Bx'}},
\end{equation}

can only have a value in a neighborhood of point $\Bx$.  Writing $\Delta = \spacegrad \cdot \spacegrad$ we have

\begin{equation}\label{eqn:relativisticElectrodynamicsL18:320}
\Delta \int d^3 \Bx' \inv{\Abs{\Bx - \Bx'} } f(\Bx') 
=
\lim_{\epsilon = \Abs{\Bx -\Bx'} \rightarrow 0}
f(\Bx) \int d^3 \Bx' \spacegrad \cdot -\frac{\Bx - \Bx'}{\Abs{\Bx - \Bx'}}.
\end{equation}

Observing that $\spacegrad \cdot f(\Bx -\Bx') = -\spacegrad' f(\Bx - \Bx')$ we can put this in a form that allows for use of Stokes theorem so that we can convert this to a surface integral

\begin{align*}
\Delta \int d^3 \Bx' \inv{\Abs{\Bx - \Bx'} } f(\Bx') 
&=
\lim_{\epsilon = \Abs{\Bx -\Bx'} \rightarrow 0}
f(\Bx) \int d^3 \Bx' \spacegrad' \cdot \frac{\Bx - \Bx'}{\Abs{\Bx - \Bx'}^3} \\
&=
\lim_{\epsilon = \Abs{\Bx -\Bx'} \rightarrow 0}
f(\Bx) \int d^2 \Bx' \Bn \cdot \frac{\Bx - \Bx'}{\Abs{\Bx - \Bx'}^3} \\
&= \int_{\phi=0}^{2\pi} \int_{\theta = 0}^\pi \epsilon^2 \sin\theta d\theta d\phi 
\frac{\Bx' - \Bx}{\Abs{\Bx - \Bx'}} \cdot \frac{\Bx - \Bx'}{\Abs{\Bx - \Bx'}^3} \\
&= -\int_{\phi=0}^{2\pi} \int_{\theta = 0}^\pi \epsilon^2 \sin\theta d\theta d\phi \frac{\epsilon^2}{\epsilon^4}
\end{align*}

where we use $(\Bx' - \Bx)/\Abs{\Bx' - \Bx}$ as the outwards normal for a sphere centered at $\Bx$ of radius $\epsilon$.  This integral is just $-4 \pi$, so we have

\begin{equation}\label{eqn:relativisticElectrodynamicsL18:360}
\Delta \int d^3 \Bx' \inv{-4 \pi \Abs{\Bx - \Bx'} } f(\Bx') 
=
f(\Bx).
\end{equation}

The convolution of $f(\Bx)$ with $-\Delta/4 \pi \Abs{\Bx}$ produces $f(\Bx)$, allowing an identification of this function with a delta function, since the two have the same operational effect
\begin{equation}\label{eqn:relativisticElectrodynamicsL18:380}
\int d^3 \Bx' \delta(\Bx - \Bx') f(\Bx') 
=
f(\Bx).
\end{equation}

\subsubsection{Returning to the d'Alembertian Green's function.}

We need two additional computations to finish the job.  The first is the gradient of the delta function

\begin{align*}
\spacegrad \delta\left(t - \frac{\Abs{\Bx}}{c}\right) &= ? \\
\Delta \delta\left(t - \frac{\Abs{\Bx}}{c}\right) &= ?
\end{align*}

Consider $\spacegrad f(g(\Bx))$.  This is

\begin{align*}
\spacegrad f(g(\Bx))
&=
e_\alpha \PD{x^\alpha}{f(g(\Bx))} \\
&=
e_\alpha \PD{g}{f} \PD{x^\alpha}{g},
\end{align*}

so we have
\begin{equation}\label{eqn:relativisticElectrodynamicsL18:400}
\spacegrad f(g(\Bx))
=
\PD{g}{f} \spacegrad g.
\end{equation}

The Laplacian is similar

\begin{align*}
\Delta f(g)
&= 
\spacegrad \cdot \left(\PD{g}{f} \spacegrad g \right) \\
&= 
\partial_\alpha \left(\PD{g}{f} \partial_\alpha g \right) \\
&= 
\left( \partial_\alpha \PD{g}{f} \right) \partial_\alpha g 
+\PD{g}{f} \partial_{\alpha\alpha} g  \\
&= 
\PDSq{g}{f} \left( \partial_\alpha g \right) (\partial_\alpha g)
+\PD{g}{f} \Delta g,
\end{align*}

so we have

\begin{equation}\label{eqn:relativisticElectrodynamicsL18:420}
\Delta f(g)
= 
\PDSq{g}{f} (\spacegrad g)^2 +\PD{g}{f} \Delta g
\end{equation}

With $g(\Bx) = \Abs{\Bx}$, we'll need the Laplacian of this vector magnitude

\begin{align*}
\Delta \Abs{\Bx}
&=
\partial_\alpha \frac{x_\alpha}{\Abs{\Bx}} \\
&=
\frac{3}{\Abs{\Bx}} 
+ x_\alpha \partial_\alpha (x^\beta x^\beta)^{-1/2} \\
&=
\frac{3}{\Abs{\Bx}} 
- \frac{x_\alpha x_\alpha}{\Abs{\Bx}^3} \\
&= \frac{2}{\Abs{\Bx}} 
\end{align*}

So that we have

\begin{align}\label{eqn:relativisticElectrodynamicsL18:440}
\spacegrad \delta\left(t - \frac{\Abs{\Bx}}{c}\right) &= 
-\inv{c} \delta'\left(t - \frac{\Abs{\Bx}}{c}\right) \frac{\Bx}{\Abs{\Bx}} \\
\Delta \delta\left(t - \frac{\Abs{\Bx}}{c}\right) &=
\inv{c^2} \delta''\left(t - \frac{\Abs{\Bx}}{c}\right) -\inv{c} \delta'\left(t - \frac{\Abs{\Bx}}{c}\right) \frac{2}{\Abs{\Bx}} 
\end{align}

Now we have all the bits and pieces of \ref{eqn:relativisticElectrodynamicsL18:131} ready to assemble

\begin{align*}
\Delta \frac{\delta\left(t - \frac{\Abs{\Bx}}{c}\right)}{4 \pi \Abs{\Bx} }
&=
-\delta\left(t - \frac{\Abs{\Bx}}{c}\right) \delta^3(\Bx) \\
&\quad +\inv{2\pi} \left( - \frac{\Bx}{\Abs{\Bx}^3} \right)
\cdot
-\inv{c} \delta'\left(t - \frac{\Abs{\Bx}}{c}\right) \frac{\Bx}{\Abs{\Bx}} \\
&\quad +
\inv{4 \pi \Abs{\Bx} }
\left(
\inv{c^2} \delta''\left(t - \frac{\Abs{\Bx}}{c}\right) -\inv{c} \delta'\left(t - \frac{\Abs{\Bx}}{c}\right) \frac{2}{\Abs{\Bx}} \right) \\
&=
-\delta\left(t - \frac{\Abs{\Bx}}{c}\right) \delta^3(\Bx) 
+\inv{4 \pi \Abs{\Bx} c^2 }
\delta''\left(t - \frac{\Abs{\Bx}}{c}\right) 
\end{align*}

Since we also have

\begin{equation}\label{eqn:relativisticElectrodynamicsL18:500}
\inv{c^2} \partial_{tt}
\frac{\delta\left(t - \frac{\Abs{\Bx}}{c}\right)}{4 \pi \Abs{\Bx} }
=
\frac{\delta''\left(t - \frac{\Abs{\Bx}}{c}\right)}{4 \pi \Abs{\Bx} c^2}
\end{equation}

The $\delta''$ terms cancel out in the d'Alembertian, leaving just

\begin{equation}\label{eqn:relativisticElectrodynamicsL18:460}
\square \frac{\delta\left(t - \frac{\Abs{\Bx}}{c}\right)}{4 \pi \Abs{\Bx} }
=
\delta\left(t - \frac{\Abs{\Bx}}{c}\right) \delta^3(\Bx) 
\end{equation}

Noting that the spatial delta function is non-zero only when $\Bx = 0$, which means $\delta(t - \Abs{\Bx}/c) = \delta(t)$ in this product, and we finally have

\begin{equation}\label{eqn:relativisticElectrodynamicsL18:480}
\square \frac{\delta\left(t - \frac{\Abs{\Bx}}{c}\right)}{4 \pi \Abs{\Bx} }
=
\delta(t) \delta^3(\Bx) 
\end{equation}

We write

\begin{equation}\label{eqn:relativisticElectrodynamicsL18:520}
G(\Bx, t) = \frac{\delta\left(t - \frac{\Abs{\Bx}}{c}\right)}{4 \pi \Abs{\Bx} },
\end{equation}

\section{Elaborating on the wave equation Green's function}

The Green's function \ref{eqn:relativisticElectrodynamicsL18:520} is a distribution that is non-zero only on the future lightcone.  Observe that for $t < 0$ we have

\begin{align*}
\delta\left(t - \frac{\Abs{\Bx}}{c}\right)
&=
\delta\left(-\Abs{t} - \frac{\Abs{\Bx}}{c}\right) \\
&= 0.
\end{align*}

We say that $G$ is supported only on the future light cone.  At $\Bx = 0$, only the contributions for $t > 0$ matter.  Note that in the ``old days'', Green's functions used to be called influence functions, a name that works particularly well in this case.  We have other Green's functions for the d'Alembertian.  The one above is called the retarded Green's functions and we also have an advanced Green's function.  Writing $+$ for advanced and $-$ for retarded these are

\begin{equation}\label{eqn:relativisticElectrodynamicsL18:600}
G_{\pm} = 
\frac{\delta\left(t \pm \frac{\Abs{\Bx}}{c}\right)}{4 \pi \Abs{\Bx}}
\end{equation}

There are also causal and non-causal variations that won't be of interest for this course.

This arms us now to solve any problem in the Lorentz gauge

\begin{equation}\label{eqn:relativisticElectrodynamicsL18:620}
A^k(\Bx, t) = \inv{c} \int d^3 \Bx' dt' 
\frac{\delta\left(t - t' - \frac{\Abs{\Bx -\Bx'}}{c}\right)}{4 \pi \Abs{\Bx - \Bx'}}
j^k(\Bx', t')
+\text{An arbitrary collection of EM waves.}
\end{equation}

The additional EM waves are the possible contributions from the homogeneous equation.

Since $\delta(t - t' - \Abs{\Bx -\Bx'}/c)$ is non-zero only when $t' = t - \Abs{\Bx -\Bx'}/c)$, the non-homogeneous parts of \ref{eqn:relativisticElectrodynamicsL18:620} reduce to

\begin{equation}\label{eqn:relativisticElectrodynamicsL18:625}
A^k(\Bx, t) = \inv{c} \int d^3 \Bx' 
\frac{j^k(\Bx', t - \Abs{\Bx - \Bx'}/c)}{4 \pi \Abs{\Bx - \Bx'}}.
\end{equation}

Our potentials at time $t$ and spatial position $\Bx$ are completely specified in terms of the sums of the currents acting at the retarded time $t - \Abs{\Bx - \Bx'}/c$.  The field can only depend on the charge and current distribution in the past.  Specifically, it can only depend on the charge and current distribution on the past light cone of the spacetime point at which we measure the field.

\section{Example of the Green's function.  Consider a charged particle moving on a worldline}

\begin{equation}\label{eqn:relativisticElectrodynamicsL18:150}
(c t, \Bx_c(t))
\end{equation}

($c$ for classical)

For this particle

\begin{align}\label{eqn:relativisticElectrodynamicsL18:170}
\rho(\Bx, t) &= e \delta^3(\Bx - \Bx_c(t)) \\
\Bj(\Bx, t) &= e \dot{\Bx}_c(t) \delta^3(\Bx - \Bx_c(t))
\end{align}

\begin{align*}
\begin{bmatrix}
A^0(\Bx, t) \\
\BA(\Bx, t)
\end{bmatrix}
&=
\inv{c}
\int d^3 \Bx' dt'
\frac{ \delta( t - t' - \Abs{\Bx - \Bx'}/c }{\Abs{\Bx - \Bx'}}
\begin{bmatrix}
c e \\
e \dot{\Bx}_c(t)
\end{bmatrix}
\delta^3(\Bx - \Bx_c(t)) \\
&=
\int_{-\infty}^\infty
\frac{ \delta( t - t' - \Abs{\Bx - \Bx_c(t')}/c }{\Abs{\Bx_c(t') - \Bx}}
\begin{bmatrix}
e \\
e \frac{\dot{\Bx}_c(t)}{c}
\end{bmatrix}
\end{align*}

PICTURE: light cones, and curved worldline.  Pick an arbitrary point $(\Bx_0, t_0)$, and draw the past light cone, looking at where this intersects with the trajectory

For the arbitrary point $(\Bx_0, t_0)$ we see that this point and the retarded time $(\Bx_c(t_r), t_r)$ obey the relation

\begin{equation}\label{eqn:relativisticElectrodynamicsL18:190}
c (t_0 - t_r) = \Abs{\Bx_0 - \Bx_c(t_r)}
\end{equation}

This retarded time is unique.  There is only one such intersection.

Our job is to calculate

\begin{equation}\label{eqn:relativisticElectrodynamicsL18:210}
\int_{-\infty}^\infty \delta(f(x)) g(x) = \frac{g(x_\conj)}{\Abs{f'(x_\conj)}}
\end{equation}

where $f(x_\conj) = 0$.

\begin{equation}\label{eqn:relativisticElectrodynamicsL18:230}
f(t') = t - t' - \Abs{\Bx - \Bx_c(t')}/c
\end{equation}

\begin{align*}
\PD{t'}{f}
&= -1 - \inv{c} \PD{t'}{} \sqrt{ (\Bx - \Bx_c(t')) \cdot (\Bx - \Bx_c(t')) } \\
&= -1 + \inv{c} \frac{(\Bx - \Bx_c(t')) \cdot \Bv_c(t')}{\Abs{\Bx - \Bx_c(t')}} 
\end{align*}

This is with

\begin{equation}\label{eqn:relativisticElectrodynamicsL18:700}
\Bv_c = \PD{t'}{\Bx_c}.
\end{equation}

Putting things back together, the potentials due to a moving charge are 

\begin{align*}
\begin{bmatrix}
A^0(\Bx, t) \\
\BA(\Bx, t)
\end{bmatrix}
&=
e \inv{\Abs{\Bx_c(t_r) - \Bx}}
\begin{bmatrix}
1 \\
\frac{\Bv_c}{c}
\end{bmatrix}
\inv{\Abs{
-1 + \inv{c} \frac{(\Bx - \Bx_c(t_r)) \cdot \Bv_c(t_r)}{\Abs{\Bx - \Bx_c(t_r)}} 
}
} \\
&=
e 
%\inv{\Abs{\Bx_c(t_r) - \Bx}}
\begin{bmatrix}
1 \\
\frac{\Bv_c}{c}
\end{bmatrix}
\inv{\Abs{
\Abs{\Bx - \Bx_c(t_r)} - (\Bx - \Bx_c(t_r)) \cdot \Bv_c(t_r)/c
} }
\end{align*}

Provided $\Abs{\Bx - \Bx_c} > (\Bx - \Bx_c(t_r)) \cdot \Bv_c(t_r)/c$, we have the Lienard-Wiechert potentials.

\begin{equation}\label{eqn:relativisticElectrodynamicsL18:720}
\begin{bmatrix}
A^0(\Bx, t) \\
\BA(\Bx, t)
\end{bmatrix}
=
e 
%\inv{\Abs{\Bx_c(t_r) - \Bx}}
\begin{bmatrix}
1 \\
\frac{\Bv_c}{c}
\end{bmatrix}
\inv{
\Abs{\Bx - \Bx_c} - (\Bx - \Bx_c(t_r)) \cdot \Bv_c(t_r)/c }
\end{equation}

FIXME: Where provides the previous inequality required to get to this final point.

\EndArticle
