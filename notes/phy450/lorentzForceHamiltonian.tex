%\input{../peeter_prologue_print.tex}
%\input{../peeter_prologue_widescreen.tex}

\chapter{Energy term of the Lorentz force equation.}
\label{chap:lorentzForceHamiltonian}
%\useCCL
\blogpage{http://sites.google.com/site/peeterjoot/math2011/lorentzForceHamiltonian.pdf}
\date{Feb 6, 2011}
\revisionInfo{lorentzForceHamiltonian.tex}

\beginArtWithToc
%\beginArtNoToc

\section{Motivation.}

In class this week, the Lorentz force was derived from an action (the simplest Lorentz invariant, gauge invariant, action that could be constructed)

\begin{equation}\label{eqn:lorentzForceHamiltonian:10}
S = - m c \int ds - \frac{e}{c} \int ds A^i u_i.
\end{equation}

We end up with the familiar equation, with the exception that the momentum includes the relativistically required gamma factor

\begin{equation}\label{eqn:lorentzForceHamiltonian:20}
\frac{d (\gamma m \Bv)}{dt} = e \left( \BE + \frac{\Bv}{c} \cross \BB \right).
\end{equation}

I asked what the energy term of this equation would be and was answered that we would get to it, and it could be obtained by a four vector minimization of the action which produces the Lorentz force equation of the following form

\begin{equation}\label{eqn:lorentzForceHamiltonian:30}
\frac{du^i}{d\tau} \sim e F^{ij} u_j.
\end{equation}

Let's see if we can work this out without the four-vector approach, using the action expressed with an explicit space time split, then also work it out in the four vector form and compare as a consistency check.

\section{Three vector approach.}
\subsection{The Lorentz force derivation.}

For completeness, let's work out the Lorentz force equation from the action \ref{eqn:lorentzForceHamiltonian:10}.  Parameterizing by time we have

\begin{align*}
S 
&= -m c^2 \int dt \InvGamma - e \int dt \InvGamma \gamma \left( 1, \inv{c} \Bv\right) \cdot (\phi, \BA) \\
&= -m c^2 \int dt \InvGamma - e \int dt \left( \phi - \inv{c} \BA \cdot \Bv \right)
\end{align*}

Our Lagrangian is therefore

\begin{equation}\label{eqn:lorentzForceHamiltonian:31}
\LL(\Bx, \Bv, t) = 
-m c^2 \InvGamma - e \phi(\Bx, t) + \frac{e}{c} \BA(\Bx, t) \cdot \Bv
\end{equation}

We can calculate our conjugate momentum easily enough

\begin{equation}\label{eqn:lorentzForceHamiltonian:40}
\PD{\Bv}{\LL} = \gamma m \Bv + \frac{e}{c} \BA,
\end{equation}

and for the gradient portion of the Euler-Lagrange equations we have

\begin{equation}\label{eqn:lorentzForceHamiltonian:60}
\PD{\Bx}{\LL} = -e \spacegrad \phi + e \spacegrad \left( \frac{\Bv}{c} \cdot \BA \right).
\end{equation}

Utilizing the convective derivative (i.e. chain rule in fancy clothes) 

\begin{equation}\label{eqn:lorentzForceHamiltonian:80}
\frac{d}{dt} = \Bv \cdot \spacegrad + \PD{t}{}.
\end{equation}

This gives us

\begin{equation}\label{eqn:lorentzForceHamiltonian:100}
-e \spacegrad \phi + e \spacegrad \left( \frac{\Bv}{c} \cdot \BA \right) = 
\frac{d(\gamma m \Bv)}{dt} 
+ \frac{e}{c} (\Bv \cdot \spacegrad) \BA
+ \frac{e}{c} \PD{t}{\BA},
\end{equation}

and a final bit of rearranging gives us

\begin{equation}\label{eqn:lorentzForceHamiltonian:120}
\frac{d(\gamma m \Bv)}{dt} =
e \left( -\spacegrad \phi - \inv{c} \PD{t}{\BA}
\right)
+ \frac{e}{c} \left( 
\spacegrad \left( \Bv \cdot \BA \right) - (\Bv \cdot \spacegrad) \BA
\right).
\end{equation}

The first set of derivatives we identify with the electric field $\BE$.  For the second, utilizing the \href{http://en.wikipedia.org/wiki/Triple_product#Vector_triple_product}{vector triple product identity} \citep{wiki:tripleProduct}

\begin{equation}\label{eqn:lorentzForceHamiltonian:140}
\Ba \cross (\Bb \cross \Bc) = \Bb (\Ba \cdot \Bc) - (\Ba \cdot \Bb) \Bc,
\end{equation}

we recognize as related to the magnetic field $\Bv \cross \BB = \Bv \cross (\spacegrad \cross \BA)$.

\subsection{The power (energy) term.}

When we start with an action explicitly constructed with Lorentz invariance as a requirement, it is somewhat odd to end up with a result that has only the spatial vector portion of what should logically be a four vector result.  We have an equation for the particle momentum, but not one for the energy.  In tutorial Simon provided the hint of how to approach this, and asked if we had calculated the Hamiltonian for the Lorentz force.   We had only calculated the Hamiltonian for the free particle.

Considering this, we can only actually calculate a Hamiltonian for the case where $\phi(\Bx, t) = \phi(\Bx)$ and $\BA(\Bx, t) = \BA(\Bx)$, because when the potentials have any sort of time dependence we do not have a Lagrangian that is invariant under time translation.  Returning to the derivation of the Hamiltonian conservation equation, we see that we must modify the argument slightly when there is a time dependence and get instead

\begin{equation}\label{eqn:lorentzForceHamiltonian:160}
\frac{d}{dt} \left( \PD{\Bv}{\LL} \cdot \LL - \LL \right) + \PD{t}{\LL} = 0.
\end{equation}

Only when there is no time dependence in the Lagrangian, do we have our conserved quantity, what we label as energy, or Hamiltonian.

From \ref{eqn:lorentzForceHamiltonian:40}, we have

\begin{align*}
0 &= 
\frac{d}{dt} \left( 
\left( \gamma m \Bv + \frac{e}{c} \BA \right) \cdot \Bv 
+m c^2 \InvGamma + e \phi - \frac{e}{c} \BA \cdot \Bv
\right) 
- e \PD{t}{\phi} + \frac{e}{c} \PD{t}{\BA} \cdot \Bv \\
\end{align*}

Our $\BA \cdot \Bv$ terms cancel, and we can combine the $\gamma$ and $\gamma^{-1}$ terms, then apply the convective derivative again

\begin{align*}
\frac{d}{dt} \left( 
\gamma m c^2 
\right) 
&= 
- e \left( \Bv \cdot \spacegrad + \PD{t}{} \right) \phi 
+ e \PD{t}{\phi} - \frac{e}{c} \PD{t}{\BA} \cdot \Bv \\
&= 
- e \Bv \cdot \spacegrad \phi 
- \frac{e}{c} \PD{t}{\BA} \cdot \Bv \\
&= 
+ e \Bv \cdot \left( - \spacegrad \phi - \inv{c} \PD{t}{\BA} \right).
\end{align*}

This is just
\begin{equation}\label{eqn:lorentzForceHamiltonian:200}
\frac{d}{dt} \left( 
\gamma m c^2 
\right) 
= e \Bv \cdot \BE,
\end{equation}

and we find the rate of change of energy term of our four momentum equation

\begin{equation}\label{eqn:lorentzForceHamiltonian:220}
\frac{d}{dt}
\left( 
\frac{E}{c}, \Bp
\right) 
= e \left( \frac{\Bv}{c} \cdot \BE, \BE + \frac{\Bv}{c} \cross \BB \right).
\end{equation}

Specified explicitly, this is

\begin{equation}\label{eqn:lorentzForceHamiltonian:220b}
\frac{d}{dt}
\left( \gamma m \left( c, \Bv \right) \right)
= e \left( \frac{\Bv}{c} \cdot \BE, \BE + \frac{\Bv}{c} \cross \BB \right).
\end{equation}

While this was the result I was looking for, once written it now stands out as incomplete relativistically.  We have an equation that specifies the time derivative of a four vector.  What about the spatial derivatives?  We really ought to have a rank two tensor result, and not a four vector result relating the fields and the energy and momentum of the particle.  The Lorentz force equation, even when expanded to four vector form, does not seem complete relativistically.

With $u^i = dx^i/ds$, we can rewrite \ref{eqn:lorentzForceHamiltonian:220b} as

\begin{equation}\label{eqn:lorentzForceHamiltonian:230}
\partial_0 (\gamma m u^i) 
= e \left( \frac{\Bv}{c} \cdot \BE, \BE + \frac{\Bv}{c} \cross \BB \right).
\end{equation}

If we were to vary the action with respect to a spatial coordinate instead of time, we should end up with a similar equation of the form $\partial_\alpha (\gamma m u^i) = ?$.  Having been pointed at the explicitly invariant result, I wonder if those equations are independent.  Let's defer exploring this, until at least after calculating the result using a four vector form of the action.

\section{Four vector approach.}
\subsection{The Lorentz force derivation from invariant action.}

We can rewrite our action, parameterizing with proper time.  This is

\begin{equation}\label{eqn:lorentzForceHamiltonian:240}
S = -m c^2 \int d\tau \sqrt{ \frac{dx^i}{d\tau} \frac{dx_i}{d\tau} }
- \frac{e}{c} \int d\tau A_i \frac{dx^i}{d\tau}
\end{equation}

Writing $\dot{x}^i = dx^i/d\tau$, our Lagrangian is then
\begin{equation}\label{eqn:lorentzForceHamiltonian:250}
\LL(x^i, \dot{x^i}, \tau)
= -m c^2 \sqrt{ \dot{x}^i \dot{x}_i }
- \frac{e}{c} A_i \dot{x}^i
\end{equation}

The Euler-Lagrange equations take the form

\begin{equation}\label{eqn:lorentzForceHamiltonian:255}
\PD{x^i}{\LL} 
= 
\frac{d}{d\tau} \PD{\dot{x}^i}{\LL} .
\end{equation}

Our gradient and conjugate momentum are

\begin{align}\label{eqn:lorentzForceHamiltonian:260}
\PD{x^i}{\LL} 
&= - \frac{e}{c} \PD{x^i}{A_j} \dot{x}^j  \\
\PD{\dot{x}^i}{\LL}  
&= -m \dot{x}_i - \frac{e}{c} A_i.
\end{align}

With our convective derivative taking the form

\begin{equation}\label{eqn:lorentzForceHamiltonian:270}
\frac{d}{d\tau} = \dot{x}^i \PD{x^i}{},
\end{equation}

we have
\begin{align*}
m \frac{d^2 x_i}{d\tau^2} 
&= 
\frac{e}{c} \PD{x^i}{A_j} \dot{x}^j
- 
\frac{e}{c} 
\dot{x}^j 
\PD{x^j}{A_i} \\
&=
\frac{e}{c} 
\dot{x}^j \left( 
\PD{x^i}{A_j} 
-\PD{x^j}{A_i} 
\right) \\
&=
\frac{e}{c} 
\dot{x}^j \left( \partial_i A_j - \partial_j A_i
\right) \\
&=
\frac{e}{c} 
\dot{x}^j F_{ij}
\end{align*}

Our Prof wrote this with indexes raised and lowered respectively

\begin{equation}\label{eqn:lorentzForceHamiltonian:280}
m \frac{d^2 x^i}{d\tau^2} = \frac{e}{c} F^{ij} \dot{x}_j .
\end{equation}

Following the text \citep{landau1980classical} he also writes $u^i = dx^i/ds = (1/c) dx^i/d\tau$, and in that form we have

\begin{equation}\label{eqn:lorentzForceHamiltonian:290}
\frac{d (m c u^i)}{ds} = \frac{e}{c} F^{ij} u_j.
\end{equation}

\subsection{Expressed explicitly in terms of the three vector fields.}
\subsubsection{The power term.}

From \ref{eqn:lorentzForceHamiltonian:290}, lets extract the $i=0$ term, relating the rate of change of energy to the field and particle velocity.  With

\begin{equation}\label{eqn:lorentzForceHamiltonian:300}
\ddtau{} = \frac{dt}{d\tau} \frac{d}{dt} = \gamma \ddt{},
\end{equation}

we have

%\frac{d (m dx^i/d\tau)}{ds} = \frac{e}{c} F^{ij} u_j.
\begin{equation}\label{eqn:lorentzForceHamiltonian:310}
\ddt{(m \gamma \ddt{x^i})} = \frac{e}{c} F^{ij} \ddt{x_j}.
\end{equation}

For $i=0$ we have

\begin{equation}\label{eqn:lorentzForceHamiltonian:320}
F^{0j} \ddt{x_j} 
= -F^{0\alpha} \ddt{x^\alpha} 
\end{equation}

That component of the field is

\begin{align*}
F^{\alpha 0} 
&=
\partial^\alpha A^0 - \partial^0 A^\alpha \\
&=
-\PD{x^\alpha}{\phi} - \inv{c} \PD{t}{A^\alpha} \\
&= \left( -\spacegrad \phi - \inv{c} \PD{t}{\BA} \right)^\alpha.
\end{align*}

This verifies the result obtained with considerably more difficulty, using the Hamiltonian like conservation relation obtained for a time translation of a time dependent Lagrangian

\begin{equation}\label{eqn:lorentzForceHamiltonian:330}
\ddt{(m \gamma c^2 )} = e \BE \cdot \Bv.
\end{equation}

\subsubsection{The Lorentz force terms.}

Let's also verify the signs for the $i > 0$ terms.  For those we have

\begin{align*}
\ddt{(m \gamma \ddt{x^\alpha})} 
&= \frac{e}{c} F^{\alpha j} \ddt{x_j} \\
&= 
\frac{e}{c} F^{\alpha 0} \ddt{x_0}
+\frac{e}{c} F^{\alpha \beta} \ddt{x_\beta} \\
&= 
e E^\alpha
- \sum_{\alpha \beta} \frac{e}{c} \left( \partial^\alpha A^\beta - \partial^\beta A^\alpha
\right)
v^\beta \\
\end{align*}

Since we have only spatial indexes left, lets be sloppy and imply summation over all repeated indexes, even if unmatched upper and lower.  This leaves us with

\begin{align*}
-\left( \partial^\alpha A^\beta - \partial^\beta A^\alpha \right) v^\beta 
&=
\left( \partial_\alpha A^\beta - \partial_\beta A^\alpha \right) v^\beta \\
&=
\epsilon_{\alpha \beta \gamma} B^\gamma
\end{align*}

With the $v^\beta$ contraction we have

\begin{equation}\label{eqn:lorentzForceHamiltonian:370}
\epsilon_{\alpha \beta \gamma} B^\gamma v^\beta 
= (\Bv \cross \BB)^\alpha,
\end{equation}

leaving our first result obtained by the time parametrization of the Lagrangian

\begin{equation}\label{eqn:lorentzForceHamiltonian:380}
\ddt{(m \gamma \Bv)} = e \left(\BE + \frac{\Bv}{c} \cross \BB \right).
\end{equation}

This now has a nice symmetrical form.  It's slightly disappointing not to have a rank two tensor on the LHS like we have with the symmetric stress tensor with Poynting Vector and energy and other similar terms that relates field energy and momentum with $\BE \cdot \BJ$ and the charge density equivalents of the Lorentz force equation.  Is there such a symmetric relationship for particles too?

\EndArticle
