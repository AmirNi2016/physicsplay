%
% Copyright © 2013 Peeter Joot.  All Rights Reserved.
% Licenced as described in the file LICENSE under the root directory of this GIT repository.
%
%\input{../blogpost.tex}
%\renewcommand{\basename}{phaseSpaceChangeOfVarsSpherical}
%\renewcommand{\dirname}{notes/phy452/}
%\newcommand{\keywords}{Statistical mechanics, PHY452H1S, phase space, Jacobian, change of variables, spherical coordinates}
%
%\input{../peeter_prologue_print2.tex}
%
%\beginArtNoToc
%
%\generatetitle{Cartesian to spherical change of variables in 3d phase space}
%\chapter{Cartesian to spherical change of variables in 3d phase space}
%\label{chap:phaseSpaceChangeOfVarsSpherical}

\makeoproblem{Cartesian to spherical change of variables in 3d phase space}{pr:phaseSpaceChangeOfVarsSpherical:1}{\citep{pathriastatistical} problem 2.2 (a)}{
Try a spherical change of vars to verify explicitly that phase space volume is preserved.
} % makeoproblem

\makeanswer{pr:phaseSpaceChangeOfVarsSpherical:1}{
Our kinetic Lagrangian in spherical coordinates is

\begin{dmath}\label{eqn:3nParticlePhaseSpaceVolume:20}
\LL 
= \inv{2} m \lr{ \rdot \rcap + r \sin\theta \phidot \phicap + r \thetadot \thetacap}^2
= \inv{2} m \lr{ \rdot^2 + r^2 \sin^2\theta \phidot^2 + r^2 \thetadot^2 }^2
\end{dmath}

We read off our canonical momentum

\begin{subequations}
\begin{equation}\label{eqn:phaseSpaceChangeOfVars:40}
p_r = \PD{r}{\LL} = m \rdot
\end{equation}
\begin{equation}\label{eqn:phaseSpaceChangeOfVars:60}
p_\theta = \PD{\theta}{\LL} = m r^2 \thetadot
\end{equation}
\begin{equation}\label{eqn:phaseSpaceChangeOfVars:80}
p_\phi = \PD{\phi}{\LL} = m r^2 \sin^2\theta \phidot,
\end{equation}
\end{subequations}

and can now express the Hamiltonian in spherical coordinates

\begin{dmath}\label{eqn:3nParticlePhaseSpaceVolume:100}
H = \inv{2} m \lr{
\lr{\frac{p_r}{m}}^2
+ r^2 \sin^2\theta \lr{\frac{p_\phi}{m r^2 \sin^2\theta}}
+ r^2 \lr{\frac{p_\theta}{m r^2}}
}
=
\frac{p_r^2}{2m} + \frac{p_\phi^2}{2 m r^2 \sin^2\theta} + \frac{p_\theta^2}{2 m r^2}
\end{dmath}

Now we want to do a change of variables.  The coordinates transform as

\begin{subequations}
\begin{equation}\label{eqn:phaseSpaceChangeOfVars:120}
x = r \sin\theta \cos\phi
\end{equation}
\begin{equation}\label{eqn:phaseSpaceChangeOfVars:140}
y = r \sin\theta \sin\phi
\end{equation}
\begin{equation}\label{eqn:phaseSpaceChangeOfVars:160}
z = r \cos\theta,
\end{equation}
\end{subequations}

or
\begin{subequations}
\begin{equation}\label{eqn:phaseSpaceChangeOfVars:180}
r = \sqrt{x^2 + y^2 + z^2}
\end{equation}
\begin{equation}\label{eqn:phaseSpaceChangeOfVars:200}
\theta = \arccos(z/r)
\end{equation}
\begin{equation}\label{eqn:phaseSpaceChangeOfVars:220}
\phi = \arctan(y/x).
\end{equation}
\end{subequations}

It's not too hard to calculate the change of variables for the momenta (verified in \nbref{sphericalPhaseSpaceChangeOfVars.nb}).  We have

\begin{subequations}
\begin{equation}\label{eqn:phaseSpaceChangeOfVars:240}
p_r = \frac{
x p_x + y p_y + z p_z
}{\sqrt{x^2 + y^2 + z^2}}
\end{equation}
\begin{equation}\label{eqn:phaseSpaceChangeOfVars:260}
p_\theta = \frac{
(p_x x + p_y y) z - p_z (x^2 + y^2)
}{\sqrt{x^2 + y^2}}
\end{equation}
\begin{equation}\label{eqn:phaseSpaceChangeOfVars:280}
p_\phi = x p_y - y p_x
\end{equation}
\end{subequations}

Now let's compute the volume element in spherical coordinates.  This is

\begin{dmath}\label{eqn:3nParticlePhaseSpaceVolume:300}
d\omega 
= dr d\theta d\phi p_r p_\theta p_\phi
= 
\frac{\partial(r, \theta, \phi, p_r, p_\theta, p_\phi)}{\partial(x, y, z, p_x, p_y, p_z)}
dx dy dz dp_x dp_y dp_z
=
\begin{vmatrix}
 \frac{x}{\sqrt{x^2+y^2+z^2}} & \frac{y}{\sqrt{x^2+y^2+z^2}} & \frac{z}{\sqrt{x^2+y^2+z^2}} & 0 & 0 & 0 \\
 \frac{x z}{\sqrt{x^2+y^2} \left(x^2+y^2+z^2\right)} & \frac{y z}{\sqrt{x^2+y^2} \left(x^2+y^2+z^2\right)} & -\frac{\sqrt{x^2+y^2}}{x^2+y^2+z^2} & 0 & 0 & 0 \\
 -\frac{y}{x^2+y^2} & \frac{x}{x^2+y^2} & 0 & 0 & 0 & 0 \\
 \frac{\left(y^2+z^2\right) p_x-x y p_y-x z p_z}{\left(x^2+y^2+z^2\right)^{3/2}} & \frac{\left(x^2+z^2\right) p_y-y \left(x p_x+z p_z\right)}{\left(x^2+y^2+z^2\right)^{3/2}} & \frac{\left(x^2+y^2\right) p_z-z \left(x p_x+y p_y\right)}{\left(x^2+y^2+z^2\right)^{3/2}} & \frac{x}{\sqrt{x^2+y^2+z^2}} & \frac{y}{\sqrt{x^2+y^2+z^2}} & \frac{z}{\sqrt{x^2+y^2+z^2}} \\
 \frac{y z \left(y p_x-x p_y\right)-x \left(x^2+y^2\right) p_z}{\left(x^2+y^2\right)^{3/2}} & \frac{x z \left(x p_y-y p_x\right)-y \left(x^2+y^2\right) p_z}{\left(x^2+y^2\right)^{3/2}} & \frac{x p_x+y p_y}{\sqrt{x^2+y^2}} & \frac{x z}{\sqrt{x^2+y^2}} & \frac{y z}{\sqrt{x^2+y^2}} & -\sqrt{x^2+y^2} \\
 p_y & -p_x & 0 & -y & x & 0 \\
\end{vmatrix}
dx dy dz dp_x dp_y dp_z
=
dx dy dz dp_x dp_y dp_z
\end{dmath}

This also has a unit determinant, as we found in the similar cylindrical change of phase space variables.

} % makeanswer

%\EndArticle
