\makeproblem{Binomial distribution for biased coin}{basicStatMech:problemSet1:2}{ 
Consider the more general case of a binomial distribution where the probability of a head is $r$ and a tail is $(1 - r)$ (a biased coin).  With $\text{head} = -1$ and $\text{tail} = +1$, obtain the binomial distribution $P_N(r,X)$ for obtaining a total of $X$ from $N$ coin tosses.  What is the limiting form of this distribution when $N \gg 1$ and $\Abs{X} \ll N$?
}
\makeanswer{basicStatMech:problemSet1:2}{ 

Let's consider 1, 2, 3, and N tosses in sequence to understand the pattern.

\paragraph{1 toss}

The base case has just two possibilities

\begin{itemize}
\item Heads, $P = r$, $X = -1$
\item Tails, $P = (1 - r)$, $X = 1$
\end{itemize}

If $k = 0,1$ for $X = -1, 1$ respectively, we have

\begin{dmath}\label{eqn:basicStatMechProblemSet1Problem2:20}
P_1(r, X) = r^{1 - k} (1 - r)^{k}
\end{dmath}

As a check, when $r = 1/2$ we have $P_1(X) = 1/2$

\paragraph{2 tosses}

Our sample space is now a bit bigger

\begin{itemize}
\item $(h,h)$, $P = r^2$, $X = -2$
\item $(h,t)$, $P = r (1 - r)$, $X = 0$
\item $(t,h)$, $P = r (1 - r)$, $X = 0$
\item $(t,t)$, $P = (1 - r)^2$, $X = 2$
\end{itemize}

Here $P$ is the probability of the ordered sequence, but we are interested only in the probability of each specific value of $X$.  For $X = 0$ there are $\binom{2}{1} = 2$ ways of picking a heads, tails combination.

Enumerating the probabilities, as before, with $k = 0, 1, 2$ for $X = -1, 0, 1$ respectively, we have

\begin{dmath}\label{eqn:basicStatMechProblemSet1Problem2:40}
P_2(r, X) = r^{2 - k} (1 - r)^{k} \binom{2}{k}
\end{dmath}

\paragraph{3 tosses}

Increasing our sample space by one more toss our possibilities for all ordered triplets of toss results is

\begin{itemize}
\item $(h,h,h)$, $P = r^3$, $X = -3$
\item $(h,h,t)$, $P = r^2(1 - r)$, $X = -1$
\item $(h,t,h)$, $P = r^2(1 - r)$, $X = -1$
\item $(h,t,t)$, $P = r(1 - r)^2$, $X = 1$
\item $(t,h,h)$, $P = r^2(1 - r)$, $X = -1$
\item $(t,h,t)$, $P = r(1 - r)^2$, $X = 1$
\item $(t,t,h)$, $P = r(1 - r)^2$, $X = 1$
\item $(t,t,t)$, $P = r (1 - r)$, $X = 0$
\item $(t,t,t)$, $P = (1 - r)^3$, $X = 3$
\end{itemize}

Here $P$ is the probability of the ordered sequence, but we are still interested only in the probability of each specific value of $X$.  We see that we have 
$\binom{3}{1} = \binom{3}{2} = 3$ ways of picking some ordering of either $(h,h,t)$ or $(t,t,h)$

Now enumerating the possibilities with $k = 0, 1, 2, 3$ for $X = -3, -1, 1, 3$ respectively, we have

\begin{dmath}\label{eqn:basicStatMechProblemSet1Problem2:50}
P_3(r, X) = r^{3 - k} (1 - r)^{k} \binom{3}{k}
\end{dmath}

\paragraph{n tosses}

To generalize we need a mapping between our random variable $X$, and the binomial index $k$, but we know what that is from the fair coin problem, one of $(N-X)/2$ or $(N + X)/2$.  To get the signs right, let's evaluate $(N \pm X)/2$ for $N = 3$ and $X \in \{3, -1, 1, 3\}$

\captionedTable{Mapping between $k$ and $(N \pm X)/2$ for $N = 3$}{tab:basicStatMechProblemSet1Problem2:1}{
\begin{tabular}{|l|l|l|}
\hline
$X$ & $\frac{N-X}{2}$ & $\frac{N+X}{2}$ \\ \hline
-3 & 3 & 0 \\ 
-1 & 2 & 1 \\ 
1 & 1 & 2 \\  
3 & 0 & 3 \\ \hline
\end{tabular}
}

Using this, we see that the generalization to unfair coins of the binomial distribution is

\begin{dmath}\label{eqn:basicStatMechProblemSet1Problem2:70}
\boxed{
P_N(r, X) = r^{\frac{N-X}{2}} (1 - r)^{\frac{N+X}{2}} \frac{N!}{
\left(
\frac{N + X}{2}
\right)!
\left(
\frac{N - X}{2}
\right)!
}
}
\end{dmath}

Checking against the fair result, we see that we have the $1/2^N$ factor when $r = 1/2$ as expected.  Let's check for $X = -1$ (two heads, one tail) to see if the exponents are right.  That is

\begin{dmath}\label{eqn:basicStatMechProblemSet1Problem2:90}
P_3(r, -1) 
= r^{\frac{3 + 1}{2}} (1 - r)^{\frac{3 - 1}{2}} \frac{3!}{
\left(
\frac{3 - 1}{2}
\right)!
\left(
\frac{3 + 1}{2}
\right)!
}
=
r^2 (1-r) \frac{3!}{1! 2!}
= r^2 (1 - r)
\end{dmath}

Good, we've got a $r^2$ (two heads) term as desired.

\paragraph{Limiting form}

We can express $P_N(r, X)$ in terms of $P_N(X) = P_N(1/2, X)$.  This is

\begin{dmath}\label{eqn:basicStatMechProblemSet1Problem2:110}
P_N(r, X) = 2^N r^{\frac{N-X}{2}} (1 - r)^{\frac{N+X}{2}} P_N(X).
\end{dmath}

Using the previous fair coin Gaussian approximation we have

\begin{dmath}\label{eqn:basicStatMechProblemSet1Problem2:130}
P_N(r, X) 
\approx 
2^N r^{\frac{N-X}{2}} (1 - r)^{\frac{N+X}{2}} 
\frac{2}{\sqrt{2 \pi N}} e^{ -\frac{X^2}{2 N} }
\end{dmath}

For $N \gg X$ we have

\begin{dmath}\label{eqn:basicStatMechProblemSet1Problem2:n}
\boxed{
P_N(r, X) 
\approx
2^{N} \sqrt{
\frac{
2 r^{N} (1 - r)^{N} 
}{\pi N}} 
e^{ -\frac{X^2}{2 N} }
}
\end{dmath}
}
