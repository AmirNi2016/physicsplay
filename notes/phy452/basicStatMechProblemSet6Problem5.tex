%
% Copyright © 2013 Peeter Joot.  All Rights Reserved.
% Licenced as described in the file LICENSE under the root directory of this GIT repository.
%
\makeoproblem{Relativisitic Fermi gas}{basicStatMech:problemSet6:5}{\citep{huang2001introduction}, pr 9.3}{
Consider a relativisitic gas of $N$ particles of spin $1/2$ obeying Fermi statistics, enclosed in volume $V$, at absolute zero.  The energy-momentum relation is 
\begin{dmath}\label{eqn:huang93:100}
\epsilon = \sqrt{(p c)^2 + 
\lr{m c^2}
^2},
\end{dmath}

where $m$ is the rest mass.

\makesubproblem{}{basicStatMech:problemSet6:5a}
Find the Fermi energy at density $n$.
\makesubproblem{}{basicStatMech:problemSet6:5b}
Define the internal energy $U$ as the average $\epsilon - m c^2$, and the pressure $P$ as the average force per unit area exerted on a perfectly-reflecting wall of the container.  Set up expressions for these quantities in the form of integrals, but you need not evaluate them.
\makesubproblem{}{basicStatMech:problemSet6:5c}
Show that $P V = 2 U/3$ at low densities, and $P V = U/3$ at high densities.  State the criteria for low and high densities.
\makesubproblem{}{basicStatMech:problemSet6:5d}
There may exist a gas of neutinos (and/or antineutinos) in the cosmos.  (Neutrinos are massless fermions of spin $1/2$.)  Calculate the Fermi energy (in eV) of such a gas, assuming a density of one particle per $\text{cm}^3$.
} % makeoproblem

\makeanswer{basicStatMech:problemSet6:5}{ 
\makeSubAnswer{}{basicStatMech:problemSet6:5a}

We've found that the density of states associated with a 3D relativisitic system is

\begin{equation}\label{eqn:huang93:20}
\mathcal{D}(p) = \frac{4 \pi V}{(c h)^3} \epsilon \sqrt{\epsilon^2 - 
\lr{m c^2}
^2},
\end{equation}

For a given density $\rho$, we can find the Fermi energy in the same way as we did for the non-relativisitic energies, with the exception that we have to integrate from a lowest energy of $m c^2$ instead of $0$ (the energy at $\Bp = 0$).  That is

\begin{dmath}\label{eqn:huang93:40}
\rho 
= \frac{N}{V} 
= 
\lr{2 \inv{2} + 1}
\frac{4 \pi}{(c h)^3} \int_{m c^2}^{\epsilon_{\mathrm{F}}}
d\epsilon \epsilon \sqrt{ \epsilon^2 - 
\lr{m c^2}^2
}
= \frac{2 \pi}{(c h)^3} 
\inv{3} \evalrange{
\lr{x^2 - 
\lr{m c^2}^2
}
^{3/2}
}{m c^2}{\epsilon_{\mathrm{F}}}
= \frac{2 \pi}{3 (c h)^3} 
\lr{\epsilon_{\mathrm{F}}^2 - 
\lr{m c^2}^2
}
^{3/2}.
\end{dmath}

Solving for $\epsilon_{\mathrm{F}}$ we have
\begin{dmath}\label{eqn:huang93:60}
\epsilon_{\mathrm{F}} = 
\sqrt{
\lr{ \frac{3 (c h)^3 \rho}{2 \pi} }
^{2/3}
+ \lr{m c^2}^2
}.
\end{dmath}

\makeSubAnswer{}{basicStatMech:problemSet6:5b}

For the pressure calculation, let's suppose that we have a configuration with a plane in the $x,y$ orientation as in \cref{fig:huang93:huang93Fig1}.

\imageFigure{../blogit/huang93Fig1}{Pressure against $x,y$ oriented plane}{fig:huang93:huang93Fig1}{0.3}

It's argued in \citep{pathriastatistical} \S 6.4 that the pressure for such a configuration is 

\begin{dmath}\label{eqn:huang93:120}
P = n \int p_z u_z f(\Bu) d^3 \Bu,
\end{dmath}

where $n$ is the number density and $f(\Bu)$ is a normalized distribution function for the velocities.  We'd like to be able to use the density of states to evaluate this integral, but to do so we need to know how to express the velocity volume element in terms of momentum.  From the Hamiltonian \eqnref{eqn:huang93:100} we find 
\footnote{ Observe that by squaring and summing one can show that this is equivalent to the standard relativisitic momentum $p_x = \frac{m v_x}{\sqrt{ 1 - \Bu^2/c^2}}$.}
(for the x-component which is representitive) 

\begin{dmath}\label{eqn:huang93:140}
u_x 
%= 
%\xdot 
= \PD{p_x}{\epsilon}
= \PD{p_x}{}
\sqrt{(p c)^2 + 
\lr{m c^2}
^2}
= 
\frac{ p_x/c^2 }{
\sqrt{(p c)^2 + 
\lr{m c^2}
^2}
},
\end{dmath}

Or

\begin{dmath}\label{eqn:huang93:220}
u_x = \frac{ p_x }{ c^2 \epsilon }.
\end{dmath}

For the volume element change of variables, we have

\begin{dmath}\label{eqn:huang93:160}
du_x \wedge du_y \wedge du_z
=
\frac
{\partial(u_x, u_y, u_z)}
{\partial(p_x, p_y, p_z)}
dp_x \wedge dp_y \wedge dp_z
=
\inv{c^6 \lr{ m^2 + (\Bp/c)^2 }^{9/2}}
\begin{vmatrix}
m^2 c^2 + p_y^2 + p_z^2 & - p_y p_x & - p_z p_x \\
-p_x p_y & m^2 c^2 + p_x^2 + p_z^2 & - p_z p_y \\
-p_x p_z & -p_y p_z & m^2 c^2 + p_x^2 + p_y^2
\end{vmatrix}
dp_x \wedge dp_y \wedge dp_z
=
m^2 \lr{ m^2 + \Bp^2/c^2 }^{-5/2}
dp_x \wedge dp_y \wedge dp_z.
\end{dmath}

Simplification of the determinant is a little hairy, but yields nicely to Mathematica.  
%FIXME: \nbref{huang93relativisiticGas.nb}
This allows us to express the velocity volume element in momentum space, and the particle energy

\begin{dmath}\label{eqn:huang93:180}
d^3 \Bu = \frac{c^6 \lr{ m c^2 }^2 } {\epsilon^5} d^3 \Bp.
\end{dmath}

We are now set to express the integral for the pressure.  The distribution function $1/(z^{-1}e^{\beta \epsilon} + 1)$ isn't normalized, so we must write

\begin{dmath}\label{eqn:huang93:200}
P 
= 
\frac{n 
\int p_z u_z f(\Bu) d^3 \Bu
}{
\int f(\Bu) d^3 \Bu
}
= 
\frac{n 
\int p_z u_z f(\Bu) \inv{\epsilon^5} d^3 \Bp
}{
\int f(\Bu) \inv{\epsilon^5} d^3 \Bp
}
= 
\frac{n 
\int_0^\pi d\theta \sin\theta \cancel{\int_0^{2 \pi} d\phi} \int_0^\infty dp p^2 
\frac{p_z^2}{c^2 \epsilon} 
\inv{ z^{-1}e^{\beta \epsilon} + 1}
\inv{\epsilon^5} 
}{
\int_0^\pi d\theta \sin\theta \cancel{\int_0^{2 \pi} d\phi} \int_0^\infty dp p^2 
\inv{ z^{-1}e^{\beta \epsilon} + 1}
\inv{\epsilon^5} 
}.
\end{dmath}

The z momentum component can be written in spherical coordinates as $p_z^2 = p^2 \cos^2\theta$.  We can also make a change of variables, integrating over energy instead of momentum.

\begin{dmath}\label{eqn:huang93:240}
c^2 p^2 = \epsilon^2 - \lr{m c^2}^2
,
\end{dmath}

Also following from this is
%\begin{dmath}\label{eqn:huang93:260}
%2 c p \frac{d (c p)}{d\epsilon} = 2 \epsilon,
%\end{dmath}
%
%or

\begin{dmath}\label{eqn:huang93:280}
\frac{d (c p)}{d\epsilon} 
= \frac{\epsilon}{c p}
= 
\frac{\epsilon}{\sqrt{\epsilon^2 -
\lr{ m c^2 }^2
}}
.
\end{dmath}

Assembling all the bits gives us

\begin{dmath}\label{eqn:huang93:300}
P
= 
\frac{n}{c^4}
\frac{
\int_0^\pi d\theta \sin\theta \cos^2 \theta \int_{m c^2}^\infty \frac{d (cp)}{d\epsilon} d\epsilon (cp)^4 
\inv{\epsilon^6} 
\inv{ z^{-1}e^{\beta \epsilon} + 1}
}
{
2 \int_{m c^2}^\infty \frac{d (c p)}{d\epsilon} d\epsilon (c p)^2 
\inv{\epsilon^5} 
\inv{ z^{-1}e^{\beta \epsilon} + 1}
}
= 
\frac{n}{c^4}
\frac{1}{3}
\frac{
\int_{m c^2}^\infty 
d\epsilon 
%\frac{d (cp)}{d\epsilon} 
\frac{\epsilon}{\sqrt{\epsilon^2 - \lr{ m c^2 }^2 }}
%(cp)^4 
\lr{ \epsilon^2 - \lr{m c^2}^2 }^2
\inv{\epsilon^6} 
\inv{ z^{-1}e^{\beta \epsilon} + 1}
}
{
\int_{m c^2}^\infty 
%\frac{d (c p)}{d\epsilon} 
d\epsilon 
\frac{\epsilon}{\sqrt{\epsilon^2 - \lr{ m c^2 }^2 }}
\lr{ \epsilon^2 - \lr{m c^2}^2 }
\inv{\epsilon^5} 
\inv{ z^{-1}e^{\beta \epsilon} + 1}
},
\end{dmath}

which is

\begin{dmath}\label{eqn:huang93:320}
P
= 
\frac{n}{3 c^4}
\frac{
\int_{m c^2}^\infty 
d\epsilon 
\frac{\lr{ \epsilon^2 - \lr{m c^2}^2 }^{3/2}}
{\epsilon^5
\lr{ z^{-1}e^{\beta \epsilon} + 1}
} 
}
{
\int_{m c^2}^\infty 
d\epsilon 
\frac{\lr{ \epsilon^2 - \lr{m c^2}^2 }^{1/2}}
{\epsilon^4
\lr{ z^{-1}e^{\beta \epsilon} + 1}
} 
}.
\end{dmath}

Now for the average energy difference from $mc^2$.

\makeSubAnswer{}{basicStatMech:problemSet6:5c}

TODO.
\makeSubAnswer{}{basicStatMech:problemSet6:5d}

\begin{dmath}\label{eqn:huang93:80}
\evalbar{\epsilon_{\mathrm{F}}}{\rho = 1/(0.01)^3}
%ef[3 10^8, 6.62606957 10^(-34), rho, 0]
%= 6.12402 \times 10^{-35} \text{J}
= 6.12402 \times 10^{-35} \text{J} \times 6.24150934 \times 10^{18} \frac{\text{eV}}{\text{J}}
= 3.82231 \times 10^{-16} \text{eV}
\end{dmath}

Wow.  That's pretty low!
}
