%
% Copyright © 2014 Peeter Joot.  All Rights Reserved.
% Licenced as described in the file LICENSE under the root directory of this GIT repository.
%
% for template copy, run:
%
% ~/bin/ct multiphysicsL1  multiphysicsLectureN tl1
%
\input{../blogpost.tex}
\renewcommand{\basename}{multiphysicsL10}
\renewcommand{\dirname}{notes/ece1254/}
\newcommand{\keywords}{Condensed matter physics, ECE1254H}
\input{../peeter_prologue_print2.tex}

%\usepackage{kbordermatrix}

\beginArtNoToc
\generatetitle{ECE1254H Modeling of Multiphysics Systems.  Lecture 10: Nonlinear systems.  Taught by Prof.\ Piero Triverio}
%\chapter{Nonlinear systems}
\label{chap:multiphysicsL10}

\section{Disclaimer}

Peeter's lecture notes from class.  These may be incoherent and rough.

\section{Nonlinear systems}

On slides, some examples to motivate:

\begin{itemize}
\item struts
\item fluids
\item diode (exponential)

Example:

F1

\begin{equation}\label{eqn:multiphysicsL10:20}
I_d = I_s \lr{ e^{V_d/V_t} - 1 } = \frac{10 - V_d}{10}.
\end{equation}

\end{itemize}

\section{Richardson and Linear Convergence}

Seeking the exact solution \( x^\conj \) for

\begin{equation}\label{eqn:multiphysicsL10:40}
f(x^\conj) = 0,
\end{equation}

Suppose that 

\begin{equation}\label{eqn:multiphysicsL10:60}
x^{k + 1} = x^k + f(x^k)
\end{equation}

If \( f(x^k) = 0 \) then we have convergence, so \( x^k = x^\conj \).

\paragraph{Convergence analysis}

Write the iteration equations at a sample point and the solution as

\begin{subequations}
\begin{equation}\label{eqn:multiphysicsL10:80}
x^{k + 1} = x^k + f(x^k)
\end{equation}
\begin{equation}\label{eqn:multiphysicsL10:100}
x^{\conj} = x^\conj + 
\mathLabelBox
{
f(x^\conj)
}
{\(=0\)}
\end{equation}
\end{subequations}

Taking the difference we have

\begin{equation}\label{eqn:multiphysicsL10:120}
x^{k+1} - x^\conj = x^k - x^\conj + \lr{ f(x^k) - f(x^\conj) }.
\end{equation}

The last term can be quantified using the mean value theorem \ref{thm:multiphysicsL10:140}, giving

\begin{dmath}\label{eqn:multiphysicsL10:140}
x^{k+1} - x^\conj 
= x^k - x^\conj + 
\evalbar{\PD{x}{f}}{\tilde{x}} \lr{ x^k - x^\conj }
= 
\lr{ x^k - x^\conj }
\lr{
1 + \evalbar{\PD{x}{f}}{\tilde{x}}  }.
\end{dmath}

The absolute value is thus

\begin{equation}\label{eqn:multiphysicsL10:160}
\Abs{x^{k+1} - x^\conj } =
\Abs{ x^k - x^\conj }
\Abs{
1 + \evalbar{\PD{x}{f}}{\tilde{x}}  }.
\end{equation}

We have convergence provided \( \Abs{ 1 + \evalbar{\PD{x}{f}}{\tilde{x}}  } < 1 \) in the region where we happen to iterate over.  This could easily be highly dependent on the initial guess.

Stated more accurately we have convergence provided

\begin{equation}\label{eqn:multiphysicsL10:180}
\Abs{
1 + \PD{x}{f} }
\le \gamma < 1
\qquad \forall \tilde{x} \in [ x^\conj - \delta, x^\conj + \delta ],
\end{equation}

and \( \Abs{x^0 - x^\conj } < \delta \).  It could very easily be difficult to determine the convergence regions.

F3

We have some problems

\begin{itemize}
\item Convergence is only linear
\item \( x, f(x) \) are not in the same units (and potentially of different orders).  For example, \(x\) could be a voltage and \( f(x) \) could be a circuit current.
\item (more on slides)
\end{itemize}

Examples where we may want to use this:

\begin{itemize}
\item Spice Gummal Poon transistor model.  Lots of diodes, ...
\item Mosfet model (30 page spec, lots of parameters).
\end{itemize}

\section{Newton's method}

The core idea of this method is sketched in

F4
 
To do this, we expand \( f(x) \) in Taylor series to first order around \( x^k \), and then solve for \( f(x) = 0 \) in that approximation

\begin{equation}\label{eqn:multiphysicsL10:200}
	f( x^{k+1} ) \approx f( x^k ) + \evalbar{ \PD{x}{f} }{x^k} \lr{ x^{k+1} - x^k } = 0.
\end{equation}

This gives

\boxedEquation{eqn:multiphysicsL10:220}{
x^{k+1} = x^k - \frac{f( x^k )}{\evalbar{ \PD{x}{f} }{x^k}}.
}

\makeexample{title}{example:multiphysicsL10:240}{
For the solution of 

\begin{equation}\label{eqn:multiphysicsL10:260}
f(x) = x^3 - 2,
\end{equation}

it was found 

F5


}

\paragraph{Convergence analysis}

The convergence condition is

\begin{equation}\label{eqn:multiphysicsL10:280}
0 = f(x^k) + \evalbar{ \PD{x}{f} }{x^k} \lr{ x^{k+1} - x^k }.
\end{equation}

The Taylor series for \( f \) around \( x^k \), using a mean value formulation is

\begin{equation}\label{eqn:multiphysicsL10:300}
f(x) 
= f(x^k) 
+ \evalbar{ \PD{x}{f} }{x^k} \lr{ x - x^k }.
+ \inv{2} \evalbar{ \PDSq{x}{f} }{\tilde{x} \in [x^\conj, x^k]} \lr{ x - x^k }^2.
\end{equation}

Evaluating at \( x^\conj \) we have

\begin{equation}\label{eqn:multiphysicsL10:320}
0 = f(x^k) 
+ \evalbar{ \PD{x}{f} }{x^k} \lr{ x^\conj - x^k }.
+ \inv{2} \evalbar{ \PDSq{x}{f} }{\tilde{x} \in [x^\conj, x^k]} \lr{ x^\conj - x^k }.
\end{equation}

\begin{equation}\label{eqn:multiphysicsL10:340}
0 = \evalbar{\PD{x}{f}}{x^k} \lr{ x^{k+1} - \cancel{x^k} - x^\conj + \cancel{x^k} }
- \inv{2} \evalbar{\PDSq{x}{f}}{\tilde{x}} \lr{ x^\conj - x^k }^2.
\end{equation}

FIXME: make sense of what he did here.

\begin{equation}\label{eqn:multiphysicsL10:360}
x^{k+1} - x^\conj 
= \inv{2} \lr{ \PD{x}{f} }^{-1} \evalbar{\PDSq{x}{f}}{\tilde{x}} \lr{ x^k - x^\conj }^2
\end{equation}

\begin{equation}\label{eqn:multiphysicsL10:380}
\Abs{ x^{k+1} - x^\conj } 
= \inv{2} \Abs{ \PD{x}{f} }^{-1} \Abs{ \PDSq{x}{f} } \Abs{ x^k - x^\conj }^2
\end{equation}

We see that convergence is quadratic in the error from the previous iteration.  We will have trouble if the derivative goes small at any point in the iteration region, for example in

F7

\paragraph{When to stop iteration}

One way to check is to look to see if the difference

\begin{equation}\label{eqn:multiphysicsL10:n}
\Norm{ x^{k+1} - x^k } < \epsilon_{\Delta x},
\end{equation}

however, when the function has a very step slope

F8 

this may not be sufficient unless we also substitute our trial solution and see if we have the match desired.

Alternatively, if the slope is shallow as in

F9

checking for just \( \Abs{ f(x^{k+1} } < \epsilon_f \) may also mean we are off target.

Finally, we may also need a relative error check to avoid false convergence

F10

Example:

F11

\section{Theorems}

\maketheorem{Mean value theorem}{thm:multiphysicsL10:140}{

For a continuous and differentiable function \( f(x) \), the difference can be expressed in terms of the derivative at an intermediate point

\begin{equation*}
f(x_2) - f(x_1) 
= \evalbar{ \PD{x}{f} }{\tilde{x}} \lr{ x_2 - x_1 }
\end{equation*}

where \( \tilde{x} \in [x_1, x_2] \).

F2
}

%\EndArticle
\EndNoBibArticle
