%
% Copyright © 2013 Peeter Joot.  All Rights Reserved.
% Licenced as described in the file LICENSE under the root directory of this GIT repository.
%
\makeproblem{Maximum entropy principle}{basicStatMech:problemSet6:1}{
%{2013 problem set 6, problem 1}
%(3 points)
Consider the ``Gibbs entropy''

\begin{dmath}\label{eqn:basicStatMechProblemSet6Problem1:20}
S = - \kB \sum_i p_i \ln p_i
\end{dmath}

where $p_i$ is the equilibrium probability of occurrence of a microstate $i$ in the ensemble.

\makesubproblem{}{basicStatMech:problemSet6:1a}
For a microcanonical ensemble with $\Omega$ configurations (each having the same energy), assigning an equal probability $p_i= 1/\Omega$ to each microstate leads to $S = \kB \ln \Omega$.  Show that this result follows from maximizing the Gibbs entropy with respect to the parameters $p_i$ subject to the constraint of

\begin{dmath}\label{eqn:basicStatMechProblemSet6Problem1:40}
\sum_i p_i = 1
\end{dmath}

(for $p_i$ to be meaningful as probabilities).  In order to do the minimization with this constraint, use the method of Lagrange multipliers - first, do an unconstrained minimization of the function

\begin{dmath}\label{eqn:basicStatMechProblemSet6Problem1:60}
S - \alpha \sum_i p_i,
\end{dmath}

then fix $\alpha$ by demanding that the constraint be satisfied.

\makesubproblem{}{basicStatMech:problemSet6:1b}
For a canonical ensemble (no constraint on total energy, but all microstates having the same number of particles $N$), maximize the Gibbs entropy with respect to the parameters $p_i$ subject to the constraint of

\begin{dmath}\label{eqn:basicStatMechProblemSet6Problem1:200}
\sum_i p_i = 1,
\end{dmath}

(for $p_i$ to be meaningful as probabilities) and with a given fixed average energy

\begin{dmath}\label{eqn:basicStatMechProblemSet6Problem1:80}
\expectation{E} = \sum_i E_i p_i,
\end{dmath}

where $E_i$ is the energy of microstate $i$.  Use the method of Lagrange multipliers, doing an unconstrained minimization of the function

\begin{dmath}\label{eqn:basicStatMechProblemSet6Problem1:100}
S - \alpha \sum_i p_i - \beta \sum_i E_i p_i,
\end{dmath}

then fix $\alpha, \beta$ by demanding that the constraint be satisfied.  What is the resulting $p_i$?

\makesubproblem{}{basicStatMech:problemSet6:1c}
For a grand canonical ensemble (no constraint on total energy, or the number of particles), maximize the Gibbs entropy with respect to the parameters $p_i$ subject to the constraint of

\begin{dmath}\label{eqn:basicStatMechProblemSet6Problem1:120}
\sum_i p_i = 1,
\end{dmath}

(for $p_i$ to be meaningful as probabilities) and with a given fixed average energy

\begin{dmath}\label{eqn:basicStatMechProblemSet6Problem1:140}
\expectation{E} = \sum_i E_i p_i,
\end{dmath}

and a given fixed average particle number

\begin{dmath}\label{eqn:basicStatMechProblemSet6Problem1:160}
\expectation{N} = \sum_i N_i p_i.
\end{dmath}

Here $E_i, N_i$ represent the energy and number of particles in microstate $i$.  Use the method of Lagrange multipliers, doing an unconstrained minimization of the function

\begin{dmath}\label{eqn:basicStatMechProblemSet6Problem1:180}
S - \alpha \sum_i p_i - \beta \sum_i E_i p_i - \gamma \sum_i N_i p_i,
\end{dmath}

then fix $\alpha, \beta, \gamma$ by demanding that the constrains be satisfied.  What is the resulting $p_i$?
} % makeproblem

\makeanswer{basicStatMech:problemSet6:1}{
\makeSubAnswer{}{basicStatMech:problemSet6:1a}

Writing 

\begin{dmath}\label{eqn:basicStatMechProblemSet6Problem2:220}
f 
= S - \alpha \sum_{j = 1}^\Omega p_j,
= -\sum_{j = 1}^\Omega p_j \lr{ \kB \ln p_j + \alpha },
\end{dmath}

our unconstrained minimization requires

\begin{dmath}\label{eqn:basicStatMechProblemSet6Problem2:240}
0 
= \PD{p_i}{f}
= 
-\lr{
\kB \lr{ \ln p_i + 1 } + \alpha 
}.
\end{dmath}

Solving for $p_i$ we have

\begin{dmath}\label{eqn:basicStatMechProblemSet6Problem2:260}
p_i = e^{-\alpha/\kB - 1}.
\end{dmath}

The probabilities for each state are constant.  To fix that constant we employ our constraint

\begin{dmath}\label{eqn:basicStatMechProblemSet6Problem2:280}
1 
= \sum_{j = 1}^\Omega p_j
= \sum_{j = 1}^\Omega e^{-\alpha/\kB - 1}
= \Omega e^{-\alpha/\kB - 1},
\end{dmath}

or

\begin{dmath}\label{eqn:basicStatMechProblemSet6Problem2:300}
\alpha/\kB + 1 = \ln \Omega.
\end{dmath}

Inserting \eqnref{eqn:basicStatMechProblemSet6Problem2:300} fixes the probability, giving us the first of the expected results

\begin{equation}\label{eqn:basicStatMechProblemSet6Problem2:320}
\myBoxed{
p_i = e^{-\ln \Omega} = \inv{\Omega}.
}
\end{equation}

Using this we our Gibbs entropy can be summed easily

\begin{dmath}\label{eqn:basicStatMechProblemSet6Problem2:340}
S 
= -\kB 
\sum_{j = 1}^\Omega p_j \ln p_j
= -\kB 
\sum_{j = 1}^\Omega \inv{\Omega} \ln \inv{\Omega}
= -\kB \frac{\Omega}{\Omega} \lr{ -\ln \Omega },
\end{dmath}

or

\begin{dmath}\label{eqn:basicStatMechProblemSet6Problem2:360}
\myBoxed{
S = \kB \ln \Omega.
}
\end{dmath}

\makeSubAnswer{}{basicStatMech:problemSet6:1b}

TODO.
\makeSubAnswer{}{basicStatMech:problemSet6:1c}

TODO.
}
