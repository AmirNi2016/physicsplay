%
% Copyright © 2016 Peeter Joot.  All Rights Reserved.
% Licenced as described in the file LICENSE under the root directory of this GIT repository.
%
%{
\input{../blogpost.tex}
\renewcommand{\basename}{vectorWaveEquationSpherical}
%\renewcommand{\dirname}{notes/phy1520/}
\renewcommand{\dirname}{notes/ece1228-electromagnetic-theory/}
%\newcommand{\dateintitle}{}
%\newcommand{\keywords}{}

\input{../peeter_prologue_print2.tex}

\usepackage{peeters_layout_exercise}
\usepackage{peeters_braket}
\usepackage{peeters_figures}
\usepackage{siunitx}
%\usepackage{macros_bm} % \bcM
%\usepackage{txfonts} % \ointclockwise

\beginArtNoToc

\generatetitle{Vector wave equation in spherical coordinates}
%\chapter{vector wave equation in spherical coordinates}
%\label{chap:vectorWaveEquationSpherical}
% \citep{jackson1975cew}

For a vector \( \BA \) in spherical coordinates, let's compute the Laplacian

\begin{dmath}\label{eqn:vectorWaveEquationSpherical:20}
\spacegrad^2 \BA,
\end{dmath}

to see the form of the wave equation.  The spherical vector representation has a curvilinear basis
\begin{dmath}\label{eqn:vectorWaveEquationSpherical:40}
\BA = \rcap A_r + \thetacap A_\theta + \phicap A_\phi,
\end{dmath}

and the spherical Laplacian has been found to have the representation

\begin{dmath}\label{eqn:vectorWaveEquationSpherical:60}
\spacegrad^2 \psi
=
    \inv{r^2} \PD{r}{} \lr{ r^2 \PD{r}{ \psi} }
   + \frac{1}{r^2 \sin\theta} \PD{\theta}{} \lr{ \sin\theta \PD{\theta}{ \psi } }
   + \frac{1}{r^2 \sin^2\theta} \PDSq{\phi}{ \psi}.
\end{dmath}

Evaluating the Laplacian will require the following curvilinear basis derivatives

\begin{dmath}\label{eqn:vectorWaveEquationSpherical:80}
\begin{aligned}
\partial_\theta \rcap      &= \thetacap \\
\partial_\theta \thetacap  &= -\rcap \\
\partial_\theta \phicap    &= 0 \\
\partial_\phi \rcap        &= S_\theta \phicap \\
\partial_\phi \thetacap    &= C_\theta \phicap \\
\partial_\phi \phicap      &= -\rcap S_\theta - \thetacap C_\theta.
\end{aligned}
\end{dmath}

We'll need to evaluate a number of derivatives.  Starting with the \( \rcap \) components

\begin{subequations}
\label{eqn:vectorWaveEquationSpherical:100}
\begin{dmath}\label{eqn:vectorWaveEquationSpherical:120}
\partial_r \lr{ r^2 \partial_r \lr{ \rcap \psi} }
=
\rcap \partial_r \lr{ r^2 \partial_r \psi }
\end{dmath}
\begin{dmath}\label{eqn:vectorWaveEquationSpherical:140}
\partial_\theta \lr{ S_\theta \partial_\theta \lr{ \rcap \psi } }
=
\partial_\theta \lr{ S_\theta (\thetacap \psi + \rcap \partial_\theta \psi ) }
=
  C_\theta                 (\thetacap \psi + \rcap \partial_\theta \psi ) 
+ S_\theta \partial_\theta (\thetacap \psi + \rcap \partial_\theta \psi ) 
=
  C_\theta                 (\thetacap \psi + \rcap \partial_\theta \psi ) 
+ S_\theta \partial_\theta ((\partial_\theta \thetacap) \psi + (\partial_\theta \rcap) \partial_\theta \psi ) 
+ S_\theta \partial_\theta (\thetacap \partial_\theta \psi + \rcap \partial_{\theta \theta} \psi ) 
=
  C_\theta                 (\thetacap \psi + \rcap \partial_\theta \psi ) 
+ S_\theta                 ((-\rcap) \psi + (\thetacap) \partial_\theta \psi ) 
+ S_\theta                 (\thetacap \partial_\theta \psi + \rcap \partial_{\theta \theta} \psi ) 
=
 \rcap     \lr{ 
     C_\theta \partial_\theta \psi 
   - S_\theta \psi
   + S_\theta \partial_{\theta \theta} \psi 
}
+\thetacap \lr{
     C_\theta \psi 
   + 2 S_\theta \partial_\theta \psi 
}
\end{dmath}
\begin{dmath}\label{eqn:vectorWaveEquationSpherical:160}
\partial_{\phi \phi}{ \rcap \psi}
=
\partial_\phi \lr{ (\partial_\phi \rcap) \psi + \rcap \partial_\phi \psi }
=
\partial_\phi \lr{ (S_\theta \phicap) \psi + \rcap \partial_\phi \psi }
=
  S_\theta \partial_\phi (\phicap \psi) 
+ \partial_\phi \lr{ \rcap \partial_\phi \psi }
=
  S_\theta (\partial_\phi \phicap) \psi
+ S_\theta \phicap \partial_\phi \psi
+ (\partial_\phi \rcap) \partial_\phi \psi 
+ \rcap \partial_{\phi\phi} \psi 
=
  S_\theta (-S_\theta \rcap - C_\theta \thetacap) \psi
+ S_\theta \phicap \partial_\phi \psi
+ (S_\theta \phicap) \partial_\phi \psi 
+ \rcap \partial_{\phi\phi} \psi 
=
\rcap \lr{
   - S_\theta^2 \psi
   + \partial_{\phi\phi} \psi 
}
+
\thetacap \lr{
   - S_\theta C_\theta \psi
}
+
\phicap \lr{
   2 S_\theta \phicap \partial_\phi \psi
}
\end{dmath}
\end{subequations}

This gives

\begin{dmath}\label{eqn:vectorWaveEquationSpherical:180}
\spacegrad^2 (\rcap A_r)
=
\rcap \lr{ 
   \inv{r^2}
   \partial_r \lr{ r^2 \partial_r A_r }
   +
   \inv{r^2 S_\theta}
   \lr{ 
        C_\theta \partial_\theta A_r 
      - S_\theta A_r
      + S_\theta \partial_{\theta \theta} A_r 
   }
   + \inv{r^2 S_\theta^2}
   \lr{
      - S_\theta^2 A_r
      + \partial_{\phi\phi} A_r 
   }
}
+ 
\thetacap
\lr{
   \inv{r^2 S_\theta}
   \lr{
        C_\theta A_r 
      + 2 S_\theta \partial_\theta A_r 
   }
   -
   \inv{r^2 S_\theta}
   S_\theta C_\theta A_r
}
+ 
\phicap
\lr{
   \inv{r^2 S_\theta^2}
   2 S_\theta \partial_\phi A_r
}
=
\rcap \lr{ 
   \spacegrad^2 A_r
   -\frac{2}{r^2 } A_r
}
+ 
\frac{\thetacap}{r^2}
\lr{
   \frac{C_\theta}{S_\theta} A_r 
   + 2 \partial_\theta A_r 
   - C_\theta A_r
}
+ 
\phicap 
\frac{2}{r^2 S_\theta} \partial_\phi A_r.
\end{dmath}

%\partial_\theta \rcap      &= \thetacap \\
%\partial_\theta \thetacap  &= -\rcap \\
%\partial_\theta \phicap    &= 0 \\
%\partial_\phi \rcap        &= S_\theta \phicap \\
%\partial_\phi \thetacap    &= C_\theta \phicap \\
%\partial_\phi \phicap      &= -\rcap S_\theta - \thetacap C_\theta.

%}
%\EndArticle
\EndNoBibArticle
