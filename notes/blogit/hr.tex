\input{../peeter_prologue.tex}

\chapter{hamiltonian}
\label{chap:hamiltonian}
%\useCCL
\blogpage{http://sites.google.com/site/peeterjoot/math2009/hamiltonian.pdf}
\date{Nov 15, 2009}
\revisionInfo{$RCSfile: hr.tex,v $ Last $Revision: 1.3 $ $Date: 2009/11/28 18:12:44 $}

\beginArtWithToc
%\beginArtNoToc

\section{Relativistic force free Hamiltonian.}

Having considered a number of Newtonian mechanical systems, lets move on to the force free relativistic Lagrangian in preparation for considering electromagnetic forces in a Hamiltonian context.

\subsection{Covariant Lagrangian.  Force free equations of motion.}

We have two options for the relativistic Lagrangian (and perhaps more).  One of which is the covariant form with exactly the same structure as a purely kinetic Newtonian Lagrangian $m \Bv^2/2$, except for replacement of the velocity dot product with a four vector dot product of proper time velocities.  That is

\begin{align}\label{eqn:hamiltonian:qqq1}
\LL &= \inv{2} m \xdot^\mu \xdot_\mu \\
\xdot^\mu &= \frac{d x^\mu}{d \tau},
\end{align}

where the corresponding covariant action is an integral over proper time

\begin{align}\label{eqn:hamiltonian:qqq2}
S = \int d\tau \LL.
\end{align}

Varing the proper time action, and picking the upper index coordinates as our generalized coordinates, we get for the Euler-Lagrange equations 

\begin{align}\label{eqn:hamiltonian:qqq3}
\frac{d}{d \tau} \frac{d \LL}{d \xdot^\alpha} = \frac{d \LL}{d x^\alpha}.
\end{align}

This is the setup required to evaluate the Euler-Lagrange equations.  First for the left hand side we want the conjugate momenta

\begin{align*}
P_\mu 
&= \frac{d \LL}{d \xdot^\alpha} \\
&= m \xdot_\mu.
\end{align*}

Our equations of motion, without yet using the Hamiltonian equations are just

\begin{align}\label{eqn:hamiltonian:qqq2x}
\frac{d}{d\tau} \left( \xdot_\mu \right) = 0.
\end{align}

Provided the covarient Lagrangian has no explicit proper time dependence, following the same procedure as in the non-relativistic case, we find

\begin{align}\label{eqn:hamiltonian:foo2r}
\frac{d}{d\tau} \left( \dot{x}^\mu \PD{\dot{x}^\mu}{\LL} -\LL \right) = 0.
\end{align}

We therefore have a constant for the system associated with proper time translation

\begin{align}\label{eqn:hamiltonian:foo2q}
H = \dot{x}^\mu \PD{\dot{x}^\mu}{\LL} -\LL.
\end{align}

Taking partials we find easily the covariant form of the Hamiltonian equations

\begin{align}\label{eqn:hamiltonian:qqq30}
\PD{P_\mu}{H} &= \dot{x}^\mu \\
\PD{x^\mu}{H} &= -\dot{P}_\mu 
\end{align}

Returning to the specifics of our covariant Lagrangian, the Hamiltonian is unsuprisingly just the Lagrangian

\begin{align}\label{eqn:hamiltonian:foo2s}
H = \inv{2} m \dot{x}^\mu \dot{x}_\mu = \LL = \inv{2m} P^\mu P_\mu.
\end{align}

Writing this out explicitly in space time coordinates we have

\begin{align}\label{eqn:hamiltonian:qqq10}
H = \inv{2} m
\left( \frac{dt}{d\tau} \right)^2
(c^2 - \Bv^2)
\end{align}

In particular in the rest frame where $t = \tau$ and $\Bv = 0$, we have

\begin{align}\label{eqn:hamiltonian:qqq11}
H = \inv{2} m c^2.
\end{align}

An immediate consequence, without even evaluating the Hamiltonian equations, is that our $\gamma$ factor falls out

\begin{align}\label{eqn:hamiltonian:qqq12}
\frac{dt}{d\tau} = \inv{\sqrt{1 - \Bv^2/c^2}}.
\end{align}

This also allows the equations of motion \ref{eqn:hamiltonian:qqq2x} to be transformed from covariant to a spacetime form

%FIXME.
%m \frac{d}{d\tau}

\subsection{An aside.}

The fact that the Hamiltonian is a constant of motion also follows directly just by taking derivatives and applying the Euler-Lagrange equations.  That is

\begin{align*}
\frac{d}{dt} \left( \inv{2} m \dot{x}^\mu \dot{x}_\mu \right) 
=
\dot{x}^\mu \underbrace{\frac{d}{dt} \left( m \dot{x}_\mu \right)}_{=0} \\
\end{align*}

\subsection{Applying the Hamiltonian equations.}

Okay.  Let's apply the Hamiltonian equations \ref{eqn:hamiltonian:qqq30}.  For our force free Lagrangian where we have no $x^\mu$ dependence, we recover \ref{eqn:hamiltonian:qqq2x} immediately by evaluating

\begin{align}\label{eqn:hamiltonian:qqq30b}
\PD{x^\mu}{H} &= -\dot{P}_\mu,
\end{align}

since the left hand side is zero.

\section{Non-covariant Lagrangian for electrodynamic interaction.}

In \cite{jackson1975cew}, the Lagrangian for a charged particle is given as (12.9) as 

\begin{align}\label{eqn:hamiltonian:em1}
\LL = -m c^2 \sqrt{1 - \Bu^2/c^2} + \frac{e}{c} \Bu \cdot \BA - e \Phi.
\end{align}

Let's work in detail from this to the Lorentz force law and the Hamiltonian and from the Hamiltonian again to the Lorentz force law using the Hamiltonian equations.  We should get the same results in each case, and have enough details in doing so to render the text a bit more comprehensible.

\subsection{Canonical momenta}

We need the conjugate momenta for both the Euler-Lagrange evaluation and the Hamiltonian, so lets get that first.  The componens of this are

\begin{align*}
\PD{\dot{x}_i}{\LL} 
&= - \inv{2} m c^2 \gamma (-2/c^2) \dot{x}_i + \frac{e}{c} A_i \\
&= m \gamma \dot{x}_i + \frac{e}{c} A_i.
\end{align*}

In vector form the canonical momenta are then

\begin{align}\label{eqn:hamiltonian:em2}
\BP &= \gamma m \Bu + \frac{e}{c} \BA.
\end{align}

\subsection{Euler-Lagrange evaluation.}

Completing the Euler-Lagrange equation evaluation is the calculation of

\begin{align}\label{eqn:hamiltonian:em2b}
\frac{d\BP}{dt} = \spacegrad \LL.
\end{align}

On the left hand side we have

\begin{align}\label{eqn:hamiltonian:em2l}
\frac{d\BP}{dt} = \frac{d(\gamma m \Bu)}{dt} + \frac{e}{c} \frac{d\BA }{dt},
\end{align}

and on the right, with implied summation over repeated indexes, we have

\begin{align}\label{eqn:hamiltonian:em2r}
\spacegrad \LL = \frac{e}{c} \Be_k (\Bu \cdot \partial_k \BA) - e \spacegrad \Phi.
\end{align}

Putting things together we have

\begin{align*}
\frac{d(\gamma m \Bu)}{dt} 
&= 
-e \left(
\spacegrad \Phi + \inv{c} \PD{t}{\BA}
+ \frac{1}{c} 
\left(
\PD{x_a}{\BA} \PD{t}{x_a} - \Be_k (\Bu \cdot \partial_k \BA) 
\right)
\right) \\
&= 
-e \left(
\spacegrad \Phi + \inv{c} \PD{t}{\BA}
+ \frac{1}{c} \Be_b u_a
\left(
\PD{x_a}{A_b} 
-
\PD{x_b}{A_a}
\right)
\right).
\end{align*}

With 

\begin{align}\label{eqn:hamiltonian:em3}
\BE = -\spacegrad \Phi - \inv{c} \PD{t}{\BA},
\end{align}

the first two terms are recognizable as the electric field.  To put some structure in the remainder start by writing

\begin{align}\label{eqn:hamiltonian:em4}
\PD{x_a}{A_b} - \PD{x_b}{A_a} = \epsilon^{fab} {(\spacegrad \cross \BA)}_f.
\end{align}

The remaining term, with $\BB = \spacegrad \cross \BA$ is now 
 
\begin{align*}
- \frac{e}{c} \Be_b u_a \epsilon^{gab} B_g
&=
\frac{e}{c} 
\Be_a u_b \epsilon^{abg} B_g \\
&= 
\frac{e}{c} \Bu \cross \BB.
\end{align*}

We are left with the momentum portion of the Lorentz force law as expected

\begin{align}\label{eqn:hamiltonian:em5}
\frac{d(\gamma m \Bu)}{dt} = e \left( \BE + \frac{1}{c} \Bu \cross \BB \right).
\end{align}

Observe that with a small velocity Taylor expansion of the Lagrangian we obtain the approximation

\begin{align}\label{eqn:hamiltonian:em6}
-m c^2 \sqrt{ 1 -\Bu^2/c^2} \approx - m c^2 \left( 1 - \inv{2} \Bu^2/c^2 \right) = \inv{2} m \Bu^2
\end{align}

If that is our starting place, we can only obtain the non-relativisitic approximation of the momentum change by evaluating the Euler-Lagrange equations

\begin{align}\label{eqn:hamiltonian:em5a}
\frac{d (m \Bu)}{dt} = e \left( \BE + \frac{1}{c} \Bu \cross \BB \right).
\end{align}

That was an exersize previously attempting working the Tong Lagrangian problem set \cite{TongMf1}.

\subsection{Hamiltonian.}

Having confirmed the by old fashioned Euler-Lagrange equation evaluation that our Lagrangian provides the desired equations of motion, let's now try it using the Hamiltonian approach.  First we need the Hamiltonian, which is nothing more than

\begin{align}\label{eqn:hamiltonian:em10}
H = \BP \cdot \Bu - \LL
\end{align}

However, in the Lagrangian and the dot product we have velocity terms that we must eliminate in favour of the canonical momenta.  The Hamiltonian remains valid in either form, but to apply the Hamiltonian equations we need $H = H(\BP, \Bx)$, and not $H = H(\Bu, \BP, \Bx)$.

\begin{align}\label{eqn:hamiltonian:em11}
H = \BP \cdot \Bu + m c^2 \sqrt{1 - \Bu^2/c^2} - \frac{e}{c} \Bu \cdot \BA + e \Phi.
\end{align}

Or
\begin{align}\label{eqn:hamiltonian:em11b}
H = \Bu \cdot \left(\BP - \frac{e}{c} \BA\right) + m c^2 \sqrt{1 - \Bu^2/c^2} + e \Phi.
\end{align}

We can rearrange \ref{eqn:hamiltonian:em2} for $\Bu$

\begin{align}\label{eqn:hamiltonian:em12}
\Bu = \inv{m \gamma} \left( \BP - \frac{e}{c} \BA \right),
\end{align}

but $\gamma$ also has a $\Bu$ dependence, so this is not complete.  Squaring gets us closer

\begin{align}\label{eqn:hamiltonian:em13}
\Bu^2 = \frac{1 - \Bu^2/c^2}{m^2} {\left( \BP - \frac{e}{c} \BA \right)}^2,
\end{align}

and a bit of final rearrangement yields

\begin{align}\label{eqn:hamiltonian:em14}
\Bu^2 = \frac{(c \BP - e \BA)^2}{m^2 c^2 + {\left( \BP - \frac{e}{c} \BA \right)}^2}.
\end{align}

Writing $\Bp = \BP - e \BA/c$, we can rearrange and find

\begin{align}\label{eqn:hamiltonian:em14a}
\sqrt{1 - \Bu^2/c^2} = \frac{m c }{\sqrt{m^2 c^2 +\Bp^2}}
\end{align}

Also, taking roots of \ref{eqn:hamiltonian:em14} we must have the directions of $\Bu$ and $\left( \BP - \frac{e}{c} \BA \right)$ differ only by a rotation.  From \ref{eqn:hamiltonian:em12} we also know that these are colinear, and therefore have

\begin{align}\label{eqn:hamiltonian:em15}
\Bu = \frac{c \BP - e \BA}{\sqrt{m^2 c^2 + {\left( \BP - \frac{e}{c} \BA \right)}^2}}.
\end{align}

This and \ref{eqn:hamiltonian:em14a} can now be substuited into \ref{eqn:hamiltonian:em11b}, for

\begin{align}\label{eqn:hamiltonian:em11c}
H = \frac{c}{m^2 c^2 + \Bp^2} 
\left(
{\left(\BP - \frac{e}{c} \BA\right)}^2 + m^2 c^2 
\right)
+ e \Phi.
\end{align}

Dividing out the common factors we finally have the Hamiltonian in a tidy form

\begin{align}\label{eqn:hamiltonian:em20}
H = \sqrt{ (c \BP - e \BA)^2 + m^2 c^4 } + e\Phi.
\end{align}

\subsection{Hamiltonian equation evaluation.}

Let's now go through the exercise of evaluating the Hamiltonian equations.  We want the starting point to be just the energy expression \ref{eqn:hamiltonian:em20}, and the use of the Hamiltonian equations and none of what led up to that.  If we were given only this Hamiltonian and the Hamiltonian principle

\begin{subequations}
\begin{align}\label{eqn:hamiltonian:em21}
\PD{P_k}{H} &= u_k \\
\PD{x_k}{H} &= -\dot{P}_k,
\end{align}
\end{subequations}

how far can we go?

For the particle velocity we have no $\Phi$ dependence and get

\begin{align}\label{eqn:hamiltonian:em22}
u_k &= \frac{c (c P_k -e A_k)}{\sqrt{ (c \BP - e \BA)^2 + m^2 c^4 }}
\end{align}

This is \ref{eqn:hamiltonian:em15} in coordinate form, one of our stepping stones on the way to the Hamiltonian, and we recover it quickly with our first set of derivatives.  We have the gradient part $\dot{\BP} = -\spacegrad H$ of the Hamiltonian left to evaluate 

\begin{align}\label{eqn:hamiltonian:em23}
\frac{d\BP}{dt} = 
\frac{e (c P_k -e A_k) \spacegrad A_k }{\sqrt{ (c \BP - e \BA)^2 + m^2 c^4 }} - e \spacegrad \Phi.
\end{align}

Or
\begin{align}\label{eqn:hamiltonian:em23b}
\frac{d\BP}{dt} = e \left( \frac{u_k}{c} \spacegrad A_k - \spacegrad \Phi \right)
\end{align}

This looks nothing like the Lorentz force law.  Knowing that $\BP - e\BA/c$ is of signifance (because we know where we started which is kind of a cheat), we can subtract derivatives of this from both sides, and use the convective derivative operator $d/dt = \PDi{t}{} + \Bu \cdot \spacegrad$ (ie. chain rule) yielding

\begin{align}\label{eqn:hamiltonian:em23c}
\frac{d}{dt}(\BP - e\BA/c) = e \left( -\inv{c}\PD{t}{\BA} - \inv{c} (\Bu \cdot \spacegrad) \BA + \frac{u_k}{c} \spacegrad A_k - \spacegrad \Phi \right).
\end{align}

The first and last terms sum to the electric field, and we seen evaluating the Euler-Lagrange equations that the remainder is $u_k \spacegrad A_k - \Bu \cdot \spacegrad \BA = \Bu \cross (\spacegrad \cross \BA)$.  We have therefore gotten close to the familiar Lorentz force law, and have

\begin{align}\label{eqn:hamiltonian:em24}
\frac{d}{dt}(\BP - e\BA/c) = e \left( \BE + \frac{\Bu}{c} \cross \BB \right).
\end{align}

The only untidy detail left is that $\BP - e \BA/c$ doesn't look much like $\gamma m \Bu$, what we recognize as the relativistically corrected momentum.

\EndArticle
%\EndNoBibArticle
