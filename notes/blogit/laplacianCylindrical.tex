%
% Copyright © 2016 Peeter Joot.  All Rights Reserved.
% Licenced as described in the file LICENSE under the root directory of this GIT repository.
%
%{
\input{../blogpost.tex}
\renewcommand{\basename}{laplacianCylindrical}
%\renewcommand{\dirname}{notes/phy1520/}
\renewcommand{\dirname}{notes/ece1228-electromagnetic-theory/}
%\newcommand{\dateintitle}{}
%\newcommand{\keywords}{}

\input{../peeter_prologue_print2.tex}

\usepackage{peeters_layout_exercise}
\usepackage{peeters_braket}
\usepackage{peeters_figures}
\usepackage{siunitx}
%\usepackage{txfonts} % \ointclockwise

\beginArtNoToc

\generatetitle{Laplacian in cylindrical coordinates}
%\chapter{Laplacian in cylindrical coordinates}
%\label{chap:laplacianCylindrical}

In class it was suggested that the identity

\begin{dmath}\label{eqn:laplacianCylindrical:20}
\spacegrad^2 \BA = 
\spacegrad \lr{ \spacegrad \cdot \BA }
-\spacegrad \cross \lr{ \spacegrad \cross \BA },
\end{dmath}

can be used to compute the Laplacian in non-rectangular coordinates.  Is that the easiest way to do this?
%  One alternative that shouldn't be any different in difficulty is to use the Geometric Algebra equivalent
%
%\begin{dmath}\label{eqn:laplacianCylindrical:40}
%\spacegrad^2 \BA = \spacegrad \lr{ \spacegrad \cdot \BA } +\spacegrad \cdot \lr{ \spacegrad \wedge \BA }.
%\end{dmath}

How about just sequential applications of the gradient on the vector?  Let's start with the vector product of the gradient and the vector.  
%We used cylindrical coordinates to derive Bessel function solutions of the wave equation, so let's derive that cylindrical Laplacian.  
First recall that the cylindrical representation of the gradient is

\begin{dmath}\label{eqn:laplacianCylindrical:80}
\spacegrad = \rhocap \partial_\rho + \frac{\phicap}{\rho} \partial_\phi + \zcap \partial_z,
\end{dmath}

where
\begin{dmath}\label{eqn:laplacianCylindrical:100}
\begin{aligned}
\rhocap &= \Be_1 e^{\Be_1 \Be_2 \phi} \\
\phicap &= \Be_2 e^{\Be_1 \Be_2 \phi} \\
\end{aligned}
\end{dmath}

Taking \( \phi \) derivatives of \cref{eqn:laplacianCylindrical:100}, we have

\begin{dmath}\label{eqn:laplacianCylindrical:120}
\begin{aligned}
\partial_\phi \rhocap &= \Be_1 \Be_1 \Be_2 e^{\Be_1 \Be_2 \phi} = \Be_2 e^{\Be_1 \Be_2 \phi} = \phicap \\
\partial_\phi \phicap &= \Be_2 \Be_1 \Be_2 e^{\Be_1 \Be_2 \phi} = -\Be_1 e^{\Be_1 \Be_2 \phi} = -\rhocap.
\end{aligned}
\end{dmath}

The gradient of a vector \( \BA = \rhocap A_\rho + \phicap A_\phi + \zcap A_z \) is

\begin{dmath}\label{eqn:laplacianCylindrical:60}
\begin{aligned}
\spacegrad \BA
&=
\lr{ \rhocap \partial_\rho + \frac{\phicap}{\rho} \partial_\phi + \zcap \partial_z }
\lr{ \rhocap A_\rho + \phicap A_\phi + \zcap A_z } \\
&=
\quad \rhocap \partial_\rho \lr{ \rhocap A_\rho + \phicap A_\phi + \zcap A_z } \\
&\quad + \frac{\phicap}{\rho} \partial_\phi \lr{ \rhocap A_\rho + \phicap A_\phi + \zcap A_z } \\
&\quad + \zcap \partial_z \lr{ \rhocap A_\rho + \phicap A_\phi + \zcap A_z } \\
&=
\quad \rhocap \lr{ \rhocap \partial_\rho A_\rho + \phicap \partial_\rho A_\phi + \zcap \partial_\rho A_z } \\
&\quad + \frac{\phicap}{\rho} \lr{ \partial_\phi(\rhocap A_\rho) + \partial_\phi(\phicap A_\phi) + \zcap \partial_\phi A_z } \\
&\quad + \zcap \lr{ \rhocap \partial_z A_\rho + \phicap \partial_z A_\phi + \zcap \partial_z A_z } \\
&=
\quad \partial_\rho A_\rho + \rhocap \phicap \partial_\rho A_\phi + \rhocap \zcap \partial_\rho A_z  \\
&\quad +\frac{1}{\rho} \lr{ A_\rho + \phicap \rhocap \partial_\phi A_\rho - \phicap \rhocap A_\phi + \partial_\phi A_\phi + \phicap \zcap \partial_\phi A_z } \\
&\quad + \zcap \rhocap \partial_z A_\rho + \zcap \phicap \partial_z A_\phi + \partial_z A_z  \\
&=
\quad \partial_\rho A_\rho + \frac{1}{\rho} \lr{ A_\rho + \partial_\phi A_\phi } + \partial_z A_z  \\
&\quad +
  \zcap \rhocap \lr{
\partial_z A_\rho 
-\partial_\rho A_z 
} \\
&\quad +
\phicap \zcap \lr{
\inv{\rho} \partial_\phi A_z 
- \partial_z A_\phi 
} \\
&\quad +
\rhocap \phicap \lr{
\partial_\rho A_\phi 
- \inv{\rho} \lr{ \partial_\phi A_\rho - A_\phi } 
},
\end{aligned}
\end{dmath}

As expected, we see that the gradient splits nicely into a dot and curl

\begin{equation}\label{eqn:laplacianCylindrical:160}
\spacegrad \BA 
= \spacegrad \cdot \BA + \spacegrad \wedge \BA 
= \spacegrad \cdot \BA + \rhocap \phicap \zcap (\spacegrad \cross \BA ),
\end{equation}

where the cylindrical representation of the divergence is seen to be

\begin{dmath}\label{eqn:laplacianCylindrical:140}
\spacegrad \cdot \BA
=
\inv{\rho} \partial_\rho (\rho A_\rho) + \frac{1}{\rho} \partial_\phi A_\phi + \partial_z A_z,
\end{dmath}

and the cylindrical representation of the curl is

\begin{dmath}\label{eqn:laplacianCylindrical:180}
\spacegrad \cross \BA
=
\rhocap 
\lr{
\inv{\rho} \partial_\phi A_z 
- \partial_z A_\phi 
}
+
  \phicap 
\lr{
\partial_z A_\rho 
-\partial_\rho A_z 
}
+
\inv{\rho} \zcap \lr{
\partial_\rho ( \rho A_\phi )
- \partial_\phi A_\rho
}.
\end{dmath}

Should we want to, it is now possible to evaluate the Laplacian of \( \BA \) using
\cref{eqn:laplacianCylindrical:20}
, which will have the following components

\begin{subequations}
\label{eqn:laplacianCylindrical:200}
\begin{dmath}\label{eqn:laplacianCylindrical:220}
\rhocap \cdot \lr{ \spacegrad^2 \BA }
=
\partial_\rho
\lr{
   \inv{\rho} \partial_\rho (\rho A_\rho) + \frac{1}{\rho} \partial_\phi A_\phi + \partial_z A_z
}
-
\lr{
   \inv{\rho} \partial_\phi \lr{ 
      \inv{\rho} \lr{
         \partial_\rho ( \rho A_\phi ) - \partial_\phi A_\rho
      }
   }
   - \partial_z \lr{
      \partial_z A_\rho -\partial_\rho A_z 
   }
}
\end{dmath}

\begin{dmath}\label{eqn:laplacianCylindrical:240}
\phicap \cdot \lr{ \spacegrad^2 \BA }
=
\inv{\rho} \partial_\phi
\lr{
   \inv{\rho} \partial_\rho (\rho A_\rho) + \frac{1}{\rho} \partial_\phi A_\phi + \partial_z A_z
}
-
\lr{
   \lr{
      \partial_z \lr{
         \inv{\rho} \partial_\phi A_z - \partial_z A_\phi 
      }
      -\partial_\rho \lr{
         \inv{\rho} \lr{ \partial_\rho ( \rho A_\phi ) - \partial_\phi A_\rho}
      }
   }
}
\end{dmath}
\begin{dmath}\label{eqn:laplacianCylindrical:260}
\zcap \cdot \lr{ \spacegrad^2 \BA }
=
\partial_z 
\lr{
   \inv{\rho} \partial_\rho (\rho A_\rho) + \frac{1}{\rho} \partial_\phi A_\phi + \partial_z A_z
}
-
\inv{\rho} \lr{
   \partial_\rho \lr{ \rho \lr{
         \partial_z A_\rho -\partial_\rho A_z
      } 
   } 
 - \partial_\phi \lr{
      \inv{\rho} \partial_\phi A_z - \partial_z A_\phi 
   }
}
\end{dmath}
\end{subequations}

There is some obvious cancellation above, but none of these look like they are any fun to evaluate fully.  Let's try this a different way.

\paragraph{Explicit cylindrical Laplacian}

%}
%\EndArticle
\EndNoBibArticle
