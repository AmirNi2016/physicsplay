%
% Copyright © 2014 Peeter Joot.  All Rights Reserved.
% Licenced as described in the file LICENSE under the root directory of this GIT repository.
%
\input{../blogpost.tex}
\renewcommand{\basename}{multiphysicsL6}
\renewcommand{\dirname}{notes/ece1254/}
\newcommand{\keywords}{Condensed matter physics, ECE1254H}
\input{../peeter_prologue_print2.tex}

%\usepackage{kbordermatrix}

\beginArtNoToc
\generatetitle{ECE1254H Modeling of Multiphysics Systems.  Lecture 6: Matrix norm, singular decomposition, and conditioning number.  Taught by Prof.\ Piero Triverio}
%\chapter{Matrix norm, singular decomposition, and conditioning number}
\label{chap:multiphysicsL6}

\section{Disclaimer}

Peeter's lecture notes from class.  These may be incoherent and rough.

\section{Matrix norm}

We've defined the matrix norm of \( M \), for the system \( \overbar{y} = M \overbar{x} \) as

\begin{dmath}\label{eqn:multiphysicsL6:21}
\Norm{M} = \max_{\Norm{\overbar{x}} = 1} \Norm{ M \overbar{x} }.
\end{dmath}

We will typically use the \( L_2 \) norm, so that the matrix norm is
\begin{dmath}\label{eqn:multiphysicsL6:41}
\Norm{M}_2 = \max_{\Norm{\overbar{x}}_2 = 1} \Norm{ M \overbar{x} }_2.
\end{dmath}

It can be shown that 

\begin{dmath}\label{eqn:multiphysicsL6:61}
   \Norm{M}_2 = \max_i \sigma_i(M),
\end{dmath}

where \( \sigma_i(M) \) are the (SVD) singular values.

\index{SVD}
\index{Singular value decomposition}
\makedefinition{Singular value decomposition (SVD)}{dfn:multiphysicsL6:1}{
        Given \( M \in \text{\R{n \times m}} \), we can find a representation of \( M \)

\begin{dmath}\label{eqn:multiphysicsL6:81}
M = U \Sigma V^\T,
\end{dmath}

where \( U \) and \( V\) are orthogonal matrices such that \( U^\T U = 1 \), and \( V^\T V = 1 \), and

\begin{dmath}\label{eqn:multiphysicsL6:101}
   \Sigma = 
\begin{bmatrix}
  \sigma_1 &          &        &          &         &         &\\
           & \sigma_2 &        &          &         &         &\\
           &          & \ddots &          &         &         &\\
           &          &        & \sigma_r &         &         &\\
           &          &          &        &       0 &         &         \\
           &          &          &        &         & \ddots  &         \\
           &          &          &        &         &         & 0       \\
\end{bmatrix}
\end{dmath}

The values \( \sigma_i, i \le \min(n,m) \) are called the singular values of \( M \).  The singular values are subject to the ordering

\begin{equation}\label{eqn:multiphysicsL6:261}
\sigma_{1} \ge \sigma_{2} \ge \cdots \ge 0 
\end{equation}

If \(r\) is the rank of \( M \), then the \( \sigma_r \) above is the minimum non-zero singular value (but the zeros are also called singular values).  

%The Matlab command to compute this is \underline{svd}.
% O(4 n^3) div O(26 n^3) ???
}

Observe that the condition \( U^\T U = 1 \) is a statement of orthonormality.  In terms of column vectors \( \overbar{u}_i \), such a product written out explicitly is

\begin{dmath}\label{eqn:multiphysicsL6:301}
\begin{bmatrix}
\overbar{u}_1^\T \\ \overbar{u}_2^\T \\ \vdots \\ \overbar{u}_n^\T 
\end{bmatrix}
\begin{bmatrix}
\overbar{u}_1 & \overbar{u}_2 & \cdots & \overbar{u}_n 
\end{bmatrix}
=
\begin{bmatrix}
1 &   & & \\
  & 1 & & \\
  &   & \ddots & \\
  &   &        & 1
\end{bmatrix}.
\end{dmath}

This is both normality \( \overbar{u}_i^\T \overbar{u}_i = 1 \), and orthonormality \( \overbar{u}_i^\T \overbar{u}_j = 1, i \ne j \).

\makeexample{2 x 2 case}{example:multiphysicsL6:1}{
(for column vectors \( \overbar{u}_i, \overbar{v}_j \)).

\begin{dmath}\label{eqn:multiphysicsL6:281}
M = 
\begin{bmatrix}
\overbar{u}_1 & \overbar{u}_2
\end{bmatrix}
\begin{bmatrix}
        \sigma_1 &  \\
        & \sigma_2
\end{bmatrix}
\begin{bmatrix}
\overbar{v}_1^\T \\
\overbar{v}_2^\T 
\end{bmatrix}
\end{dmath}

Consider \( \overbar{y} = M \overbar{x} \), and take an \( \overbar{x} \) with \( \Norm{\overbar{x}}_2 = 1 \)

F1
}

\section{Conditioning number}

Given a perturbation of \( M \overbar{x} = \overbar{b} \) to 

\begin{dmath}\label{eqn:multiphysicsL6:121}
        \lr{ M + \delta M }
        \lr{ \overbar{x} + \delta \overbar{x} } = \overbar{b},
\end{dmath}

or
\begin{dmath}\label{eqn:multiphysicsL6:141}
        \cancel{ M \overbar{x} - \overbar{b} } + \delta M \overbar{x} + M \delta \overbar{x} + \delta M \delta \overbar{x} = 0.
\end{dmath}

This gives

\begin{dmath}\label{eqn:multiphysicsL6:161}
        M \delta \overbar{x} = - \delta M \overbar{x} - \delta M \delta \overbar{x},
\end{dmath}

or
\begin{dmath}\label{eqn:multiphysicsL6:181}
        \delta \overbar{x} = - M^{-1} \delta M \lr{ \overbar{x} + \delta \overbar{x} }.
\end{dmath}

Taking norms

\begin{dmath}\label{eqn:multiphysicsL6:201}
\Norm{ \delta \overbar{x}}_2 = \Norm{
        M^{-1} \delta M \lr{ \overbar{x} + \delta \overbar{x} }
}_2
\le
\Norm{ M^{-1} }_2 \Norm{ \delta M }_2 \Norm{ \overbar{x} + \delta \overbar{x} }_2,
\end{dmath}

or 
\begin{dmath}\label{eqn:multiphysicsL6:221}
\mathLabelBox
[
   labelstyle={yshift=1.2em},
   linestyle={}
]
{
\frac{\Norm{ \delta \overbar{x}}_2 }{
\Norm{ \overbar{x} + \delta \overbar{x}}_2 }
}
{relative error of solution}
\le 
\mathLabelBox
[
   labelstyle={below of=m\themathLableNode, below of=m\themathLableNode}
]
{
\Norm{M}_2
\Norm{M^{-1}}_2
}
{conditioning number of \(M\)}
\mathLabelBox
[
   labelstyle={xshift=2cm},
   linestyle={out=270,in=90, latex-}
]
{
\frac{ \Norm{ \delta M}_2 }
{\Norm{M}_2}
}
{
relative perturbation of \( M \)
}.
\end{dmath}

The \textAndIndex{conditioning number} can be shown to be

\begin{equation}\label{eqn:multiphysicsL6:241}
        \cond(M) = 
        \frac
        {\sigma_{\mathrm{max}}}
        {\sigma_{\mathrm{min}}}
        \ge 1
\end{equation}

FIXME: justify.

\subsection{sensitivity to conditioning number}

Double precision relative rounding errors can be of the order \( 10^{-16} \sim 2^{-54} \), which allows us to gauge the relative error of the solution

\begin{tabular}{|llll|}
	\hline
	relative error of solution & \( \le \) & \( \cond(M) \) & \( \frac{ \Norm{ \delta M } }{\Norm{M} } \) \\
	\hline
	\( 10^{-15} \)             & \( \le \) & 10             & \( \sim 10^{-16} \) \\
	\( 10^{-2} \)              & \( \le \) & \( 10^{14} \)  & \( 10^{-16} \) \\
	\hline
\end{tabular}

%\EndArticle
\EndNoBibArticle
