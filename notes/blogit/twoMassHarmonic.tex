%
% Copyright © 2013 Peeter Joot.  All Rights Reserved.
% Licenced as described in the file LICENSE under the root directory of this GIT repository.
%
\input{../blogpost.tex}
\renewcommand{\basename}{twoMassHarmonic}
\renewcommand{\dirname}{notes/classicalmechanics/}
%\newcommand{\dateintitle}{}
\newcommand{\keywords}{Lagrangian, Harmonic oscillator, center of mass, two body problem}

\newcommand{\nought}[0]{\circ}

\input{../peeter_prologue_print2.tex}

\beginArtNoToc

\generatetitle{Two body harmonic oscillator in 3D}
%\chapter{Two body harmonic oscillator in 3D}
%\label{chap:twoMassHarmonic}

\makeproblem{Two body harmonic oscillator in 3D}{pr:twoMassHarmonic:1}{

In lattice problems, we consider normal modes of harmonic coupled systems.  Show how it is natural to introduce displacement coordinates to correctly model such a system in a physically realistic fashion.
} % makeproblem

\makeanswer{pr:twoMassHarmonic:1}{ 

For the system illustrated in \cref{fig:twoMassSpringCoupling:twoMassSpringCouplingFig1} the Lagrangian is

\imageFigure{../../figures/classicalmechanics/twoMassSpringCouplingFig1}{Two masses with harmonic coupling}{fig:twoMassSpringCoupling:twoMassSpringCouplingFig1}{0.2}

\begin{dmath}\label{eqn:twoMassHarmonic:20}
\LL = 
\inv{2} m_1 \lr{ \dot{\Br}_1 }^2
+\inv{2} m_2 \lr{ \dot{\Br}_2 }^2
- \frac{K}{2} \lr{ \Br_2 - \Br_1 }^2.
\end{dmath}

We wish to solve the equations of motion

\begin{dmath}\label{eqn:twoMassHarmonic:40}
\ddt{} \spacegrad_{\dot{\Br}_i} \LL = 
\spacegrad_{\Br_i} \LL.
\end{dmath}

Noting that $\spacegrad_\Bx \Ba \cdot \Bx = \Ba$, the coupled system to solve is 

\begin{dmath}\label{eqn:twoMassHarmonic:60}
\begin{aligned}
m_1 \ddot{\Br}_1 &= - K \lr{ \Br_1 - \Br_2 } \\
m_2 \ddot{\Br}_2 &= - K \lr{ \Br_2 - \Br_1 }.
\end{aligned}
\end{dmath}

These can be decoupled using differences and sums

\begin{dmath}\label{eqn:twoMassHarmonic:80}
\begin{aligned}
m_1 \lr{ m_2 \ddot{\Br}_2 } - m_2 \lr{ m_1 \ddot{\Br}_1 } &= - (m_1 + m_2) K \lr{ \Br_2 - \Br_1 } \\
m_1 \ddot{\Br}_1 + m_2 \ddot{\Br}_2 &= 0
\end{aligned}
\end{dmath}

The second is the equation for the acceleration of the center of mass $\BR_{\mathrm{CM}}(t)$.  That center of mass relation is directly integrable.  With $M = m_1 + m_2$, that is

\begin{dmath}\label{eqn:twoMassHarmonic:100}
M \BR_{\mathrm{CM}}(t) 
= 
m_1 \Br_1 + m_2 \Br_2 = 
 (t - t_\nought) 
M \BV_{\mathrm{CM}}
+ M \BR_{\mathrm{CM}}(t_\nought).
\end{dmath}

The first is the harmonic oscillation about the center of mass position.  Introducing the reduced mass

\begin{dmath}\label{eqn:twoMassHarmonic:120}
\mu = \frac{m_1 m_2}{m_1 + m_2},
\end{dmath}

that oscillation equation is

\begin{dmath}\label{eqn:twoMassHarmonic:140}
\frac{d^2}{dt^2}
\lr{ \Br_2 - \Br_1 }
= -\frac{K}{\mu} 
\lr{ \Br_2 - \Br_1 }.
\end{dmath}

With angular frequency $\omega^2 = \frac{K}{\mu}$, vector difference $\Delta \Br(t) = \Br_2(t) - \Br_1(t)$, and initial time values $\Delta \Br_\nought = \Delta \Br(t_\nought)$, and $\Delta \Bv_\nought = \Delta \Br'(t_\nought)$ the solution for $\Delta \Br(t)$, by inspection, is

\begin{dmath}\label{eqn:twoMassHarmonic:180}
\Delta \Br(t) = 
\Delta \Br_\nought \cos\lr{ \omega(t - t_\nought) }
+ \frac{\Delta \Bv_\nought}{\omega} \sin\lr{ \omega(t - t_\nought) }.
\end{dmath}

The reference time can be picked to allow for solutions of arbitrary phase.  For example, for cosine solutions, pick $t_\nought$ as the time for which the amplitude difference is maximized.

To find for the individual $\Br_i$ vectors we have only to invert the matrix relation

\begin{dmath}\label{eqn:twoMassHarmonic:200}
\begin{bmatrix}
-1 & 1 \\
m_1 & m_2 
\end{bmatrix}
\begin{bmatrix}
\Br_1 \\
\Br_2
\end{bmatrix}
=
\begin{bmatrix}
\Delta \Br(t) \\
M \BR_{\mathrm{CM}}(t) 
\end{bmatrix},
\end{dmath}

or

\begin{dmath}\label{eqn:twoMassHarmonic:220}
\begin{bmatrix}
\Br_1 \\
\Br_2
\end{bmatrix}
=
\frac{1}{m_2 + m_1}
\begin{bmatrix}
-m_2 & 1 \\
m_1 & 1 
\end{bmatrix}
\begin{bmatrix}
\Delta \Br(t) \\
M \BR_{\mathrm{CM}}(t) 
\end{bmatrix}
\end{dmath}

The final solution is

\begin{dmath}\label{eqn:twoMassHarmonic:240}
\begin{aligned}
\Br_1(t) &=
-\frac{\mu}{m_1}
\Delta \Br(t) 
+ \BR_{\mathrm{CM}}(t) \\
\Br_2(t) &=
\frac{\mu}{m_2}
\Delta \Br(t) 
+ \BR_{\mathrm{CM}}(t) 
\end{aligned}
\end{dmath}

Looking at this, it appears non-sensical.  At the very least, it is unphysical, and allows the masses to pass through each other.
%This is illustrated in the animation of
%\nbref{harmonicOscillatorTwoMasses.cdf}

Our Lagrangian needs to model the equilbrium length of the spring.  

In the abscence of any initial angular momentum, this problem is essentially one dimensional.  

\paragraph{1D system with non-zero equilibrium length}

Let's consider a physically realistic harmonic oscillator system, with coupling that is relative to an equilibrium length (the length of an uncompressed or unstretched spring for example).  That system is illustrated in 

FIXME: fig2.

Adjusting for a rest length $a$ for the spring, the new system is described by

\begin{dmath}\label{eqn:twoMassHarmonic:22}
\LL = 
\inv{2} m_1 \lr{ \dot{x}_1 }^2
+\inv{2} m_2 \lr{ \dot{x}_2 }^2
- \frac{K}{2} \lr{ x_2 - x_1 - a }^2.
\end{dmath}

Now our equations of motion are

\begin{dmath}\label{eqn:twoMassHarmonic:61}
\begin{aligned}
m_1 \ddot{x}_1 &= - K \lr{ x_1 - x_2 + a } \\
m_2 \ddot{x}_2 &= - K \lr{ x_2 - x_1 - a }.
\end{aligned}
\end{dmath}

With $u = x_2 - x_1 - a$, this is

\begin{dmath}\label{eqn:twoMassHarmonic:260}
\ddot{u} = -\frac{K}{\mu} u.
\end{dmath}

Solving and back substituting for $\Delta x(t) = x_2(t) - x_1(t)$, we have

\begin{dmath}\label{eqn:twoMassHarmonic:280}
\Delta x(t) 
= 
a +
\lr{ \Delta x(0) - a } \cos\omega t
+
\frac{ \Delta v(0) }{\omega} \sin\omega t.
\end{dmath}

Note that this does not model collision effects, should the initial position or velocity be sufficient to bring the masses into contact.

\paragraph{3D system with non-zero equilibrium length}

The geometric of a 3D harmonically coupled system with a non-zero equilibrium lenth is sketched in

FIXME:

We can model the coupling spring as a line segment colinear with the difference vector, or

\begin{dmath}\label{eqn:twoMassHarmonic:21}
\LL = 
\inv{2} m_1 \lr{ \dot{\Br}_1 }^2
+\inv{2} m_2 \lr{ \dot{\Br}_2 }^2
- \frac{K}{2} \lr{ \Delta \Br - \Ba }^2
+ \lambda \lr{ \Delta \Br - \lr{\acap \cdot \Delta \Br} \acap }^2.
\end{dmath}

A Lagrange multiplier $\lambda$ is used to enforce a requirement that the difference vector $\Delta \Br$ is colinear with $\Ba$ (i.e. zero component perpendicular to the projection along $\acap$.)

The rejection square expands as

\begin{dmath}\label{eqn:twoMassHarmonic:300}
\lr{ \Delta \Br - \lr{\acap \cdot \Delta \Br} \acap }^2
=
\lr{ \Delta \Br }^2
- 2 \lr{\acap \cdot \Delta \Br}^2
+ \lr{\acap \cdot \Delta \Br}^2
=
\lr{ \Delta \Br }^2
- \lr{\acap \cdot \Delta \Br}^2
\end{dmath}

The Euler-Lagrange equations expand as

\begin{subequations}
\begin{dmath}\label{eqn:twoMassHarmonic:320}
m_1 \ddot{\Br}_1 = K \lr{ \Delta \Br - \Ba } - 2 \lr{ \Delta \Br - \lr{ \acap \cdot \Delta \Br } \acap }
\end{dmath}
\begin{dmath}\label{eqn:twoMassHarmonic:340}
m_2 \ddot{\Br}_2 = - K \lr{ \Delta \Br - \Ba } + 2 \lr{ \Delta \Br - \lr{ \acap \cdot \Delta \Br } \acap } 
\end{dmath}
\begin{dmath}\label{eqn:twoMassHarmonic:360}
0 = \lr{ \Delta \Br - \lr{\acap \cdot \Delta \Br} \acap }^2
\end{dmath}
\end{subequations}

\Eqnref{eqn:twoMassHarmonic:360} indicates that the norm of the rejection is zero, so that rejection is also zero $\Delta \Br - \lr{ \acap \cdot \Delta \Br } \acap = 0$.  This kills off the $\lambda$ terms, leaving just

\begin{dmath}\label{eqn:twoMassHarmonic:380}
\begin{aligned}
m_1 \ddot{\Br}_1 &= K \lr{ \Delta \Br - \Ba } \\
m_2 \ddot{\Br}_2 &= - K \lr{ \Delta \Br - \Ba }.
\end{aligned}
\end{dmath}

Taking differences this is

\begin{dmath}\label{eqn:twoMassHarmonic:400}
\Delta \ddot{\Br} = - \frac{K}{\mu} \lr{ \Delta \Br - \Ba }.
\end{dmath}

By inspection the solution for the difference is

\begin{dmath}\label{eqn:twoMassHarmonic:420}
\Delta \Br(t) = 
\Ba
+
\lr{ \Delta \Br_\nought - \Ba } \cos\lr{ \omega(t - t_\nought) }
+ \frac{\Delta \Bv_\nought}{\omega} \sin\lr{ \omega(t - t_\nought) }.
\end{dmath}

with the individual mass position vectors still given by \eqnref{eqn:twoMassHarmonic:240}.

We get a strong hint here why we wish to work with displacement coordinates.  Once we do so, there's no longer any requirement to include the Lagrange multipliers that specify the physical constraint.

} % makeanswer

%\EndArticle
\EndNoBibArticle
