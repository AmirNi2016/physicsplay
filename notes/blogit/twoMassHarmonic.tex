%
% Copyright © 2013 Peeter Joot.  All Rights Reserved.
% Licenced as described in the file LICENSE under the root directory of this GIT repository.
%
\input{../blogpost.tex}
\renewcommand{\basename}{twoMassHarmonic}
\renewcommand{\dirname}{notes/phy487/}
%\newcommand{\dateintitle}{}
\newcommand{\keywords}{Lagrangian, Harmonic oscillator, center of mass, two body problem}

\newcommand{\nought}[0]{\circ}

\input{../peeter_prologue_print2.tex}

\beginArtNoToc

\generatetitle{Harmonic oscillator and displacement coordinates}
%\chapter{Two body harmonic oscillator in 3D}
%\label{chap:twoMassHarmonic}

%\makeproblem{Two body harmonic oscillator in 3D}{pr:twoMassHarmonic:1}{
\paragraph{Motivation}

In lattice problems, we consider normal modes of harmonic coupled systems.  Here is a progression through a set of treatments of two harmonically coupled masses, to a lattice configuration with a number of masses all harmonically coupled.
%} % makeproblem

%\makeanswer{pr:twoMassHarmonic:1}{ 
\paragraph{Two body harmonic oscillator in 3D}

For the system illustrated in \cref{fig:twoMassSpringCoupling:twoMassSpringCouplingFig1} the Lagrangian is

\imageFigure{../../figures/phy487/twoMassSpringCouplingFig1}{Two masses with harmonic coupling}{fig:twoMassSpringCoupling:twoMassSpringCouplingFig1}{0.2}

\begin{dmath}\label{eqn:twoMassHarmonic:20}
\LL = 
\inv{2} m_1 \lr{ \dot{\Br}_1 }^2
+\inv{2} m_2 \lr{ \dot{\Br}_2 }^2
- \frac{K}{2} \lr{ \Br_2 - \Br_1 }^2.
\end{dmath}

We wish to solve the equations of motion

\begin{dmath}\label{eqn:twoMassHarmonic:40}
\ddt{} \spacegrad_{\dot{\Br}_i} \LL = 
\spacegrad_{\Br_i} \LL.
\end{dmath}

Noting that $\spacegrad_\Bx \Ba \cdot \Bx = \Ba$, the coupled system to solve is 

\begin{dmath}\label{eqn:twoMassHarmonic:60}
\begin{aligned}
m_1 \ddot{\Br}_1 &= - K \lr{ \Br_1 - \Br_2 } \\
m_2 \ddot{\Br}_2 &= - K \lr{ \Br_2 - \Br_1 }.
\end{aligned}
\end{dmath}

These can be decoupled using differences and sums

\begin{dmath}\label{eqn:twoMassHarmonic:80}
\begin{aligned}
m_1 \lr{ m_2 \ddot{\Br}_2 } - m_2 \lr{ m_1 \ddot{\Br}_1 } &= - (m_1 + m_2) K \lr{ \Br_2 - \Br_1 } \\
m_1 \ddot{\Br}_1 + m_2 \ddot{\Br}_2 &= 0
\end{aligned}
\end{dmath}

The second is the equation for the acceleration of the center of mass $\BR_{\mathrm{CM}}(t)$.  That center of mass relation is directly integrable.  With $M = m_1 + m_2$, that is

\begin{dmath}\label{eqn:twoMassHarmonic:100}
M \BR_{\mathrm{CM}}(t) 
= 
m_1 \Br_1 + m_2 \Br_2 = 
 (t - t_\nought) 
M \BV_{\mathrm{CM}}
+ M \BR_{\mathrm{CM}}(t_\nought).
\end{dmath}

The first is the harmonic oscillation about the center of mass position.  Introducing the reduced mass

\begin{dmath}\label{eqn:twoMassHarmonic:120}
\mu = \frac{m_1 m_2}{m_1 + m_2},
\end{dmath}

that oscillation equation is

\begin{dmath}\label{eqn:twoMassHarmonic:140}
\frac{d^2}{dt^2}
\lr{ \Br_2 - \Br_1 }
= -\frac{K}{\mu} 
\lr{ \Br_2 - \Br_1 }.
\end{dmath}

With angular frequency $\omega^2 = \frac{K}{\mu}$, vector difference $\Delta \Br(t) = \Br_2(t) - \Br_1(t)$, and initial time values $\Delta \Br_\nought = \Delta \Br(t_\nought)$, and $\Delta \Bv_\nought = \Delta \Br'(t_\nought)$ the solution for $\Delta \Br(t)$, by inspection, is

\begin{dmath}\label{eqn:twoMassHarmonic:180}
\Delta \Br(t) = 
\Delta \Br_\nought \cos\lr{ \omega(t - t_\nought) }
+ \frac{\Delta \Bv_\nought}{\omega} \sin\lr{ \omega(t - t_\nought) }.
\end{dmath}

The reference time can be picked to allow for solutions of arbitrary phase.  For example, for cosine solutions, pick $t_\nought$ as the time for which the amplitude difference is maximized.

To find for the individual $\Br_i$ vectors we have only to invert the matrix relation

\begin{dmath}\label{eqn:twoMassHarmonic:200}
\begin{bmatrix}
-1 & 1 \\
m_1 & m_2 
\end{bmatrix}
\begin{bmatrix}
\Br_1 \\
\Br_2
\end{bmatrix}
=
\begin{bmatrix}
\Delta \Br(t) \\
M \BR_{\mathrm{CM}}(t) 
\end{bmatrix},
\end{dmath}

or

\begin{dmath}\label{eqn:twoMassHarmonic:220}
\begin{bmatrix}
\Br_1 \\
\Br_2
\end{bmatrix}
=
\frac{1}{m_2 + m_1}
\begin{bmatrix}
-m_2 & 1 \\
m_1 & 1 
\end{bmatrix}
\begin{bmatrix}
\Delta \Br(t) \\
M \BR_{\mathrm{CM}}(t) 
\end{bmatrix}
\end{dmath}

The final solution is

\begin{dmath}\label{eqn:twoMassHarmonic:240}
\begin{aligned}
\Br_1(t) &=
-\frac{\mu}{m_1}
\Delta \Br(t) 
+ \BR_{\mathrm{CM}}(t) \\
\Br_2(t) &=
\frac{\mu}{m_2}
\Delta \Br(t) 
+ \BR_{\mathrm{CM}}(t) 
\end{aligned}
\end{dmath}

Looking at this, it appears non-sensical.  At the very least, it is unphysical, and allows the masses to pass through each other.
%This is illustrated in the animation of
%\nbref{harmonicOscillatorTwoMasses.cdf}

Our Lagrangian needs to model the equilibrium length of the spring.  

In the absence of any initial angular momentum, this problem is essentially one dimensional.  

\paragraph{1D system with non-zero equilibrium length}

Let's consider a physically realistic harmonic oscillator system, with coupling that is relative to an equilibrium length (the length of an uncompressed or unstretched spring for example).  That system is illustrated in \cref{fig:twoMassSpringCoupling:twoMassSpringCouplingFig2}.

\imageFigure{../../figures/phy487/twoMassSpringCouplingFig2}{Linear harmonic coupling with equilibrium length}{fig:twoMassSpringCoupling:twoMassSpringCouplingFig2}{0.1}

Adjusting for a rest length $a = a_2 - a_1$ for the spring, the new system is described by

\begin{dmath}\label{eqn:twoMassHarmonic:22}
\LL = 
\inv{2} m_1 \lr{ \dot{x}_1 }^2
+\inv{2} m_2 \lr{ \dot{x}_2 }^2
- \frac{K}{2} \lr{ x_2 - x_1 - a }^2.
\end{dmath}

Now our equations of motion are

\begin{dmath}\label{eqn:twoMassHarmonic:61}
\begin{aligned}
m_1 \ddot{x}_1 &= - K \lr{ x_1 - x_2 + a } \\
m_2 \ddot{x}_2 &= - K \lr{ x_2 - x_1 - a }.
\end{aligned}
\end{dmath}

With $u = x_2 - x_1 - a$, this is

\begin{dmath}\label{eqn:twoMassHarmonic:260}
\ddot{u} = -\frac{K}{\mu} u.
\end{dmath}

Solving and back substituting for $\Delta x(t) = x_2(t) - x_1(t)$, we have

\begin{dmath}\label{eqn:twoMassHarmonic:280}
\Delta x(t) 
= 
a +
\lr{ \Delta x(0) - a } \cos\omega t
+
\frac{ \Delta v(0) }{\omega} \sin\omega t.
\end{dmath}

Note that this does not model collision effects, should the initial position or velocity be sufficient to bring the masses into contact.

\paragraph{3D system with non-zero equilibrium length}

The geometric of a 3D harmonically coupled system with a non-zero equilibrium length is sketched in \cref{fig:twoMassSpringCoupling:twoMassSpringCouplingFig3}.

\imageFigure{../../figures/phy487/twoMassSpringCouplingFig3}{Two mass harmonic coupled system}{fig:twoMassSpringCoupling:twoMassSpringCouplingFig3}{0.2}

We can model the coupling spring as a line segment colinear with the difference vector, or

\begin{dmath}\label{eqn:twoMassHarmonic:21}
\LL = 
\inv{2} m_1 \lr{ \dot{\Br}_1 }^2
+\inv{2} m_2 \lr{ \dot{\Br}_2 }^2
- \frac{K}{2} \lr{ \Delta \Br - \Ba }^2
+ \lambda \lr{ \Delta \Br - \lr{\acap \cdot \Delta \Br} \acap }^2.
\end{dmath}

A Lagrange multiplier $\lambda$ is used to enforce a requirement that the difference vector $\Delta \Br$ is colinear with $\Ba$ (i.e. zero component perpendicular to the projection along $\acap$.)

The rejection square expands as

\begin{dmath}\label{eqn:twoMassHarmonic:300}
\lr{ \Delta \Br - \lr{\acap \cdot \Delta \Br} \acap }^2
=
\lr{ \Delta \Br }^2
- 2 \lr{\acap \cdot \Delta \Br}^2
+ \lr{\acap \cdot \Delta \Br}^2
=
\lr{ \Delta \Br }^2
- \lr{\acap \cdot \Delta \Br}^2
\end{dmath}

The Euler-Lagrange equations expand as

\begin{subequations}
\begin{dmath}\label{eqn:twoMassHarmonic:320}
m_1 \ddot{\Br}_1 = K \lr{ \Delta \Br - \Ba } - 2 \lr{ \Delta \Br - \lr{ \acap \cdot \Delta \Br } \acap }
\end{dmath}
\begin{dmath}\label{eqn:twoMassHarmonic:340}
m_2 \ddot{\Br}_2 = - K \lr{ \Delta \Br - \Ba } + 2 \lr{ \Delta \Br - \lr{ \acap \cdot \Delta \Br } \acap } 
\end{dmath}
\begin{dmath}\label{eqn:twoMassHarmonic:360}
0 = \lr{ \Delta \Br - \lr{\acap \cdot \Delta \Br} \acap }^2
\end{dmath}
\end{subequations}

\Eqnref{eqn:twoMassHarmonic:360} indicates that the norm of the rejection is zero, so that rejection is also zero $\Delta \Br - \lr{ \acap \cdot \Delta \Br } \acap = 0$.  This kills off the $\lambda$ terms, leaving just

\begin{dmath}\label{eqn:twoMassHarmonic:380}
\begin{aligned}
m_1 \ddot{\Br}_1 &= K \lr{ \Delta \Br - \Ba } \\
m_2 \ddot{\Br}_2 &= - K \lr{ \Delta \Br - \Ba }.
\end{aligned}
\end{dmath}

Taking differences this is

\begin{dmath}\label{eqn:twoMassHarmonic:400}
\Delta \ddot{\Br} = - \frac{K}{\mu} \lr{ \Delta \Br - \Ba }.
\end{dmath}

By inspection the solution for the difference is

\begin{dmath}\label{eqn:twoMassHarmonic:420}
\Delta \Br(t) = 
\Ba
+
\lr{ \Delta \Br_\nought - \Ba } \cos\lr{ \omega(t - t_\nought) }
+ \frac{\Delta \Bv_\nought}{\omega} \sin\lr{ \omega(t - t_\nought) }.
\end{dmath}

with the individual mass position vectors still given by \eqnref{eqn:twoMassHarmonic:240}.

We get a strong hint here why we wish to work with displacement coordinates.  
%Once we do so, there's no longer any requirement to include the Lagrange multipliers that specify the physical constraint.

\paragraph{A different formulation of the equilibrium position constraint}

The use of the direction constraint above appeared somewhat forced.  Here's a more natural way of specifying that we have an equilibrium length constraint

\begin{dmath}\label{eqn:twoMassHarmonic:440}
\LL 
= 
\inv{2} m_1 \lr{ \dot{\Br}_1 }^2
+\inv{2} m_2 \lr{ \dot{\Br}_2 }^2
- \frac{K}{2} \lr{ 
\Abs{\Br_2 - \Br_1} - a
}^2
= 
\inv{2} m_1 \lr{ \dot{\Br}_1 }^2
+\inv{2} m_2 \lr{ \dot{\Br}_2 }^2
- \frac{K}{2} \lr{ 
\lr{\Br_2 - \Br_1}^2 - 2 a \Abs{\Br_2 - \Br_1} + a^2
}.
\end{dmath}

The evaluation of the absolute value gradient in the Euler-Lagrange equations can be done implicitly, computing the absolute square gradient in two different ways

\begin{subequations}
\begin{equation}\label{eqn:twoMassHarmonic:460}
\PD{\Bx}{\Abs{\Bx}^2} 
=
\PD{\Bx}{\Bx^2} 
=
2 \Bx
\end{equation}
\begin{equation}\label{eqn:twoMassHarmonic:480}
\PD{\Bx}{\Abs{\Bx}^2} 
=
2 \Abs{\Bx} \PD{\Bx}{\Abs{\Bx}},
\end{equation}
\end{subequations}

so that
\begin{dmath}\label{eqn:twoMassHarmonic:500}
\PD{\Bx}{\Abs{\Bx}} = \frac{\Bx}{\Abs{\Bx}}.
\end{dmath}

This gives us

\begin{dmath}\label{eqn:twoMassHarmonic:520}
\begin{aligned}
m_1 \ddot{\Br}_1 &= - K \lr{ \Br_1 - \Br_2 - a \frac{\Br_1 - \Br_2}{\Abs{\Br_2 - \Br_1}} } \\
m_2 \ddot{\Br}_2 &= - K \lr{ \Br_2 - \Br_1 - a \frac{\Br_2 - \Br_1}{\Abs{\Br_2 - \Br_1}} }
\end{aligned}
\end{dmath}

With $\Delta \Br = \Br_2 - \Br_1$ and $\widehat{\Delta \Br} = \lr{\Br_2 - \Br_1}/\Abs{\Br_2 - \Br_1}$, this gives

\begin{dmath}\label{eqn:twoMassHarmonic:540}
\myBoxed{
\mu \Delta \ddot{\Br} = - K \lr{ \Delta \Br - a \widehat{\Delta \Br} }.
}
\end{dmath}

In general, $\widehat{\Delta \Br}$ could rotate in space (non-zero angular momentum for the system), meaning that we'd also have a directional dependence on the LHS.  A specific solution is possible if we assume that the direction is fixed, and introduce scalar displacement coordinates, relative to the center of the equilibrium position as illustrated in \cref{fig:twoMassSpringCoupling:twoMassSpringCouplingFig4}.

\imageFigure{../../figures/phy487/twoMassSpringCouplingFig4}{Coupling directed along difference vector}{fig:twoMassSpringCoupling:twoMassSpringCouplingFig4}{0.2}

\begin{dmath}\label{eqn:twoMassHarmonic:560}
\begin{aligned}
\Br_1 &= \lr{ -\frac{a}{2} + u_1 } \widehat{\Delta \Br} \\
\Br_2 &= \lr{ \frac{a}{2} + u_2 } \widehat{\Delta \Br}.
\end{aligned}
\end{dmath}

With $\Delta u = u_2 - u_1$, \eqnref{eqn:twoMassHarmonic:540} takes the form

\begin{dmath}\label{eqn:twoMassHarmonic:580}
\mu \Delta \ddot{u} = - K \Delta u.
\end{dmath}

We see exactly how natural displacement coordinates are for the two mass problem.  We have also avoided the awkward requirement for a Lagrange multiplier constraint in the Lagrangian model of the system.

\paragraph{Linearized potential about equilibrium point}

Let's compute the linear expansion of a two mass potential, with masses located at $\Br_1, \Br_2$ and equilibrium positions $\Ba_1, \Ba_2$.

\begin{dmath}\label{eqn:twoMassHarmonic:600}
\phi(\Br_1, \Br_2) 
=
\frac{K}{2} \lr{ \Abs{\Br_2 - \Br_1} - \Abs{\Ba_2 - \Ba_1} }^2
=
\frac{K}{2} \lr{ 
\lr{\Br_2 - \Br_1}^2 
- 2 \Abs{\Ba_2 - \Ba_1} \Abs{\Br_2 - \Br_1} 
+ \lr{\Ba_2 - \Ba_1}^2 
}.
\end{dmath}

With $\Delta \Ba = \Ba_2 - \Ba_1$, and $\Br_k = \sum_i \Be_i r_{ki}$, this has first derivatives

\begin{dmath}\label{eqn:twoMassHarmonic:620}
\PD{r_{1i}}{\phi}
= 
K \lr{
\lr{\Br_1 - \Br_2} \cdot \Be_i
- \Abs{\Ba_2 - \Ba_1} \frac{ r_{1i} - r_{2i} }{ \Abs{\Br_2 - \Br_1} }
}
\end{dmath}

Regrouping and noting the $\Br_2, \Br_1$ swapping symmetry, these first derivatives are

\begin{dmath}\label{eqn:twoMassHarmonic:640}
\begin{aligned}
\PD{r_{1i}}{\phi}
&= 
K 
\lr{
r_{1i} - r_{2i} 
}
\lr{ 
1 - 
\frac{ \Abs{\Ba_2 - \Ba_1} }{ \Abs{\Br_2 - \Br_1} } 
} \\
\PD{r_{2i}}{\phi}
&= 
K 
\lr{
r_{2i} - r_{1i} 
}
\lr{ 
1 - 
\frac{ \Abs{\Ba_2 - \Ba_1} }{ \Abs{\Br_2 - \Br_1} } 
}.
\end{aligned}
\end{dmath}

At the equilibrium positions $\Ba_1, \Ba_2$, the first order derivatives are all zero for this potential, a property used in the equilibrium potential expansion discussions of \citep{ibach2009solid} and \citep{ashcroft1976solid}.  Proceeding to calculate the second derivatives

\begin{dmath}\label{eqn:twoMassHarmonic:660}
\PD{r_{1j}}{}
\PD{r_{1i}}{\phi}
= 
K 
\delta_{i j}
\lr{ 
1 - 
\frac{ \Abs{\Ba_2 - \Ba_1} }{ \Abs{\Br_2 - \Br_1} } 
}
-
K 
\lr{
r_{1i} - r_{2i} 
}
\Abs{\Ba_2 - \Ba_1} 
\PD{r_{1j}}{}
\lr{ \lr{\Br_1 - \Br_2}^2 }^{-1/2}
= 
K 
\delta_{i j}
\lr{ 
1 - 
\frac{ \Abs{\Ba_2 - \Ba_1} }{ \Abs{\Br_2 - \Br_1} } 
}
+
K 
\lr{
r_{1i} - r_{2i} 
}
\Abs{\Ba_2 - \Ba_1} 
\frac
{2 \lr{ r_{1j} - r_{2j} }
}
{2 \Abs{\Br_1 - \Br_2}^3 }
\end{dmath}

At the equilibrium positions, this is

\begin{dmath}\label{eqn:twoMassHarmonic:680}
\evalbar{
\PD{r_{1j}}{}
\PD{r_{1i}}{\phi}
}{\Ba_1, \Ba_2}
=
+K 
\frac{\Delta a_i}{\Abs{\Delta \Ba}}
\frac{\Delta a_j}{\Abs{\Delta \Ba}}.
\end{dmath}

These ratios are the direction cosines, as illustrated in \cref{fig:twoMassSpringCoupling:twoMassSpringCouplingFig5}, where $\Delta \Ba = \Abs{\Delta \Ba} \lr{\cos \theta_1, \cos\theta_2, \cos\theta_3}$.  Again employing symmetries, the second derivatives for the non-mixed coordinates are

\imageFigure{../../figures/phy487/twoMassSpringCouplingFig5}{Direction cosines relative to equilibrium position difference vector}{fig:twoMassSpringCoupling:twoMassSpringCouplingFig5}{0.3}

\begin{dmath}\label{eqn:twoMassHarmonic:700}
\begin{aligned}
\evalbar{
\PD{r_{1j}}{}
\PD{r_{1i}}{\phi}
}{\Ba_1, \Ba_2}
&=
K \cos\theta_i \cos\theta_j \\
\evalbar{
\PD{r_{2j}}{}
\PD{r_{2i}}{\phi}
}{\Ba_1, \Ba_2}
&=
K \cos\theta_i \cos\theta_j.
\end{aligned}
\end{dmath}

For the mixed derivatives

\begin{dmath}\label{eqn:twoMassHarmonic:660}
\PD{r_{2j}}{}
\PD{r_{1i}}{\phi}
= 
-K 
\delta_{i j}
\lr{ 
1 - 
\frac{ \Abs{\Ba_2 - \Ba_1} }{ \Abs{\Br_2 - \Br_1} } 
}
-
K 
\lr{
r_{1i} - r_{2i} 
}
\Abs{\Ba_2 - \Ba_1} 
\PD{r_{2j}}{}
\lr{ \lr{\Br_2 - \Br_1}^2 }^{-1/2}
= 
-K 
\delta_{i j}
\lr{ 
1 - 
\frac{ \Abs{\Ba_2 - \Ba_1} }{ \Abs{\Br_2 - \Br_1} } 
}
+
K 
\lr{
r_{1i} - r_{2i} 
}
\Abs{\Ba_2 - \Ba_1} 
\frac
{2 \lr{ r_{2j} - r_{1j} }
}
{2 \Abs{\Br_1 - \Br_2}^3 }.
\end{dmath}

At the equilibrium positions, this is

\begin{equation}\label{eqn:twoMassHarmonic:720}
\evalbar{
\PD{r_{2j}}{}
\PD{r_{1i}}{\phi}
}{\Ba_1, \Ba_2}
=
\evalbar{
\PD{r_{1j}}{}
\PD{r_{2i}}{\phi}
}{\Ba_1, \Ba_2}
=
-K \cos\theta_i \cos\theta_j,
\end{equation}

so to second order, with displacement coordinates $\Bu_i = \Br_i - \Ba_i$, the potential is

\begin{dmath}\label{eqn:twoMassHarmonic:740}
\phi(\Bu_1, \Bu_2) 
\approx
\phi(\Ba_1, \Ba_2)
+
\frac{K}{2} \sum_{i j} \cos\theta_i \cos\theta_j \lr{
  u_{1j} u_{1i}
- u_{2j} u_{1i}
- u_{1j} u_{2i}
+ u_{2j} u_{2i}
},
\end{dmath}

but since $\phi(\Ba_1, \Ba_2) = 0$, we have

\begin{dmath}\label{eqn:twoMassHarmonic:760}
\myBoxed{
\phi(\Bu_1, \Bu_2) 
\approx
\frac{K}{2} \sum_{i j} \cos\theta_i \cos\theta_j 
\lr{ u_{2 i} - u_{1 i} }
\lr{ u_{2 j} - u_{1 j} }.
}
\end{dmath}

As a check observe that if $\Delta \Ba$ is directed along $\Be_1$, we have to second order $\phi(\Bu_1, \Bu_2) = \frac{K}{2} \lr{ u_{2 1} - u_{1 1} }^2$, as we found previously.

The complete Lagrangian is, to second order about the equilibrium positions,

\begin{dmath}\label{eqn:twoMassHarmonic:780}
\LL = 
\sum_j \frac{m_i}{2} \dot{u}_{ij}^2 
-
\frac{K}{2} \sum_{i j} 
\cos\theta_i \cos\theta_j 
\lr{ u_{2 i} - u_{1 i} }
\lr{ u_{2 j} - u_{1 j} }.
\end{dmath}

Evaluating the Euler-Lagrange equations for $m_2$ we have

\begin{dmath}\label{eqn:twoMassHarmonic:800}
\ddt{} \PD{\dot{u}_{2k}}{\LL}
=
m_2 \ddot{u}_{2k},
\end{dmath}

and

\begin{dmath}\label{eqn:twoMassHarmonic:820}
\PD{u_{2k}}{\LL}
=
- \frac{K}{2} \sum_{ij}
\cos\theta_i \cos\theta_j 
\lr{
\delta_{i k} \lr{ u_{2 j} - u_{1 j} }
+
\lr{ u_{2 i} - u_{1 i} }
\delta_{j k}
}
=
- K \sum_{j}
\cos\theta_k \cos\theta_j 
\lr{
u_{2 j} - u_{1 j} 
}
=
-K
\cos\theta_k 
\widehat{\Delta \Ba} \cdot \Delta \Bu.
\end{dmath}

The vector form of the Euler-Lagrange equations $d/dt(\PDi{\dot{\Bu}_i}{\LL}) = \PDi{\Bu_i}{\LL}$, is by inspection
\begin{dmath}\label{eqn:twoMassHarmonic:840}
\begin{aligned}
m_1 \ddot{\Bu}_1 &= K \widehat{\Delta \Ba} \lr{ \widehat{\Delta \Ba} \cdot \Delta \Bu } \\
m_2 \ddot{\Bu}_2 &= -K \widehat{\Delta \Ba} \lr{ \widehat{\Delta \Ba} \cdot \Delta \Bu },
\end{aligned}
\end{dmath}

or

\begin{dmath}\label{eqn:twoMassHarmonic:860}
\myBoxed{
\begin{aligned}
\mu \Delta \ddot{\Bu} &= -K \widehat{\Delta \Ba} \lr{ \widehat{\Delta \Ba} \cdot \Delta \Bu } \\
m_1 \ddot{\Bu}_1 + m_2 \ddot{\Bu}_2 &= 0.
\end{aligned}
}
\end{dmath}

Observe that on the RHS above we have a projection operator, so we could also write

\begin{dmath}\label{eqn:twoMassHarmonic:880}
\mu \Delta \ddot{\Bu} = -K \Proj_{\widehat{\Delta \Ba}} \Delta \Bu.
\end{dmath}

Only the portion of the displacement difference $\Delta \Bu$ that is directed along the equilibrium line contributes to the acceleration of the displacement difference.

\paragraph{A number of harmonically coupled masses}

Now let's consider masses at lattice points indexed by a lattice vector $\Bn$, as illustrated in \cref{fig:twoMassSpringCoupling:twoMassSpringCouplingFig6}.

\imageFigure{../../figures/phy487/twoMassSpringCouplingFig6}{Masses harmonically coupled in a lattice}{fig:twoMassSpringCoupling:twoMassSpringCouplingFig6}{0.3}



%} % makeanswer
\EndArticle
