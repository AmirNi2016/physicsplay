%
% Copyright © 2016 Peeter Joot.  All Rights Reserved.
% Licenced as described in the file LICENSE under the root directory of this GIT repository.
%
%{
\input{../blogpost.tex}
\renewcommand{\basename}{fundamentalTheoremOfCalculus}
\renewcommand{\dirname}{notes/phy1520/}
%\newcommand{\dateintitle}{}
%\newcommand{\keywords}{}

\input{../peeter_prologue_print2.tex}

\usepackage{peeters_layout_exercise}
\usepackage{peeters_braket}
\usepackage{peeters_figures}
\usepackage{siunitx}

\beginArtNoToc

\generatetitle{Fundamental theorem of calculus}
%\chapter{Fundamental theorem of calculus}
%\label{chap:fundamentalTheoremOfCalculus}

\section{Stokes Theorem}

The Fundamental Theorem of (Geometric) Calculus is a generalization of Stokes theorem to multivector integrals.  Notationally, it looks like Stokes theorem with all the dot and wedge products removed.  It is worth restating Stokes theorem and all the definitions associated with it for reference

\maketheorem{Stokes' Theorem}{thm:fundamentalTheoremOfCalculus:20}{

For blades \(F \in \bigwedge^{s}\), and \(m\) volume element \(d^k \Bx, s < k\),

\begin{equation*}
\int_V d^k \Bx \cdot (\boldpartial \wedge F) = \oint_{\partial V} d^{k-1} \Bx \cdot F.
\end{equation*}
}

This is a loaded and abstract statement, and requires many definitions to make it useful

\begin{itemize}
\item The volume integral is over a \(m\) dimensional surface (manifold).
\item Integration over the boundary of the manifold \(V\) is indicated by \( \partial V \).
\item This manifold is assumed to be spanned by a parameterized vector \( \Bx(u^1, u^2, \cdots, u^k) \).
\item A curvilinear coordinate basis \( \setlr{ \Bx_i } \) can be defined on the manifold by
\begin{equation}\label{eqn:fundamentalTheoremOfCalculus:40}
\Bx_i \equiv \PD{u^i}{\Bx} \equiv \partial_i \Bx.
\end{equation}
\item A dual basis \( \setlr{\Bx^i} \) reciprocal to the tangent vector basis \( \Bx_i \) can be calculated subject to the requirement \( \Bx_i \cdot \Bx^j = \delta_i^j \).
\item The vector derivative \(\boldpartial\), the projection of the gradient onto the tangent space of the manifold, is defined by
\begin{equation}\label{eqn:fundamentalTheoremOfCalculus:100}
\boldpartial = \Bx^i \partial_i = \sum_{i=1}^k \Bx_i \PD{u^i}{}.
\end{equation}
\item The volume element is defined by
\begin{dmath}\label{eqn:fundamentalTheoremOfCalculus:60}
d^k \Bx = d\Bx_1 \wedge d\Bx_2 \cdots \wedge d\Bx_k,
\end{dmath}

where

\begin{dmath}\label{eqn:fundamentalTheoremOfCalculus:80}
d\Bx_k = \Bx_k du^k,\qquad \text{(no sum)}.
\end{dmath}
\item The volume element is non-zero on the manifold, or \( \Bx_1 \wedge \cdots \wedge \Bx_k \ne 0 \).
\item The surface area element \( d^{k-1} \Bx \), is defined by
\begin{dmath}\label{eqn:fundamentalTheoremOfCalculus:120}
d^{k-1} \Bx = \sum_{i = 1}^k (-1)^{k-i} d\Bx_1 \wedge d\Bx_2 \cdots \widehat{d\Bx_i} \cdots \wedge d\Bx_k,
\end{dmath}

where \( \widehat{d\Bx_i} \) indicates the omission of \( d\Bx_i \).
\item My proof for this theorem was restricted to a simple ``rectangular'' volume parameterized by the ranges
   \( 
   [u^1(0), u^1(1) ] \directproduct 
   [u^2(0), u^2(1) ] \directproduct \cdots \directproduct
   [u^k(0), u^k(1) ] \)
\item The precise meaning that should be given to oriented area integral is
\begin{dmath}\label{eqn:fundamentalTheoremOfCalculus:140}
\oint_{\partial V} d^{k-1} \Bx \cdot F
=
\sum_{i = 1}^k (-1)^{k-i} \int \evalrange{
   \lr{ \lr{ d\Bx_1 \wedge d\Bx_2 \cdots \widehat{d\Bx_i} \cdots \wedge d\Bx_k } \cdot F }
}{u^i = u^i(0)}{u^i(1)},
\end{dmath}

where both the a area form and the blade \( F \) are evaluated at the end points of the parameterization range.
\end{itemize}

After the work of stating exactly what is meant by this theorem, most of the proof follows from the fact that for \( s < k \) the volume curl dot product can be expanded as

\begin{dmath}\label{eqn:fundamentalTheoremOfCalculus:160}
\int_V d^k \Bx \cdot (\boldpartial \wedge F) =
\int_V d^k \Bx \cdot (\Bx^i \wedge \partial_i F) =
\int_V \lr{ d^k \Bx \cdot \Bx^i } \cdot \partial_i F.
\end{dmath}

Each of the \(du^i\) integrals can be evaluated directly, since each of the remaining \(d\Bx_j = du^j \PDi{u^j}{}, i \ne j \) is calculated with \( u^i \) held fixed.  This allows for the integration over a ``rectangular'' parameterization region, proving the theorem for such a volume parameterization.  A more general proof requires a triangulation of the volume and surface, but the basic principle of the theorem is evident, without that additional work.

\section{Fundamental Theorem of Calculus}

There is a Geometric Algebra generalization of Stokes theorem that does not have the blade grade restriction of Stokes theorem.  In \citep{aMacdonaldVAGC} this is stated as

\begin{dmath}\label{eqn:fundamentalTheoremOfCalculus:180}
\int_V d^k \Bx \boldpartial F = \oint_{\partial V} d^{k-1} \Bx F.
\end{dmath}

A similar expression is used in \citep{doran2003gap} where it is also pointed out there is a variant with the vector derivative acting to the left

\begin{dmath}\label{eqn:fundamentalTheoremOfCalculus:200}
\int_V F d^k \Bx \boldpartial = \oint_{\partial V} F d^{k-1} \Bx.
\end{dmath}

In \citep{sobczyk2011fundamental} it is pointed out that a bidirectional formulation is possible, providing the most general expression of the Fundamental Theorem of (Geometric) Calculus

%\begin{dmath}\label{eqn:fundamentalTheoremOfCalculus:220}
\boxedEquation{eqn:fundamentalTheoremOfCalculus:220}{
\int_V F d^k \Bx \boldpartial G = \oint_{\partial V} F d^{k-1} \Bx G.
}
%\end{dmath}

Here the vector derivative acts both to the left and right on \( F \) and \( G \).  The specific action of this operator is
\begin{dmath}\label{eqn:fundamentalTheoremOfCalculus:240}
F \boldpartial G
=
(F \boldpartial) G
+
F (\boldpartial G)
=
(\partial_i F) \Bx^i G
+
F \Bx^i (\partial_i G).
\end{dmath}

The fundamental theorem can be demonstrated by direct expansion.  With the vector derivative \( \boldpartial \) and its partials \( \partial_i \) acting bidirectionally, that is

\begin{dmath}\label{eqn:fundamentalTheoremOfCalculus:260}
\int_V F d^k \Bx \boldpartial G
=
\int_V F d^k \Bx \Bx^i \partial_i G
=
\int_V F \lr{ d^k \Bx \cdot \Bx^i + d^k \Bx \wedge \Bx^i } \partial_i G.
\end{dmath}

Both the reciprocal frame vectors and the curvilinear basis span the tangent space of the manifold, since we can write any reciprocal frame vector as a set of projections in the curvilinear basis

\begin{dmath}\label{eqn:fundamentalTheoremOfCalculus:280}
\Bx^i = \sum_j \lr{ \Bx^i \cdot \Bx^j } \Bx_j,
\end{dmath}

so \( \Bx^i \in \Span \setlr{ \Bx_j, j \in [1,k] } \).  
This means that \( d^k \Bx \wedge \Bx^i = 0 \), and
%Writing \( d^k u = du^1 du^2 \cdots du^k \), we have

\begin{dmath}\label{eqn:fundamentalTheoremOfCalculus:300}
\int_V F d^k \Bx \boldpartial G
=
\int_V F \lr{ d^k \Bx \cdot \Bx^i } \partial_i G
=
\sum_{i = 1}^{k}
\int_V 
du^1 du^2 \cdots \widehat{ du^i} \cdots du^k
F \lr{ 
(-1)^{k-i}
 \Bx_1 \wedge \Bx_2 \cdots \widehat{\Bx_i} \cdots \wedge \Bx_k } \partial_i G du^i 
=
\sum_{i = 1}^{k}
(-1)^{k-i}
\int_{u^1}
\int_{u^2}
\cdots
\int_{u^{i-1}}
\int_{u^{i+1}}
\cdots
\int_{u^k}
\evalrange{ \lr{
F d\Bx_1 \wedge d\Bx_2 \cdots \widehat{d\Bx_i} \cdots \wedge d\Bx_k G
}
}{u^i = u^i(0)}{u^i(1)}.
\end{dmath}

Adding in the same notational sugar that we used in Stokes theorem, this proves the Fundamental theorem 
\eqnref{eqn:fundamentalTheoremOfCalculus:220}
for ``rectangular'' parameterizations.  Note that such a parameterization need not actually be rectangular.

\makeexample{Application to Maxwell's equation}{example:fundamentalTheoremOfCalculus:1}{

Maxwell's equation is an example of a first order gradient equation

\begin{dmath}\label{eqn:fundamentalTheoremOfCalculus:320}
\grad F = \inv{\epsilon_0 c} J.
\end{dmath}

Integrating over a four-volume (where the vector derivative equals the gradient), and applying the Fundamental theorem, we have

\begin{dmath}\label{eqn:fundamentalTheoremOfCalculus:340}
\inv{\epsilon_0 c} \int d^4 x J = \oint d^3 x F.
\end{dmath}

Observe that the surface area element product with \( F \) has both vector and trivector terms.  This can be demonstrated by considering some examples

\begin{dmath}\label{eqn:fundamentalTheoremOfCalculus:360}
\begin{aligned}
\gamma_{012} \gamma_{01} &\propto \gamma_2 \\
\gamma_{012} \gamma_{23} &\propto \gamma_{023}.
\end{aligned}
\end{dmath}

On the other hand, the four volume integral of \( J \) has only trivector parts.  This means that the integral can be split into a pair of equations

\begin{dmath}\label{eqn:fundamentalTheoremOfCalculus:380}
\begin{aligned}
\inv{\epsilon_0 c} \int d^4 x \cdot J &= 
\oint \gpgradethree{ d^3 x F} \\
0 &=
\oint d^3 x \cdot F.
\end{aligned}
\end{dmath}

The first can be put into a slightly tidier form using a duality transformation
\begin{dmath}\label{eqn:fundamentalTheoremOfCalculus:400}
\gpgradethree{ d^3 x F}
=
-\gpgradethree{ d^3 x I^2 F}
=
\gpgradethree{ I d^3 x I F}
=
(I d^3 x) \wedge (I F).
\end{dmath}

Letting \( n \Abs{d^3 x} = I d^3 x \), this gives

\begin{dmath}\label{eqn:fundamentalTheoremOfCalculus:420}
\oint \Abs{d^3 x} n \wedge (I F) = \inv{\epsilon_0 c} \int d^4 x \cdot J.
\end{dmath}

Note that this normal is normal to a three-volume subspace of the spacetime volume.  For example, if one component of that spacetime surface area element is \( \gamma_{012} c dt dx dy \), then the normal to that area component is \( \gamma_3 \).

The Fundamental theorem of calculus immediately provides relations between the Faraday bivector \( F \) and the four-current \( J \).
} % example

%}
\EndArticle
