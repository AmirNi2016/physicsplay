%
% Copyright © 2013 Peeter Joot.  All Rights Reserved.
% Licenced as described in the file LICENSE under the root directory of this GIT repository.
%
\input{../blogpost.tex}
\renewcommand{\basename}{stokesTheoremGeometricAlgebra}
\renewcommand{\dirname}{notes/gabook/}
\newcommand{\keywords}{Stokes theorem, Geometric algebra, Clifford algebra, gradient, divergence, wedge product}

\input{../peeter_prologue_print2.tex}

% ointctr...
\usepackage{txfonts}

%%\declaretheorem[shaded={bgcolor=Lavender,textwidth=12em}]{theorem}
%
%% Liked this one (solid background)
%%\declaretheorem[shaded={bgcolor=Lavender}]{Theorem}
%
%%\declaretheorem[name=\"Ubung]{exercise}
%
%% liked this one: (is Lavender the light blue that this produces?)
%%\declaretheorem[shaded={bgcolor=Lavender}]{Lemma}
%
%%\declaretheorem[shaded={rulecolor=Lavender, rulewidth=2pt, bgcolor={rgb}{1,1,1}}]{BoxII}

% moved to peeters_layout.sty:
%--------------------------------------------------------------------------
%\usepackage{tikz}
%\usepackage[framemethod=tikz]{mdframed}
%%\theoremstyle{plain}
%%\newmdtheoremenv[
%%  linecolor=cyan,
%%  roundcorner=5pt,
%%  linewidth=1pt
%%]{mytBoxed}{mytBoxed}%[*]
%
%% works, but has a blank header line that still takes up space.
%% also is whole page width, not just the equation as I was hoping for (i.e.
%% a non-problematic replacement for myBoxed)
%\mdtheorem[style=theoremstyle]{mytBoxed}{mytBoxed}
%\mdtheorem[
%  linecolor=cyan,
%  roundcorner=5pt,
%  linewidth=1pt
%]{mytBoxed}{}

% in ../*print2.tex (want in layout.sty)
%\crefname{theorem}{theorem}{theorems} 
%\Crefname{theorem}{Theorem}{Theorems} 
%
%\crefname{lemma}{lemma}{lemmas} 
%\Crefname{lemma}{Lemma}{Lemmas} 

%%------------------------------------
%% Example based on:
%%
%% http://ctan.cms.math.ca/tex-archive/macros/latex/contrib/mdframed/mdframed.pdf
%% 
%\usetikzlibrary{calc,arrows}
%\tikzset{
%  excursus arrow/.style={%
%    line width=2pt,
%    draw=DarkOliveGreen!40,
%    rounded corners=2ex,
%  },
%  excursus head/.style={
%    fill=white,
%    font=\bfseries\sffamily,
%    text=DarkOliveGreen!80,
%    anchor=base west,
%  },
%}
%
%\mdfdefinestyle{digressionarrows}{%
%  singleextra={%
%    \path let \p1=(P), \p2=(O) in (\x2,\y1) coordinate (Q);
%    \path let \p1=(Q), \p2=(O) in (\x1,{(\y1-\y2)/2}) coordinate (M);
%    \path [excursus arrow, round cap-to]
%    ($(O)+(5em,0ex)$) -| (M) |- %
%    ($(Q)+(12em,0ex)$) .. controls +(0:16em) and +(185:6em) .. %
%  ++(23em,2ex);
%  \node [excursus head] at ($(Q)+(2.5em,-0.75pt)$) {Digression};},
%  firstextra={%
%    \path let \p1=(P), \p2=(O) in (\x2,\y1) coordinate (Q);
%    \path [excursus arrow,-to]
%    (O) |- %
%    ($(Q)+(12em,0ex)$) .. controls +(0:16em) and +(185:6em) .. %
%    ++(23em,2ex);
%    \node [excursus head] at ($(Q)+(2.5em,-2pt)$) {Digression};},
%  secondextra={%
%    \path let \p1=(P), \p2=(O) in (\x2,\y1) coordinate (Q);
%    \path [excursus arrow,round cap-]
%    ($(O)+(5em,0ex)$) -| (Q);},
%  middleextra={%
%    \path let \p1=(P), \p2=(O) in (\x2,\y1) coordinate (Q);
%    \path [excursus arrow]
%    (O) -- (Q);},
%  middlelinewidth=2.5em,middlelinecolor=white,
%  hidealllines=true,topline=true,
%  innertopmargin=0.5ex,
%  innerbottommargin=2.5ex,
%  innerrightmargin=2pt,
%  innerleftmargin=2ex,
%  skipabove=0.87\baselineskip,
%  skipbelow=0.62\baselineskip,
%}
%------------------------------------

%
%\usepackage{empheq}
%
%%\definecolor{myblue}{rgb}{.8, .8, 1}
%%\definecolor{ocre}{RGB}{243,102,25}
%%\definecolor{mygray}{RGB}{243,243,244}
%%\newcommand*\mybox[1]{%
%%  \colorbox{DarkOliveGreen}{\hspace{1em}#1\hspace{1em}}}
%
%\newcommand*\mybox[1]{%
%  \fcolorbox{DarkOliveGreen}{Maroon!5}{\hspace{1em}#1\hspace{1em}}}
%%  \fcolorbox{ocre}{mygray}{\hspace{1em}#1\hspace{1em}}}
%
%\newcommand{\boxedEquation}[2]{%
%\begin{empheq}[box=\mybox]{equation}\label{#1}%
%#2%
%\end{empheq}%
%}
%
%%--------------------------------------------------------------------------

\beginArtNoToc

\generatetitle{Stokes theorem in Geometric algebra}
%\chapter{Stokes theorem in Geometric algebra}
\label{chap:stokesTheoremGeometricAlgebra}

The generalization of Stokes theorem to higher dimensional spaces, expressed in the formalism of geometric algebra is

\begin{theorem}[Stokes' Theorem]\label{thm:stokesTheoremGeometricAlgebraII:1740}

For blades $F \in \bigwedge^{s}$, and $m$ volume element $d^k \Bx, s < k$, 

\begin{equation*}%\label{eqn:stokesTheoremGeometricAlgebraII:120}
\int_V d^k \Bx \cdot (\boldpartial \wedge F) = \int_{\partial V} d^{k-1} \Bx \cdot F.
\end{equation*}

Here the volume integral is over a $m$ dimensional surface (manifold), $\boldpartial$ is the projection of the gradient onto the tangent space of the manifold, and $\partial V$ indicates integration over the boundary of $V$.

\end{theorem}

It takes some work to give this more concrete meaning.  Rather than trying to attempt that work head on, we build up to the general result by first considering some specific examples.

\section{Basic notation}

A finite vector space, not neccessarily Euclidean, with basis $\{\Be_1, \Be_2, \cdots\}$ will be assumed to be the generator of the geometric algebra.  A dual or reciprocal basis $\{\Be^1, \Be^2, \cdots\}$ for this basis can be calculated, defined by the property

\begin{equation}\label{eqn:stokesTheoremGeometricAlgebraII:20}
\Be_i \cdot \Be^j = {\delta_i}^j.
\end{equation}

This is an Euclidean space when $\Be_i = \Be^i, \forall i$.

Implicit summation over repeated indexes, typically over mixed upper and lower indexes, will be assumed unless otherwise noted.  For example, the components of a vector $\Bx$ with respect to the standard or reciprocal bases, are

\begin{equation}\label{eqn:stokesTheoremGeometricAlgebraII:40}
\Bx = \Be_i x^i = \Be^j x_j.
\end{equation}

The coordinates of the vector follow by taking dot products

\begin{subequations}
\begin{equation}\label{eqn:stokesTheoremGeometricAlgebraII:60}
\Bx \cdot \Be^j = \lr{ \Be_i x^i } \cdot \Be^j = x^i {\delta_i}^j = x^j
\end{equation}
\begin{equation}\label{eqn:stokesTheoremGeometricAlgebraII:80}
\Bx \cdot \Be_j = \lr{ \Be^i x_i } \cdot \Be_j = x_i {\delta^i}_j = x_j
\end{equation}
\end{subequations}

Similarly, a bivector $F$ in coordinate representation has the form

\begin{equation}\label{eqn:stokesTheoremGeometricAlgebraII:1180}
F = \inv{2} \Be^i \wedge \Be^j F_{ij} = \inv{2} \Be_i \wedge \Be_j F^{ij},
\end{equation}

where
\begin{equation}\label{eqn:stokesTheoremGeometricAlgebraII:1200}
\begin{aligned}
F_{ij} &= \lr{ F \cdot \Be_j } \cdot \Be_i \\
F^{ij} &= \lr{ F \cdot \Be^j } \cdot \Be^i.
\end{aligned}
\end{equation}

With the directional derivative defined by

\begin{equation}\label{eqn:stokesTheoremGeometricAlgebraII:1260}
\Ba \cdot \spacegrad f(\Bx) = \lim_{t \rightarrow 0} \frac{f(\Bx + t \Ba) - f(\Bx)}{t},
\end{equation}

the gradient $\spacegrad$, in terms of the standard and dual bases is

\begin{equation}\label{eqn:stokesTheoremGeometricAlgebraII:100}
\spacegrad \equiv \Be^i \PD{x^i}{}.
%\equiv \Be^i \partial_i,
\end{equation}

To select from a multivector $A$ the grade $k$ portion, say $A_k$ we write

\begin{equation}\label{eqn:stokesTheoremGeometricAlgebraII:1220}
A_k = \gpgrade{A}{k}.
\end{equation}

The scalar portion of a multivector $A$ will be written as 

\begin{equation}\label{eqn:stokesTheoremGeometricAlgebraII:1240}
\gpgrade{A}{0} \equiv \gpgradezero{A}.
\end{equation}

The grade selection operators can be used to define the outer and inner products.  For blades $U$, and $V$ of grade $r$ and $s$ respectively, these are

\begin{subequations}
\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebraII:300}
\gpgrade{ U V }{\Abs{r + s}} \equiv U \wedge V
\end{dmath}
\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebraII:780}
\gpgrade{ U V }{\Abs{r - s}} \equiv U \cdot V.
\end{dmath}
\end{subequations}

Written out explicitly for odd grade blades $A$ (vector, trivector, ...), and vector $\Ba$ the dot and wedge products are respectively

\begin{equation}\label{eqn:stokesTheoremGeometricAlgebraII:800}
\begin{aligned}
\Ba \wedge A &= \inv{2} (\Ba A - A \Ba) \\
\Ba \cdot A &= \inv{2} (\Ba A + A \Ba).
\end{aligned}
\end{equation}

Similarly for even grade blades these are

\begin{equation}\label{eqn:stokesTheoremGeometricAlgebraII:820}
\begin{aligned}
\Ba \wedge A &= \inv{2} (\Ba A + A \Ba) \\
\Ba \cdot A &= \inv{2} (\Ba A - A \Ba).
\end{aligned}
\end{equation}

It will be useful to employ the cyclic scalar reordering identity for the scalar selection operator

\begin{equation}\label{eqn:stokesTheoremGeometricAlgebraII:920}
\gpgradezero{\Ba \Bb \Bc} 
= \gpgradezero{\Bb \Bc \Ba}
= \gpgradezero{\Bc \Ba \Bb}.
\end{equation}

\section{Curvilinear coordinates}

A manifold will be loosely defined herein as a parameterized surface.  For example, a 2D manifold can be considered a surface in an $n$ dimensional vector space, parameterized by two variables

\begin{equation}\label{eqn:stokesTheoremGeometricAlgebraII:1280}
\Bx = \Bx(a,b) = \Bx(u^1, u^2).
\end{equation}

Note that the indices here do not represent exponentiation.  We can construct a basis for the manifold as

\begin{equation}\label{eqn:stokesTheoremGeometricAlgebraII:1300}
\Bx_i = \PD{u^i}{\Bx}.
\end{equation}

On the manifold we can calculate a reciprocal basis $\{\Bx^i\}$, defined by requiring, at each point on the surface

\begin{equation}\label{eqn:stokesTheoremGeometricAlgebraII:1320}
\Bx^i \cdot \Bx_j = {\delta^i}_j.
\end{equation}

Associated implicitly with this basis is a curvilinear coordinate representation defined by the projection operation

\begin{equation}\label{eqn:stokesTheoremGeometricAlgebraII:1340}
\Bx = x^i \Bx_i,
\end{equation}

(sums over mixed indexes are implied).   These coordinates can be calculated by taking dot products with the reciprocal frame vectors

\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebraII:1360}
\Bx \cdot \Bx^i 
= x^j \Bx_j \cdot \Bx^i 
= x^j {\delta_j}^i 
= x^i.
\end{dmath}

Having used the same notation for coordinates with respect to the standard basis and its dual, we must rely on context to disambiguate the two.  In most cases to follow coordinates are with respect to a specific curvilinear basis.

When the complete vector space is spanned by $\{\Bx_i\}$ the gradient has the curvilinear representation

\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebraII:1380}
\spacegrad = \Bx^i \PD{u^i}{}.
\end{dmath}

When this basis does not span the space, this sum is the projection of the gradiient onto the tangent space at the point of evaluation, and is called the vector derivative

\begin{equation}\label{eqn:stokesTheoremGeometricAlgebraII:1400}
\boldpartial = \Bx^i \PD{u^i}{}.
\end{equation}

It will be convient to write this sum over indexes $i$ with the short hand $\PD{u^i}{} \equiv \partial_i$, or

\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebraII:1740}
\boldpartial = \Bx^i \partial_i.
\end{dmath}

To avoid ambiguity we will not use the $\partial_i = \PDi{x^i}{}$ notation that we use for standard bases.

See \citep{aMacdonaldVAGC} for a more complete discussion of the gradient and vector derivatives in curvilinear coordinates.

\section{Green's theorem}

Given a two parameter ($u,v$) surface parameterization, the curvilinear coordinate representation of a vector $\Bf$ has the form

\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebraII:1640}
\Bf = f_u \Bx^u + f_v \Bx^v + f_\perp \Bx^\perp.
\end{dmath}

We assume that the vector space is of dimension two or greater but otherwise unrestricted, and need not have an Euclidean basis.  Here $f_\perp \Bx^\perp$ denotes the rejection of $\Bf$ from the tangent space at the point of evaluation.  Green's theorem relates the integral around a closed curve to an ``area'' integral on that surface

\begin{theorem}[Green's Theorem]\label{thm:stokesTheoremGeometricAlgebraII:1660}
\begin{equation*}
\ointctrclockwise \Bf \cdot d\Bl
=
\iint \lr{ 
-\PD{v}{f_u}
+\PD{u}{f_v}
}
du dv
\end{equation*}
\end{theorem}

Following the arguments used in \citep{schwartz1987pe} for Stokes theorem in three dimensions, we first evaluate the loop integral along the differential element of the surface at the point $\Bx(u_0, v_0)$ evaluated over the range $(du, dv)$, as shown in the infinitesimal loop of \cref{fig:loopIntegralInfinitesimal:loopIntegralInfinitesimalFig1}.

\imageFigure{../../figures/gabook/loopIntegralInfinitesimalFig1}{Infinitesimal loop integral}{fig:loopIntegralInfinitesimal:loopIntegralInfinitesimalFig1}{0.2}

Over the infinitesimal area, the loop integral decomposes into

\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebraII:1700}
\ointctrclockwise \Bf \cdot d\Bl
=
\int \Bf \cdot d\Bx_1
+\int \Bf \cdot d\Bx_2
+\int \Bf \cdot d\Bx_3
+\int \Bf \cdot d\Bx_4,
\end{dmath}

where the differentials along the curve are

\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebraII:1600}
\begin{aligned}
d\Bx_1 &= \evalbar{ \PD{u}{\Bx} }{v = v_0} du \\
d\Bx_2 &= \evalbar{ \PD{v}{\Bx} }{u = u_0 + du} dv \\
d\Bx_3 &= -\evalbar{ \PD{u}{\Bx} }{v = v_0 + dv} du \\
d\Bx_4 &= -\evalbar{ \PD{v}{\Bx} }{u = u_0} dv.
\end{aligned}
\end{dmath}

It is assumed that the parameterization change $(du, dv)$ is small enough that this loop integral can be considered planar (regardless of the dimension of the vector space).  Making use of the fact that $\Bx^\perp \cdot \Bx_\alpha = 0$ for $\alpha \in \{u,v\}$, the loop integral is

\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebraII:1620}
\ointctrclockwise \Bf \cdot d\Bl
=
\int 
\lr{
f_u \Bx^u + f_v \Bx^v + f_\perp \Bx^\perp
}
\cdot 
\Bigl( 
\Bx_u(u, v_0) du - \Bx_u(u, v_0 + dv) du
+\Bx_v(u_0 + du, v) dv - \Bx_v(u_0, v) dv
\Bigr)
=
\int 
f_u(u, v_0) du - f_u(u, v_0 + dv) du
+
f_v(u_0 + du, v) dv - f_v(u_0, v) dv
\end{dmath}

With the distances being infinesimal, these diffences can be rewritten as partial differentials

\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebraII:1860}
\ointctrclockwise \Bf \cdot d\Bl
=
\iint \lr{ 
-\PD{v}{f_u}
+\PD{u}{f_v}
}
du dv.
\end{dmath}

We can now sum over a larger area as in \cref{fig:loopIntegralInfinitesimalSum:loopIntegralInfinitesimalSumFig2}

\imageFigure{../../figures/gabook/loopIntegralInfinitesimalSumFig2}{Sum of infinitesimal loops}{fig:loopIntegralInfinitesimalSum:loopIntegralInfinitesimalSumFig2}{0.2}

All the opposing oriented loop elements cancel, so the integral around the complete boundary of the surface $\Bx(u, v)$ is given by the $u,v$ area integral of the partials difference.

We will see that Green's theorem is a special case of the Curl (Stokes) theorem.  This observation will also provide a geometric interpretation of the right hand side area integral of \cref{thm:stokesTheoremGeometricAlgebraII:1660}, and allow for a coordinate free representation.

\paragraph{Special case:}

An important special case of Green's theorem is for a Euclidean two dimensional space where the vector function is

\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebraII:1720}
\Bf = P \Be_1 + Q \Be_2.
\end{dmath}

Here Green's theorem takes the form

\boxedEquation{eqn:stokesTheoremGeometricAlgebraII:1710}{
\ointctrclockwise P dx + Q dy
=
\iint \lr{ 
\PD{x}{Q}
-\PD{y}{P}
}
dx dy.
}

\section{Curl theorem, two volume vector field}

Having examined the right hand side of \cref{thm:stokesTheoremGeometricAlgebraII:1740} for the very simplest geometric object $\Bf$, let's look at the right hand side, the area integral in more detail.  We restrict our attention for now to vectors $\Bf$ still defined by \eqnref{eqn:stokesTheoremGeometricAlgebraII:1640}.  

First we need to assign a meaning to $d^2 \Bx$.  By this, we mean the wedge products of the two differential elements.  With

\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebraII:1780}
d\Bx_i = du^i \PD{u^i}{\Bx} = du^i \Bx_i,
\end{dmath}

that area element is

\begin{equation}\label{eqn:stokesTheoremGeometricAlgebraII:1800}
d^2 \Bx 
= d\Bx_1 \wedge d\Bx_2
= du^1 du^2 \Bx_1 \wedge \Bx_2.
\end{equation}

This is the oriented area element that lies in the tangent plane at the point of evaluation, and has the magnitude of the area of that segment of the surface, as depicted in \cref{fig:loopIntegralAreaElements:loopIntegralAreaElementsFig3}.

\imageFigure{../../figures/gabook/loopIntegralAreaElementsFig3}{Oriented area element tiling of a surface}{fig:loopIntegralAreaElements:loopIntegralAreaElementsFig3}{0.3}

Observe that we have no requirement to introduce a normal to the surface to describe the direction of the plane.  The wedge product provides the information about the orientation of the place in the space, even when the vector space that our vector lies in has dimension greater than three.

Proceeding with the expansion of the dot product of the area element with the curl, using \eqnref{eqn:stokesTheoremGeometricAlgebraII:800}, \eqnref{eqn:stokesTheoremGeometricAlgebraII:820}, and \eqnref{eqn:stokesTheoremGeometricAlgebraII:920}, and a scalar selection operation, we have

\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebraII:1760}
d^2 \Bx \cdot \lr{ \boldpartial \wedge \Bf }
=
\gpgradezero{
d^2 \Bx \lr{ \boldpartial \wedge \Bf }
}
=
\gpgradezero{
d^2 \Bx 
\inv{2}
\lr{ \rboldpartial \Bf - \Bf \lboldpartial }
}
=
\inv{2}
\gpgradezero{
d^2 \Bx \lr{ \Bx^i \lr{ \partial_i \Bf} - \lr{\partial_i \Bf} \Bx^i }
}
=
\inv{2}
\gpgradezero{
\lr{ \partial_i \Bf } d^2 \Bx \Bx^i - \lr{ \partial_i \Bf } \Bx^i d^2 \Bx
}
=
\gpgradezero{
\lr{ \partial_i \Bf } \lr{ d^2 \Bx \cdot \Bx^i }
}
=
\partial_i \Bf \cdot 
\lr{ d^2 \Bx \cdot \Bx^i }.
\end{dmath}

Let's proceed to expand the inner dot product

\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebraII:1820}
d^2 \Bx \cdot \Bx^i 
=
du^1 du^2
\lr{ \Bx_1 \wedge \Bx_2 } \cdot \Bx^i
=
du^1 du^2
\lr{
\Bx_1 \cdot \Bx^i \Bx_2
-\Bx_2 \cdot \Bx^i \Bx_1
}
=
du^1 du^2
\lr{
{\delta_1}^i \Bx_2
-{\delta_2}^i \Bx_1
}.
\end{dmath}

The complete curl term is thus

\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebraII:1840}
d^2 \Bx \cdot \lr{ \boldpartial \wedge \Bf }
=
du^1 du^2
\lr{
\PD{u^1}{\Bf} \cdot \Bx_2
-\PD{u^2}{\Bf} \cdot \Bx_1
}
\end{dmath}

This almost has the form of \eqnref{eqn:stokesTheoremGeometricAlgebraII:1860}, although that is not immediately obvious.  Eliminating the coordinate representation, we have

\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebraII:1900}
\PD{u}{f_v} -\PD{v}{f_u}
=
\PD{u}{}\lr{\Bf \cdot \Bx_v}
-\PD{v}{}\lr{\Bf \cdot \Bx_u}
=
\PD{u}{\Bf} \cdot \Bx_v
-\PD{v}{\Bf} \cdot \Bx_v
+ 
\Bf \cdot \lr{
\PD{u}{\Bx_v} 
-\PD{v}{\Bx_u} 
}
=
\PD{u}{\Bf} \cdot \Bx_v
-\PD{v}{\Bf} \cdot \Bx_v
+ 
\Bf \cdot \lr{
\frac{\partial^2 \Bx}{\partial u \partial v}
-\frac{\partial^2 \Bx}{\partial v \partial u}
}
=
\PD{u}{\Bf} \cdot \Bx_v
-\PD{v}{\Bf} \cdot \Bx_v.
\end{dmath}

With the shorthand $u = u^1, v = u^2$ eliminated, and after scaling by $-du^1 du^2$, this is equal to the area integrand of \eqnref{eqn:stokesTheoremGeometricAlgebraII:1840}.  We have related the two parameter surface integral of the curl to the loop integral over its boundary

\boxedEquation{eqn:stokesTheoremGeometricAlgebraII:1980}{
\int d^2 \Bx \cdot (\boldpartial \wedge \Bf) = \ointclockwise \Bf \cdot d\Bl.
}

This is the very simplest special case of Stokes theorem.   Comparing to the general form of Stokes \cref{thm:stokesTheoremGeometricAlgebraII:1740}, we see that the one volume surface area element can be written implicitly as

\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebraII:2100}
d^1 \Bx \cdot \Bf = \Bf \cdot \lr{ d\Bx_2 -d\Bx_1 },
\end{dmath}

where it is implied that both the vector $\Bf$ and the differential elements are evaluated on the boundaries of the integration ranges respectively.  From this we can loosely express the ``surface'' differential element as

\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebraII:2120}
d^1 \Bx = d\Bx_2 -d\Bx_1.
\end{dmath}

FIXME: example.  Euclidean space.

FIXME: example.  Non-Euclidean space.

\section{Stokes theorem, three volume vector field}

As a further expositional example, let's now consider the curl of a vector field, integrated over a three parameter surface.  With this generalization, let's start calling this Stokes theorem, instead of the Curl theorem.

Using \cref{thm:stokesTheoremGeometricAlgebraII:1420}, we have

\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebraII:1940}
d^3 \Bx \cdot \lr{ \boldpartial \wedge \Bf }
=
\lr{ d^3 \Bx \cdot \Bx^i } \cdot \partial_i \Bf
=
du^1 du^2 du^3
\lr{ 
\lr{ \Bx_1 \wedge \Bx_2 \wedge \Bx_3 }
 \cdot \Bx^i } \cdot \partial_i \Bf
=
du^1 du^2 du^3
\lr{ 
\lr{ \Bx_1 \wedge \Bx_2 } {\delta_3}^i 
-\lr{ \Bx_1 \wedge \Bx_3 } {\delta_2}^i 
+\lr{ \Bx_2 \wedge \Bx_3 } {\delta_1}^i 
} \cdot \partial_i \Bf
=
du^1 du^2 du^3
\lr{
\lr{ \Bx_1 \wedge \Bx_2 } \cdot \partial_3 \Bf
-\lr{ \Bx_1 \wedge \Bx_3 } \cdot \partial_2 \Bf
+\lr{ \Bx_2 \wedge \Bx_3 } \cdot \partial_1 \Bf
}.
\end{dmath}

\begin{mdframed}[style=digressionarrows]
As was the case with the loop integral, we expect this to equal a completely antisymmetric sum over the coordinates of $\Bf$.  A bit of experimentation shows that such a sum, after dropping the parameter space volume element factor, is

\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebraII:1960}
\Bx_1 \lr{ -\partial_2 f_3 + \partial_3 f_2 }
+\Bx_2 \lr{ -\partial_3 f_1 + \partial_1 f_3 }
+\Bx_3 \lr{ -\partial_1 f_2 + \partial_2 f_1 }
=
\Bx_1 \lr{ -\partial_2 \Bf \cdot \Bx_3 + \partial_3 \Bf \cdot \Bx_2 }
+\Bx_2 \lr{ -\partial_3 \Bf \cdot \Bx_1 + \partial_1 \Bf \cdot \Bx_3 }
+\Bx_3 \lr{ -\partial_1 \Bf \cdot \Bx_2 + \partial_2 \Bf \cdot \Bx_1 }
=
\lr{ \Bx_1 \partial_3 \Bf \cdot \Bx_2 -\Bx_2 \partial_3 \Bf \cdot \Bx_1 }
+\lr{ \Bx_3 \partial_2 \Bf \cdot \Bx_1 -\Bx_1 \partial_2 \Bf \cdot \Bx_3 }
+\lr{ \Bx_2 \partial_1 \Bf \cdot \Bx_3 -\Bx_3 \partial_1 \Bf \cdot \Bx_2 }
= 
 \lr{ \Bx_1 \wedge \Bx_2 } \cdot \partial_3 \Bf
+\lr{ \Bx_3 \wedge \Bx_1 } \cdot \partial_2 \Bf
+\lr{ \Bx_2 \wedge \Bx_3 } \cdot \partial_1 \Bf.
\end{dmath}
\end{mdframed}

The key to the Stokes argument is again consideration of a differential volume element, for which the partial can be evaluated as the difference of the endpoints, with all else held constant.  Using a $(u,v,w)$ parameterization over such a differential volume element delimited by the parameterization ranges 
$[u_0,u_0 + du]$, $[v_0,v_0 + dv]$, $[w_0,w_0 + dw]$, we have

\begin{equation}\label{eqn:stokesTheoremGeometricAlgebraII:2000}
\begin{aligned}
\int_{u = u_0}^{u_0 + du}
\int_{v = v_0}^{v_0 + dv}
\int_{w = w_0}^{w_0 + dw}
d^3 \Bx \cdot \lr{ \boldpartial \wedge \Bf }
&=
\int_{u = u_0}^{u_0 + du}
du 
\int_{v = v_0}^{v_0 + dv}
dv
\evalrange{ \biglr{ \lr{ \Bx_u \wedge \Bx_v } \cdot \Bf } }{w = w_0}{w_0 + dw} \\
&-
\int_{u = u_0}^{u_0 + du}
du 
\int_{w = w_0}^{w_0 + dw}
dw
\evalrange{\biglr{ \lr{ \Bx_u \wedge \Bx_w } \cdot \Bf } }{v = v_0}{v_0 + dv} \\
&+
\int_{v = v_0}^{v_0 + dv}
dv 
\int_{w = w_0}^{w_0 + dw}
dw
\evalrange{
\biglr{ \lr{ \Bx_v \wedge \Bx_w } \cdot \Bf } }{u = u_0}{u_0 + du}
.
\end{aligned}
\end{equation}

Extending this over the ranges $[u_0,u_0 + \Delta u]$, $[v_0,v_0 + \Delta v]$, $[w_0,w_0 + \Delta w]$, we have proved Stokes \cref{thm:stokesTheoremGeometricAlgebraII:1740} for vectors and a three parameter volume element, provided we have a surface element of the form

\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebraII:2020}
d^2 \Bx =
\evalrange{ \biglr{d\Bx_u \wedge d\Bx_v } }{w = w_0}{w_1}
-
\evalrange{ \biglr{d\Bx_u \wedge d\Bx_w } }{v = v_0}{v_1}
+
\evalrange{ \biglr{d\Bx_v \wedge \Bx_w } }{ u = u_0 }{u_1},
\end{dmath}

where the evaluation of the dot products with $\Bf$ are also evaluated at the same points.

\section{Stokes theorem, four volume vector field}

It's becoming clear how this generalizes.  Let's examine one more specific expansion of the boundary surface volume element for a four volume parameterization.  This is the last special case of physical interest (for relativistic physics in $\bigwedge^{3,1}$ spaces).

Using a parameterization $u^1 = x, u^2 = y, u^3 = z, u^4 = \tau = c t$, our four volume is

\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebraII:2040}
d^4 \Bx 
= 
d\Bx_x \wedge
d\Bx_y \wedge
d\Bx_z \wedge
d\Bx_\tau,
\end{dmath}

and the cooresponding boundary surface differential form we find using the same expansion

\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebraII:2060}
d^4 \Bx \cdot \lr{ \boldpartial \wedge \Bf }
=
\lr{ d^4 \Bx \cdot \Bx^i } \cdot \partial_i \Bf
=
du^1 du^2 du^3 du^4
\lr{ 
\lr{ \Bx_1 \wedge \Bx_2 \wedge \Bx_3 \wedge \Bx_4 }
 \cdot \Bx^i } \cdot \partial_i \Bf
=
du^1 du^2 du^3 du_4
\lr{ 
\lr{ \Bx_1 \wedge \Bx_2 \wedge \Bx_3 } {\delta_4}^i 
-\lr{ \Bx_1 \wedge \Bx_2 \wedge \Bx_4 } {\delta_3}^i 
+\lr{ \Bx_1 \wedge \Bx_3 \wedge \Bx_4 } {\delta_2}^i 
-\lr{ \Bx_2 \wedge \Bx_3 \wedge \Bx_4 } {\delta_1}^i 
} \cdot \partial_i \Bf
=
du^1 du^2 du^3 du^4
\lr{
 \lr{ \Bx_1 \wedge \Bx_2 \wedge \Bx_3 } \cdot \partial_4 \Bf
-\lr{ \Bx_1 \wedge \Bx_2 \wedge \Bx_4 } \cdot \partial_3 \Bf
+\lr{ \Bx_1 \wedge \Bx_3 \wedge \Bx_4 } \cdot \partial_2 \Bf
-\lr{ \Bx_2 \wedge \Bx_3 \wedge \Bx_4 } \cdot \partial_1 \Bf
}.
\end{dmath}

Our boundary value surface element is therefore

\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebraII:2080}
d^3 \Bx =
  \Bx_1 \wedge \Bx_2 \wedge \Bx_3 
- \Bx_1 \wedge \Bx_2 \wedge \Bx_4
+ \Bx_1 \wedge \Bx_3 \wedge \Bx_4 
- \Bx_2 \wedge \Bx_3 \wedge \Bx_4.
\end{dmath}

where it is implied that this (and the dot products with $\Bf$) are evaluated on the boundaries of the integration ranges of the omitted index.

\section{Stokes theorem, four volume vector field}

\section{Stokes theorem, three volume bivector field}

\section{Stokes theorem, four volume bivector field}

\section{Stokes theorem, general case}

\section{Appendix}

To expand a general inner product of the form $d^k \Bx \cdot (\boldpartial \wedge F)$ we require

\begin{lemma}[Distribution of inner products]\label{thm:stokesTheoremGeometricAlgebraII:1420}
Given two blades $A_s, B_r$ with grades subject to $s > r > 0$, and a vector $b$, the inner product distributes according to
\begin{equation*}
A_s \cdot \lr{ b \wedge B_r } = \lr{ A_s \cdot b } \cdot B_r.
\end{equation*}
\end{lemma}

The proof is straightforward, but also mechanical.
Start by expanding the wedge and dot products within a grade selection operator

\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebraII:1460}
A_s \cdot \lr{ b \wedge B_r }
=
\gpgrade{A_s (b \wedge B_r)}{s - (r + 1)}
=
\inv{2} \gpgrade{A_s \lr{b B_r + (-1)^{r} B_r b} }{s - (r + 1)}
\end{dmath}

Solving for $B_r b$ in 

\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebraII:1480}
2 b \cdot B_r = b B_r - (-1)^{r} B_r b,
\end{dmath}

we have

\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebraII:1500}
A_s \cdot \lr{ b \wedge B_r }
=
\inv{2} \gpgrade{ A_s b B_r + A_s \lr{ b B_r - 2 b \cdot B_r } }{s - (r + 1)}
=
\gpgrade{ A_s b B_r }{s - (r + 1)}
- 
\cancel{\gpgrade{ A_s \lr{ b \cdot B_r } }{s - (r + 1)}}.
\end{dmath}

The last term above is zero since we are selecting the $s - r - 1$ grade element of a multivector with grades $s - r + 1$ and $s + r - 1$, which has no terms for $r > 0$.  Now we can expand the $A_s b$ multivector product, for

\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebraII:1520}
A_s \cdot \lr{ b \wedge B_r }
=
\gpgrade{ \lr{ A_s \cdot b + A_s \wedge b} B_r }{s - (r + 1)}.
\end{dmath}

The latter multivector (with the wedge product factor) above has grades $s + 1 - r$ and $s + 1 + r$, so this selection operator finds nothing.  This leaves

\begin{dmath}\label{eqn:stokesTheoremGeometricAlgebraII:1540}
A_s \cdot \lr{ b \wedge B_r }
=
\gpgrade{ 
\lr{ A_s \cdot b } \cdot B_r
+ \lr{ A_s \cdot b } \wedge B_r 
}{s - (r + 1)}.
\end{dmath}

The first dot products term has grade $s - 1 - r$ and is selected, whereas the wedge term has grade $s - 1 + r \ne s - r - 1$ (for $r > 0$).  This completes the proof.

\EndArticle
