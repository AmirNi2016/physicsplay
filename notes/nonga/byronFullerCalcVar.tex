\documentclass{article}

\input{../peeters_macros.tex}
\input{../peeters_macros2.tex}

%\usepackage{listings}
%\usepackage{txfonts} % for ointctr... (also appears to make "prettier" \int and \sum's)
% makes \grad look funny though (almost like spacegrad, but narrower)

\usepackage[bookmarks=true]{hyperref}

\usepackage{color,cite,graphicx}
   % use colour in the document, put your citations as [1-4]
   % rather than [1,2,3,4] (it looks nicer, and the extended LaTeX2e
   % graphics package. 
\usepackage{latexsym,amssymb,epsf} % don't remember if these are
   % needed, but their inclusion can't do any damage


\title{ Worked calculus of variations problems from Byron and Fuller. }
\author{Peeter Joot \quad peeter.joot@gmail.com }
\date{ March 21, 2009.  Last Revision: $Date: 2009/05/01 01:32:05 $ }

\begin{document}

\maketitle{}
\tableofcontents

\section{ Worked calculus of variations problems. }

Select problems from chapter II of \cite{byron1992mca}.

\subsection{ Problem 1.  Shortest line between points in polar coordinates. }

Problem.  Variational calculus exersize to find shortest distance between two points using polar coordinates.
 
The line element is:
 
\begin{align*}
ds^2 = r^2 d\theta^2 + {r'}^2
\end{align*}
 
So, the integral to minimize is
 
\begin{align*}
I = \int \sqrt{ r^2 + {r'}^2 } d\theta
\end{align*}
 
Application of the Euler-Lagrange equations yields
 
\begin{align*}
0 
&= \left( \PD{r}{} - \frac{d}{d\theta} \PD{r'}{} \right) \sqrt{ r^2 + {r'}^2 }  \\
&= \frac{r}{\sqrt{{r'}^2 + r^2}} - \frac{d}{d\theta} \left( \frac{{r'}}{\sqrt{{r'}^2 + r^2}}\right) \\
\end{align*}
 
Dividing through by $r$ and writing $v = u' = {r'}/r$ this is
 
\begin{align*}
\frac{1}{\sqrt{v^2 + 1}}
&= \frac{d}{d\theta} \left( \frac{v}{\sqrt{v^2 + 1}}\right) \\
&= \frac{v'}{\sqrt{v^2 + 1}} -\frac{v^2 v'}{(\sqrt{v^2 + 1})^3} \\
\end{align*}
 
\begin{align*}
1 
&= v' \left( 1 -\frac{v^2 }{v^2 + 1} \right) \\
&= \frac{v'}{v^2 + 1} \\
\end{align*}

This is now separable, and can be integrated directly

\begin{align*}
\theta - \theta_0
&= \int \frac{dv}{v^2 + 1} \\
&= \arctan(v) \\
\end{align*}
 
\begin{align*}
\tan(\theta - \theta_0)
&= \frac{{r'}}{r} \\
&= \frac{d \ln(r) }{d\theta}
\end{align*}

That solves the first of the second order differential equations resulting from the Euler-Lagrange equations, and the 
last becomes
\begin{align*}
\ln(r) &= \int \tan(\theta - \theta_0) d\theta \\
&= -\ln(\cos(\theta - \theta_0)) + \ln(r_0)
\end{align*}

Finally a polar parametric equation is obtained
 
\begin{align*}
\frac{r}{r_0} \cos(\theta - \theta_0) = 1
\end{align*}
 
If all went right, this should be the equation for a straight line in polar form.

It doesn't look like one, but if the cosine is expanded 

\begin{align*}
\cos(\theta - \theta_0) 
&= \Re\left( e^{i\theta}e^{-i\theta_0} \right) \\
&= \Re\left( (\cos\theta + i\sin\theta)(\cos\theta_0 - i\sin\theta_0) \right) \\
&= \cos\theta\cos\theta_0 + \sin\theta\sin\theta_0 \\
\end{align*}

With $x = r\cos\theta$, and $y = r\sin\theta$ this gives

\begin{align*}
r_0 
&= r \left( \cos\theta\cos\theta_0 + \sin\theta\sin\theta_0 \right) \\
&= x \cos\theta_0 + y\sin\theta_0 \\
\end{align*}

So, sure enough, following the math gives an equation for a straight line in a recognizable form.

\subsection{ Problem 2. Shortest line, in 3D. }

Did this one in \cite{PJgoldch1}

\subsection{ Problem 3.  Spherical geodesics. }

First calculate the line element (this was given in the problem, but I feel like working it out).
The position vector with $i = \Be_1 \Be_2$, is given by

\begin{align*}
\Br = a ( \sin\theta \Be_1 e^{i\phi} + \Be_3 \cos\theta )
\end{align*}

So, the differential given constant radius $a$ is

\begin{align*}
d\Br 
&= 
a \thetadot ( \cos\theta \Be_1 e^{i\phi} - \Be_3 \sin\theta )
+ a \phidot ( \sin\theta \Be_1 \Be_1 \Be_2 e^{i\phi} ) \\
&= 
a \left( \thetadot \cos\theta \Be_1 + \phidot \sin\theta \Be_2 \right) e^{i\phi} - a \thetadot \Be_3 \sin\theta \\
\end{align*}

And the square is
\begin{align*}
d\Br^2
&= a^2 \left( \thetadot^2 \cos^2\theta + \phidot^2 \sin^2\theta + \thetadot^2 \sin^2\theta \right) \\
&= a^2 \left( \thetadot^2 + \phidot^2 \sin^2\theta \right) \\
\end{align*}

Here the derivatives are with respect to some implicit variable that parameterizes the differential displacement.
This can be taken to be $\theta$, which gives the distance along any two points on the sphere as

\begin{align*}
S &= a^2 \int d\theta \sqrt{1 + \left(\frac{d\phi}{d\theta}\right)^2 \sin^2\theta } \\
\end{align*}

Writing $f(\theta, \phi, \phidot) = \sqrt{1 + \phidot^2 \sin^2\theta}$, the Euler-Lagrange equations can be
applied

\begin{align*}
0 
&= \left( \PD{\phi}{} - \frac{d}{d\theta} \PD{\phidot}{} \right) f \\
&= 0 - \frac{d}{d\theta} \frac{(1/2)(2\phidot) \sin^2\theta}{\sqrt{1 + \phidot^2 \sin^2\theta}} \\
\end{align*}

Introducing an integration constant $\kappa$, this is

\begin{align*}
\phidot \sin^2\theta = \kappa \sqrt{1 + \phidot^2 \sin^2\theta}
\end{align*}

squaring
\begin{align*}
\phidot^2 \sin^4\theta &= \kappa^2 \left(1 + \phidot^2 \sin^2\theta \right) \\
\phidot^2 \sin^2\theta \left( \sin^2 \theta - \kappa^2 \right) &= \kappa^2 \\
\end{align*}

\begin{align*}
\phi - \phi_0 &= \kappa \int \frac{d\theta}{\sin\theta \sqrt{ \sin^2 \theta - \kappa^2 }} \\
\end{align*}

This doesn't look particularily nice to integrate.  Instead, let's try writing the arc length integral as

\begin{align*}
\frac{S}{a^2} &= \int d\phi \sqrt{{\frac{d\theta}{d\phi}}^2 + \sin^2\theta } \\
\end{align*}

\begin{align*}
0 
&= \left( \PD{\theta}{} - \frac{d}{d\phi} \PD{\thetadot}{} \right) \sqrt{\thetadot^2 + \sin^2\theta } \\
&= \frac{\sin\theta \cos\theta}{ \sqrt{\thetadot^2 + \sin^2\theta } } -
\frac{d}{d\phi} \frac{\thetadot} { \sqrt{\thetadot^2 + \sin^2\theta } } \\
&= \frac{\sin\theta \cos\theta}{ \sqrt{\thetadot^2 + \sin^2\theta } } -
\left(
\frac{\thetaddot} { \sqrt{\thetadot^2 + \sin^2\theta } } 
+ \frac{(-1/2)\thetadot(2 \thetadot \thetaddot + 2 \sin\theta\cos\theta \thetadot)} { (\sqrt{\thetadot^2 + \sin^2\theta })^3 } 
\right) \\
&= \frac{\sin\theta \cos\theta}{ \sqrt{\thetadot^2 + \sin^2\theta } } 
- \frac{\thetaddot} { \sqrt{\thetadot^2 + \sin^2\theta } } 
+ \frac{\thetadot^2( \thetaddot + \sin\theta\cos\theta )} { (\sqrt{\thetadot^2 + \sin^2\theta })^3 } 
\\
\end{align*}

Multiplying through by $(\sqrt{\thetadot^2 + \sin^2\theta })^3$, this is

\begin{align*}
0 
&= (\sin\theta \cos\theta - \thetaddot) ( \thetadot^2 + \sin^2\theta ) + \thetadot^2( \thetaddot + \sin\theta\cos\theta )  \\
&= 
2 \sin\theta \cos\theta \thetadot^2 
+ \sin\theta \cos\theta \sin^2\theta 
- \thetaddot \sin^2\theta  
\\
\end{align*}

Or
\begin{align*}
\thetaddot =
2 (\cot\theta) \thetadot^2 
+ \sin\theta \cos\theta 
\end{align*}

Darn.  That doesn't look much easier to solve.

Looking back at the problem, I see that it was asked to prove that $\phi = \alpha - \sin^{-1}(k\cot(\theta))$.  So, instead of trying to solve
the differential equation above from scratch, verification that this given solution is probably all that was desired.

\begin{align*}
-\sin(\phi - \alpha) = k\cot(\theta)
\end{align*}

Or
\begin{align*}
\theta = \cot^{-1}\left(-\inv{k} \sin(\phi - \alpha)\right)
\end{align*}

Looks like derivatives of the above are required. ... An exersize for a different night.

\subsection{ Problem 6.  Action with second order derivatives. }

Did this one in \cite{PJgoldch1}.

\subsection{ Problem 7.  Fermat's principle. }

TODO: looks like an interesting one.

\subsection{ Problem 9.  Schr\"{o}dinger Lagrangian. }

Did this one in \cite{PJgoldch1}.

\subsection{ Problem 10.  $\pi$-meson Lagrangian (Klein-Gordon). }

\subsubsection{ Setup. }

Charged scalar meson in two real fields is given in the Minkowski notation $x_\mu = (x,y,z,it)$, with $c = \hbar = 1$.

\begin{align}
\LL = -\inv{2}\left( 
\PD{x_\mu}{\phi_1} \PD{x_\mu}{\phi_1} 
+ \PD{x_\mu}{\phi_2} \PD{x_\mu}{\phi_2} 
\right)
+ \inv{2}
\left( 
{\phi_1}^2 
+ {\phi_2}^2 
\right)
\left( e^2 A_\mu A_\mu - m^2 \right) 
+ e A_\mu \left(
\phi_2 \PD{x_\mu}{\phi_1}
-\phi_1 \PD{x_\mu}{\phi_2}
\right)
\end{align}

With summation over repeated indexes.

I'm more comfortable with the upper and lower index notation used for repeated indexes, and will switch to that for the remainder
of the problem.  Translating with $x^\mu = (x,y,z,t)$, $x_\mu = (x,y,z,-t)$ (retaining the use of a $+++-$ metric), we have

\begin{align}
\LL 
&= -\inv{2}\left( 
\PD{x_\mu}{\phi_1} \PD{x^\mu}{\phi_1} 
+ \PD{x_\mu}{\phi_2} \PD{x^\mu}{\phi_2} 
\right)
+ \inv{2}
\left( 
{\phi_1}^2 
+ {\phi_2}^2 
\right)
\left( e^2 A_\mu A^\mu - m^2 \right) 
+ e A^\mu \left(
\phi_2 \PD{x^\mu}{\phi_1}
-\phi_1 \PD{x^\mu}{\phi_2}
\right) \\
&= -\inv{2}\left( 
\partial_\mu \phi_1 \partial^\mu \phi_1
+\partial_\mu \phi_1 \partial^\mu \phi_1
\right)
+ \inv{2}
\left( 
{\phi_1}^2 
+ {\phi_2}^2 
\right)
\left( e^2 A_\mu A^\mu - m^2 \right) 
+ e A^\mu \left(
\phi_2 \partial_\mu {\phi_1}
-\phi_1 \partial_\mu {\phi_2}
\right) 
\end{align}

In this last form with $\partial_\mu \equiv \PDi{x^\mu}{}$, and $\partial^\mu \equiv \PDi{x_\mu}{}$, we have this Lagrangian density expressed nicely with
balanced upper and lower indexes.

%For comfort with the conventions
%I'm used to using, translate this to a $+---$ metric as well as the use of upper and lower index notation.  The density is 
%then
%
%\begin{align}
%\LL 
%&=
%\inv{2}\left( 
%\partial_\mu \phi_1 \partial^\mu \phi_1
%+\partial_\mu \phi_2 \partial^\mu \phi_2
%\right)
%- \inv{2} \left( m^2 + e^2 A^\mu A_\mu \right) \left( {\phi_1}^2 + {\phi_2}^2 \right)
%- e A^\mu \left( 
%\phi_2 \partial_\mu \phi_1 - \phi_1 \partial_\mu \phi_2  
%\right) 
%\end{align}

%\begin{align}
%\LL 
%&=
%\inv{2}\left( (\grad \phi_1)^2 + (\grad \phi_2)^2 \right)
%- \inv{2} \left( m^2 + e^2 A^2 \right) \left( {\phi_1}^2 + {\phi_2}^2 \right)
%- e A \cdot \left( \phi_2 \grad \phi_1 - \phi_1 \grad \phi_2  \right) 
%\end{align}

\subsubsection{ Euler-Lagrange evaluation. }

Evaluating the Euler-Lagrange equations we have

\begin{align*}
\PD{\phi_1}{\LL} &= \left( -m^2 + e^2 A^\mu A_\mu \right) \phi_1 - e A^\mu \partial_\mu \phi_2 
\end{align*}

\begin{align*}
\partial_\mu \PD{(\partial_\mu \phi_1)}{\LL} 
&=
\partial_\mu \left( -\partial^\mu \phi_1 + e A^\mu \phi_2 \right) \\
&=
-\partial_\mu \partial^\mu \phi_1 
+ e (\partial_\mu A^\mu) \phi_2 
+ e A^\mu \partial_\mu \phi_2 
\\
\end{align*}

Adding in the same calculation for variation of $\phi_2$ we have

\begin{align*}
\left( \partial_\mu \partial^\mu -m^2 + e^2 A^\mu A_\mu \right) \phi_1 &= e (\partial_\mu A^\mu) \phi_2 + 2 e (A^\mu \partial_\mu) \phi_2  \\
\left( \partial_\mu \partial^\mu -m^2 + e^2 A^\mu A_\mu \right) \phi_2 &= -e (\partial_\mu A^\mu) \phi_1 - 2 e (A^\mu \partial_\mu) \phi_1 
\end{align*}

%\begin{align}
%(\grad^2 + m^2 + e^2 A^2) \phi_1 &= e (\grad \cdot A) \phi_2 + 2 e A \cdot (\grad \phi_2) \\
%(\grad^2 + m^2 + e^2 A^2) \phi_2 &= - e (\grad \cdot A) \phi_1 - 2 e A \cdot (\grad \phi_1)
%\end{align}
%
\subsubsection{ Complexify the Euler-Lagrange solutions. }

Writing

\begin{align*}
\phi &= \inv{\sqrt{2}}\left( \phi_1 - i \phi_2 \right) \\
\phi^\conj &= \inv{\sqrt{2}}\left( \phi_2 + i \phi_2 \right) \\
\end{align*}

and by adding multiples of the Euler-Lagrange equation evaluations above we have

\begin{align}\label{eqn:complexifiedSolution}
\left( \partial_\mu \partial^\mu -m^2 + e^2 A^\mu A_\mu \right) \phi &= i e (\partial_\mu A^\mu) \phi + 2 i e (A^\mu \partial_\mu) \phi 
\end{align}

Noting that $\square^2 = \partial_\mu \partial^\mu$, this does obtain the desired result for the $A=0$ case.

\subsubsection{ Complexify the density. }

Part of the problem is also to put the density in complex form (albeit only for the $A=0$ case).  We do this by expanding

\begin{align*}
%(\grad \phi^\conj) \cdot (\grad \phi) 
&= \partial_\mu \phi^\conj \partial^\mu \phi \\
&=
\inv{2} \left( \partial_\mu (\phi_1 + i \phi_2) \partial^\mu (\phi_1 - i \phi_2) \right) \\
&=
\inv{2} \left( \partial_\mu \phi_1 \partial^\mu \phi_1 + \partial_\mu \phi_2 \partial^\mu \phi_2 \right) \\
\end{align*}

and by evaluating
\begin{align*}
\phi^\conj \phi 
&= \inv{2} (\phi_1 + i \phi_2) (\phi_1 - i \phi_2) \\
&= \inv{2} ({\phi_1}^2 + {\phi_2}^2 )
\end{align*}

This leaves just the probability current term.  We can get this by expanding

\begin{align*}
- i A^\mu \left( \phi^\conj \partial_\mu \phi - \phi \partial_\mu \phi^\conj \right)
&=
\frac{-i}{2} A^\mu \left( (\phi_1 + i \phi_2) \partial_\mu (\phi_1 - i \phi_2) - (\phi_1 - i \phi_2) \partial_\mu (\phi_1 + i \phi_2) \right) \\
&=
A^\mu \left( \phi_2 \partial_\mu \phi_1 - \phi_1 \partial_\mu \phi_2 \right)
\end{align*}

%(having initially guessed that expanding $\phi^\conj \grad \phi - \phi \grad \phi^\conj$ would do the job).

So the density in terms of the complex field variable is 

%\begin{align}
%\LL 
%&=
%(\grad \phi^\conj) \cdot (\grad \phi)
%- \left( m^2 + e^2 A^2 \right) \phi^\conj \phi
%+ i e A \cdot \left( \phi^\conj \grad \phi - \phi \grad \phi^\conj \right)
%\end{align}
%
Or in index form

\begin{align}\label{eqn:densityComplex}
\LL 
&=
-\partial^\mu \phi^\conj \partial_\mu \phi
+ \left( -m^2 + e^2 A^\mu A_\mu \right) \phi^\conj \phi
- i e A^\mu \left( \phi^\conj \partial_\mu \phi - \phi \partial_\mu \phi^\conj \right)
\end{align}

Evaluating the Euler-Lagrange equations to verify that no sign errors were made we have

\begin{align*}
\PD{\phi^\conj}{\LL}
&=
\partial_\mu \PD{(\partial_\mu \phi^\conj)}{\LL} \\
\left( -m^2 + e^2 A^2 \right) \phi 
- i e A^\mu \partial_\mu \phi
&=
\partial_\mu (-\partial^\mu \phi + i e A^\mu \phi) \\
\end{align*}

Which gives
\begin{align}
\left( -m^2 + e^2 A^2 + \partial_\mu \partial^\mu \right) \phi &= i e (\partial_\mu A^\mu + 2 A^\mu \partial_\mu) \phi
\end{align}

This is consistent with the original result \ref{eqn:complexifiedSolution} based on the two real fields.

\subsubsection{ Noether current for global gauge invariance. }

To calculate the Noether current that results from a global gauge transformation by a complex phase factor, form

\begin{align*}
\phi &\rightarrow \phi' = \phi e^{-i e \theta} \\
\phi^\conj &\rightarrow {\phi'}^\conj = \phi^\conj e^{i e \theta} \\
\LL' &= \LL( \phi', {\phi'}^\conj, \partial_\mu \phi', \partial_\mu {\phi'}^\conj )
\end{align*}

Then 

\begin{align*}
\frac{d\LL'}{d\theta} 
&=
\PD{\phi'}{\LL'} \PD{\theta}{\phi'} 
+\PD{(\partial_\mu \phi')}{\LL'} \PD{\theta}{\partial_\mu \phi'}
+\PD{{\phi'}^\conj}{\LL'} \PD{\theta}{{\phi'}^\conj}
+\PD{(\partial_\mu {\phi')}^\conj}{\LL'} \PD{\theta}{\partial_\mu {\phi'}^\conj} \\
&=
\PD{\phi'}{\LL'} \PD{\theta}{\phi'} 
+\PD{(\partial_\mu \phi')}{\LL'} \partial_\mu \PD{\theta}{\phi'}
+\PD{{\phi'}^\conj}{\LL'} \PD{\theta}{{\phi'}^\conj}
+\PD{(\partial_\mu {\phi')}^\conj}{\LL'} \partial_\mu \PD{\theta}{{\phi'}^\conj} \\
&=
\partial_\mu \PD{(\partial_\mu \phi')}{\LL'} 
\PD{\theta}{\phi'} 
+\PD{(\partial_\mu \phi')}{\LL'} \partial_\mu \PD{\theta}{\phi'}
+
\partial_\mu \PD{(\partial_\mu {\phi'}^\conj)}{\LL'} 
\PD{\theta}{{\phi'}^\conj}
+\PD{(\partial_\mu {\phi')}^\conj}{\LL'} \partial_\mu \PD{\theta}{{\phi'}^\conj} \\
&=
\partial_\mu \left( 
\PD{(\partial_\mu \phi')}{\LL'} \PD{\theta}{\phi'} 
+
\PD{(\partial_\mu {\phi'}^\conj)}{\LL'} \PD{\theta}{{\phi'}^\conj}
\right)
\end{align*}

Calculating these for the $A=0$ Lagrangian we have

\begin{align*}
\PD{\theta}{\phi'} 
&= \PD{\theta}{} \left( \phi e^{-i e \theta} \right) \\
&= -i e \phi e^{-i e \theta} \\
\end{align*}

and
\begin{align*}
\PD{(\partial_\mu \phi')}{\LL'} &= - \partial^\mu {\phi'}^\conj \\
\PD{(\partial_\mu {\phi'}^\conj)}{\LL'} &= - \partial^\mu \phi' \\
\end{align*}

Evaluation at $\theta=0$ for this zero potential Lagrangian we have the Noether conservation statement
\begin{align*}
0 
&=
\left. \frac{d\LL'}{d\theta} \right\vert_{\theta=0} \\
&=
-\partial_\mu \left( \partial^\mu \phi^\conj (-i e \phi ) + \partial^\mu \phi (i e \phi^\conj ) \right)
\end{align*}

Writing

\begin{align}
J^\mu \equiv i \left( \phi^\conj \partial^\mu \phi - \phi \partial^\mu \phi^\conj \right)
\end{align}

this is

\begin{align*}
0 &= - e \partial_\mu J^\mu
\end{align*}

Or 
\begin{align}
\partial_\mu J^\mu &= 0
\end{align}

Observe that this same probability current was in the original Lagrangian (with potential), and with this definition one has a slightly
tidier form for the Lagrangian density \ref{eqn:densityComplex}

\begin{align}
\LL 
&=
-\partial^\mu \phi^\conj \partial_\mu \phi
+ \left( -m^2 + e^2 A^\mu A_\mu \right) \phi^\conj \phi
- e A_\mu J^\mu 
\end{align}

\subsubsection{ Interaction via local gauge invariance. }

In \cite{PJkgNotes} the Klein-Gordon equation of this problem was also explored, including a derivation of the interaction terms
by introducing a local gauge term.  That result ended up differently, and it appears that the difference from the
interaction terms given in this problem may be due to the choice of the sign of the complex exponential.

Let's try this again, and see if matching results can be obtained.  Also note that the KG notes mentioned above use the GA notation with a $+---$ metric,
so comparing the two requires some care.

\bibliographystyle{plainnat}
\bibliography{myrefs}

\end{document}
