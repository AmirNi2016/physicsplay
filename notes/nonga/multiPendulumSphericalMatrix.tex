\input{../peeter_prologue.tex}

\chapter{Equations of motion for the multiple spherical pendulum using Geometric Algebra.}
\label{chap:sPolarArxiv}
%\useCCL
%\blogpage{http://sites.google.com/site/peeterjoot/math2009/sPolarArxiv.pdf?revision=1}
%\date{Nov 13, 2009}
\date{}
%\revisionInfo{$RCSfile: multiPendulumSphericalMatrix.tex,v $}

%\beginArtWithToc
\beginArtNoToc

\section{Abstract}

Derivations of the equations of motion for the double planar pendulum, and for the single spherical pendulum are readily found as examples or problems in Lagrangian mechanics texts.  The generalization of this, treating the double or multiple pendulum, with the planar constraint removed is less common.  It is shown here that Geometric Algebra is an effective way to tackle the formulation of the equations of motion for the general unconstrained multiple pendulum problem.  The end result is free of any Geometric Algebra, with the equations of motion expressed as a single non-linear matrix algebra equation.

\section{Notation and assumptions.}

Simplifying assumptions of point masses, rigid massless connecting rods, and frictionless pivots will be made.

It will also be assumed here that the reader is familiar with Geometric (or Clifford) Algebra, with notation following \cite{hestenes1999nfc}, and \cite{doran2003gap}.  We utilize the grade selection operator

\begin{align}\label{eqn:sPolarArxiv:moo1}
\gpgradezero{A B},
\end{align}

to denote the scalar grade component of a multivector product $A B$ (ie. the generalized dot product of the factors).  For the reverse of a multivector $A$, we write

\begin{align}\label{eqn:sPolarArxiv:moo2}
\tilde{A}.
\end{align}

It will be natural, for matrices containing multivector elements, to introduce a Hermitian conjugate operation

\begin{align}\label{eqn:sPolarArxiv:moo3}
A^\dagger = {\tilde{A}}^\T,
\end{align}
reversing the elements and transposing the matrix.  

The standard orthonormal basis vectors will be denoted $\Be_1, \Be_2, \Be_3$ with $\Be_3$ upwards opposing a constant gravitational force of magnitude $g$.

For a point $\rcap$ on a unit sphere we parameterize the position using a polar angle $\theta$, and $x,y$ plane angle $\phi$.  Two unit bivectors facilitate the parameterization of this spherical polar unit vector.  First, for the $x,y$ plane, the use of

\begin{align}\label{eqn:sPolarArxiv:moo4}
i = \Be_1 \wedge \Be_2 = \Be_1 \Be_2,
\end{align}

allows for an polar form exponential rotation of vectors in the plane.  In particular, for the cylindrical outwards unit normal $\hat{\Brho}$ at angle $\phi$ from $\Be_1$ we can write

\begin{align}\label{eqn:sPolarArxiv:moo5}
\hat{\Brho} = \Be_1 e^{i \phi}.
\end{align}

The unit bivector for the plane of rotation between $\Be_3$ and the spherical radial unit vector $\rcap$ is 

\begin{align}\label{eqn:sPolarArxiv:moo6}
j = \Be_3 \wedge \hat{\Brho} = \Be_3 \Be_1 e^{i \phi}.
\end{align}

Finally, the spherical unit radial vector can be obtained by a single sided exponential rotation operator

\begin{align}\label{eqn:sPolarArxiv:moo7}
\rcap = \Be_3 e^{j \theta}
\end{align}

Because $j$ contains $\Be_3$ as a factor, double sided half angle rotation operators are not required.

\section{The Lagrangian.}

A multiple (two) particle spherical pendulum is depicted in figure (\ref{fig:sPolarArxiv:pendulumDouble})

\begin{figure}[htp]
\centering
\includegraphics[totalheight=0.4\textheight]{pendulumDouble}
\caption{Double spherical pendulum.}\label{fig:sPolarArxiv:pendulumDouble}
\end{figure}

The position vector for each particle can be expressed relative to the mass it is connected to (or the origin for the first particle), as in

\begin{align}\label{eqn:sPolarArxiv:boo1}
z_k &= z_{k-1} + \Be_3 l_k e^{j_k \theta_k} \\
j_k &= \Be_3 \wedge \left( \Be_1 e^{i \phi_k} \right) \\
i &= \Be_1 \wedge \Be_2.
\end{align}

To express the Kinetic energy for any of the masses $m_k$, we need the derivative of the incremental difference in position

\begin{align*}
\frac{d}{dt} \left( \Be_3 e^{j_k \theta_k} \right)
&=
\Be_3 \left( j_k \dot{\theta}_k e^{j_k \theta_k} + \frac{d j_k }{dt} \sin\theta_k \right)  \\
&=
\Be_3 \left( j_k \dot{\theta}_k e^{j_k \theta_k} + \Be_3 \Be_2 \dot{\phi}_k e^{i \phi_k} \sin\theta_k \right)  \\
&=
\left( \frac{d}{dt}
\begin{bmatrix}
\theta_k & \phi_k
\end{bmatrix} \right)
\begin{bmatrix}
\Be_1 e^{i \phi_k} e^{j_k \theta_k} \\
\Be_2 e^{i \phi_k} \sin\theta_k
\end{bmatrix}.
\end{align*}

We use the contraction property of the vector product, that the square of a vector is the squared (scalar) length of that vector, to calculate the particle kinetic energy $m \dot{\Bx}^2/2$.  To first express just the velocity part of that Kinetic energy, we write

\begin{align}\label{eqn:sPolarArxiv:boo2}
A_k &=
\begin{bmatrix}
\Be_1 e^{i \phi_k} e^{j_k \theta_k} \\
\Be_2 e^{i \phi_k} \sin\theta_k
\end{bmatrix} \\
\BTheta_k &=
\begin{bmatrix}
\theta_k \\
\phi_k
\end{bmatrix}.
\end{align}

Now, the relative velocity differential can be written utilizing these factors

\begin{align}\label{eqn:sPolarArxiv:boo3}
(\dot{z}_k - \dot{z}_{k-1})^2 = l_k^2 {\dot{\BTheta}_k}^\dagger A_k A_k^\dagger \dot{\BTheta}_k.
\end{align}

Observe that the inner product is Hermitian under this definition since $(A_k A_k^\dagger)^\dagger = A_k A_k^\dagger$.
%  \footnote{Realized later, and being too lazy to adjust everything in these notes, the use of reversion here is not necessary.  Since the generalized coordinates are scalars we could use transposition instead of Hermitian conjugation.  All the matrix elements are vectors so reversal doesn't change anything.}

The total (squared) velocity of the $k$th particle is then

\begin{align}\label{eqn:sPolarArxiv:boo4}
\BTheta &=
\begin{bmatrix}
\BTheta_1 \\
\BTheta_2 \\
\vdots \\
\BTheta_N \\
\end{bmatrix} \\
B_k &=
\begin{bmatrix}
l_1 A_1 \\
l_2 A_2 \\
\vdots \\
l_k A_k \\
0 \\
\end{bmatrix} \\
(\dot{z}_k)^2 &=
\dot{\BTheta}^\dagger B_k B_k^\dagger \dot{\BTheta},
\end{align}

where the zero matrix in $B_k$ is a $N-k$ by one zero.  Summing over all masses and adding in the potential energy we have for the Lagrangian of the system

\begin{align}\label{eqn:sPolarArxiv:boo5b}
K &=
\inv{2} \sum_{k=1}^N m_k
\dot{\BTheta}^\dagger
B_k B_k^\dagger
\dot{\BTheta} \\
\mu_k &= \sum_{j=k}^N m_j \\
\Phi &=
g \sum_{k=1}^N \mu_k l_k \cos\theta_k \\
\LL &= K - \Phi.
\end{align}

We have a slightly unholy mess of matrix and Geometric Algebra with the Kinetic energy expressed as a Hermitian quadratic form.

\section{Some tidy up.}

Before continuing with evaluation of the Euler-Lagrange equations it is helpful to make a couple of observations about the structure of the matrix products that make up our velocity terms

\begin{align}\label{eqn:sPolarArxiv:boo8}
\dot{\BTheta}^\dagger
B_k B_k^\dagger
\dot{\BTheta}
&=
\dot{\BTheta}^\dagger
\begin{bmatrix}
\begin{bmatrix}
l_1^2 A_1 A_1^\dagger & l_1 l_2 A_1 A_2^\dagger & \hdots & l_1 l_k A_1 A_k^\dagger \\
l_2 l_1 A_2 A_1^\dagger & l_2^2 A_2 A_2^\dagger & \hdots & l_2 l_k A_2 A_k^\dagger \\
\vdots \\
l_k l_1 A_k A_1^\dagger & l_k l_2 A_k A_2^\dagger & \hdots & l_k^2 A_k A_k^\dagger
\end{bmatrix} & 0 \\
0 & 0
\end{bmatrix}
\dot{\BTheta}.
\end{align}

Specifically, consider the $A_a A_b^\dagger$ products that make up the elements of the matrices $Q_k = B_k B_k^\dagger$.  Without knowing anything about the grades that make up the elements of $Q_k$, since it is Hermitian (by this definition of Hermitian) there can be no elements of grade order two or three in the final matrix.  This is because reversion of such grades inverts the sign, and the matrix elements in $Q_k$ all equal their reverse.  Additionally, the elements of the multivector column matrices $A_k$ are vectors, so in the product $A_a A_b^\dagger$ we can only have scalar and bivector (grade two) elements.  The resulting one by one scalar matrix is a sum over all the mixed angular velocities $\dot{\theta}_a \dot{\theta}_b$, $\dot{\theta}_a \dot{\phi}_b$, and $\dot{\phi}_a \dot{\phi}_b$, so once this summation is complete any bivector grades of $A_a A_b^\dagger$ must cancel out.  This is consistent with the expectation that we have a one by one scalar matrix result out of this in the end (i.e. a number).  The end result is a freedom to exploit the convenience of explicitly using a scalar selection operator that filters out any vector, bivector, and trivector grades in the products $A_a A_b^\dagger$.  We will get the same result if we write

\begin{align}\label{eqn:sPolarArxiv:boo9}
\dot{\BTheta}^\dagger
B_k B_k^\dagger
\dot{\BTheta}
&=
\dot{\BTheta}^\dagger
\begin{bmatrix}
\begin{bmatrix}
l_1^2 \gpgradezero{A_1 A_1^\dagger} & l_1 l_2 \gpgradezero{A_1 A_2^\dagger} & \hdots & l_1 l_k \gpgradezero{A_1 A_k^\dagger} \\
l_2 l_1 \gpgradezero{A_2 A_1^\dagger} & l_2^2 \gpgradezero{A_2 A_2^\dagger} & \hdots & l_2 l_k \gpgradezero{A_2 A_k^\dagger} \\
\vdots \\
l_k l_1 \gpgradezero{A_k A_1^\dagger} & l_k l_2 \gpgradezero{A_k A_2^\dagger} & \hdots & l_k^2 \gpgradezero{A_k A_k^\dagger}
\end{bmatrix} & 0 \\
0 & 0
\end{bmatrix}
\dot{\BTheta}.
\end{align}

Pulling in the summation over $m_k$ we have

\begin{align}\label{eqn:sPolarArxiv:boo15}
\sum_k m_k
\dot{\BTheta}^\dagger
B_k B_k^\dagger
\dot{\BTheta}
&=
\dot{\BTheta}^\dagger
{\begin{bmatrix}
\mu_{\max(r,c)} l_r l_c \gpgradezero{A_r A_c^\dagger}
\end{bmatrix}}_{rc}
\dot{\BTheta}.
\end{align}

It appears justifiable to label the $\mu_{\max(r,c)} l_r l_c$ factors of the angular velocity matrices as moments of inertia in a generalized sense.  Using this block matrix form, and scalar selection, we can now write the Lagrangian in a slightly tidier form

\begin{align}\label{eqn:sPolarArxiv:boo5}
\mu_k &= \sum_{j=k}^N m_j \\
Q &= 
{\begin{bmatrix}
\mu_{\max(r,c)} l_r l_c A_r A_c^\dagger
\end{bmatrix}}_{rc} \\
K &=
\inv{2} \dot{\BTheta}^\dagger Q
\dot{\BTheta} 
=\inv{2} \dot{\BTheta}^\T \gpgradezero{Q}
\dot{\BTheta} \\
\Phi &=
g \sum_{k=1}^N \mu_k l_k \cos\theta_k \\
\LL &= K - \Phi.
\end{align}

After some expansion, writing $S_\theta = \sin\theta$, $C_\phi = \cos\phi$ and so forth, one can find that the scalar parts of the block matrices $A_r A_c^\dagger$ contained in $Q$ are

\begin{align}\label{eqn:sPolarArxiv:boo20}
\gpgradezero{A_r A_c^\dagger}
=
\begin{bmatrix}
C_{\phi_c - \phi_r} 
C_{\theta_r}
C_{\theta_c}
+S_{\theta_r}
S_{\theta_c} &
-S_{\phi_c - \phi_r} C_{\theta_r} S_{\theta_c} \\
S_{\phi_c - \phi_r} C_{\theta_c} S_{\theta_r} &
C_{\phi_c - \phi_r} S_{\theta_r} S_{\theta_c}
\end{bmatrix}.
\end{align}

The diagonal blocks are particularly simple and have no $\phi$ dependence

\begin{align}\label{eqn:sPolarArxiv:boo20d}
\gpgradezero{A_r A_r^\dagger}
=
\begin{bmatrix}
1 & 0 \\
0 & \sin^2 \theta_r
\end{bmatrix}
\end{align}

Observe also that $\gpgradezero{A_r A_c^\dagger}^T = \gpgradezero{A_c A_r^\dagger}$, so the scalar matrix

\begin{align}\label{eqn:sPolarArxiv:boo21}
\gpgradezero{Q} = 
{\begin{bmatrix}
\mu_{\max(r,c)} l_r l_c \gpgradezero{ A_r A_c^\dagger }
\end{bmatrix}}_{rc}.
\end{align}

is a real symmetric matrix.  We have the option of using this explicit scalar expansion if desired for further computations associated with this problem.  That completely eliminates the Geometric algebra from the problem, and is probably a logical way to formulate things for numerical work since one can then exploit any pre existing matrix algebra system without having to create one that understands non-commuting variables and vector products.

\section{Evaluating the Euler-Lagrange equations.}

For the acceleration terms of the Euler-Lagrange equations our computation reduces nicely to a function of only $\gpgradezero{Q}$

\begin{align*}
\frac{d}{dt} \PD{\dot{\theta}_a}{\LL}
&=
\inv{2} \frac{d}{dt} 
\left(
\PD{\dot{\theta}_a}{\dot{\BTheta}}^\T
\gpgradezero{Q} 
\dot{\BTheta}
+
\dot{\BTheta}^\T
\gpgradezero{Q} 
\PD{\dot{\theta}_a}{\dot{\BTheta}}
\right)  \\
&=
\frac{d}{dt} \left(
{\begin{bmatrix}
\delta_{ac}
\begin{bmatrix}
1 & 0
\end{bmatrix}
\end{bmatrix}}_c
\gpgradezero{Q} 
\dot{\BTheta}
\right),
\end{align*}

and

\begin{align*}
\frac{d}{dt} \PD{\dot{\phi}_a}{\LL}
&=
\inv{2} \frac{d}{dt} 
\left(
\PD{\dot{\phi}_a}{\dot{\BTheta}}^\T
\gpgradezero{Q} 
\dot{\BTheta}
+
\dot{\BTheta}^\T
\gpgradezero{Q} 
\PD{\dot{\phi}_a}{\dot{\BTheta}}
\right)  \\
&=
\frac{d}{dt} \left(
{\begin{bmatrix}
\delta_{ac}
\begin{bmatrix}
0 & 1
\end{bmatrix}
\end{bmatrix}}_c
\gpgradezero{Q} 
\dot{\BTheta}
\right).
\end{align*}

The last groupings above made use of $\gpgradezero{Q} = \gpgradezero{Q}^\T$, and in particular $(\gpgradezero{Q} + \gpgradezero{Q}^\T)/2 = \gpgradezero{Q}$.  We can now form a column matrix putting all the angular velocity gradient in a tidy block matrix representation

\begin{align}\label{eqn:sPolarArxiv:boo22}
\grad_{\dot{\BTheta}} \LL = 
{\begin{bmatrix}
\begin{bmatrix}
\PD{\dot{\theta}_r}{\LL} \\
\PD{\dot{\phi}_r}{\LL} \\
\end{bmatrix}
\end{bmatrix}}_r = \gpgradezero{Q} \dot{\BTheta}.
\end{align}

A small aside on Hamiltonian form.  This velocity gradient is also the conjugate momentum of the Hamiltonian, so if we wish to express the Hamiltonian in terms of conjugate momenta, we require invertability of $\gpgradezero{Q}$ at the point in time that we evaluate things.  Writing

\begin{align}\label{eqn:sPolarArxiv:boo30}
P_{\BTheta} = \grad_{\dot{\BTheta}} \LL,
\end{align}

and noting that $(\gpgradezero{Q}^{-1})^\T = \gpgradezero{Q}^{-1}$, we get for the kinetic energy portion of the Hamiltonian 

\begin{align}\label{eqn:sPolarArxiv:boo31}
K = \inv{2} {P_{\BTheta}}^\T \gpgradezero{Q}^{-1} P_{\BTheta}.
\end{align}

Now, the invertability of $\gpgradezero{Q}$ cannot be taken for granted.  Even in the single particle case we do not have invertability.  For the single particle case we have

\begin{align}\label{eqn:sPolarArxiv:boo45}
\gpgradezero{Q} =
m l^2 
\begin{bmatrix}
1 & 0 \\
0 & \sin^2 \theta
\end{bmatrix},
\end{align}

so at $\theta = \pm \pi/2$ this quadratic form is singular, and the planar angular momentum becomes a constant of motion.

Returning to the evaluation of the Euler-Lagrange equations, the problem is now reduced to calculating the right hand side of the following system

\begin{align}\label{eqn:sPolarArxiv:boo23}
\frac{d}{dt} \left( \gpgradezero{Q} \dot{\BTheta} \right) =
{\begin{bmatrix}
\begin{bmatrix}
\PD{\theta_r}{\LL} \\
\PD{\phi_r}{\LL} \\
\end{bmatrix}
\end{bmatrix}}_r.
\end{align}

With back substitution of \ref{eqn:sPolarArxiv:boo20}, and \ref{eqn:sPolarArxiv:boo21} we have a complete non-multivector expansion of the left hand side.  For the right hand side taking the $\theta_a$ and $\phi_a$ derivatives respectively we get

\begin{align}\label{eqn:sPolarArxiv:boo6}
\PD{\theta_a}{\LL}
=
\inv{2} \dot{\BTheta}^\dagger
{\begin{bmatrix}
\mu_{\max(r,c)} l_r l_c \gpgradezero{
\PD{\theta_a}{A_r} A_c^\dagger
+A_r \PD{\theta_a}{A_c}^\dagger
}
\end{bmatrix}}_{rc} 
\dot{\BTheta}
-g \mu_a l_a \sin\theta_a,
\end{align}

and

\begin{align}\label{eqn:sPolarArxiv:boo6c}
\PD{\phi_a}{\LL}
=
\inv{2} \dot{\BTheta}^\dagger
{\begin{bmatrix}
\mu_{\max(r,c)} l_r l_c \gpgradezero{
\PD{\phi_a}{A_r} A_c^\dagger
+A_r \PD{\phi_a}{A_c}^\dagger
}
\end{bmatrix}}_{rc} 
\dot{\BTheta}.
\end{align}

So to proceed we must consider the $\gpgradezero{A_r A_c^\dagger}$ partials.  A bit of thought shows that the matrices of partials above are mostly zeros.  Illustrating by example, consider $\PDi{\theta_2}{\gpgradezero{Q}}$, which in block matrix form is

\begin{align}\label{eqn:sPolarArxiv:boo33}
\PD{\theta_2}{\gpgradezero{Q}}
=
\begin{bmatrix}
0 & \inv{2} \mu_2 l_1 l_2 \gpgradezero{A_1 \PD{\theta_2}{A_2}^\dagger} & 0 & \hdots & 0 \\
\inv{2} \mu_2 l_2 l_1 \gpgradezero{\PD{\theta_2}{A_2} A_1^\dagger} &
\inv{2} \mu_2 l_2 l_2 \gpgradezero{A_2 \PD{\theta_2}{A_2}^\dagger + \PD{\theta_2}{A_2} A_2^\dagger} &
\inv{2} \mu_3 l_2 l_3 \gpgradezero{\PD{\theta_2}{A_2} A_3^\dagger} & \hdots &
\inv{2} \mu_N l_2 l_N \gpgradezero{\PD{\theta_2}{A_2} A_N^\dagger} \\
0 & \inv{2} \mu_3 l_3 l_2 \gpgradezero{A_3 \PD{\theta_2}{A_2}^\dagger} & 0 & \hdots & 0 \\
0 & \vdots & 0 & \hdots & 0 \\
0 & \inv{2} \mu_N l_N l_2 \gpgradezero{A_N \PD{\theta_2}{A_2}^\dagger} & 0 & \hdots & 0 \\
\end{bmatrix}.
\end{align}

Observe that the diagonal term has a scalar plus its reverse, so we can drop the one half factor and one of the summands for a total contribution to $\PDi{\theta_2}{\LL}$ of just

\begin{align*}
\mu_2 {l_2}^2 {\dot{\BTheta}_2}^\T \gpgradezero{\PD{\theta_2}{A_2} A_2^\dagger} \dot{\BTheta}_2.
\end{align*}

Now consider one of the pairs of off diagonal terms.  Adding these we contributions to $\PDi{\theta_2}{\LL}$ of

\begin{align*}
\inv{2} \mu_2 l_1 l_2 
{\dot{\BTheta}_1}^\T
\gpgradezero{A_1 \PD{\theta_2}{A_2}^\dagger} 
\dot{\BTheta}_2
+\inv{2} \mu_2 l_2 l_1 
{\dot{\BTheta}_2}^\T
\gpgradezero{\PD{\theta_2}{A_2} A_1^\dagger} 
\dot{\BTheta}_1
&=
\inv{2} \mu_2 l_1 l_2 
{\dot{\BTheta}_1}^\T
\gpgradezero{
A_1 \PD{\theta_2}{A_2}^\dagger
+A_1 \PD{\theta_2}{A_2}^\dagger
} 
\dot{\BTheta}_2 \\
&=
\mu_2 l_1 l_2 
{\dot{\BTheta}_1}^\T
\gpgradezero{
A_1 \PD{\theta_2}{A_2}^\dagger
} 
\dot{\BTheta}_2.
\end{align*}

This has exactly the same form as the diagonal term, so summing over all terms we get for the position gradient components of the Euler-Lagrange equation just

\begin{align}\label{eqn:sPolarArxiv:boo41}
\PD{\theta_a}{\LL}
&=
\sum_{k}
\mu_{\max(k,a)} l_k l_a 
{\dot{\BTheta}_k}^\T
\gpgradezero{
A_k \PD{\theta_a}{A_a}^\dagger
} 
\dot{\BTheta}_a 
-g \mu_a l_a \sin\theta_a,
\end{align}

and

\begin{align}\label{eqn:sPolarArxiv:boo40}
\PD{\phi_a}{\LL}
&=
\sum_{k}
\mu_{\max(k,a)} l_k l_a 
{\dot{\BTheta}_k}^\T
\gpgradezero{
A_k \PD{\phi_a}{A_a}^\dagger
} 
\dot{\BTheta}_a.
\end{align}

The only thing that remains to do is evaluate the $\gpgradezero{A_k \PDi{\phi_a}{A_a}^\dagger}$ matrices.

Utilizing \ref{eqn:sPolarArxiv:boo20}, one obtains easily

\begin{align}\label{eqn:sPolarArxiv:boo51}
\gpgradezero{ A_k \PD{\theta_c}{A_c}^\dagger }
&=
\begin{bmatrix}
-C_{\phi_a - \phi_k} C_{\theta_k} S_{\theta_a} + S_{\theta_k} C_{\theta_a} &
-S_{\phi_a - \phi_k} C_{\theta_k} C_{\theta_a} \\
-S_{\phi_a - \phi_k} S_{\theta_a} S_{\theta_k} &
C_{\phi_a - \phi_k} (1 + \delta_{k a}) S_{\theta_k} C_{\theta_a} 
\end{bmatrix},
\end{align}

and

\begin{align}\label{eqn:sPolarArxiv:boo50}
\gpgradezero{ A_k \PD{\phi_a}{A_a}^\dagger }
&=
\begin{bmatrix}
-S_{\phi_a - \phi_k} C_{\theta_k} C_{\theta_a} + S_{\theta_k} S_{\theta_a} &
-C_{\phi_a - \phi_k} C_{\theta_k} S_{\theta_a} \\
C_{\phi_a - \phi_k} C_{\theta_a} S_{\theta_k} &
-S_{\phi_a - \phi_k} S_{\theta_k} S_{\theta_a} 
\end{bmatrix}.
\end{align}

The right hand side of the Euler-Lagrange equations now becomes

\begin{align}\label{eqn:sPolarArxiv:boo55}
\grad_{\BTheta} \LL =
\sum_k
{\begin{bmatrix}
\begin{bmatrix}
\mu_{\max(k,r)} l_k l_r {\dot{\BTheta}_k}^\T \gpgradezero{ A_k \PD{\theta_r}{A_r}^\dagger } \dot{\BTheta}_r \\
\mu_{\max(k,r)} l_k l_r {\dot{\BTheta}_k}^\T \gpgradezero{ A_k \PD{\phi_r}{A_r}^\dagger } \dot{\BTheta}_r 
\end{bmatrix}
\end{bmatrix}}_r
- g
{\begin{bmatrix}
\mu_r l_r \sin\theta_r 
\begin{bmatrix}
1 \\
0
\end{bmatrix}
\end{bmatrix}}_r.
\end{align}

Between \ref{eqn:sPolarArxiv:boo55}, \ref{eqn:sPolarArxiv:boo22}, and a few other auxillary relations, all above we have completed the task of evaluating the Euler-Lagrange equations for the most general multiple particle distinct mass pendulum system.  Just as the simple planar pendulum is a non-linear system, so is this, and we must resort to numerical methods or solution restricted to a linear approximation in a small neighbourhood of a particular phase space point.

\EndArticle
