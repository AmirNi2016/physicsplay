\input{../peeter_prologue.tex}

\chapter{Hamiltonian notes.}
\label{chap:hamiltonian}
%\useCCL
\blogpage{http://sites.google.com/site/peeterjoot/math2009/hamiltonian.pdf}
\date{Sept 26, 2009}
\revisionInfo{$RCSfile: hamiltonian.tex,v $ Last $Revision: 1.9 $ $Date: 2009/10/01 00:36:26 $}

\beginArtWithToc

\section{Motivation}

I've now seen Hamiltonian's used, mostly in a Quantum context, and think that I understand at least some of the math associated with the Hamiltonian and the Hamiltonian principle.  I have, however, not used either of these enough that it seems natural to do so.

Here I attempt to summarize for myself what I know about Hamiltonian's, and work through a number of examples.  Some of the examples considered will be ones already treated with the Lagrangian formalism \cite{PJTongMf1}.

Some notation will be invented along the way as reasonable, since I'd like to try to also relate the usual coordinate representation of the Hamiltonian, the Hamiltonian principle, and the Poisson bracket, with the bivector representation of the 2N complex configuration space introduced in \cite{doran2003gap}.

\section{Hamiltonian as a conserved quantity.}

Starting with the Lagrangian formalism the Hamiltonian can be found as a conserved quantity associated with time translation when the Lagrangian has no explicit time dependence.  This follows directly by considering the time derivative of the Lagrangian $\LL = \LL(q^i, \qdot^i)$.

\begin{align*}
\frac{d\LL}{dt} 
&= \PD{q^i}{\LL} \frac{dq^i}{dt} +\PD{\qdot^i}{\LL} \frac{d\qdot^i}{dt} \\
&= \qdot^i \frac{d}{dt}\PD{\qdot^i}{\LL} +\PD{\qdot^i}{\LL} \frac{d\qdot^i}{dt} \\
&= \frac{d}{dt} \left( \qdot^i \PD{\qdot^i}{\LL} \right) 
\end{align*}

We can therefore form the difference 

\begin{align}\label{eqn:hamiltonian:foo1}
\frac{d}{dt} \left( \qdot^i \PD{\qdot^i}{\LL} -\LL \right) = 0
\end{align}

and find that this quantity, labeled H, is a constant of motion for the system

\begin{align}\label{eqn:hamiltonian:foo2}
H \equiv \qdot^i \PD{\qdot^i}{\LL} -\LL = \text{constant}
\end{align}

We'll see later that this constant is sometimes the total energy of the system.

The $\qdot^i$ partials of the Lagrangian are called the canonical momentum conjugate to $q^i$.  Quite a mouthful, so just canonical momenta seems like a good compromise.  We will write (reserving $p^i = m q^i$ for the non-canonical momenta)

\begin{align}\label{eqn:hamiltonian:foo2b}
P_i \equiv \PD{\qdot^i}{\LL}
\end{align}

and note that these are the coordinates of a sort of velocity gradient of the Lagrangian.  We've seen these canonical momenta in velocity gradient form previously where it was noted that we could write the Euler-Lagrange equations in vector form in an orthonormal reciprocal frame space as

\begin{align}\label{eqn:hamiltonian:foo9}
\grad \LL = \frac{d}{dt} \grad_v \LL
\end{align}

where $\grad_v = e^i \partial \LL/\partial \xdot^i = e^i P_i$, $\grad = e^i \partial/\partial x^i$, and $x = e_i x^i$.

%Here we will be exploring phase space relationships where the position and velocity basis pairs are treated independently, but also will not have much requirement for direct use of the Euler Lagrange equations.

\section{Some syntactic sugar.  In vector form.}

Following Jackson \cite{jackson1975cew} (section 12.1, relativistic Lorentz force Hamiltonian), this can be written in vector form if the velocity gradient, the vector sum of the momenta conjugate to the $q^i$'s is given its own symbol $\BP$.  He writes

\begin{align}\label{eqn:hamiltonian:foo3}
H = \Bv \cdot \BP - \LL
\end{align}

This makes most sense when working in orthonormal coordinates, but can be generalized.  Suppose we introduce a pair of reciprocal frame basis for the generalized position and velocity coordinates, writing as vectors in configuration space

\begin{align}\label{eqn:hamiltonian:foo4}
q &= e_i q^i \\
v &= f_i \qdot^i 
\end{align}

Following \cite{doran2003gap} (who use this for their bivector complexification of the configuration space), we have the freedom to impose orthonormal constraints on this configuration space basis

\begin{align}\label{eqn:hamiltonian:foo5}
e^i \cdot e_j &= {\delta^i}_j \\
f^i \cdot f_j &= {\delta^i}_j \\
e^i \cdot f_j &= {\delta^i}_j
\end{align}

We can now define configuration space position and velocity gradients

\begin{align}\label{eqn:hamiltonian:foo6}
\grad &\equiv e^i \PD{q^i}{} \\
\grad_v &\equiv f^i \PD{\qdot^i}{}
\end{align}

so the conjugate momenta in vector form is now

\begin{align}\label{eqn:hamiltonian:foo7}
P \equiv \grad_v \LL = f^i \PD{\qdot^i}{\LL}
\end{align}

Our Hamiltonian takes the form

\begin{align}\label{eqn:hamiltonian:foo8}
H = v \cdot P - \LL
\end{align}

\section{The Hamiltonian principle.}

We want to take partials of \ref{eqn:hamiltonian:foo2} with respect to $P_i$ and $q^i$.  In terms of the canonical momenta we want to differentiate

\begin{align}\label{eqn:hamiltonian:hoo1}
H \equiv \qdot^i P_i -\LL(q^i, \qdot^i, t)
\end{align}

for the $P_i$ partial we have

\begin{align*}
\PD{P_i}{H} = \qdot^i
\end{align*}

and for the $q^i$ partial

\begin{align*}
\PD{q^i}{H} 
&= -\PD{q^i}{\LL} \\
&= - \frac{d}{dt} \PD{\qdot^i}{\LL} 
\end{align*}

These two results taken together form what I believe is called the Hamiltonian principle

\begin{align}\label{eqn:hamiltonian:hoo3}
\PD{P_i}{H} &= \qdot^i \\
\PD{q^i}{H} &= - \dot{P}_i \\
P_i &= \PD{\qdot^i}{\LL} 
\end{align}

A set of 2N first order equations equivalent to the second order Euler-Lagrange equations.  These appear to follow straight from the definitions.  Given that I'm curious why the more complex method of derivation is chosen in \cite{goldstein1951cm}.  There the total differential of the Hamiltonian is computed

\begin{align*}
dH &= 
\qdot^i dP_i 
+ d\qdot^i P_i 
- dq^i \PD{q^i}{\LL}
- d \qdot^i \PD{\qdot^i}{\LL}
- dt \PD{t}{\LL} \\
&= 
\qdot^i dP_i 
+ d\qdot^i \left( P_i - \PD{\qdot^i}{\LL} \right)
- dq^i \PD{q^i}{\LL}
- dt \PD{t}{\LL} \\
&= 
\qdot^i dP_i 
- dq^i \underbrace{\PD{q^i}{\LL}}_{= d/dt P_i}
- dt \PD{t}{\LL} \\
\end{align*}

A term by term comparison to the total differential written out explicitly

\begin{align}\label{eqn:hamiltonian:hoo4}
dH &= 
\PD{q^i}{H} d q^i
+\PD{P_i}{H} d P_i
+\PD{t}{H} dt
\end{align}

allows the Hamiltonian equations to be picked off.

\begin{align}\label{eqn:hamiltonian:hoo5}
\PD{P_i}{H} &= \qdot^i  \\
\PD{q^i}{H} &= - \dot{P}_i  \\
\PD{t}{H}   &= - \PD{t}{\LL} 
\end{align}

I guess that isn't that much more complicated and it does yield a relation between the Hamiltonian and Lagrangian time derivatives.

\section{Examples.}

Now, that's just about the most abstract way we can start things off isn't it?  Getting some initial feel for this constant of motion can be had by considering a sequence of Lagrangians, starting with the very simplest.

\subsection{Force free motion}

Our very simplest Lagrangian is that of one dimensional purely kinetic motion

\begin{align}\label{eqn:hamiltonian:boo1}
\LL = \inv{2} m v^2 = \inv{2} m \xdot^2
\end{align}

Our Hamiltonian is in this case just

\begin{align}\label{eqn:hamiltonian:boo2}
H = \xdot m \xdot - \inv{2} m \xdot = \inv{2} m v^2
\end{align}

The Hamiltonian is just the kinetic energy.  The canonical momentum in this case is also equal to the momentum, so eliminating $v$ to apply the Hamiltonian equations we have

\begin{align}\label{eqn:hamiltonian:boo3}
H = \inv{2m} p^2
\end{align}

We have then

\begin{align*}
\PD{p}{H} &= \frac{p}{m} = \dot{x} \\
\PD{x}{H} &= 0 = -\dot{p} 
\end{align*}

Just for fun we can put this simple linear system in matrix form

\begin{align}\label{eqn:hamiltonian:boo4}
\frac{d}{dt}
\begin{bmatrix}
p \\
x
\end{bmatrix}
=
\inv{m}
\begin{bmatrix}
0 & 0 \\
1 & 0
\end{bmatrix}
\begin{bmatrix}
p \\
x
\end{bmatrix}
\end{align}

A linear system of this form $y' = A y$ can be solved by exponentiation with solution

\begin{align}\label{eqn:hamiltonian:boo5}
y = e^{A t} y_0
\end{align}

In this case our matrix is nilpotent degree 2 so we can exponentiate only requiring up to the first order power

\begin{align}\label{eqn:hamiltonian:boo6}
e^{A t} = I + A t
\end{align}

specifically

\begin{align}\label{eqn:hamiltonian:boo7}
\begin{bmatrix}
p \\
x
\end{bmatrix}
=
\begin{bmatrix}
1 & 0 \\
\frac{t}{m} & 1
\end{bmatrix}
\begin{bmatrix}
p_0 \\
x_0
\end{bmatrix}
\end{align}

Written out in full this is just

\begin{align}\label{eqn:hamiltonian:boo8}
p &= p_0 \\
x &= \frac{p_0}{m} t + x_0
\end{align}

Since the canonical momentum is the regular momentum $p = m v$ in this case, we have the usual constant rate change of position $x = v_0 t + x_0$ that we could have gotten in many easier ways.  I'd hazard a guess that any single variable Lagrangian that is at most quadratic in position or velocity will yield a linear system.

The generalization of this Hamiltonian to three dimensions is straightforward, and we get

\begin{align}\label{eqn:hamiltonian:boo9}
H &= \inv{m} \Bp^2 
\end{align}

\begin{align}\label{eqn:hamiltonian:boo10}
\frac{d}{dt}
\begin{bmatrix}
p_x \\
x \\
p_y \\
y \\
p_z \\
z \\
\end{bmatrix}
=
\inv{m}
\begin{bmatrix}
0 & 0 &   &   &   &   \\
1 & 0 &   &   &   &   \\
  &   & 0 & 0 &   &   \\
  &   & 1 & 0 &   &   \\
  &   &   &   & 0 & 0 \\
  &   &   &   & 1 & 0 \\
\end{bmatrix}
\begin{bmatrix}
p_x \\
x \\
p_y \\
y \\
p_z \\
z \\
\end{bmatrix}
\end{align}

Since there is no coupling (nilpotent matrices down the diagonal) between the coordinates this can be treated as three independent sets of equations of the form \ref{eqn:hamiltonian:boo4}, and we have

\begin{align}\label{eqn:hamiltonian:boo11}
p_i(t) &= p_i(0) \\
x_i(t) &= \frac{p_i(0)}{m} t + x_i(0)
\end{align}

Or just

\begin{align}\label{eqn:hamiltonian:boo12}
\Bp(t) &= \Bp(0) \\
\Bx(t) &= \frac{\Bp(0)}{m} t + \Bx(0)
\end{align}

\subsection{Linear potential (surface gravitation)}

For the gravitational force $F = - m g \zcap = - \spacegrad \phi$, we have $\phi = m g z$, and a Lagrangian of

\begin{align}\label{eqn:hamiltonian:roo1}
\LL = \inv{2} m \Bv^2 - \phi = \inv{2} m \Bv^2 - m g z
\end{align}

Without velocity dependence the canonical momentum is the momentum $m \Bv$, and our Hamiltonian is

\begin{align}\label{eqn:hamiltonian:roo2}
H = \inv{2 m} \Bp^2 + m g z
\end{align}

The Hamiltonian equations are

\begin{align}\label{eqn:hamiltonian:roo3}
\PD{p_i}{H} &= \xdot_i = \inv{m} p_i \\
\sigma_i \PD{x_i}{H} &= -\sigma_i \pdot_i = \begin{bmatrix}0 \\ 0 \\ m g \end{bmatrix}
\end{align}

In matrix form we have

\begin{align}\label{eqn:hamiltonian:roo4}
\frac{d}{dt}
\begin{bmatrix}
p_x \\
x \\
p_y \\
y \\
p_z \\
z \\
\end{bmatrix}
=
\inv{m}
\begin{bmatrix}
0 & 0 &   &   &   &   \\
1 & 0 &   &   &   &   \\
  &   & 0 & 0 &   &   \\
  &   & 1 & 0 &   &   \\
  &   &   &   & 0 & 0 \\
  &   &   &   & 1 & 0 \\
\end{bmatrix}
\begin{bmatrix}
p_x \\
x \\
p_y \\
y \\
p_z \\
z \\
\end{bmatrix}
+
\begin{bmatrix}
0 \\
0 \\
0 \\
0 \\
-m g \\
0 \\
\end{bmatrix}
\end{align}

So our problem is now reduced to solving a linear system of the form

\begin{align}\label{eqn:hamiltonian:roo5}
y' = A y + b
\end{align}

That extra little term $b$ throws a wrench into things and I'm no longer sure how to integrate by inspection.  What can be noted is that we really only have to consider the $z$ components since we've solved the problem for the $x$ and $y$ coordinates in the force free case.  That leaves

\begin{align}\label{eqn:hamiltonian:roo6}
\frac{d}{dt}
\begin{bmatrix}
p_z \\
z \\
\end{bmatrix}
=
\inv{m}
\begin{bmatrix}
0 & 0 \\
1 & 0 \\
\end{bmatrix}
\begin{bmatrix}
p_z \\
z \\
\end{bmatrix}
+
\begin{bmatrix}
-m g \\
0 \\
\end{bmatrix}
\end{align}

Is there any reason that we have to solve in matrix form?  Except for a coolness factor, not really, and we can integrate each equation directly.  For the momentum equation we have

\begin{align}\label{eqn:hamiltonian:roo7}
p_z = - m g t + p_z(0)
\end{align}

This can be substituted into the position equation for

\begin{align}\label{eqn:hamiltonian:roo8}
\dot{z} = \inv{m} (p_z(0) - m g t)
\end{align}

Direct integration is now possible for the final solution

\begin{align*}
z 
&= \inv{m} (p_z(0) t - m g t^2/2) + z_0 \\
&= \frac{p_z(0)}{m} t - \frac{g}{2} t^2 + z_0 
\end{align*}

Again something that we could have gotten in many easier ways.  Using the result we see that the solution to \ref{eqn:hamiltonian:roo6} in matrix form, again with $A = \inv{m}\begin{bmatrix}0 & 0 \\ 1 & 0\end{bmatrix}$ is

\begin{align}\label{eqn:hamiltonian:roo9}
\begin{bmatrix}
p_z \\
z \\
\end{bmatrix}
= e^{At} 
\begin{bmatrix}
p_z(0) \\
z(0) \\
\end{bmatrix}
- m g 
\begin{bmatrix}
t \\
\inv{2m} t^2
\end{bmatrix}
\end{align}

I thought if I wrote this out how to solve \ref{eqn:hamiltonian:roo5} may be more obvious, but that path is still unclear.  If $A$ were invertible, which it isn't, then writing $b = A c$ would allow for a change of variables.  Does this matter for consideration of a physical problem.  Not really, so I'll fight the urge to play with the math for a while and perhaps revisit this later separately.

\subsection{Harmonic oscillator (spring potential)}

Like the free particle, the harmonic oscillator is very tractable in a phase space representation.  For a restoring force $F = - k x \xcap = -\spacegrad \phi$, we have $\phi = k x^2/2$, and a Lagrangian of

\begin{align}\label{eqn:hamiltonian:woo1}
\LL = \inv{2} m \Bv^2 - \inv{2} k \Bx^2
\end{align}

Our Hamiltonian is again just the total energy 

\begin{align}\label{eqn:hamiltonian:woo2}
H = \inv{2m} \Bp^2 + \inv{2} k \Bx^2
\end{align}

Evaluating the Hamiltonian equations we have

\begin{align}\label{eqn:hamiltonian:woo3}
\PD{p_i}{H} &= \dot{x_i} = p_i/m \\
\PD{x_i}{H} &= -\dot{p_i} = k x_i
\end{align}

Considering just the $x$ dimension (the others have the free particle behavior), our matrix phase space representation is

\begin{align}\label{eqn:hamiltonian:woo4}
\frac{d}{dt}
\begin{bmatrix}
p \\
x \\
\end{bmatrix}
=
\begin{bmatrix}
0 & - k \\
1/m & 0 \\
\end{bmatrix}
\begin{bmatrix}
p \\
x \\
\end{bmatrix}
\end{align}

So with 

\begin{align}\label{eqn:hamiltonian:woo5}
A = 
\begin{bmatrix}
0 & - k \\
1/m & 0 \\
\end{bmatrix}
\end{align}

Our solution is 

\begin{align}\label{eqn:hamiltonian:woo6}
\begin{bmatrix}
p \\
x \\
\end{bmatrix}
=
e^{At}
\begin{bmatrix}
p_0 \\
x_0 \\
\end{bmatrix}
\end{align}

The stateful nature of the phase space solution is interesting.  Provided we can make a simultaneous measurement of position and momentum, this initial state determines a next position and momentum state at a new time $t = t_0 + \Delta t_1$, and we have a tragectory through phase space of discrete transitions from one state to another

\begin{align}\label{eqn:hamiltonian:woo6a}
{\begin{bmatrix}
p \\
x \\
\end{bmatrix}}_{i+1}
=
e^{A \Delta t_{i+1}}
{\begin{bmatrix}
p \\
x \\
\end{bmatrix}}_i
\end{align}

Or 

\begin{align}\label{eqn:hamiltonian:woo6b}
{\begin{bmatrix}
p \\
x \\
\end{bmatrix}}_{i+1}
=
e^{A \Delta t_{i+1}} e^{A \Delta t_{i}} \cdots e^{A \Delta t_1}
{\begin{bmatrix}
p \\
x \\
\end{bmatrix}}_0
\end{align}

As for solving the system, we require again the exponential of our matrix.  This matrix being antisymmetric, has complex eigenvalues and again cannot be exponentiated easily by diagonalization.  However,  this antisymmetric matrix is very much like the complex imaginary and its square is a negative scalar multiple of identity, so we can procede directly forming the power series

\begin{align}\label{eqn:hamiltonian:woo7}
A^2 =
\begin{bmatrix}
0 & - k \\
1/m & 0 \\
\end{bmatrix}
\begin{bmatrix}
0 & - k \\
1/m & 0 \\
\end{bmatrix}
=
-\frac{k}{m} I
\end{align}

The first few powers are 
\begin{align}\label{eqn:hamiltonian:woo8}
A^2 &= -\frac{k}{m} I \\
A^3 &= -\frac{k}{m} A \\
A^4 &= \left(\frac{k}{m}\right)^2 I \\
A^5 &= \left(\frac{k}{m}\right)^2 A
\end{align}

So exponentiating we can collect cosine and sine terms
\begin{align*}
e^{At} 
&= I \left( 1 - \frac{k}{m} \frac{t^2}{2!} + \left( \frac{k}{m} \right)^2 \frac{t^4}{4!} + \cdots \right) 
+ A\sqrt{\frac{m}{k}} \left( \sqrt{\frac{k}{m}} - \left(\sqrt{\frac{k}{m}}\right)^3 \frac{t^3}{3!} + \left(\sqrt{\frac{k}{m}}\right)^5 \frac{t^5}{5!} \right) \\
&= 
I \cos\left(\sqrt{\frac{k}{m}} t\right) + \sqrt{\frac{m}{k}} A \sin\left(\sqrt{\frac{k}{m}} t\right)
\end{align*}

As a check it is readily verified that this satisfies the desired $d(e^{At})/dt = A e^{At}$ property.

The full solution in phase space representation is therefore

\begin{align}\label{eqn:hamiltonian:woo9}
\begin{bmatrix}
p \\
x \\
\end{bmatrix}
=
\begin{bmatrix}
p_0 \\
x_0 \\
\end{bmatrix}
\cos\left(\sqrt{\frac{k}{m}} t\right) 
+ \sqrt{\frac{m}{k}}
\begin{bmatrix}
-k x_0 \\
p_0/m \\
\end{bmatrix}
\sin\left(\sqrt{\frac{k}{m}} t\right)
\end{align}

Written out separately this is clearer

\begin{align}\label{eqn:hamiltonian:woo10}
p &= p_0 \cos\left(\sqrt{\frac{k}{m}} t\right) - \sqrt{\frac{m}{k}} k x_0 \sin\left(\sqrt{\frac{k}{m}} t\right) \\
x &= x_0 \cos\left(\sqrt{\frac{k}{m}} t\right) + \sqrt{\frac{m}{k}} \frac{p_0}{m} \sin\left(\sqrt{\frac{k}{m}} t\right)
\end{align}

One can readily verify that $m \xdot = p$, and $m \ddot{x} = -k x$ as expected.

Let's pause before leaving the harmonic oscillator to see if \ref{eqn:hamiltonian:woo10} seems to make sense.  Consider the position solution.  With only initial position and no initial velocity $p_0/m$ we have oscillation that has no dependence on the mass or spring constant.  This is the unmoving mass about to be let go at the end of a spring case, and since we have no damping force the magnitude of the oscillation is exactly the initial position of the mass.  If the instantaneous velocity is measured at position zero, it makes sense in this case that the oscillation amplitude does depend on both the mass and the spring constant.  The stronger the spring ($k$), the bigger the oscillation, and the smaller the mass, the bigger the oscillation.

It is definitely no easier to work with the phase space formulation than just solving the second order system directly.  The fact that we have a linear system to solve, at least in this particular case is kind of nice.  Perhaps this methodology can be helpful considering linear approximation solutions in a neighborhood of some phase space point for more complex non-linear systems.


\subsection{Gravitational potential}

Next I'd like to consider a two particle gravitational interaction.  However, to start we need the Lagrangian, and what should the potential term be in a two particle gravitational Lagrangian?  I'd guess something with a $1/x$ form, but do we need one potential term for each mass or something interrelated?  Whatever the Lagrangian is, we want it to produce the pair of force relationships

\begin{align}\label{eqn:hamiltonian:moo1}
\text{Force on 2} &= - G m_1 m_2 \frac{(\Br_2 - \Br_1)}{\Abs{\Br_2 - \Br_1}} \\
\text{Force on 1} &= G m_1 m_2 \frac{(\Br_2 - \Br_1)}{\Abs{\Br_2 - \Br_1}}
\end{align}

Guessing that the Lagrangian has a single term for the interaction potential

\begin{align}\label{eqn:hamiltonian:moo2}
\phi_{21} &= \kappa \inv{\Abs{\Br_2 - \Br_1}} 
\end{align}

so that we have
\begin{align}\label{eqn:hamiltonian:moo3}
\LL &= \inv{2} m {\Bv_1}^2 +\inv{2} m {\Bv_2}^2 - \phi_{21}
\end{align}

We can evaluate the Euler-Lagrange equations and see if the result is consistent with the Newtonian force laws of \ref{eqn:hamiltonian:moo1}.  Suppose we write the coordinates of $\Br_i$ as ${x^k}_i$.  There are then six Euler-Lagrange equations 

\begin{align*}
\PD{{x^j}_i}{\LL} &= \frac{d}{dt} \PD{{\dot{x}^j}_i}{\LL} \\
-\PD{{x^j}_i}{\phi_{21}} &= m_i {\ddot{x}^j}_i
\end{align*}

Evaluating the potential derivatives separately.  Consider the $i=2$ derivative

\begin{align*}
\PD{{x^j}_2}{\phi_{21}}
&= 
\kappa \PD{{x^j}_2}{} \left( \sum_k ({x^k}_2 - {x^k}_1)^2 \right)^{-1/2} \\
&=
-\kappa \inv{\Abs{\Br_2 - \Br_1}^3} \sum_k ({x^k}_2 - {x^k}_1) \PD{{x^j}_2}{} ({x^k}_2 - {x^k}_1) \\
&=
-\kappa \inv{\Abs{\Br_2 - \Br_1}^3} ({x^j}_2 - {x^j}_1)
\end{align*}

%Somewhat problematic in this derivative is the fact that the derivative of an absolute or square is multivalued.  Consider the graph of $y = (x-a)^2$, the derivative is $y' = \pm 2 (x-a)$ depending upon which side of the parabola one is evaluating the slope.  It appears that everything will work out, obtaining the Newtonian gravitation equations for two particle interaction with either sign, but we have to use the same sign for all derivatives.  With this sign picked arbitrarily following the sense convention of this above calculation, we have from the Euler-Lagrange equations

Therefore the final result of the Euler-Lagrange equations is

\begin{align}\label{eqn:hamiltonian:moo4}
\kappa \inv{\Abs{\Br_2 - \Br_1}^3} ({x^j}_2 - {x^j}_1) &= m_2 {\ddot{x}^j}_2 \\
-\kappa \inv{\Abs{\Br_2 - \Br_1}^3} ({x^j}_2 - {x^j}_1) &= m_1 {\ddot{x}^j}_1
\end{align}

which confirms the Lagrangian and potential guess and fixes the constant $\kappa = - G m_1 m_2$.  With the sign fixed, our potential, Lagrangian, and Hamiltonian are respectively

\begin{align}\label{eqn:hamiltonian:moo5}
\phi_{21} &= -\frac{G m_2 m_1 }{\Abs{\Br_2 - \Br_1}}  \\
\LL &= \inv{2} m_1 {\Bv_1}^2 +\inv{2} m_2 {\Bv_2}^2 - \phi_{21} \\
H &= \inv{2 m_1} {\Bp_1}^2 +\inv{2 m_2} {\Bp_2}^2 + \phi_{21}
\end{align}

There is however an undesirable asymmetry to this expression, in particular a formulation that extends to multiple particles seems desirable.  Let's write instead a slight variation

\begin{align}\label{eqn:hamiltonian:moo6}
\phi_{ij} = - \frac{G m_i m_j}{\Abs{\Br_i - \Br_j}}
\end{align}

and form a scaled by two double summation over all pairs of potentials

\begin{align}\label{eqn:hamiltonian:moo7}
\LL &= \sum_i \inv{2} m_i {\Bv_i}^2 - \inv{2} \sum_{i \ne j} \phi_{ij}
\end{align}

%Again since $$, for this to have meaning an agreement to evaluate the Euler-Lagrange partials according to the following ``positive'' sense is required
%
%\begin{align}\label{eqn:hamiltonian:moo8}
%\PD{{x^j}_i}{} (\Br_a - \Br_b)^2 \equiv (\Br_a - \Br_b) \cdot \PD{{x^j}_i}{} (\Br_a - \Br_b)
%\end{align}

Having established what seems like an appropriate form for the Lagrangian, we can write the Hamiltonian for the multiparticle gravitational interaction by inspection

\begin{align}\label{eqn:hamiltonian:moo9}
H = \sum_i \inv{2 m_i} {\Bp_i}^2 + \inv{2} \sum_{i \ne j} \phi_{ij}
\end{align}

This leaves us finally in position to evaluate the Hamiltonian equations, but the result of doing so is rudely nothing more than the Newtonian equations in coordinate form.  We get, for the $k$th component of the $i$th particle 

\begin{align}\label{eqn:hamiltonian:moo10}
\PD{{p^k}_i}{H} = {\dot{x}^k}_i = \inv{m_i} {p^k}_i 
\end{align}

\begin{align}\label{eqn:hamiltonian:moo11}
\PD{{x^k}_i}{H} = -{\dot{p}^k}_i = G \sum_{j \ne i} m_i m_j \frac{{x^k}_i -{x^k}_j}{\Abs{\Br_i - \Br_j}^3}
\end{align}

The state space vector for this system of equations is brutally ugly, and could be put into the following form for example

\begin{align}\label{eqn:hamiltonian:moo12}
\Bz =
\begin{bmatrix}
{p^1}_1 \\
{p^2}_1 \\
{p^3}_1 \\
{x^1}_1 \\
{x^2}_1 \\
{x^3}_1 \\
{p^1}_2 \\
{p^2}_2 \\
{p^3}_2 \\
{x^1}_2 \\
\vdots \\
\end{bmatrix}
\end{align}

Where the Hamiltonian equations take the form of a non-linear function on such state space vectors
We have a somewhat sparse equation of the form

\begin{align}\label{eqn:hamiltonian:moo13}
\frac{d\Bz}{dt} = A(\Bz)
\end{align}

One thing that is possible in such a representation is calculating the first order approximate change in position and momentum moving from one time to a small time later

\begin{align}\label{eqn:hamiltonian:moo14}
\Bz(t_0 + \Delta t) = \Bz(t_0) + A(\Bz(t_0)) \Delta t
\end{align}

One could concievably calculate the trajectories in phase space using such increments, and if a small enough time increment is used this can be thought of as solving the gravitational system.  I recall that Feynman did something like this in his lectures, but set up the problem in a more computationally efficient form (it definitely didn't have the redundancy built into the Hamiltonian equations).

FIXME: should be able to solve this for an arbitrary $\Delta t$ later time if this was extended to the higher order terms.  Need something like the $e^{z \cdot \grad}$ chain rule expansion.  Think this through.  Will be a little different since we are already starting with the first order contribution.

What does this system of equations look like with a reduction of order through center of mass change of variables?
% Lut was exploring this and having trouble.

\subsection{Pendulum}

\subsection{Spherical pendulum}

\subsection{Double pendulum}

\subsection{Particle in non-velocity dependent potential.}

\subsection{Velocity dependent potential.}

\subsection{Dangling mass connected by string to another.}

\subsection{Relativistic force free Hamiltonian.}

\subsection{Lorentz force Hamiltonian.}

\EndArticle
