\documentclass{article}

\input{../peeters_macros.tex}
\input{../peeters_macros2.tex}

%\usepackage{listings}
\usepackage{txfonts} % for ointctr... (also appears to make "prettier" \int and \sum's)
\usepackage[bookmarks=true]{hyperref}

\usepackage{color,cite,graphicx}
   % use colour in the document, put your citations as [1-4]
   % rather than [1,2,3,4] (it looks nicer, and the extended LaTeX2e
   % graphics package.
\usepackage{latexsym,amssymb,epsf} % don't remember if these are
   % needed, but their inclusion can't do any damage


\title{ Quantum Harmonic Oscillator. }
\author{Peeter Joot \quad peeter.joot@gmail.com }
\date{ April 19, 2009.  Last Revision: $Date: 2009/04/20 04:09:27 $ }

\begin{document}

\maketitle{}
\tableofcontents
\section{ Motivation. }

In \cite{byron1992mca} (chapter II), an operator solution to the
(one dimensional) quantum
harmonic oscillator problem is presented.  Try this in a more old fashioned way,
as a comparison.

We want to solve the Schr\"{o}dinger equation for a quadratic potential

\begin{align}\label{eqn:toSolve}
-\frac{\hbar^2}{2m} \psi + \inv{2} m \omega^2 x^2 \psi = i \hbar \PD{t}{\psi}
\end{align}

\section{ Setup. }

\subsection{ Separation of variables. }

Equation \ref{eqn:toSolve} is separable, and to do so we can write

\begin{align*}
\psi(x,t) = \phi(x) T(t)
\end{align*}

and proceed to form the separated equation

\begin{align*}
-\frac{\hbar^2}{2m} \frac{\phi''}{\phi} + \inv{2} m \omega^2 x^2 = i \hbar \frac{T'}{T} = \text{constant}
\end{align*}

Writing $E$ for the constant, the and solving for the time function we have

\begin{align*}
(\ln(T))' &= -i \frac{E}{\hbar} \\
\implies \\
\ln(T) &= -i \frac{Et}{\hbar} + \ln(A)
\end{align*}

where $A$ is some constant.  This yields

\begin{align*}
T(t) = A e^{ -i E t/\hbar }
\end{align*}

What remains is now to solve the spatial wave equation

\begin{align}\label{eqn:spatial}
\phi'' + \left( \frac{m^2 \omega^2}{\hbar^2} x^2 - \frac{2m E}{\hbar^2}\right) \phi = 0
\end{align}

This doesn't really look too much like the harmonic oscillator problem of classical physics.  Let's remind ourself
what that was like before continuing.

\subsection{ Mass on a spring. }

The harmonic oscillator problem from classical physics
shows up many times, and is usually first seen when examining motion
of a mass on a spring.  There we have a restoring force that accelerates the
mass in the opposite direction from its equilibrium position

\begin{align}
m \xddot = -k x
\end{align}

This has two complex exponential solutions.  With a substitution of the test function

\begin{align*}
x = e^{i \omega t}
\end{align*}

we have

\begin{align*}
(-m \omega^2 + k) e^{i \omega t} = 0
\end{align*}

So the test function is a solution provided

\begin{align*}
\omega^2 = \frac{k}{m}
\end{align*}

That doesn't really help understanding why \ref{eqn:spatial} is labeled the Harmonic oscillator.  Let's instead put the equation into an energy form.  The work done against the spring
(potential energy to be returned when the mass is released) is

\begin{align*}
W 
&= - \int F \cdot dx \\
&= - \int -kx dx \\
&= \inv{2} k (x^2 - x_0^2)
\end{align*}

So, our Lagrangian is

\begin{align*}
\LL = \inv{2}m \xdot^2 - \inv{2} k (x^2 - x_0^2)
\end{align*}

The constant term in the potential can be dropped, since it won't contribute to the equations of motion.  Our conjugate momentum $\PDi{\xdot}{\LL}$ is just $m \xdot$, and the Hamiltonian
is therefore

\begin{align*}
H 
&= \xdot \PD{\xdot}{\LL} - \LL \\
&= m \xdot^2  - \left( \inv{2}m \xdot^2 - \inv{2} k x^2 \right) \\
&= \inv{2} m \xdot^2  + \inv{2} k x^2 \\
\end{align*}

Or

\begin{align*}
H &= \frac{p^2}{2 m } + \inv{2} m \omega^2 x^2 \\
\end{align*}

Ah.  In this form we see the structure of the QM Harmonic oscillator equation.  With the position space representation of the momentum operator $p \sim -i \hbar \PDi{x}{}$ we have
something now similar to \ref{eqn:toSolve}.

\section{ Series solution. }

\subsection{ Assuming Gaussian solutions. }

Having seen the operator solution of the QM harmonic oscillator problem, we will cheat, and use that as a starting point.  Assume that
the solution can be expressed as a scaled Gaussian as in

\begin{align}
\phi(x) &= f(x) e^{ - \alpha x^2/2 }
\end{align}

\begin{align*}
\phi'(x) &= \left( f'(x) - \alpha x f(x) \right) e^{ - \alpha x^2/2 } \\
\phi''(x)
&=
\left( f''(x) - \alpha f(x) -\alpha x f'(x) \right) e^{ - \alpha x^2/2 }
\left( f'(x) - \alpha x f(x) \right) (-\alpha x) e^{ - \alpha x^2/2 } \\
&=
\left( f''(x) - \alpha f(x) - 2 \alpha x f'(x) + \alpha^2 x^2 f(x) \right) e^{ - \alpha x^2/2 }
\end{align*}

Substitution of the scaled Gaussian test solution, and its derivatives, gives us

\begin{align*}
\left( f'' - \alpha f - 2 \alpha x f' + \alpha^2 x^2 f + \left( \frac{m^2 \omega^2}{\hbar^2} x^2 - \frac{2 m E}{\hbar^2} \right) f \right) e^{ -\alpha x^2 /2} = 0
\end{align*}

Since the exponential is never zero, this requires a zero for the differential equation

\begin{align}
f'' - 2 \alpha x f' + \left( \left(\alpha^2 + \frac{m^2 \omega^2}{\hbar^2} \right) x^2 - \left(\frac{2 m E}{\hbar^2} + \alpha \right) \right) f = 0
\end{align}

Compared to \ref{eqn:spatial}, this doesn't really appear to be much of an improvement, but let's work with it, looking for a term by term power series solution.

Before doing so, a couple helper variable substitutions appear to be in order.  Let

\begin{align*}
\beta^2 &= \alpha^2 + \frac{m^2 \omega^2}{\hbar^2}  \\
\sigma &= \frac{2 m E}{\hbar^2} + \alpha 
\end{align*}

So the new differential equation to solve is

\begin{align}
f'' - 2 \alpha x f' + \beta^2 x^2 f - \sigma f = 0
\end{align}

Assuming various power series solutions of the form

\begin{align*}
f_n(x) &= \sum_{r=0}^n a_r x^r
\end{align*}

derivatives are
\begin{align*}
f_n' &= \sum_{r=0}^n r a_r x^{r-1} \\
f_n'' &= \sum_{r=0}^n r(r-1) a_r x^{r-2}
\end{align*}

We have 
\begin{align*}
0 &= \sum_{r=0}^{n-2} (r+2)(r+1) a_{r+2} x^{r}
 - 2 \alpha \sum_{r=1}^n r a_r x^{r}
+ \beta^2
\sum_{r=0}^n a_r x^{r+2} 
- \sigma \sum_{r=0}^n a_r x^r
\end{align*}

This should be enough to figure out recurrence relations for the various constants in the polynomials.

However, before trying to acquire the recurrence relations in their most general form, an attempt at a few simple cases, looking for the lowest order
polynomial solutions explicitly, gets into trouble.

Specifically, if I try $n=0$, $n=1$, $n=2$ equating each of the polynomial coefficients to zero keeps killing all the coefficients in sequence.  What's 
gone wrong?

\subsection{ Try zeroth order polynomial scaled Gaussian explicitly. }

Somewhere above things went wrong.  How about a plain old Gaussian?  Let's substitute 

\begin{align*}
\psi = A e^{\alpha x^2/2}
\end{align*}

into 

\begin{align*}
-\frac{\hbar^2}{2m} \psi'' + \left( \inv{2}m \omega^2 x^2 - E \right) \psi = 0
\end{align*}

Dropping the constant $A$ temporarily the derivatives are
\begin{align*}
\psi' &= \alpha x e^{\alpha x^2/2} \\
\psi'' &= ( \alpha^2 x^2 + \alpha ) e^{\alpha x^2/2} \\
\end{align*}

This gives
\begin{align*}
\left( -( \alpha^2 x^2 + \alpha )\frac{\hbar^2}{2 m} + \left( \inv{2}m \omega^2 x^2 - E \right) \right) e^{\alpha x^2/2} = 0
\end{align*}

Equating $x^2$ and $x^0$ terms we have

\begin{align*}
\frac{\alpha^2 \hbar^2}{2 m} &= \inv{2}m \omega^2  \\
\frac{\alpha \hbar^2}{2 m} &= -E 
\end{align*}

Or
\begin{align*}
\alpha &= \pm \frac{ m \omega }{ \hbar }  \\
{\alpha } &= - \frac{2 m E }{\hbar^2}
\end{align*}

Since $\omega = \sqrt{k/m}$ is a given, we want $E$ in terms of $\omega$.  Picking $\alpha$ negative for positive energy, this is

\begin{align*}
E = \frac{ \omega \hbar }{ 2 } 
\end{align*}

The solution to the $T'/T$ equation is thus

\begin{align*}
T \propto e^{-i \omega t/2}
\end{align*}

So, except for the undetermined constant normalization factor, we have one full solution of the wave equation, 

\begin{align*}
\psi(x,t) = A \exp\left( - \frac{m \omega x^2 }{2 \hbar} - i \frac{\omega t}{2} \right)
\end{align*}

The normalization

\begin{align*}
1 
&= \int \psi \psi^\conj \\
&= A^2 \int \exp\left( - \frac{m \omega x^2 }{\hbar} \right) \\
&= A^2 \sqrt{ \frac{\hbar \pi}{ m \omega } }
\end{align*}

For a normalized solution
\begin{align}
\psi(x,t) = \left( 
\frac{ m \omega }{\hbar \pi}
\right)^{1/4} \exp\left( - \frac{m \omega x^2 }{2 \hbar} - i \frac{\omega t}{2} \right)
\end{align}

\subsection{ Try first order polynomial scaled Gaussian. }

Next, let's try 

\begin{align*}
\psi = (x + A) e^{-\alpha x^2/2}
\end{align*}

No coefficient for the first order nomial has been used since we will need a scale factor in the end for normalization anyways.  Taking derivatives

\begin{align*}
\psi' 
&= (1 + (x + A)(-\alpha x)) e^{-\alpha x^2/2} \\
&= (1 - \alpha A x - \alpha x^2 ) e^{-\alpha x^2/2} \\
\end{align*}

\begin{align*}
\psi'' 
&= 
\left( - 3 \alpha x - \alpha A + \alpha^2 A x^2 + \alpha^2 x^3 \right) e^{-\alpha x^2/2} \\
\end{align*}

So we have

\begin{align*}
-\frac{\hbar^2}{2m}\left( - 3 \alpha x - \alpha A + \alpha^2 A x^2 + \alpha^2 x^3 \right) 
+ \left( \inv{2}m \omega^2 x^2 - E \right) (x + A) = 0
\end{align*}

Equating either cubic or squared terms provides $\alpha$

\begin{align*}
\alpha = \pm \frac{m \omega}{\hbar}
\end{align*}

This is what we had for the plain old Gaussian as well.

Equating either the first and scalar terms gives us the energy 

\begin{align*}
E = \frac{3 \alpha \hbar^2}{2m} = \frac{3 \omega \hbar}{2}
\end{align*}

which differs from the zeroth order case by a factor of three.

It's curious that the coefficient $A$ cannot be determined.  I didn't expect it to be a free parameter.  Is the normalization enough to
fix this and any other leading factor?

With
\begin{align*}
\psi = (B x + A) \exp( - m \omega x^2/2 \hbar - 3 i \omega t / 2 )
\end{align*}

\begin{align*}
1 
&= \int \psi\psi^\conj \\
&= \int (B^2 x^2 + 2 A B x + A^2 ) e^{- m \omega x^2/ \hbar } \\
&= \int (B^2 x^2 + A^2 ) e^{- m \omega x^2/ \hbar } \\
&= A^2 \sqrt{\frac{\pi \hbar}{m \omega}} + B^2 \inv{2 \pi} \left( \frac{\pi \hbar}{ m \omega} \right)^{3/2} \\
&= \sqrt{\frac{\pi \hbar}{m \omega}} \left( A^2 + B^2 \frac{ \hbar}{ 2 m \omega} \right) \\
\end{align*}

In terms of an arbitrary constant $B$, this gives

\begin{align*}
\end{align*}

It is perhaps reasonable to pick $B=1$.  Regardless, the general solution for this first order polynomial scaled Gaussian is

\begin{align*}
\psi(x,t) = 
\left(B x \pm \sqrt{\sqrt{\frac{m \omega}{\pi \hbar}} - B^2 \frac{ \hbar}{ 2 m \omega} }\right) \exp\left( - \frac{m \omega x^2}{2 \hbar} - \frac{3 i \omega t }{ 2} \right)
\end{align*}

I expected something a bit more simple, without this extra degree of freedom.  That probably has to come from the orthonormality conditions on the
Hermite polynomials.

Now, there isn't anything here that is particularly special in these two cases, so I'd expect the error has to be a plain old algebra problem 
hiding in there somewhere.

\bibliographystyle{plainnat}
\bibliography{myrefs}

\end{document}
