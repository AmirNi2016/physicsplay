%
% Copyright © 2012 Peeter Joot.  All Rights Reserved.
% Licenced as described in the file LICENSE under the root directory of this GIT repository.
%
%\input{../assignment.tex}
%\renewcommand{\basename}{modernOpticsProblem Set1}
%\renewcommand{\dirname}{notes/phy485/}
%\newcommand{\keywords}{Optics, PHY485H1F}
%\newcommand{\dateintitle}{}
%\input{../peeter_prologue_print2.tex}
%\beginArtNoToc
%\generatetitle{PHY485H1F Modern Optics.  Problem Set 1: Geometric Optics}
\chapter{Problem set 1.  Geometric Optics}
\label{chap:modernOpticsProblem Set1}

\makeproblem{ABCD Matrices}{modernOptics:problemSet1:1}{
Using the ABCD matrices from the lecture, prove these well-known rules of geometric optics. In each case, {\bf make an illustration}, tracing some important rays that illustrate the rule. 
\begin{enumerate}
\item[(a)] {\em An image is formed when $1/f = 1/s_o + 1/s_i$.} Solve this problem using the result we found in class: when B=0 for a system matrix, the input and output are conjugate planes.
\item[(b)] {\em An image with magnification $-x'/f$ is formed when $x x' = f^2$.} Repeat part (a), but in ``Newton's form'': replace $s_o$ with $f + x$, and replace $s_i$ with $f + x'$. 
\item[(c)] {\em The position distribution at the focus of a lens is the angular position of the incident beam.} (In other words, a lens does a kind of Fourier transform, as you may know already.) Find where the input plane has to be located for $y_o = f \alpha_i$.
\item[(d)] {\em Two identical lenses spaced by $2f$ image an object at $f$ with unity magnification.}
\item[(e)] Two identical lenses spaced by $2f$ are {\em telecentric}, meaning that an object at $f+x$ from the first lens has a magnification independent of $x$, in contrast to a simple lens.
\item[(f)] A lens and a flat mirror spaced by distance $f$ create a {\em cat's eye}. What are its properties? Consider, in particular, an emitter located $f$ in front of the Cat's eye and located at $y_i = 0$. 
\end{enumerate}
}

\makeanswer{modernOptics:problemSet1:1}{ 

\begin{enumerate}
\item[(a)] 

Our system and the associated transfer matrices labels are illustrated in figure (\ref{fig:modernOpticsProblemSet1:modernOpticsProblemSet1Fig1aTake2}).

\imageFigure{modernOpticsProblemSet1Fig1aTake2}{Input and output conjugate planes for paraxial thin lens}{fig:modernOpticsProblemSet1:modernOpticsProblemSet1Fig1aTake2}{0.4}

We form the system transfer matrix by applying first a free propagation matrix, then a thin lens paraxial matrix, and one more free propagation matrix

\begin{dmath}\label{eqn:modernOpticsProblemSet1:1790}
M 
= M_3 M_2 M_1
= 
\begin{bmatrix}
1 & s' \\
0 1
\end{bmatrix}
\begin{bmatrix}
1 & 0 \\
-1/f & 1
\end{bmatrix}
\begin{bmatrix}
1 & s \\
0 1
\end{bmatrix}
=
\begin{bmatrix}
1 - s'/f & s' \\
-1/f & 1
\end{bmatrix}
\begin{bmatrix}
1 & s \\
0 1
\end{bmatrix}
=
\begin{bmatrix}
1 - s'/f & s + s' - s s'/f \\
-1/f & -s/f + 1
\end{bmatrix}.
\end{dmath}

Consider ray $(B)$ from the figure, where we have

\begin{dmath}\label{eqn:modernOpticsProblemSet1:1810}
\begin{bmatrix}
0 \\
\alpha
\end{bmatrix}
\rightarrow
\alpha
\begin{bmatrix}
s + s' - s s'/f \\
-s/f + 1
\end{bmatrix}
= 
\begin{bmatrix}
0 \\
\alpha'
\end{bmatrix}.
\end{dmath}

With 

\begin{equation}\label{eqn:modernOpticsProblemSet1:1830}
y = y' = \alpha ( s + s' - s s'/f ) = 0,
\end{equation}

for all $\alpha$.  We must have

\begin{equation}\label{eqn:modernOpticsProblemSet1:1850}
s + s' = \frac{s s'}{f}.
\end{equation}

Dividing through by $s s'$ we have

\begin{equation}\label{eqn:modernOpticsProblemSet1:1870}
\boxed{
\inv{s'} + \inv{s} = \inv{f},
}
\end{equation}

as expected.

\item[(b)]

Let's consider the system as the compound action of three transfer matrices as illustrated in figure (\ref{fig:modernOpticsProblemSet1:modernOpticsProblemSet1Fig2b1}), this time labeling the figure in terms of the variables for this problem.

\imageFigure{modernOpticsProblemSet1Fig2b1}{Newton's form, an image with magnification}{fig:modernOpticsProblemSet1:modernOpticsProblemSet1Fig2b1}{0.4}

Compounding the transfer matrices we have

\begin{dmath}\label{eqn:modernOpticsProblemSet1:1510}
M 
= M_3 M_2 M_1
= 
\begin{bmatrix}
1 & x' + f \\
0 & 1
\end{bmatrix}
\begin{bmatrix}
1 & 0 \\
-1/f & 1
\end{bmatrix}
\begin{bmatrix}
1 & x + f \\
0 & 1
\end{bmatrix}
=
\begin{bmatrix}
-x'/f & x' + f \\
-1/f & 1
\end{bmatrix}
\begin{bmatrix}
1 & x + f \\
0 & 1
\end{bmatrix}
=
-\inv{f}
\begin{bmatrix}
x' & x x' - f^2 \\
1 & x
\end{bmatrix}.
\end{dmath}

Consider the ray $A$ where the effect is

\begin{dmath}\label{eqn:modernOpticsProblemSet1:1530}
\begin{bmatrix}
y \\
0
\end{bmatrix}
\rightarrow 
-\inv{f} 
\begin{bmatrix}
y x' \\
y
\end{bmatrix}.
\end{dmath}

We see that $y' = -y x'/f$ or

\begin{equation}\label{eqn:modernOpticsProblemSet1:1550}
\boxed{
m = - \frac{x'}{f} = \frac{y'}{y}.
}
\end{equation}

The quantity defined as the magnification is in fact the ratio of the output to the input size as intuitively expected.  Now consider a ray $C$ originating at $y = 0$ at the image source, and landing at $y = 0$ on the conjugate output plane.  For this ray we have

\begin{equation}\label{eqn:modernOpticsProblemSet1:1570}
\begin{bmatrix}
0 \\
\alpha
\end{bmatrix}
\rightarrow 
-\inv{f} 
\begin{bmatrix}
x x' -f^2 \\
x
\end{bmatrix} \theta
= 
\begin{bmatrix}
0 \\
\alpha'
\end{bmatrix}.
\end{equation}

Since this holds for all input angles originating at $y = 0$ from the input plane, we must have
\begin{dmath}\label{eqn:modernOpticsProblemSet1:1590}
\boxed{
x x' = f^2,
}
\end{dmath}

as desired.

\item[(c)]

Here we refer to figure (\ref{fig:modernOpticsProblemSet1:modernOpticsProblemSet1Fig1c}), this time considering no ray that passes the focus past the lens.  Our system transfer matrix, given the reduced free propagation distance past the lens is
\imageFigure{modernOpticsProblemSet1Fig1c}{Position distribution at the focus of a lens}{fig:modernOpticsProblemSet1:modernOpticsProblemSet1Fig1c}{0.3}

\begin{dmath}\label{eqn:modernOpticsProblemSet1:1610}
M 
= M_3 M_2 M_1
=
\begin{bmatrix}
1 & f \\
0 & 1
\end{bmatrix}
\begin{bmatrix}
1 & 0 \\
-1/f & 1
\end{bmatrix}
\begin{bmatrix}
1 & x + f \\
0 & 1
\end{bmatrix}
=
\begin{bmatrix}
0 & f \\
-1/f & 1
\end{bmatrix}
\begin{bmatrix}
1 & x + f \\
0 & 1
\end{bmatrix}
=
\begin{bmatrix}
0 & f \\
-1/f & -x/f
\end{bmatrix}.
\end{dmath}

A ray is transformed according to
\begin{dmath}\label{eqn:modernOpticsProblemSet1:1630}
\begin{bmatrix}
y \\
\theta 
\end{bmatrix}
\rightarrow
\begin{bmatrix}
0 & f \\
-1/f & -x/f
\end{bmatrix}
\begin{bmatrix}
y \\
\theta 
\end{bmatrix}
=
\begin{bmatrix}
f \theta \\
-\inv{f} ( y - x \theta )
\end{bmatrix}.
\end{dmath}

In particular
\begin{dmath}\label{eqn:modernOpticsProblemSet1:1650}
\boxed{
y' = f \theta,
}
\end{dmath}

demonstrating the claim that at the focus, the position is an angular distribution of the incident beam.  This is clearly independent of $x$ so the input plane position is irrelevant.

\item[(d)]

Consider figure (\ref{fig:modernOpticsProblemSet1:modernOpticsProblemSet1Fig1d}).

\imageFigure{modernOpticsProblemSet1Fig1d}{Two identical lenses separated by twice focus}{fig:modernOpticsProblemSet1:modernOpticsProblemSet1Fig1d}{0.2}

The transfer matrix $M = M_5 M_4 M_3 M_2 M_1$ for the system is

\begin{dmath}\label{eqn:modernOpticsProblemSet1:1670}
M 
= M_5 M_4 M_3 M_2 M_1
=
\begin{bmatrix}
1 & x + f \\
0 & 1 
\end{bmatrix}
\begin{bmatrix}
1 & 0 \\
-1/f & 1
\end{bmatrix}
\begin{bmatrix}
1 & 2 f \\
0 & 1
\end{bmatrix}
\begin{bmatrix}
1 & 0 \\
-1/f & 1
\end{bmatrix}
\begin{bmatrix}
1 & x + f \\
0 & 1 
\end{bmatrix}
=
\begin{bmatrix}
-x/f & x + f \\
-1/f & 1
\end{bmatrix}
\begin{bmatrix}
1 & 2 f \\
0 & 1
\end{bmatrix}
\begin{bmatrix}
1 & x + f \\
-1/f & -x/f
\end{bmatrix}
=
\begin{bmatrix}
-x/f & -x + f \\
-1/f & -1
\end{bmatrix}
\begin{bmatrix}
1 & x + f \\
-1/f & -x/f
\end{bmatrix}
=
\begin{bmatrix}
-1 & -2 x \\
0 & -1
\end{bmatrix}.
\end{dmath}

Consider any ray from the source going towards the lens along the horizontal.  We have

\begin{dmath}\label{eqn:modernOpticsProblemSet1:1690}
\begin{bmatrix}
y \\
0
\end{bmatrix}
\rightarrow 
\begin{bmatrix}
-y \\
0
\end{bmatrix},
\end{dmath}

The ratio of the output to the input height to be

\begin{dmath}\label{eqn:modernOpticsProblemSet1:1710}
\boxed{
\frac{y'}{y} = -1,
}
\end{dmath}

which is the unit magnitude magnification as desired.

\item[(e)]

This is actually demonstrated above.

\item[(f)]

Here we consider figure (\ref{fig:modernOpticsProblemSet1:modernOpticsProblemSet1Fig1f}).

\imageFigure{modernOpticsProblemSet1Fig1f}{Cat's eye.  Lens with mirror behind at focus}{fig:modernOpticsProblemSet1:modernOpticsProblemSet1Fig1f}{0.4}

Our system transfer matrix is

\begin{dmath}\label{eqn:modernOpticsProblemSet1:1730}
M = 
M_7
M_6
M_5
M_4
M_3
M_2
M_1
=
\begin{bmatrix}
1 & s' \\
0 & 1
\end{bmatrix}
\begin{bmatrix}
1 & 0 \\
-1/f & 1
\end{bmatrix}
\begin{bmatrix}
1 & f \\
0 & 1
\end{bmatrix}
\begin{bmatrix}
1 & 0 \\
0 & 1
\end{bmatrix}
\begin{bmatrix}
1 & f \\
0 & 1
\end{bmatrix}
\begin{bmatrix}
1 & 0 \\
-1/f & 1
\end{bmatrix}
\begin{bmatrix}
1 & s \\
0 & 1
\end{bmatrix}
=
\begin{bmatrix}
1 - s'/f & s' \\
-1/f & 1
\end{bmatrix}
\begin{bmatrix}
1 & 2 f \\
0 & 1
\end{bmatrix}
\begin{bmatrix}
1 & s \\
-1/f & -s/f + 1
\end{bmatrix}
=
\begin{bmatrix}
1 - s'/f & 2f - s' \\
-1/f & -1
\end{bmatrix}
\begin{bmatrix}
1 & s \\
-1/f & -s/f + 1
\end{bmatrix}
=
\begin{bmatrix}
-1 & 2 f - s' -s \\
0 & -1
\end{bmatrix}
\end{dmath}

We see that the angle of the output light is unchanged except for sign, so we have no scattering in the paraxial limit.  Observe that if the emitter is positioned at $s = f$ we have

\begin{dmath}\label{eqn:modernOpticsProblemSet1:1750}
M = 
\begin{bmatrix}
-1 & f - s' \\
0 & -1
\end{bmatrix}
\end{dmath}

so

\begin{dmath}\label{eqn:modernOpticsProblemSet1:1770}
y' = -y + (f -s') \alpha.
\end{dmath}

The image is magnified (negatively) for any position $\Abs{s'} > f$ without any angular distortion.  In fact, if the observation is also made at the focus, then the image magnification is unity.  Notice that at the focus we have both a sign change in the position and the angle coordinate, meaning that the output image is exactly the same as in the input image.  In retrospect, this is exactly the same system mathematically as the $2f$ spaced lenses of parts (d) and (e), and we could have done the matrix products just once for all those parts of the problem!

\end{enumerate}
}

\makeproblem{Ray in a linear index gradient}{modernOptics:problemSet1:2}{
What is the shape of a ray moving into a linear index gradient (figure \ref{fig:modernOpticsProblemSet1:FigureRayLinGrad})? You'd expect something like a parabola from the intuition that the Ray Equation is `Newton-like'. Find out what you actually get! To establish some conventions: take $n(y) = n_0 - \beta y$; choose parameterization of the ray so that $s=0$ at the top of the trajectory: $\Br(0) = 0$, and $d \Br /ds = \hat{x}$ at $s=0$. In this case the ray will remain in the $xy$ plane, so your task is to find $x(s)$ and $y(s)$. 
\imageFigure{FigureRayLinGrad}{}{fig:modernOpticsProblemSet1:FigureRayLinGrad}{0.2}
\begin{enumerate}
\item[(a)] Start with the Ray Equation $\frac{d}{ds} \{ n \frac{d}{ds} \Br \} = \spacegrad n$. Integrate both sides with respect to $s$, and use initial conditions to determine constants of integration. You should be left with two first-order differential equations.
\item[(b)] Solve the $dy/ds$ equation first, by integrating again with respect to $s$. Give an exact expression for $z(s)$. Also give approximate expressions for $y(s)$  in two limits: small $s$, and large $s$. 
\item[(c)] Now solve the $dx/ds$ equation. Again, give an exact expression for $x(s)$, and approximate expressions for $x(s)$  in two limits: small $s$, and large $s$.
\item[(d)] Combine your results to give $x(y)$. (This may seem strange, but an exact result for $y(x)$ is hard to write down. You'll have to restrict yourself to $x>0$ for this curve to be functional.) You can again find an exact result, an small-s approximation, and a large-s approximation.
\item[(e)] Is the trajectory of an optical ray a parabola in any limit? If so, what is gravitational acceleration?
\item[(f)] Use your favorite software (Mathematica, ...) to make a plot of $x(s)$, $y(s)$, and $x(y)$. In each plot, compare the exact expression (as a solid line) to the two limiting expressions (as dashed lines). Nondimensionalize in terms of $L=n_0/\beta$: in other words, use the variables $x/L$, $y/L$, and $s/L$.
\end{enumerate}
}

\makeanswer{modernOptics:problemSet1:2}{ 
\begin{enumerate}
\item[(a)] Our ray equation, after computation of the gradient of the index of refraction for the material becomes

\begin{dmath}\label{eqn:modernOpticsProblemSet1:10}
\dds{} \left( n(\Br) \dds{\Br} \right) 
= \spacegrad n(\Br) 
= \spacegrad \left( n_0 - \beta y \right)
= -\beta \ycap.
\end{dmath}

In components this is

\begin{equation}\label{eqn:modernOpticsProblemSet1:30}
\begin{aligned}
\dds{} \left( \left( n_0 - \beta y \right) \dds{x} \right) &= 0 \\
\dds{} \left( \left( n_0 - \beta y \right) \dds{y} \right) &= -\beta \\
\dds{} \left( \left( n_0 - \beta y \right) \dds{z} \right) &= 0
\end{aligned}
\end{equation}

Integrating once, with the introduction of $n_0$ factors in our integration constant (which will clearly make life easier), we have
\begin{equation}\label{eqn:modernOpticsProblemSet1:50}
\begin{aligned}
\left( n_0 - \beta y \right) \dds{x} &= A n_0 \\
\left( n_0 - \beta y \right) \dds{y} &= -\beta s + B n_0 \\
\left( n_0 - \beta y \right) \dds{z} &= C n_0
\end{aligned}
\end{equation}

In particular, at $s = 0$, where $x(0) = y(0) = z(0) = 0$, $x'(0) = 1$ and $y'(0) = z'(0) = 0$, we have

\begin{equation}\label{eqn:modernOpticsProblemSet1:70}
\begin{aligned}
n_0 (1) &= A n_0 \\
n_0 (0) &= B n_0 \\
n_0 (0) &= C n_0
\end{aligned}
\end{equation}

Our equations of motion become
\begin{equation}\label{eqn:modernOpticsProblemSet1:90}
\boxed{
\begin{aligned}
\left( n_0 - \beta y \right) \dds{x} &= n_0 \\
\left( n_0 - \beta y \right) \dds{y} &= -\beta s \\
\left( n_0 - \beta y \right) \dds{z} &= 0.
\end{aligned}
}
\end{equation}

We have two non-trivial differential equations to solve.

\item[(b)]

First observe that unless $n_0 = \beta y(s)$ for all $s$, then $z(s)$ must be constant.  However, our boundary condition $\Br(0) = 0$ means that this constant is zero

\begin{equation}\label{eqn:modernOpticsProblemSet1:110}
z(s) = \text{constant} = z(0) = 0.
\end{equation}

Solving for $y(s)$ next we have after rearranging

\begin{dmath}\label{eqn:modernOpticsProblemSet1:130}
\int \left( n_0 - \beta y \right) dy = -\beta \int s ds
\end{dmath}

This yields

\begin{dmath}\label{eqn:modernOpticsProblemSet1:150}
n_0 y - \frac{\beta}{2} y^2 = -\frac{\beta}{2} s^2 + C.
\end{dmath}

Noting that $y(0) = 0$ we have $C = 0$

\begin{dmath}\label{eqn:modernOpticsProblemSet1:170}
y^2 - s^2 - 2 \frac{n_0}{\beta} y = 0.
\end{dmath}

Completing the square

\begin{dmath}\label{eqn:modernOpticsProblemSet1:230}
\left( y - \frac{n_0}{\beta} \right)^2 = s^2 + \left( \frac{n_0}{\beta} \right)^2 
\end{dmath}

or

\begin{dmath}\label{eqn:modernOpticsProblemSet1:190}
y = \frac{n_0}{\beta} \pm \sqrt{ s^2 + \left( \frac{n_0}{\beta} \right)^2 }.
\end{dmath}

Given the $y(0) = 0$ boundary constraint, we can only pick the negative root.  Borrowing the $L = n_0/\beta$ notation from later in the problem, we have

\begin{dmath}\label{eqn:modernOpticsProblemSet1:210}
\boxed{
%y(s) = \frac{n_0}{\beta} - \sqrt{ s^2 + \left( \frac{n_0}{\beta} \right)^2 }.
y(s) = L \left( 1 - \sqrt{ \left( \frac{s}{L}\right)^2 + 1 } \right) .
}
\end{dmath}

Let's look at the small limit where $s \ll L$  

\begin{dmath}\label{eqn:modernOpticsProblemSet1:250}
y(s) 
%= L \left( 1 - \sqrt{ 1 + \left(\frac{s}{L}\right)^2 } \right)
\sim L \left( 1 - \left( 1 + \inv{2} \left(\frac{s}{L}\right)^2 \right) \right),
\end{dmath}

\begin{equation}\label{eqn:modernOpticsProblemSet1:1890}
\boxed{
y(s) \sim -\frac{s^2}{2 L} \quad \mbox{when $ s \ll L$}.
}
\end{equation}

In the large limit for $s \gg L$ the $s^2$ term dominates, leaving

\begin{dmath}\label{eqn:modernOpticsProblemSet1:270}
\boxed{
y(s) \sim - s \quad \mbox{when $s \gg L$}.
}
\end{dmath}

A plot of $y/L$, $-s/L$, and $-s^2/2 L^2$ can be found in figure (\ref{fig:modernOpticsProblemSet1:modernOpticsProblemSet1Fig2b}).

\imageFigure{modernOpticsProblemSet1Fig2b}{Plots of $y(s)$ and corresponding big and small limiting forms}{fig:modernOpticsProblemSet1:modernOpticsProblemSet1Fig2b}{0.2}

\item[(c)]
We are now set to solve our x component ray equation

\begin{dmath}\label{eqn:modernOpticsProblemSet1:290}
(L - y) \dds{x} = L,
\end{dmath}

or
\begin{dmath}\label{eqn:modernOpticsProblemSet1:310}
\sqrt{s^2 + L^2} \dds{x} = L.
\end{dmath}

Integrating we have

\begin{dmath}\label{eqn:modernOpticsProblemSet1:330}
x 
= L \int_0^s \frac{ds'}{\sqrt{{s'}^2 + L^2}}
= L \int_0^s \frac{ds'}{\sqrt{{s'}^2 + L^2}}
= L \int_0^{s/L} \frac{dt}{\sqrt{t^2 + 1}}
= L \evalrange{ \ln\left( t + \sqrt{ t^2 + 1} \right) }{0}{s/L}
\end{dmath}

This is

\begin{dmath}\label{eqn:modernOpticsProblemSet1:350}
\boxed{
x(s) = L \ln\left( \frac{s}{L} + \sqrt{ \left( \frac{s}{L} \right)^2 + 1} \right).
}
\end{dmath}

In the large limit for $s \gg L$ the $s^2$ term in the square root dominates, leaving

\begin{dmath}\label{eqn:modernOpticsProblemSet1:370}
\boxed{
x(s) 
\sim L \ln\left( \frac{2 s}{L} \right)
\quad \mbox{when $s \gg L$}.
%= L\ln 2 + L \ln \frac{s}{L}
%\sim L \ln \frac{s}{L}
}
\end{dmath}

In the small limit $s \ll L$

\begin{dmath}\label{eqn:modernOpticsProblemSet1:390}
x(s) \sim L \ln\left( \frac{s}{L} + 1 \right)
= L \left( 
\frac{s}{L}
 -\inv{2} 
\left(
\frac{s}{L}
\right)^2
 +\inv{3} 
\left(
\frac{s}{L}
\right)^3
- \cdots
\right),
\end{dmath}

or
\begin{equation}\label{eqn:modernOpticsProblemSet1:1910}
\boxed{
x(s) \sim s \quad \mbox{when $s \ll L$}.
}
\end{equation}

With $t = s/L$, we have a plot of $u(t) = x(Lt)/L$, and the small and large limit approximations above in figure (\ref{fig:modernOpticsProblemSet1:modernOpticsProblemSet1Fig2c}).

\imageFigure{modernOpticsProblemSet1Fig2c}{Plots of $x(s)$ and corresponding big and small limiting forms}{fig:modernOpticsProblemSet1:modernOpticsProblemSet1Fig2c}{0.2}

\item[(d)]
With $t = s/L$, $u = x/L$, and $v = y/L$ we have

\begin{subequations}
\begin{dmath}\label{eqn:modernOpticsProblemSet1:410}
u = \ln\left( t + \sqrt{t^2 + 1} \right)
\end{dmath}
\begin{dmath}\label{eqn:modernOpticsProblemSet1:430}
v = 1 - \sqrt{t^2 + 1}
\end{dmath}
\end{subequations}

Rearranging for $t$ and $\sqrt{1 + t^2}$, we have

\begin{subequations}
\begin{dmath}\label{eqn:modernOpticsProblemSet1:450}
\sqrt{t^2 + 1} = 1 - v
\end{dmath}
\begin{dmath}\label{eqn:modernOpticsProblemSet1:470}
t = \sqrt{(1 - v)^2 - 1},
\end{dmath}
\end{subequations}

so

\begin{dmath}\label{eqn:modernOpticsProblemSet1:490}
u(v) = \ln\left( \sqrt{v^2 - 2 v} + 1 - v \right)
\end{dmath}

or
\begin{dmath}\label{eqn:modernOpticsProblemSet1:510}
\boxed{
x(y) = L \ln\left( \sqrt{\left(\frac{y}{L}\right)^2 - 2 \frac{y}{L}} + 1 - \frac{y}{L} \right).
}
\end{dmath}

Now, for the approximations.  Noting that the range of $y$ is $(-\infty, 0]$ let's write $w = -v = \Abs{v}$ in \ref{eqn:modernOpticsProblemSet1:490} so that we have

\begin{dmath}\label{eqn:modernOpticsProblemSet1:490b}
u(w) = \ln\left( \sqrt{w^2 + 2 w} + 1 + w \right).
\end{dmath}

For $w >> 1$ we have 

\begin{equation}\label{eqn:modernOpticsProblemSet1:610}
\sqrt{w^2 + w} \sim \sqrt{w^2} = w = -y/L
\end{equation}

so that
\begin{dmath}\label{eqn:modernOpticsProblemSet1:490c}
\boxed{
x(y) \sim L \ln\left( -\frac{2 y}{L} \right) \quad \mbox{when $-y/L \gg 1$}.
}
\end{dmath}

In the small limit $w << 1$ we also have $w^2 \ll w$, so that
\begin{dmath}\label{eqn:modernOpticsProblemSet1:630}
u(w) 
\sim \ln( \sqrt{w} + 1)
\sim \sqrt{w} - \inv{2} (\sqrt{w})^2 + \inv{3}(\sqrt{w})^3 - \cdots
\sim \sqrt{w},
\end{dmath}

or

\begin{equation}\label{eqn:modernOpticsProblemSet1:650}
\boxed{
x(y) \sim L \sqrt{-\frac{y}{L}} \quad \mbox{when $-y/L \ll 1$}.
}
\end{equation}

A plot of $x(y/L)/L$, and the small and large limit approximations can be found in figure (\ref{fig:modernOpticsProblemSet1:modernOpticsProblemSet1Fig2d}).

\imageFigure{modernOpticsProblemSet1Fig2d}{Plots of $x(y/L)/L$ and corresponding big and small limiting forms}{fig:modernOpticsProblemSet1:modernOpticsProblemSet1Fig2d}{0.2}

\item[(e)]

In the small limit we found

\begin{subequations}
\begin{dmath}\label{eqn:modernOpticsProblemSet1:530}
x(s) \sim s
\end{dmath}
\begin{dmath}\label{eqn:modernOpticsProblemSet1:550}
y(s) \sim -\frac{s^2}{2 L},
\end{dmath}
\end{subequations}

so we have

\begin{dmath}\label{eqn:modernOpticsProblemSet1:570}
y \sim -\frac{x^2}{2 L},
\end{dmath}

a parabolic trajectory.  Comparing to $y'' = g$, where $y = g t^2/2 + y_0' t + y_0$, the quantity that's analogous to the gravitational acceleration in \ref{eqn:modernOpticsProblemSet1:570} is

\begin{equation}\label{eqn:modernOpticsProblemSet1:590}
\boxed{
- \inv{L} = -\frac{\beta}{n_0} \rightarrow g.
}
\end{equation}

\item[(f)]
These plots were included above.  Good asymptotic matching in the large limit was found to be fairly range dependent, which can be observed in the Mathematica CDF notebook available in \href{https://raw.github.com/peeterjoot/physicsplay/master/notes/phy485/mathematica/modernOpticsProblemSet1.cdf}{http://goo.gl/OumcI} (\href{http://www.wolfram.com/cdf-player/}{http://www.wolfram.com/cdf-player/}).  Dynamic (Manipulate) graphs are available for each of the graphs above, where the range is slider parameterized.
\end{enumerate}
}

\makeproblem{Ray equation at a surface}{modernOptics:problemSet1:3}{
Show that Snell's law can be derived from the {\em transverse} component of the ray equation applied at an index step. Set up the problem with an index step from $n_1$ in the half-plane $x<0$; and $n_2$ in the half-plane $x>0$ (figure \ref{fig:modernOpticsProblemSet1:FigureSnell}). Define your rays according to two straight-line trajectories: a ray in the $xy$ plane defined by $x=s \cos{\theta_1}$ and $y=s \sin{\theta_1}$ for $x<0$; and $x=s \cos{\theta_2}$ and $y=s \sin{\theta_2}$ for $x>0$. 
\begin{enumerate}
\item[(a)] Solve the { transverse} (or y-) component of the Ray Equation. Show that it gives Snell's law. 
\item[(b)] Show that the {\em normal} (or x-) component of the Ray Equation is contradictory, unless the limit of a small index step is taken. Why is this? What is missing?
\end{enumerate}

\imageFigure{FigureSnell}{}{fig:modernOpticsProblemSet1:FigureSnell}{0.2}
}
\makeanswer{modernOptics:problemSet1:3}{ 
\begin{enumerate}
\item[(a)] 

The index of refraction $n(x)$ has no y-component, so we have

\begin{dmath}\label{eqn:modernOpticsProblemSet1:710}
\ycap \cdot \spacegrad n = 0.
\end{dmath}

The y-component of the Ray equation

\begin{dmath}\label{eqn:modernOpticsProblemSet1:910}
\dds{} \left( n(x) \frac{dy}{ds} \right) = 0,
\end{dmath}

can therefore be integrated directly

\begin{dmath}\label{eqn:modernOpticsProblemSet1:930}
n(x) \frac{dy}{ds} = \text{constant}
\end{dmath}

With the chosen ray parameterization we have for $x < 0$ the y-component of the ray ``velocity''

\begin{dmath}\label{eqn:modernOpticsProblemSet1:670}
\ycap \cdot \dds{\Br_1} 
= \ycap \cdot \dds{} s (\cos\theta_1, \sin\theta_1)
= \ycap \cdot (\cos\theta_1, \sin\theta_1)
= \sin\theta_1
\end{dmath}

Similarly for the y-component in the $x > 0$ region we have 

\begin{dmath}\label{eqn:modernOpticsProblemSet1:690}
\ycap \cdot \dds{\Br_2} = \sin\theta_2.
\end{dmath}

We want to use this in the integrated Ray equation \ref{eqn:modernOpticsProblemSet1:930} which takes the form

\begin{dmath}\label{eqn:modernOpticsProblemSet1:950}
n_1 \frac{dy_1}{ds} = \text{constant} = n_2 \frac{dy_2}{ds},
\end{dmath}

but since we have found that $dy_1/ds = \sin\theta_1$ and $dy_2/ds = \sin\theta_2$, we have Snell's law

\begin{dmath}\label{eqn:modernOpticsProblemSet1:770}
\boxed{
n_2 \sin\theta_2 = n_1 \sin\theta_1.
}
\end{dmath}

\item[(b)] 
We can produce a contradictory result if we avoid the origin when treating the x-component of the Ray equation.  Repeating the argument above for $\Abs{x} > 0$ where $\spacegrad n = 0$ would give us

\begin{dmath}\label{eqn:modernOpticsProblemSet1:790}
n \dds{x} = \text{constant}
\end{dmath}

With $dx_1/ds = \cos\theta_1$ and $dx_2/ds = \cos\theta_2$ we would have

\begin{dmath}\label{eqn:modernOpticsProblemSet1:810}
n_2 \cos\theta_2 = n_1 \cos\theta_1,
\end{dmath}

which contradicts Snell's law.

This conclusion isn't valid because we have avoided the origin, where the index of refraction is not continuous.  What is missing is proper treatment of this step discontinuity.  To frame this properly, let's express the index of refraction a bit more precisely.  That is

\begin{dmath}\label{eqn:modernOpticsProblemSet1:830}
n(x) = n_1 + \Delta n \theta(x)
\end{dmath}

where $\Delta n = n_2 - n_1$.  We now have a non-zero gradient

\begin{dmath}\label{eqn:modernOpticsProblemSet1:850}
\spacegrad n = \xcap \Delta n \delta(x).
\end{dmath}

The Ray equation, split by coordinates, now takes the form

\begin{equation}\label{eqn:modernOpticsProblemSet1:870}
\boxed{
\begin{aligned}
\dds{} \left( 
\left( \theta(x) n_2 
+
\theta(-x) n_1 \right) \dds{x}
\right)
&= \Delta n \delta(x) \\
\left( \theta(x) n_2 
+
\theta(-x) n_1 \right) \dds{y}
&= \text{constant}.
\end{aligned}
}
\end{equation}

Note that any solution of the above must also take into account the dependence between $s$, $x$ and $y$

\begin{equation}\label{eqn:modernOpticsProblemSet1:1930}
ds^2 = dx^2 + dy^2,
\end{equation}

or 
\begin{equation}\label{eqn:modernOpticsProblemSet1:1950}
1 = (dx/ds)^2 + (dy/ds)^2.
\end{equation}

%Should we need to make the angle position dependent, our originally chosen parameterization $\Br(s) = s (\cos\theta(s), \sin(\theta(s))$ is no longer 
While we can still directly integrate the y-component equation once (as done above), our original assumed parameterization of $\Br(s) = s(\cos\theta, \sin\theta)$ looses it's convenient form since we now have $\theta = \theta(s)$ in the neighborhood of the origin.  Once we choose to not neglect the step discontinuity, we have a coupled, much more difficult, system to deal with.

Can this system, or one for which a limiting form of the unit step and delta functions is used (i.e. the sinc representation of the delta function), be solved exactly?

\end{enumerate}
}

%\vcsinfo
%\EndArticle
%\EndNoBibArticle
