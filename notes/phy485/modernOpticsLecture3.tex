%
% Copyright © 2012 Peeter Joot.  All Rights Reserved.
% Licenced as described in the file LICENSE under the root directory of this GIT repository.
%
%\input{../blogpost.tex}
%\renewcommand{\basename}{modernOpticsLecture3}
%\renewcommand{\dirname}{notes/phy485/}
%\newcommand{\keywords}{Eikonal equation, ray equation, Optics, PHY485H1F}
%\input{../peeter_prologue_print2.tex}
%\beginArtNoToc
%\generatetitle{PHY485H1F Modern Optics.  Lecture 3: GRIN (Graded Refractive INdex).  Taught by Prof.\ Joseph Thywissen}
\label{chap:modernOpticsLecture3}

%\section{Disclaimer}
%
%Peeter's lecture notes from class.  May not be entirely coherent.
%
\section{Gradium Lens}

%FIXME: Reading: \S 8 \citep{saleh1991fundamentals}?  Was this reading for
% grin fibers?
\paragraph{Reading}: \S FIXME \citep{hecht1998hecht}.  The portion that includes figure 6.42.

We'll use Fermat's theorem

\makedefinition{Fermat's theorem}{dfn:modernOpticsLecture3:10}{
The pathlength is the same for all rays.
}

Looking to \cref{fig:modernOpticsLecture3:modernOpticsLecture3Fig1} we will now consider a cylindrical lens constructed out of a non-uniform index material 
\imageFigure{figures/modernOpticsLecture3Fig1}{Gradium lens}{fig:modernOpticsLecture3:modernOpticsLecture3Fig1}{0.4}
%and \cref{fig:modernOpticsLecture3:modernOpticsLecture3Fig2} 
%\imageFigure{figures/modernOpticsLecture3Fig2}{Cylindrical coordinates for the problem}{fig:modernOpticsLecture3:modernOpticsLecture3Fig2}{0.2}

Suppose we have an index of refraction that is distributed parabolicly

\begin{dmath}\label{eqn:modernOpticsLecture3:10}
n(\rho) = n_0 - \alpha \rho^2/2.
\end{dmath}

Consider the ray paths that pass through the lens at $\rho = 0$.  These will have pathlength

\begin{dmath}\label{eqn:modernOpticsLecture3:450}
\evalbar{OPL}{\rho = 0} = d n_0 + f.
\end{dmath}

Note that we assume $n = 1$ outside of the lens so that portion of the pathlength is $f$ and not $n_{\text{outside}} f$.  A ray passing through the lens at $\rho \ne 0$ will have a pathlength of approximately (neglecting any curvature or ray angle within the lens) 

\begin{dmath}\label{eqn:modernOpticsLecture3:470}
\evalbar{OPL}{\rho \ne 0} = d n(\rho) + \sqrt{f^2 + \rho^2}.
\end{dmath}

For these to come together to the same focal point, the two pathlengths must be equal (Fermat's theorem), so we have

\begin{dmath}\label{eqn:modernOpticsLecture3:490}
n(\rho) = - \inv{d} \sqrt{f^2 + \rho^2} + n_0 + \frac{f}{d}.
\end{dmath}

Assuming a paraxial approximation where $\rho \ll f$ we have

\begin{dmath}\label{eqn:modernOpticsLecture3:510}
n(\rho) 
= n_0 + \frac{f}{d} \left( 1 - \sqrt{1 + \left( \frac{\rho}{f} \right)^2} \right)
\sim 
n_0 + \frac{f}{d} \left( 1 - \left( 1 + \inv{2} \left( \frac{\rho}{f} \right)^2 \right) \right)
= 
n_0 - \inv{2} \frac{\rho^2}{ f d }
\end{dmath}

We write 

\begin{dmath}\label{eqn:modernOpticsLecture3:530}
\alpha = \inv{ 2 f d },
\end{dmath}

and seek to solve the Ray equation

\begin{dmath}\label{eqn:modernOpticsLecture3:550}
\dds{} \left( n(\rho) \dds{} \left( \Brho + z \zcap \right) \right) = \spacegrad n(\rho).
\end{dmath}

With $\spacegrad n(\rho) \cdot \zcap = 0$, we can consider only the radial portion of this equation

\begin{dmath}\label{eqn:modernOpticsLecture3:570}
\dds{} \left( n(\rho) \dds{\Brho} \right) = \spacegrad n(\rho).
=
- \alpha \Brho.
\end{dmath}

We seek a relationship as potentially illustrated in \cref{fig:modernOpticsLecture3:modernOpticsLecture3Fig3} where given a paraxial approximation we have

\imageFigure{figures/modernOpticsLecture3Fig3}{Arc length}{fig:modernOpticsLecture3:modernOpticsLecture3Fig3}{0.2}

\begin{dmath}\label{eqn:modernOpticsLecture3:30}
ds = dz \sqrt{ 1 + \Abs{ \ddz{\rho} }^2} \sim dz,
\end{dmath}

and can reduce the Ray equation to

\begin{dmath}\label{eqn:modernOpticsLecture3:70}
\ddz{} ( \left( n_0 - \frac{\alpha}{2} \rho^2 \right) \ddz{\Brho} = - \alpha \Brho.
\end{dmath}

We'd like to drop the $\rho^2$ term above, and can do that provided

\begin{dmath}\label{eqn:modernOpticsLecture3:590}
\rho \ll \sqrt{ \frac{2 n_0}{ \alpha} } = 2 \sqrt{ n_0 f d }.
\end{dmath}

This leaves us with a plain old SHO

\begin{dmath}\label{eqn:modernOpticsLecture3:90}
\boxed{
n_0 \frac{d^2}{dz^2} \Brho = - \alpha \Brho
}
\end{dmath}

Let's write this out

\begin{dmath}\label{eqn:modernOpticsLecture3:110}
\Brho(z) = 
\begin{bmatrix}
x(z) \\
y(z) \\
\end{bmatrix}
=
\begin{bmatrix}
A \cos \left( \sqrt{\frac{\alpha}{n_0}} z \right) + B \sin\left( \sqrt{\frac{\alpha}{n_0}} z \right) \\
C \cos \left( \sqrt{\frac{\alpha}{n_0}} z \right) + D \sin\left( \sqrt{\frac{\alpha}{n_0}} z \right) \\
\end{bmatrix}
\end{dmath}

We have 4 constants determined by the initial conditions 

\begin{dmath}\label{eqn:modernOpticsLecture3:130}
\Brho(0) = 
\begin{bmatrix}
A \\
C
\end{bmatrix}
\end{dmath}

\begin{dmath}\label{eqn:modernOpticsLecture3:150}
\evalbar{\ddz{\Brho}}{0} = 
\sqrt{\frac{\alpha}{n_0}}
\begin{bmatrix}
B \\
D
\end{bmatrix},
\end{dmath}

as illustrated in \cref{fig:modernOpticsLecture3:modernOpticsLecture3Fig4}.
\imageFigure{figures/modernOpticsLecture3Fig4}{Nodal distribution}{fig:modernOpticsLecture3:modernOpticsLecture3Fig4}{0.2}

If the length is an integer $L$ as in \cref{fig:modernOpticsLecture3:modernOpticsLecture3Fig5}.
\imageFigure{figures/modernOpticsLecture3Fig5}{first order solution}{fig:modernOpticsLecture3:modernOpticsLecture3Fig5}{0.2}

If the length is a half integer $L$ as in \cref{fig:modernOpticsLecture3:modernOpticsLecture3Fig6}.
\imageFigure{figures/modernOpticsLecture3Fig6}{second order solution}{fig:modernOpticsLecture3:modernOpticsLecture3Fig6}{0.2}

If $\text{length} = \left(n + \inv{4} \right)L$ as in \cref{fig:modernOpticsLecture3:modernOpticsLecture3Fig7}.
\imageFigure{figures/modernOpticsLecture3Fig7}{third order solution}{fig:modernOpticsLecture3:modernOpticsLecture3Fig7}{0.2}

It was mentioned that this solved a problem with regular fiber optic cables illustrated in \cref{fig:modernOpticsLecture3:modernOpticsLecture3Fig8}

\imageFigure{figures/modernOpticsLecture3Fig8}{regular fiber effects}{fig:modernOpticsLecture3:modernOpticsLecture3Fig8}{0.2}

so that for the GRIN configuration we have something more like \cref{fig:modernOpticsLecture3:modernOpticsLecture3Fig9}.
\imageFigure{figures/modernOpticsLecture3Fig9}{step index fiber}{fig:modernOpticsLecture3:modernOpticsLecture3Fig9}{0.2}

This phenomena is well described in \S 5.6.1 \citep{hecht1998hecht}.

\paragraph{Phase delay in GRIN lens?}

Are path lengths equal?  Instead of dropping all but the $dz$ term in our $ds$ approximation above (FIXME: ref), how about we retain the first order Taylor expansion

\begin{dmath}\label{eqn:modernOpticsLecture3:170}
T 
= \int_0^L \frac{ds}{c/n(\Br)} 
= \int_0^L dz \left( 1 + \inv{2} \Abs{ \ddz{\Brho}}^2 \right) \left(n_0 - \frac{\alpha}{2} \rho^2 \right)
\approx \frac{n_0}{c} \int_0^L dz \left( 1 + \inv{2} \Abs{ \ddz{\Brho} }^2 - \frac{\alpha}{2 n_0} \rho^2 \right) + O(\text{higher order corrections})
\end{dmath}

\begin{dmath}\label{eqn:modernOpticsLecture3:190}
\ddz{} \left( \Brho \cdot \ddz{\Brho} \right) 
=
\Abs{ \ddz{\Brho} }^2 + \rho \cdot \frac{d^2 \Brho }{d^2 z}
\end{dmath}

so 

\begin{dmath}\label{eqn:modernOpticsLecture3:210}
T 
= \frac{n_0}{c} \int_0^L dz 
\left( 1 
       + \inv{2} \ddz{} \left( \Brho \cdot \ddz{\Brho} 
\right) 
       - \rho \cdot \frac{d^2 \Brho }{d^2 z}
       -\inv{2} \frac{\alpha}{n_0} \rho^2
\right) 
\end{dmath}

But
\begin{dmath}\label{eqn:modernOpticsLecture3:230}
- \rho \cdot \frac{d^2 \Brho }{d^2 z}
-\inv{2} \frac{\alpha}{n_0} \rho^2
=
-\inv{2} \underbrace{\left( \frac{d^2}{dz^2} \Brho - \frac{\alpha}{n_0} \Brho \right)}_{ = 0 \text{by Eikonal}} \cdot \Brho
\end{dmath}

so 
\begin{dmath}\label{eqn:modernOpticsLecture3:250}
T 
= \frac{n_0 L}{c} 
+ \underbrace{\evalrange{ \Brho \cdot \ddz{\Brho} }{0}{L}}_{\mbox{$= 0$ if refocused}}
\end{dmath}

Here if refocused means $\Brho = 0$ at both sides.

\section{Ray equation and action minimization}

\paragraph{Reading}: \S 3 of \citep{born1980principles} for details on this topic.

Ray equation gives paths of stationary action 

In general our action is 

\begin{dmath}\label{eqn:modernOpticsLecture3:270}
S = \int_{t_1}^{t_2} dt \LL
\end{dmath}

where $\LL$ is the Lagrangian.  We recall Hamilton's principle which states that if 

\begin{dmath}\label{eqn:modernOpticsLecture3:290}
\delta S = 0,
\end{dmath}

(a path variation as illustrated in \cref{fig:modernOpticsLecture3:modernOpticsLecture3Fig10}

\imageFigure{figures/modernOpticsLecture3Fig10}{Action minimization}{fig:modernOpticsLecture3:modernOpticsLecture3Fig10}{0.2}

), then the statement \cref{eqn:modernOpticsLecture3:290} gives us Hamiltonian dynamics (Hamilton's equations).

Why does this work?  One explanation is that we have in quantum mechanics the most general action

\begin{dmath}\label{eqn:modernOpticsLecture3:410}
amplitude (path) = \exp( i S[path]/\hbar ),
\end{dmath}

This is called Feynman's Path Integral.

We have a Lagrangian for electromagnetism

\begin{dmath}\label{eqn:modernOpticsLecture3:430}
\LL_{\text{EM}} = \inv{c} \rho \phi + \inv{c} \Bj \cdot \BA + \inv{8 \pi} \BE^2 - \inv{8 \pi} \BB^2.
\end{dmath}

Using this we can derive Maxwell's equations.

As a problem we are going to calculate the amplitude for the Cornu spiral \cref{fig:modernOpticsLecture3:modernOpticsLecture3Fig11}.

\imageFigure{figures/modernOpticsLecture3Fig11}{Cornu spiral path of interest}{fig:modernOpticsLecture3:modernOpticsLecture3Fig11}{0.2}

Propose some experiments

1) Block the primary path \cref{fig:modernOpticsLecture3:modernOpticsLecture3Fig12}.

\imageFigure{figures/modernOpticsLecture3Fig12}{Single slit}{fig:modernOpticsLecture3:modernOpticsLecture3Fig12}{0.2}

2) Block 2 paths \cref{fig:modernOpticsLecture3:modernOpticsLecture3Fig13}.

\imageFigure{figures/modernOpticsLecture3Fig13}{Double slit}{fig:modernOpticsLecture3:modernOpticsLecture3Fig13}{0.2}

3) Block half paths \cref{fig:modernOpticsLecture3:modernOpticsLecture3Fig14}.

\imageFigure{figures/modernOpticsLecture3Fig14}{Wall blocking half path}{fig:modernOpticsLecture3:modernOpticsLecture3Fig14}{0.2}

4) Allow paths with the same phase.

\Cref{fig:modernOpticsLecture3:modernOpticsLecture3Fig15}.
\imageFigure{figures/modernOpticsLecture3Fig15}{Many slits}{fig:modernOpticsLecture3:modernOpticsLecture3Fig15}{0.2}

We'll see that the Action principle does in fact provide us all the real physical effects (Fresnel diffraction, multi-slit diffraction, ...)
%\vcsinfo
%\EndArticle
