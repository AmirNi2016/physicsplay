%\input{../peeter_prologue_print.tex}
%\input{../peeter_prologue_widescreen.tex}

\chapter{Inclined flow without constant height assumption.  Setting up the problem, but not actually solving it.}
\label{chap:inclinedFlowWithoutConstantHeightAssumption}
%\useCCL
\blogpage{http://sites.google.com/site/peeterjoot2/math2012/inclinedFlowWithoutConstantHeightAssumption.pdf}
\date{Mar 6, 2012}
\gitRevisionInfo{inclinedFlowWithoutConstantHeightAssumption}

\beginArtWithToc
%\beginArtNoToc

\section{Motivation.}

In an informal discussion after class, it was claimed that the steady state flow down a plane would have constant height, unless you bring surface tension effects into the mix.  Part of that statement just doesn't make sense to me.  Consider the forces acting on the fluid in the figure (\ref{fig:inclinedFlowWithoutConstantHeightAssumption:inclinedFlowWithoutConstantHeightAssumptionFig1})

\begin{figure}[htp]
   \centering
   \includegraphics[totalheight=0.3\textheight]{inclinedFlowWithoutConstantHeightAssumptionFig1}
\caption{Gravitational force components acting on fluid flowing down a plane.}
\label{fig:inclinedFlowWithoutConstantHeightAssumption:inclinedFlowWithoutConstantHeightAssumptionFig1}
\end{figure}

In the inclined reference frame we have a component of the force acting downwards (in the negative y-axis direction), and have a component directed down the x-axis.  Wouldn't this act to both push the fluid down the plane and push part of the fluid downwards?  I'd expect this to introduce some vorticity as depicted.

While we are just about to start covered surface tension, perhaps this is just allowing the surface to vary, and then solving the Navier-Stokes equations that result.  Let's try setting up the Navier-Stokes equation for steady state viscous flow down a plane without any assumption that the height is constant and see how far we can get.

\section{The equations of motion.}

We'll use the same coordinates as before, with the directions given as in figure (\ref{fig:inclinedFlowWithoutConstantHeightAssumption:inclinedFlowWithoutConstantHeightAssumptionFig2}).  However, this time, we let the height $h(x)$ of the fluid at any distance $x$ down the plane from the initial point vary.

\begin{figure}[htp]
   \centering
   \def\svgwidth{0.7\columnwidth}
   \input{inclinedFlowWithoutConstantHeightAssumptionFig2.pdf_tex}
   \caption{Diagram of coordinates for inclined flow problem.}
\label{fig:inclinedFlowWithoutConstantHeightAssumption:inclinedFlowWithoutConstantHeightAssumptionFig2}
\end{figure}

For viscous incompressible flow down the plane our equations of motion are

\begin{subequations}
\label{eqn:inclinedFlowWithoutConstantHeightAssumption:20}
\begin{equation}\label{eqn:inclinedFlowWithoutConstantHeightAssumption:380}
\rho \PD{t}{u} + \rho (u \partial_x + v \partial_y) u = -\partial_x p + \mu \left(\partial_{xx} + \partial_{yy}\right) u + \rho g \sin\alpha 
\end{equation}
\begin{equation}\label{eqn:inclinedFlowWithoutConstantHeightAssumption:400}
\rho \PD{t}{v} + \rho (u \partial_x + v \partial_y) v = -\partial_y p + \mu \left(\partial_{xx} + \partial_{yy}\right) v - \rho g \cos\alpha 
\end{equation}
\begin{equation}\label{eqn:inclinedFlowWithoutConstantHeightAssumption:420}
0 = -\partial_z p 
\end{equation}
\begin{equation}\label{eqn:inclinedFlowWithoutConstantHeightAssumption:440}
0 = \partial_x u + \partial_y v.
\end{equation}
\end{subequations}

Now, can we kill the time dependent term?  Even allowing for $u$ to vary with $x$ and introducing a non-horizontal flow component, I think that we can.  If the flow at $x = 0$ is constant, not varying at all with time, I think it makes sense that we will have no time dependence in the flow for $x \ne 0$.  So, I believe that our starting point is as above, but with the time derivatives killed off.  That is

\begin{subequations}
\label{eqn:inclinedFlowWithoutConstantHeightAssumption:40}
\begin{equation}\label{eqn:inclinedFlowWithoutConstantHeightAssumption:300}
\rho (u \partial_x + v \partial_y) u = -\partial_x p + \mu \left(\partial_{xx} + \partial_{yy}\right) u + \rho g \sin\alpha \\
\end{equation}
\begin{equation}\label{eqn:inclinedFlowWithoutConstantHeightAssumption:320}
\rho (u \partial_x + v \partial_y) v = -\partial_y p + \mu \left(\partial_{xx} + \partial_{yy}\right) v - \rho g \cos\alpha \\
\end{equation}
\begin{equation}\label{eqn:inclinedFlowWithoutConstantHeightAssumption:340}
0 = -\partial_z p \\
\end{equation}
\begin{equation}\label{eqn:inclinedFlowWithoutConstantHeightAssumption:360}
0 = \partial_x u + \partial_y v.
\end{equation}
\end{subequations}

These don't look particularly easy to solve, and we haven't even set up the boundary value constraints yet.  Let's do that next.

\section{The boundary value constraints.}

One of out constraints is the no-slip condition for the velocity components at the base of the slope

\begin{equation}\label{eqn:inclinedFlowWithoutConstantHeightAssumption:80}
\boxed{
u(x, 0) = v(x, 0) = 0.
}
\end{equation}

We should also have a zero tangential component to the traction vector at the interface.  We need to consider some geometry, and refer to figure (\ref{fig:inclinedFlowWithoutConstantHeightAssumption:inclinedFlowWithoutConstantHeightAssumptionFig3})

\begin{figure}[htp]
   \centering
   \def\svgwidth{0.7\columnwidth}
   \input{inclinedFlowWithoutConstantHeightAssumptionFig3.pdf_tex}
   \caption{Differential vector element.}
\label{fig:inclinedFlowWithoutConstantHeightAssumption:inclinedFlowWithoutConstantHeightAssumptionFig3}
\end{figure}

A position vector on the surface has the value

\begin{equation}\label{eqn:inclinedFlowWithoutConstantHeightAssumption:100}
\Br = x \xcap + h \ycap
\end{equation}

so that a differential element on the surface, tangential to the surface is proportional to

\begin{equation}\label{eqn:inclinedFlowWithoutConstantHeightAssumption:120}
d\Br = \left( \xcap + \ddx{h} \ycap \right) dx
\end{equation}

so our unit tangent vector in the direction depicted in the figure is

\begin{equation}\label{eqn:inclinedFlowWithoutConstantHeightAssumption:140}
\taucap = \inv{\sqrt{1 + (h')^2}} \left( 1, h' \right).
\end{equation}

The outwards facing normal has a value, up to a factor of plus or minus one, of

\begin{equation}\label{eqn:inclinedFlowWithoutConstantHeightAssumption:160}
\ncap = 
\inv{\sqrt{1 + (h')^2}} \left( h', -1 \right).
\end{equation}

We can fix the orientation by considering the unit bivector

\begin{align*}
\taucap \wedge \ncap &= 
\inv{1 + (h')^2} 
\left( 1, h' \right) 
\wedge
\left( h', -1 \right) \\
&=
\begin{vmatrix}
1 & h' \\
h' & -1
\end{vmatrix}
\Be_1 \Be_2 \\
&=
( -1 - (h')^2 )
\Be_1 \Be_2.
\end{align*}

So we really want the other orientation

\begin{equation}\label{eqn:inclinedFlowWithoutConstantHeightAssumption:180}
\ncap = \inv{\sqrt{1 + (h')^2}} \left( -h', 1 \right).
\end{equation}

Our traction vector relative to the normal $\ncap$ is

\begin{align*}
\Bt 
&= \Be_i T_{ij} n_j \\
&= 
\Be_i \left( -p \delta_{ij}
+ \mu e_{ij}
\right) n_j \\
&=
-p \ncap + \mu \Be_i e_{ij} n_j
\end{align*}

So the component in the tangential direction is

\begin{align*}
\Bt \cdot \taucap 
&=
-p \cancel{\ncap \cdot \taucap} + \mu \Be_i e_{ij} n_j tau_i \\
&=
\frac{\mu}{1 + (h')^2}
\begin{bmatrix}
1 & h' 
\end{bmatrix}
\begin{bmatrix}
e_{11} & e_{12} \\
e_{21} & e_{22}
\end{bmatrix}
\begin{bmatrix}
-h'  \\
1
\end{bmatrix} \\
&=
\frac{\mu}{1 + (h')^2}
\begin{bmatrix}
1 & h' 
\end{bmatrix}
\begin{bmatrix}
-h' e_{11} + e_{12} \\
-h' e_{21} + e_{22}
\end{bmatrix} \\
&=
\frac{\mu}{1 + (h')^2}
\left(
-h' e_{11} + e_{12} + h'( -h' e_{21} + e_{22} )
\right) \\
&=
\frac{\mu}{1 + (h')^2}
\left(
h' (e_{22} - e_{11} )
+ e_{12} (1 - (h')^2 )
\right) 
\end{align*}

Our strain tensor components, for a general 2D flow, are

\begin{align}\label{eqn:inclinedFlowWithoutConstantHeightAssumption:200}
e_{11} &= \PD{x}{u} \\
e_{22} &= \PD{y}{v} \\
e_{12} &= 
\inv{2} \left( 
\PD{x}{v} +
\PD{y}{u}
\right).
\end{align}

So, a zero tangential traction vector component at the interface requires

\begin{equation}\label{eqn:inclinedFlowWithoutConstantHeightAssumption:220}
\boxed{
0 = h' \left( \evalbar{\left( \PD{y}{v} - \PD{x}{u} \right) + 
\inv{2} \left( 
\PD{x}{v} +
\PD{y}{u}
\right)
}{y = h}\right)
(1 - (h')^2 ).
}
\end{equation}

What is the normal component of the traction vector at the interface?  We can calculate

\begin{align*}
\Bt \cdot \ncap 
&=
-p \ncap \cdot \ncap + \mu \Be_i e_{ij} n_j n_i \\
&=
-p
+
\frac{\mu}{1 + (h')^2}
\begin{bmatrix}
-h' & 1
\end{bmatrix}
\begin{bmatrix}
-h' e_{11} + e_{12} \\
-h' e_{21} + e_{22}
\end{bmatrix} \\
&=
-p
+
\frac{\mu}{1 + (h')^2}
\left(
-h'(-h' e_{11} + e_{12}) -h' e_{21} + e_{22}
\right)  \\
&=
-p
+
\frac{\mu}{1 + (h')^2}
\left(
-2 h' e_{12} 
+ (h')^2 e_{11} + e_{22}
\right)
\end{align*}

So this component of the traction vector is
\begin{equation}\label{eqn:inclinedFlowWithoutConstantHeightAssumption:240}
\Bt \cdot \ncap 
=
-p
+
\frac{\mu}{1 + (h')^2}
\left(
- h' 
\left( 
\PD{x}{v} +
\PD{y}{u}
\right)
+ (h')^2 \PD{x}{u} 
 + \PD{y}{v} 
\right)
\end{equation}

For the purely recilinear flow, with $h' = 0$ and $v = 0$, as a a consequence of NS and our assumptions, all but the pressure portion of this component of the traction vector was zero.  The force balance equation for the interface was therefore just a matching of the pressure with the external (ie: air) pressure.

In this more general case we have the same thing, but the non-pressure portions of the traction vector are all zero in the medium.  Outside of the fluid (in the air say), we have assumed no motion, so this force balance condition becomes

\begin{equation}\label{eqn:inclinedFlowWithoutConstantHeightAssumption:260}
\evalbar{\Bt \cdot \ncap}{\text{fluid}}
=
\evalbar{\Bt \cdot \ncap}{\text{air}}.
\end{equation}

Again assuming no motion of the air, with air pressure $p_A$, this is

\begin{equation}\label{eqn:inclinedFlowWithoutConstantHeightAssumption:280}
\boxed{
-p(x, h)
+
\evalbar{
\frac{\mu}{1 + (h')^2}
\left(
- h' 
\left( 
\PD{x}{v} +
\PD{y}{u}
\right)
+ (h')^2 \PD{x}{u} 
 + \PD{y}{v} 
\right)
}{y = h}
= -p_A
}
\end{equation}

Observe that for the horizontal flow problem, where $h' = 0$ and $v = 0$, this would have been nothing more than a requirement that $p(h) = p_A$, but now that we introduce downwards motion and allow the height to vary, the pressure matching condition becomes a much more complex beastie.

\section{Laplacian of Pressure and Vorticity.}

Supposing that we are neglecting the non-linear term of the Navier-Stokes equation.  For incompressible steady state flow, without any external forces, we would then have

\begin{subequations}
\begin{equation}\label{eqn:inclinedFlowWithoutConstantHeightAssumption:5}
0 = -\spacegrad p + \mu \spacegrad^2 \Bu 
\end{equation}
\begin{equation}\label{eqn:inclinedFlowWithoutConstantHeightAssumption:460}
0 = \spacegrad \cdot \Bu
\end{equation}
\end{subequations}

How do we actually solve this beastie?

\subsection{Separation of variables?}

Considering this in 2D, assuming no z-dependence, with $\Bu = \Bu(x, y) = (u, v)$ we have

\begin{align}\label{eqn:nsVorticity:30}
0 &= -\partial_x p + \mu (\partial_{xx} + \partial_{yy} )u \\
0 &= -\partial_y p + \mu (\partial_{xx} + \partial_{yy} )v \\
0 &= \partial_x u + \partial_y v.
\end{align}

Attempting separation of variables seems like something reasonable to try.  With

\begin{align}\label{eqn:nsVorticity:50}
u &= X(x) Y(y) \\
v &= R(x) S(y) \\
p &= P(x) Q(y)
\end{align}

we get

\begin{align}\label{eqn:nsVorticity:70}
0 &= -P' Q + \mu (X'' Y + X Y'') \\
0 &= -P Q' + \mu (R'' S + R S'') \\
0 &= X' Y + R S'
\end{align}

I couldn't find a way to substitute any of these into the other that would allow me to separate them, but perhaps I wasn't clever enough.  

\subsection{In terms of vorticity?}

The idea of substituting the zero divergence equation $\spacegrad \cdot \Bu$ will clearly lead to something a bit simpler.  Treating the Laplacian as a geometric (Clifford) product of two gradients we have

\begin{align*}
0 
&= -\spacegrad p + \mu \spacegrad^2 \Bu \\
&= -\spacegrad p + \mu \spacegrad ( \spacegrad \Bu ) \\
&= -\spacegrad p + \mu \spacegrad ( \cancel{\spacegrad \cdot \Bu} + \spacegrad \wedge \Bu ) \\
&= -\spacegrad p + \mu \spacegrad ( \spacegrad \wedge \Bu ) \\
&= \spacegrad \left( -p + \mu \spacegrad \wedge \Bu \right)
\end{align*}

Writing out the vorticity (bivector) in component form, and writing $i = \Be_1 \wedge \Be_2 = \Be_1 \Be_2$ for the 2D pseudoscalar, we have

\begin{align*}
\spacegrad \wedge \Bu 
&= (\Be_1 \partial_x + \Be_2 \partial_y) \wedge (\Be_1 u + \Be_2 v) \\
&= \Be_1 \Be_2 (\partial_x v - \partial_y u ) \\
&= i (\partial_x v - \partial_y u )
\end{align*}

It seems natural to write

\begin{equation}\label{eqn:inclinedFlowWithoutConstantHeightAssumption:90}
\Theta = \partial_x v - \partial_y u,
\end{equation}

so that Navier-Stokes takes the form

\begin{equation}\label{eqn:inclinedFlowWithoutConstantHeightAssumption:110}
0 = \spacegrad (-p + i \mu \Theta ).
\end{equation}

Operating on this from the left with another gradient we find that this combination of pressure and vorticity must satisfy the following multivector Laplacian equation

\begin{equation}\label{eqn:inclinedFlowWithoutConstantHeightAssumption:130}
0 = \spacegrad^2 (-p + i \mu \Theta ).
\end{equation}

However, note that $\spacegrad^2$ is a scalar operator, and this zero identity has both scalar and pure bivector components.  Both must separately equal zero

\begin{subequations}
\label{eqn:inclinedFlowWithoutConstantHeightAssumption:150}
\begin{equation}\label{eqn:inclinedFlowWithoutConstantHeightAssumption:170}
0 = \spacegrad^2 p 
\end{equation}
\begin{equation}\label{eqn:inclinedFlowWithoutConstantHeightAssumption:190}
0 = \spacegrad^2 \Theta.
\end{equation}
\end{subequations}

Note that we can obtain \ref{eqn:inclinedFlowWithoutConstantHeightAssumption:150} much more directly, if we know that's what we want to do.  Just operate on \ref{eqn:inclinedFlowWithoutConstantHeightAssumption:5} with the gradient from the left right off the bat.  We find

\begin{align*}
0 
&= -\spacegrad^2 p + \mu \spacegrad^3 \Bu \\
&= -\spacegrad^2 p + \mu \spacegrad^2 (\spacegrad \Bu) \\
&= -\spacegrad^2 p + \mu \spacegrad^2 (\spacegrad \wedge \Bu) \\
\end{align*}

Again, we have a multivector equation scalar and bivector parts, that must separately equal zero.  With the magnitude of the vorticity $\Theta$  given by \ref{eqn:inclinedFlowWithoutConstantHeightAssumption:90}, we once again obtain \ref{eqn:inclinedFlowWithoutConstantHeightAssumption:150}.  This can be done in plain old vector algebra as well by operating on the left not by the gradient, but separately with a divergence and curl operator.

\subsection{Pressure and vorticity equations with the non-linear term retained.}

If we add back in our body force, and assume that it is constant (i.e. gravity), then this this will get killed with the application of the gradient.  We'll still end up with one Laplacian for pressure, and one for vorticity.  That's not the case for the inertial $(\Bu \cdot \spacegrad) \Bu$ term of Navier-Stokes.  Let's take the divergence and curl of this and see how we have to modify the Laplacian equations above.

Starting with the divergence, with summation implied over repeated indexes, we have

\begin{align*}
\spacegrad \cdot ((\Bu \cdot \spacegrad) \Bu)
&=
\partial_k ( \Bu \cdot \spacegrad u_k ) \\
&=
\partial_k ( u_m \partial_m u_k ) \\
&=
(\partial_k u_m) (\partial_m u_k ) 
+ u_m \partial_m \partial_k u_k \\
&=
\sum_k (\partial_k u_k)^2
+
\sum_{k \ne m} (\partial_k u_m) (\partial_m u_k ) 
+ (\Bu \cdot \spacegrad) ( \spacegrad \cdot \Bu )
\end{align*}

So we have

\begin{equation}\label{eqn:inclinedFlowWithoutConstantHeightAssumption:480}
\spacegrad \cdot ((\Bu \cdot \spacegrad) \Bu)
=
\sum_k (\partial_k u_k)^2
+
2 \sum_{k < m} (\partial_k u_m) (\partial_m u_k ) 
+ (\Bu \cdot \spacegrad) ( \spacegrad \cdot \Bu )
\end{equation}

We are working with the $\spacegrad \cdot \Bu = 0$ incompressibility assumption so we kill off the last term.  Our velocity ends up introducing a non-homogeneous forcing term to the Laplacian pressure equation and we've got something trickier to solve

\begin{equation}\label{eqn:inclinedFlowWithoutConstantHeightAssumption:500}
\boxed{
\rho \sum_k (\partial_k u_k)^2
+
2 \rho \sum_{k < m} (\partial_k u_m) (\partial_m u_k ) 
=
-\spacegrad^2 p.
}
\end{equation}

Now let's see how our vorticity Laplacian needs to be modified.  Taking the curl of the impulsive term we have

\begin{align*}
\spacegrad \wedge ((\Bu \cdot \spacegrad) \Bu) 
&=
\Be_k \partial_k \wedge ( u_m \partial_m u_n \Be_n ) \\
&=
(\Be_k \wedge \Be_n) \partial_k ( u_m \partial_m u_n ) \\
&=
(\Be_k \wedge \Be_n) 
\left( 
(\partial_k u_m) (\partial_m u_n ) 
+u_m \partial_m \partial_k u_n 
\right) \\
&=
(\Be_k \wedge \Be_n) 
\left( 
(\partial_k u_m) (\partial_m u_n ) 
+ (\Bu \cdot \spacegrad) \partial_k u_n
\right) 
\end{align*}

So we have
\begin{equation}\label{eqn:inclinedFlowWithoutConstantHeightAssumption:520}
\spacegrad \wedge ((\Bu \cdot \spacegrad) \Bu) 
=
(\spacegrad u_m) \wedge (\partial_m \Bu)
+ (\Bu \cdot \spacegrad) (\spacegrad \wedge \Bu)
\end{equation}

Putting things back together, our vorticity equation is

\begin{equation}\label{eqn:inclinedFlowWithoutConstantHeightAssumption:540}
\rho (\spacegrad u_m) \wedge (\partial_m \Bu)
+ \rho (\Bu \cdot \spacegrad) (\spacegrad \wedge \Bu)
= 
\mu \spacegrad^2 (\spacegrad \wedge \Bu)
\end{equation}

Or, with

\begin{equation}\label{eqn:inclinedFlowWithoutConstantHeightAssumption:560}
\Bomega = \spacegrad \wedge \Bu,
\end{equation}

this is

\begin{equation}\label{eqn:inclinedFlowWithoutConstantHeightAssumption:580}
\boxed{
(\spacegrad u_m) \wedge (\partial_m \Bu) + (\Bu \cdot \spacegrad) \Bomega = \nu \spacegrad^2 \Bomega.
}
\end{equation}

It is this and \ref{eqn:inclinedFlowWithoutConstantHeightAssumption:500} that we really have to solve.  Before moving on, let's write out all the non-boundary condition equations in coordinate form for the 2D case that we are interested in here.  We have

\begin{subequations}
\begin{equation}\label{eqn:inclinedFlowWithoutConstantHeightAssumption:600}
\rho \left( \left(\PD{x}{u}\right)^2 +\left(\PD{y}{u}\right)^2 + 2 \PD{y}{u} \PD{x}{v} \right) = -\spacegrad^2 p
\end{equation}
\begin{equation}\label{eqn:inclinedFlowWithoutConstantHeightAssumption:620}
2 \left( 
\PD{x}{u} \PD{y}{v}
+\PD{x}{v} \PD{y}{v}
\right)
+ \left( u \PD{x}{} + v \PD{y}{} \right) \Theta
=
\nu \spacegrad^2 \Theta
\end{equation}
\begin{equation}\label{eqn:inclinedFlowWithoutConstantHeightAssumption:640}
\Theta = \PD{x}{v} - \PD{y}{u}
\end{equation}
\end{subequations}

Our solution has to satisfy these equations, as well as still satisfying the original Navier-Stokes system \ref{eqn:inclinedFlowWithoutConstantHeightAssumption:40} that includes our gravitational term, and also has to satisfy both of our boundary value constraints \ref{eqn:inclinedFlowWithoutConstantHeightAssumption:220}, \ref{eqn:inclinedFlowWithoutConstantHeightAssumption:280}, and have $u(x, 0) = v(x, 0) = 0$.  Wow, what a mess!  And this is all just the steady state problem.  Imagine adding time into the mix too!

\section{Now what?}

The strategy that I'd thought to attempt to tackle a problem with is something along the following lines

\begin{itemize}
\item First ignore the non-linear terms.  Find solutions for the homogeneous vorticity and pressure Laplacian equations that satisfy our boundary value conditions, and use that to find a first solution for $h(x)$.
\item Use this to solve for $u$ and $v$ from the vorticity.
\end{itemize}

However, after having gotten this far, just setting up the problem for solution, I think that it's perhaps best not to try to solve it yet, and study some more first.  I have a feeling that there are likely a number of techniques that have been developed that will likely be useful to know before I try to plow my way through things.  It's interesting to see just how tricky the equations of motion become when one doesn't make unrealistic assumptions.  I have a feeling that to actually attempt this specific problem, I may very well need a computer and numerical techniques.

%\EndArticle
\EndNoBibArticle
