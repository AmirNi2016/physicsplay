%
%
%
% Copyright © 2012 Peeter Joot
% All Rights Reserved
%
% This file may be reproduced and distributed in whole or in part, without fee, subject to the following conditions:
%
% o The copyright notice above and this permission notice must be preserved complete on all complete or partial copies.
%
% o Any translation or derived work must be approved by the author in writing before distribution.
%
% o If you distribute this work in part, instructions for obtaining the complete version of this file must be included, and a means for obtaining a complete version provided.
%
%
% Exceptions to these rules may be granted for academic purposes: Write to the author and ask.
%
%
%
%\input{../peeter_prologue_print.tex}
%\input{../peeter_prologue_widescreen.tex}

%\usepackage[english]{babel}
%\usepackage{media9}
\chapter{Steady state velocity profile of stirred cup of non-bottomless coffee.}

\label{chap:coffeeCupWithBottom}
%\useCCL
\blogpage{http://sites.google.com/site/peeterjoot2/math2012/coffeeCupWithBottom.pdf}
\date{Apr 29, 2012}
\gitRevisionInfo{coffeeCupWithBottom}
\keywords{Navier-Stokes, PHY454H1S, PHY454H1}

\beginArtWithToc
%\beginArtNoToc
%\wordpresscategory{}

\section{Motivation.}

Having tackled the problem of the spin down of a bottomless cup of coffee, lets try setting up the harder problem with a non-infinite cup.  It turns out that this is a lot harder.  Even the steady state solution requires a superposition of Bessel functions (whereas we only had that in the bottomless problem when we tried to find the time evolution after ceasing the stirring).  

I can find the form of the solution, but don't know how to actually apply the boundary value constraints.  I also find the no-slip constraints themselves become problematic, because they lead to an inconsistency at the point of contact of a moving and a static interface.  Before continuing, I need to find out how to deal with that inconsistency.

\section{Navier-Stokes for the problem.}

Working in cylindrical coordinates is the only sensible option.  Let's look first at the steady state problem, with the cup being stirred at at constant rate with the unrealistic rotating cylinder  stir stick used previously.  We'll assume an azimuthal velocity profile

\begin{equation}\label{eqn:coffeeCupWithBottom:10}
\Bu = u(r, z, t) \phicap.
\end{equation}

Let's first verify that this satisfies our incompressible condition

\begin{equation}\label{eqn:coffeeCupWithBottom:30}
\begin{aligned}
\spacegrad \cdot \Bu
&=
\left( \rcap \partial_r + \frac{\phicap}{r} \partial_\phi + \zcap \partial_z \right) \cdot ( u \phicap ) \\
&=
\cancel{\rcap \cdot \phicap} \partial_r u 
+ \frac{\phicap}{r} \cdot (u \partial_\phi \phicap + \phicap \cancel{\partial_\phi u})
+ \cancel{\zcap \cdot \phicap} \partial_z u.
\end{aligned}
\end{equation}

The only term that survives is the $\partial_\phi \phicap = -\rcap$ but that's perpendicular to $\phicap$ so we have $0 = \spacegrad \cdot \Bu$ as desired.  This leaves us with

\begin{equation}\label{eqn:coffeeCupWithBottom:50}
\frac{u}{r} \partial_\phi ( u \phicap )
= -\inv{\rho} 
\left( \rcap \partial_r + \frac{\phicap}{r} \partial_\phi + \zcap \partial_z \right) p
+ \nu 
\left( \inv{r} \partial_r ( r \partial_r ) + \frac{1}{r^2} \partial_{\phi \phi} + \partial_{zz} \right) u \phicap + \Bg
\end{equation}

Splitting into $\phicap, \rcap, \zcap$ coordinates respectively we have

\begin{subequations}
\begin{equation}\label{eqn:coffeeCupWithBottom:70}
0 = -\inv{r \rho} \partial_\phi p + \nu \left( \inv{r} \partial_r ( r \partial_r u ) - \frac{u}{r^2} + \partial_{zz} u \right) 
\end{equation}
\begin{equation}\label{eqn:coffeeCupWithBottom:90}
- \frac{u^2}{r} = -\inv{\rho} \partial_r p 
\end{equation}
\begin{equation}\label{eqn:coffeeCupWithBottom:110}
0 = -\inv{\rho} \partial_z p - g.
\end{equation}
\end{subequations}

Demanding a symmetrical solution kills off the pressure term in \ref{eqn:coffeeCupWithBottom:70}, and we can proceed with separation of variables to find the allowable solutions for the velocity before imposing our boundary value conditions.  With $u = R(r) Z(z)$ we have

\begin{equation}\label{eqn:coffeeCupWithBottom:130}
\inv{r R} ( R' + r R'' ) - \frac{1}{r^2} = -\frac{Z''}{Z} = -\inv{a^2} = \inv{b^2}
\end{equation}

Should we pick a negative or a positive constant here (ie: trig or hyperbolic functions for $Z$)?  Allowing for both temporarily, we find for $R$

\begin{subequations}
\begin{equation}\label{eqn:coffeeCupWithBottom:150}
0 = r R' + r^2 R'' + R \left( -1 + \frac{r^2}{a^2} \right) 
\end{equation}
\begin{equation}\label{eqn:coffeeCupWithBottom:170}
0 = r R' + r^2 R'' + R \left( -1 - \frac{r^2}{b^2} \right).
\end{equation}
\end{subequations}

Using Mathematica (\href{https://raw.github.com/peeterjoot/physicsplay/master/notes/phy454/coffeeCupWithBottom.cdf}{phy454/coffeeCupWithBottom.cdf}) to look up the solutions, we find that this was a Bessel equation with solutions

\begin{subequations}
\begin{equation}\label{eqn:coffeeCupWithBottom:190}
R(r) \in \Span \{ J_1(r/a), Y_1(r/a) \} 
\end{equation}
\begin{equation}\label{eqn:coffeeCupWithBottom:210}
R(r) \in \Span \{ J_1(i r/b), Y_1(i r/b) \}.
\end{equation}
\end{subequations}

However, the second set are not real valued for $r > 0$.  This means we want the hyperbolic solutions for $Z$.  Because we also have a boundary value constrain of $u = 0$ on the bottom of the cup, we can pick only hyperbolic sine solutions.  As before, we'll ``stir'' the coffee with a cylinder at radius $s$ (with cup radius $R$), our solution has the form

\begin{equation}\label{eqn:coffeeCupWithBottom:230}
u(r, z, 0) = 
\left\{
\begin{array}{l l}
s \Omega
\sum 
C_a J_1(r/a) \sinh(z/a)
& \quad \mbox{$r < s$} \\
s \Omega
\sum 
\left( D_a J_1(r/a) + E_a Y_1(r/a) \right) \sinh(z/a)
 & \quad \mbox{$r \in [s, R]$} \\
\end{array}
\right.
\end{equation}

Observe that, regardless of $a$ we have $u(0, z, 0) = 0$ because $J_1(0) = 0$.  We also can't scale $a$ as $\lambda_i/s$ (where $\lambda_i$ are the zeros of $J_1$) when the stirring isn't at the edge since we need $u(s, z, 0) = \Omega s$.  That suggests that we probably want to write our system as

\begin{equation}\label{eqn:coffeeCupWithBottom:230b}
u(r, z, 0) = 
\left\{
\begin{array}{l l}
s \Omega
\sum 
C_i J_1(\lambda_i r/R) \sinh(\lambda_i z/R)
& \quad \mbox{$r < s$} \\
s \Omega
\sum 
\left( D_i J_1(\lambda_i r/R) + E_i Y_1(\lambda_i r/R) \right) \sinh(\lambda_i z/R)
 & \quad \mbox{$r \in [s, R]$} \\
\end{array}
\right.
\end{equation}

The boundary value constraints of $u(r = s) = \Omega s$ and $u(r = R) = 0$ require the solution of

\begin{subequations}
\begin{equation}\label{eqn:coffeeCupWithBottom:310}
1 = \sum C_i J_1(\lambda_i s/R) \sinh(\lambda_i z/R) 
\end{equation}
\begin{equation}\label{eqn:coffeeCupWithBottom:330}
1 = \sum \left( D_i J_1(\lambda_i s/R) + E_i Y_1(\lambda_i s/R) \right) \sinh(\lambda_i z/R)
\end{equation}
\begin{equation}\label{eqn:coffeeCupWithBottom:350}
0 = \sum E_i Y_1(\lambda_i) \sinh(\lambda_i z/R).
\end{equation}
\end{subequations}

We know how to solve a system like \ref{eqn:coffeeCupWithBottom:310} if we did not have the $\sinh$ term in the mix.  Can we look for a numerical (least squares?) solution to this more general problem.  Will it be possible to find something that's a good fit regardless of the value of $z$?

We have other troubles too.  We can't simultaneously satisfy the boundary value condition of $u(s, z) = \Omega s$ and also $u(s, 0) = 0$.  Should we attempt something like a least squares solution and start going near $z = 0$ the small $\sinh$ values near there will start forcing the $C_i$'s arbitrarily high.

We have to somehow modify the no-slip condition so that when we have a moving interface in contact with a static interface we somehow deal with the fact that the no-slip constraints cannot simultaneously require the velocity to match both the moving and static interfaces at that point of contact.

%This is clearly going to be an easier problem to solve, if we stir the coffee on the outside edge of the cup only ($s = R$).  Lets start with the inside region and see how far we get.  We've got to match a $u(s, z, 0) = s \Omega$ boundary value constraint, where $\Omega$ is the angular velocity of the stirring.  

%We know how to solve that, since we had a similar problem for the $t = 0$ boundary value constraint in the bottomless spin down problem.  Writing $\lambda_i/s = 1/a$ where $\lambda_i$ are the zeros of the $J_1$ we can almost put things in a form that we know how to solve
%
%\begin{equation}\label{eqn:coffeeCupWithBottom:250}
%1 = \sum_i C_i J_1(\lambda_i r/s) \sinh( \lambda_i z/s)
%\end{equation}
%
%If that $\sinh$ were not there, then we could solve this with
%
%\begin{equation}\label{eqn:coffeeCupWithBottom:270}
%C_i = 
%\frac{
%\int_0^1 w J_1 (\lambda_i w) dw
%}{
%\int_0^1 w J_1^2 (\lambda_i w) dw
%}.
%\end{equation}
%
%It's not clear how to solve this more general problem.  In fact, thinking about doing so numerically, we see there's a problem.  
%
%Let's try this numerically, looking for least square solutions for the unknown coefficents that satisfy
%
%\begin{equation}\label{eqn:coffeeCupWithBottom:290}
%u(r, z, 0) = 
%\left\{
%%\begin{array}{l l}
%s \Omega
%\sum 
%C_i J_1\left(\lambda_i \frac{r}{s}\right) \sinh\left(\lambda_i \frac{z}{s}\right)
%& \quad \mbox{$r < s$} \\
%s \Omega
%\sum 
%\left( D_i J_1\left(\lambda_i \frac{r-s}{R-s}\right) + E_i Y_1\left(\lambda_i \frac{r-s}{R-s}\right) \right) \sinh\left(\lambda_i \frac{z}{R-s}\right)
% & \quad \mbox{$r \in [s, R]$} \\
%\end{array}
%\right.
%\end{equation}
%
%Hmm, this doesn't work either.  In the first we have a zero on the RHS when $r = s$.

%\EndArticle
\EndNoBibArticle
